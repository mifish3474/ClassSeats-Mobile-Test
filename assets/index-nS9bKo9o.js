(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Dy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Bm={exports:{}},ia={},Wm={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=Symbol.for("react.element"),Ly=Symbol.for("react.portal"),My=Symbol.for("react.fragment"),Oy=Symbol.for("react.strict_mode"),Fy=Symbol.for("react.profiler"),Uy=Symbol.for("react.provider"),zy=Symbol.for("react.context"),$y=Symbol.for("react.forward_ref"),By=Symbol.for("react.suspense"),Wy=Symbol.for("react.memo"),Hy=Symbol.for("react.lazy"),Jf=Symbol.iterator;function Vy(e){return e===null||typeof e!="object"?null:(e=Jf&&e[Jf]||e["@@iterator"],typeof e=="function"?e:null)}var Hm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vm=Object.assign,Km={};function Xs(e,t,n){this.props=e,this.context=t,this.refs=Km,this.updater=n||Hm}Xs.prototype.isReactComponent={};Xs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Gm(){}Gm.prototype=Xs.prototype;function $c(e,t,n){this.props=e,this.context=t,this.refs=Km,this.updater=n||Hm}var Bc=$c.prototype=new Gm;Bc.constructor=$c;Vm(Bc,Xs.prototype);Bc.isPureReactComponent=!0;var qf=Array.isArray,Ym=Object.prototype.hasOwnProperty,Wc={current:null},Qm={key:!0,ref:!0,__self:!0,__source:!0};function Jm(e,t,n){var r,s={},o=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(o=""+t.key),t)Ym.call(t,r)&&!Qm.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var c=Array(u),f=0;f<u;f++)c[f]=arguments[f+2];s.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:yl,type:e,key:o,ref:l,props:s,_owner:Wc.current}}function Ky(e,t){return{$$typeof:yl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Hc(e){return typeof e=="object"&&e!==null&&e.$$typeof===yl}function Gy(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Xf=/\/+/g;function Za(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Gy(""+e.key):t.toString(36)}function mi(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case yl:case Ly:l=!0}}if(l)return l=e,s=s(l),e=r===""?"."+Za(l,0):r,qf(s)?(n="",e!=null&&(n=e.replace(Xf,"$&/")+"/"),mi(s,t,n,"",function(f){return f})):s!=null&&(Hc(s)&&(s=Ky(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Xf,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=r===""?".":r+":",qf(e))for(var u=0;u<e.length;u++){o=e[u];var c=r+Za(o,u);l+=mi(o,t,n,c,s)}else if(c=Vy(e),typeof c=="function")for(e=c.call(e),u=0;!(o=e.next()).done;)o=o.value,c=r+Za(o,u++),l+=mi(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Gl(e,t,n){if(e==null)return e;var r=[],s=0;return mi(e,r,"","",function(o){return t.call(n,o,s++)}),r}function Yy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rt={current:null},hi={transition:null},Qy={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:hi,ReactCurrentOwner:Wc};function qm(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:Gl,forEach:function(e,t,n){Gl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Gl(e,function(){t++}),t},toArray:function(e){return Gl(e,function(t){return t})||[]},only:function(e){if(!Hc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ie.Component=Xs;ie.Fragment=My;ie.Profiler=Fy;ie.PureComponent=$c;ie.StrictMode=Oy;ie.Suspense=By;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qy;ie.act=qm;ie.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Vm({},e.props),s=e.key,o=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,l=Wc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)Ym.call(t,c)&&!Qm.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&u!==void 0?u[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];r.children=u}return{$$typeof:yl,type:e.type,key:s,ref:o,props:r,_owner:l}};ie.createContext=function(e){return e={$$typeof:zy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Uy,_context:e},e.Consumer=e};ie.createElement=Jm;ie.createFactory=function(e){var t=Jm.bind(null,e);return t.type=e,t};ie.createRef=function(){return{current:null}};ie.forwardRef=function(e){return{$$typeof:$y,render:e}};ie.isValidElement=Hc;ie.lazy=function(e){return{$$typeof:Hy,_payload:{_status:-1,_result:e},_init:Yy}};ie.memo=function(e,t){return{$$typeof:Wy,type:e,compare:t===void 0?null:t}};ie.startTransition=function(e){var t=hi.transition;hi.transition={};try{e()}finally{hi.transition=t}};ie.unstable_act=qm;ie.useCallback=function(e,t){return Rt.current.useCallback(e,t)};ie.useContext=function(e){return Rt.current.useContext(e)};ie.useDebugValue=function(){};ie.useDeferredValue=function(e){return Rt.current.useDeferredValue(e)};ie.useEffect=function(e,t){return Rt.current.useEffect(e,t)};ie.useId=function(){return Rt.current.useId()};ie.useImperativeHandle=function(e,t,n){return Rt.current.useImperativeHandle(e,t,n)};ie.useInsertionEffect=function(e,t){return Rt.current.useInsertionEffect(e,t)};ie.useLayoutEffect=function(e,t){return Rt.current.useLayoutEffect(e,t)};ie.useMemo=function(e,t){return Rt.current.useMemo(e,t)};ie.useReducer=function(e,t,n){return Rt.current.useReducer(e,t,n)};ie.useRef=function(e){return Rt.current.useRef(e)};ie.useState=function(e){return Rt.current.useState(e)};ie.useSyncExternalStore=function(e,t,n){return Rt.current.useSyncExternalStore(e,t,n)};ie.useTransition=function(){return Rt.current.useTransition()};ie.version="18.3.1";Wm.exports=ie;var d=Wm.exports;const Ds=Dy(d);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy=d,qy=Symbol.for("react.element"),Xy=Symbol.for("react.fragment"),Zy=Object.prototype.hasOwnProperty,ex=Jy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tx={key:!0,ref:!0,__self:!0,__source:!0};function Xm(e,t,n){var r,s={},o=null,l=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Zy.call(t,r)&&!tx.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:qy,type:e,key:o,ref:l,props:s,_owner:ex.current}}ia.Fragment=Xy;ia.jsx=Xm;ia.jsxs=Xm;Bm.exports=ia;var i=Bm.exports,Uu={},Zm={exports:{}},Ht={},eh={exports:{}},th={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,q){var X=U.length;U.push(q);e:for(;0<X;){var se=X-1>>>1,D=U[se];if(0<s(D,q))U[se]=q,U[X]=D,X=se;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var q=U[0],X=U.pop();if(X!==q){U[0]=X;e:for(var se=0,D=U.length,Be=D>>>1;se<Be;){var I=2*(se+1)-1,_e=U[I],Oe=I+1,Te=U[Oe];if(0>s(_e,X))Oe<D&&0>s(Te,_e)?(U[se]=Te,U[Oe]=X,se=Oe):(U[se]=_e,U[I]=X,se=I);else if(Oe<D&&0>s(Te,X))U[se]=Te,U[Oe]=X,se=Oe;else break e}}return q}function s(U,q){var X=U.sortIndex-q.sortIndex;return X!==0?X:U.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var c=[],f=[],g=1,w=null,S=3,R=!1,k=!1,j=!1,Q=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var q=n(f);q!==null;){if(q.callback===null)r(f);else if(q.startTime<=U)r(f),q.sortIndex=q.expirationTime,t(c,q);else break;q=n(f)}}function _(U){if(j=!1,b(U),!k)if(n(c)!==null)k=!0,et(T);else{var q=n(f);q!==null&&tt(_,q.startTime-U)}}function T(U,q){k=!1,j&&(j=!1,h(z),z=-1),R=!0;var X=S;try{for(b(q),w=n(c);w!==null&&(!(w.expirationTime>q)||U&&!me());){var se=w.callback;if(typeof se=="function"){w.callback=null,S=w.priorityLevel;var D=se(w.expirationTime<=q);q=e.unstable_now(),typeof D=="function"?w.callback=D:w===n(c)&&r(c),b(q)}else r(c);w=n(c)}if(w!==null)var Be=!0;else{var I=n(f);I!==null&&tt(_,I.startTime-q),Be=!1}return Be}finally{w=null,S=X,R=!1}}var $=!1,B=null,z=-1,re=5,Z=-1;function me(){return!(e.unstable_now()-Z<re)}function ze(){if(B!==null){var U=e.unstable_now();Z=U;var q=!0;try{q=B(!0,U)}finally{q?it():($=!1,B=null)}}else $=!1}var it;if(typeof m=="function")it=function(){m(ze)};else if(typeof MessageChannel<"u"){var Ze=new MessageChannel,$e=Ze.port2;Ze.port1.onmessage=ze,it=function(){$e.postMessage(null)}}else it=function(){Q(ze,0)};function et(U){B=U,$||($=!0,it())}function tt(U,q){z=Q(function(){U(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){k||R||(k=!0,et(T))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(U){switch(S){case 1:case 2:case 3:var q=3;break;default:q=S}var X=S;S=q;try{return U()}finally{S=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,q){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var X=S;S=U;try{return q()}finally{S=X}},e.unstable_scheduleCallback=function(U,q,X){var se=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?se+X:se):X=se,U){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=X+D,U={id:g++,callback:q,priorityLevel:U,startTime:X,expirationTime:D,sortIndex:-1},X>se?(U.sortIndex=X,t(f,U),n(c)===null&&U===n(f)&&(j?(h(z),z=-1):j=!0,tt(_,X-se))):(U.sortIndex=D,t(c,U),k||R||(k=!0,et(T))),U},e.unstable_shouldYield=me,e.unstable_wrapCallback=function(U){var q=S;return function(){var X=S;S=q;try{return U.apply(this,arguments)}finally{S=X}}}})(th);eh.exports=th;var nx=eh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rx=d,Wt=nx;function M(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nh=new Set,Xo={};function ss(e,t){Bs(e,t),Bs(e+"Capture",t)}function Bs(e,t){for(Xo[e]=t,e=0;e<t.length;e++)nh.add(t[e])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zu=Object.prototype.hasOwnProperty,sx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zf={},ep={};function ox(e){return zu.call(ep,e)?!0:zu.call(Zf,e)?!1:sx.test(e)?ep[e]=!0:(Zf[e]=!0,!1)}function lx(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ix(e,t,n,r){if(t===null||typeof t>"u"||lx(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _t(e,t,n,r,s,o,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mt[e]=new _t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mt[t]=new _t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mt[e]=new _t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mt[e]=new _t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mt[e]=new _t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mt[e]=new _t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mt[e]=new _t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mt[e]=new _t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mt[e]=new _t(e,5,!1,e.toLowerCase(),null,!1,!1)});var Vc=/[\-:]([a-z])/g;function Kc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Vc,Kc);mt[t]=new _t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Vc,Kc);mt[t]=new _t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Vc,Kc);mt[t]=new _t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mt[e]=new _t(e,1,!1,e.toLowerCase(),null,!1,!1)});mt.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mt[e]=new _t(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gc(e,t,n,r){var s=mt.hasOwnProperty(t)?mt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ix(t,n,s,r)&&(n=null),r||s===null?ox(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Gn=rx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yl=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Ss=Symbol.for("react.fragment"),Yc=Symbol.for("react.strict_mode"),$u=Symbol.for("react.profiler"),rh=Symbol.for("react.provider"),sh=Symbol.for("react.context"),Qc=Symbol.for("react.forward_ref"),Bu=Symbol.for("react.suspense"),Wu=Symbol.for("react.suspense_list"),Jc=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),oh=Symbol.for("react.offscreen"),tp=Symbol.iterator;function So(e){return e===null||typeof e!="object"?null:(e=tp&&e[tp]||e["@@iterator"],typeof e=="function"?e:null)}var Me=Object.assign,eu;function Io(e){if(eu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);eu=t&&t[1]||""}return`
`+eu+e}var tu=!1;function nu(e,t){if(!e||tu)return"";tu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var r=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){r=f}e.call(t.prototype)}else{try{throw Error()}catch(f){r=f}e()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var s=f.stack.split(`
`),o=r.stack.split(`
`),l=s.length-1,u=o.length-1;1<=l&&0<=u&&s[l]!==o[u];)u--;for(;1<=l&&0<=u;l--,u--)if(s[l]!==o[u]){if(l!==1||u!==1)do if(l--,u--,0>u||s[l]!==o[u]){var c=`
`+s[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=u);break}}}finally{tu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Io(e):""}function ax(e){switch(e.tag){case 5:return Io(e.type);case 16:return Io("Lazy");case 13:return Io("Suspense");case 19:return Io("SuspenseList");case 0:case 2:case 15:return e=nu(e.type,!1),e;case 11:return e=nu(e.type.render,!1),e;case 1:return e=nu(e.type,!0),e;default:return""}}function Hu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ss:return"Fragment";case ws:return"Portal";case $u:return"Profiler";case Yc:return"StrictMode";case Bu:return"Suspense";case Wu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sh:return(e.displayName||"Context")+".Consumer";case rh:return(e._context.displayName||"Context")+".Provider";case Qc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jc:return t=e.displayName||null,t!==null?t:Hu(e.type)||"Memo";case or:t=e._payload,e=e._init;try{return Hu(e(t))}catch{}}return null}function ux(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hu(t);case 8:return t===Yc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Nr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cx(e){var t=lh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ql(e){e._valueTracker||(e._valueTracker=cx(e))}function ih(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=lh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ai(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vu(e,t){var n=t.checked;return Me({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function np(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Nr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ah(e,t){t=t.checked,t!=null&&Gc(e,"checked",t,!1)}function Ku(e,t){ah(e,t);var n=Nr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gu(e,t.type,n):t.hasOwnProperty("defaultValue")&&Gu(e,t.type,Nr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rp(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Gu(e,t,n){(t!=="number"||Ai(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Do=Array.isArray;function Ls(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Nr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Yu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(M(91));return Me({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sp(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(M(92));if(Do(n)){if(1<n.length)throw Error(M(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Nr(n)}}function uh(e,t){var n=Nr(t.value),r=Nr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function op(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ch(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ch(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Jl,dh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Jl=Jl||document.createElement("div"),Jl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Jl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Zo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var $o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dx=["Webkit","ms","Moz","O"];Object.keys($o).forEach(function(e){dx.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),$o[t]=$o[e]})});function fh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||$o.hasOwnProperty(e)&&$o[e]?(""+t).trim():t+"px"}function ph(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=fh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var fx=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ju(e,t){if(t){if(fx[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(M(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(M(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(M(61))}if(t.style!=null&&typeof t.style!="object")throw Error(M(62))}}function qu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xu=null;function qc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zu=null,Ms=null,Os=null;function lp(e){if(e=wl(e)){if(typeof Zu!="function")throw Error(M(280));var t=e.stateNode;t&&(t=fa(t),Zu(e.stateNode,e.type,t))}}function mh(e){Ms?Os?Os.push(e):Os=[e]:Ms=e}function hh(){if(Ms){var e=Ms,t=Os;if(Os=Ms=null,lp(e),t)for(e=0;e<t.length;e++)lp(t[e])}}function gh(e,t){return e(t)}function yh(){}var ru=!1;function xh(e,t,n){if(ru)return e(t,n);ru=!0;try{return gh(e,t,n)}finally{ru=!1,(Ms!==null||Os!==null)&&(yh(),hh())}}function el(e,t){var n=e.stateNode;if(n===null)return null;var r=fa(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(M(231,t,typeof n));return n}var ec=!1;if(Wn)try{var bo={};Object.defineProperty(bo,"passive",{get:function(){ec=!0}}),window.addEventListener("test",bo,bo),window.removeEventListener("test",bo,bo)}catch{ec=!1}function px(e,t,n,r,s,o,l,u,c){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(g){this.onError(g)}}var Bo=!1,Pi=null,Ii=!1,tc=null,mx={onError:function(e){Bo=!0,Pi=e}};function hx(e,t,n,r,s,o,l,u,c){Bo=!1,Pi=null,px.apply(mx,arguments)}function gx(e,t,n,r,s,o,l,u,c){if(hx.apply(this,arguments),Bo){if(Bo){var f=Pi;Bo=!1,Pi=null}else throw Error(M(198));Ii||(Ii=!0,tc=f)}}function os(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function vh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ip(e){if(os(e)!==e)throw Error(M(188))}function yx(e){var t=e.alternate;if(!t){if(t=os(e),t===null)throw Error(M(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return ip(s),e;if(o===r)return ip(s),t;o=o.sibling}throw Error(M(188))}if(n.return!==r.return)n=s,r=o;else{for(var l=!1,u=s.child;u;){if(u===n){l=!0,n=s,r=o;break}if(u===r){l=!0,r=s,n=o;break}u=u.sibling}if(!l){for(u=o.child;u;){if(u===n){l=!0,n=o,r=s;break}if(u===r){l=!0,r=o,n=s;break}u=u.sibling}if(!l)throw Error(M(189))}}if(n.alternate!==r)throw Error(M(190))}if(n.tag!==3)throw Error(M(188));return n.stateNode.current===n?e:t}function wh(e){return e=yx(e),e!==null?Sh(e):null}function Sh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sh(e);if(t!==null)return t;e=e.sibling}return null}var bh=Wt.unstable_scheduleCallback,ap=Wt.unstable_cancelCallback,xx=Wt.unstable_shouldYield,vx=Wt.unstable_requestPaint,Ge=Wt.unstable_now,wx=Wt.unstable_getCurrentPriorityLevel,Xc=Wt.unstable_ImmediatePriority,Nh=Wt.unstable_UserBlockingPriority,Di=Wt.unstable_NormalPriority,Sx=Wt.unstable_LowPriority,kh=Wt.unstable_IdlePriority,aa=null,jn=null;function bx(e){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(aa,e,void 0,(e.current.flags&128)===128)}catch{}}var un=Math.clz32?Math.clz32:jx,Nx=Math.log,kx=Math.LN2;function jx(e){return e>>>=0,e===0?32:31-(Nx(e)/kx|0)|0}var ql=64,Xl=4194304;function Lo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Li(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,l=n&268435455;if(l!==0){var u=l&~s;u!==0?r=Lo(u):(o&=l,o!==0&&(r=Lo(o)))}else l=n&~s,l!==0?r=Lo(l):o!==0&&(r=Lo(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-un(t),s=1<<n,r|=e[n],t&=~s;return r}function Cx(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ex(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-un(o),u=1<<l,c=s[l];c===-1?(!(u&n)||u&r)&&(s[l]=Cx(u,t)):c<=t&&(e.expiredLanes|=u),o&=~u}}function nc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function jh(){var e=ql;return ql<<=1,!(ql&4194240)&&(ql=64),e}function su(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-un(t),e[t]=n}function Rx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-un(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Zc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-un(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Se=0;function Ch(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Eh,ed,Rh,_h,Th,rc=!1,Zl=[],fr=null,pr=null,mr=null,tl=new Map,nl=new Map,ar=[],_x="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function up(e,t){switch(e){case"focusin":case"focusout":fr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":mr=null;break;case"pointerover":case"pointerout":tl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":nl.delete(t.pointerId)}}function No(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=wl(t),t!==null&&ed(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Tx(e,t,n,r,s){switch(t){case"focusin":return fr=No(fr,e,t,n,r,s),!0;case"dragenter":return pr=No(pr,e,t,n,r,s),!0;case"mouseover":return mr=No(mr,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return tl.set(o,No(tl.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,nl.set(o,No(nl.get(o)||null,e,t,n,r,s)),!0}return!1}function Ah(e){var t=Br(e.target);if(t!==null){var n=os(t);if(n!==null){if(t=n.tag,t===13){if(t=vh(n),t!==null){e.blockedOn=t,Th(e.priority,function(){Rh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=sc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Xu=r,n.target.dispatchEvent(r),Xu=null}else return t=wl(n),t!==null&&ed(t),e.blockedOn=n,!1;t.shift()}return!0}function cp(e,t,n){gi(e)&&n.delete(t)}function Ax(){rc=!1,fr!==null&&gi(fr)&&(fr=null),pr!==null&&gi(pr)&&(pr=null),mr!==null&&gi(mr)&&(mr=null),tl.forEach(cp),nl.forEach(cp)}function ko(e,t){e.blockedOn===t&&(e.blockedOn=null,rc||(rc=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,Ax)))}function rl(e){function t(s){return ko(s,e)}if(0<Zl.length){ko(Zl[0],e);for(var n=1;n<Zl.length;n++){var r=Zl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(fr!==null&&ko(fr,e),pr!==null&&ko(pr,e),mr!==null&&ko(mr,e),tl.forEach(t),nl.forEach(t),n=0;n<ar.length;n++)r=ar[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ar.length&&(n=ar[0],n.blockedOn===null);)Ah(n),n.blockedOn===null&&ar.shift()}var Fs=Gn.ReactCurrentBatchConfig,Mi=!0;function Px(e,t,n,r){var s=Se,o=Fs.transition;Fs.transition=null;try{Se=1,td(e,t,n,r)}finally{Se=s,Fs.transition=o}}function Ix(e,t,n,r){var s=Se,o=Fs.transition;Fs.transition=null;try{Se=4,td(e,t,n,r)}finally{Se=s,Fs.transition=o}}function td(e,t,n,r){if(Mi){var s=sc(e,t,n,r);if(s===null)mu(e,t,r,Oi,n),up(e,r);else if(Tx(s,e,t,n,r))r.stopPropagation();else if(up(e,r),t&4&&-1<_x.indexOf(e)){for(;s!==null;){var o=wl(s);if(o!==null&&Eh(o),o=sc(e,t,n,r),o===null&&mu(e,t,r,Oi,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else mu(e,t,r,null,n)}}var Oi=null;function sc(e,t,n,r){if(Oi=null,e=qc(r),e=Br(e),e!==null)if(t=os(e),t===null)e=null;else if(n=t.tag,n===13){if(e=vh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Oi=e,null}function Ph(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wx()){case Xc:return 1;case Nh:return 4;case Di:case Sx:return 16;case kh:return 536870912;default:return 16}default:return 16}}var cr=null,nd=null,yi=null;function Ih(){if(yi)return yi;var e,t=nd,n=t.length,r,s="value"in cr?cr.value:cr.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===s[o-r];r++);return yi=s.slice(e,1<r?1-r:void 0)}function xi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ei(){return!0}function dp(){return!1}function Vt(e){function t(n,r,s,o,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ei:dp,this.isPropagationStopped=dp,this}return Me(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ei)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ei)},persist:function(){},isPersistent:ei}),t}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rd=Vt(Zs),vl=Me({},Zs,{view:0,detail:0}),Dx=Vt(vl),ou,lu,jo,ua=Me({},vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jo&&(jo&&e.type==="mousemove"?(ou=e.screenX-jo.screenX,lu=e.screenY-jo.screenY):lu=ou=0,jo=e),ou)},movementY:function(e){return"movementY"in e?e.movementY:lu}}),fp=Vt(ua),Lx=Me({},ua,{dataTransfer:0}),Mx=Vt(Lx),Ox=Me({},vl,{relatedTarget:0}),iu=Vt(Ox),Fx=Me({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ux=Vt(Fx),zx=Me({},Zs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$x=Vt(zx),Bx=Me({},Zs,{data:0}),pp=Vt(Bx),Wx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Kx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Vx[e])?!!t[e]:!1}function sd(){return Kx}var Gx=Me({},vl,{key:function(e){if(e.key){var t=Wx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Hx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sd,charCode:function(e){return e.type==="keypress"?xi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Yx=Vt(Gx),Qx=Me({},ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mp=Vt(Qx),Jx=Me({},vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sd}),qx=Vt(Jx),Xx=Me({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zx=Vt(Xx),ev=Me({},ua,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tv=Vt(ev),nv=[9,13,27,32],od=Wn&&"CompositionEvent"in window,Wo=null;Wn&&"documentMode"in document&&(Wo=document.documentMode);var rv=Wn&&"TextEvent"in window&&!Wo,Dh=Wn&&(!od||Wo&&8<Wo&&11>=Wo),hp=" ",gp=!1;function Lh(e,t){switch(e){case"keyup":return nv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bs=!1;function sv(e,t){switch(e){case"compositionend":return Mh(t);case"keypress":return t.which!==32?null:(gp=!0,hp);case"textInput":return e=t.data,e===hp&&gp?null:e;default:return null}}function ov(e,t){if(bs)return e==="compositionend"||!od&&Lh(e,t)?(e=Ih(),yi=nd=cr=null,bs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dh&&t.locale!=="ko"?null:t.data;default:return null}}var lv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!lv[e.type]:t==="textarea"}function Oh(e,t,n,r){mh(r),t=Fi(t,"onChange"),0<t.length&&(n=new rd("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ho=null,sl=null;function iv(e){Yh(e,0)}function ca(e){var t=js(e);if(ih(t))return e}function av(e,t){if(e==="change")return t}var Fh=!1;if(Wn){var au;if(Wn){var uu="oninput"in document;if(!uu){var xp=document.createElement("div");xp.setAttribute("oninput","return;"),uu=typeof xp.oninput=="function"}au=uu}else au=!1;Fh=au&&(!document.documentMode||9<document.documentMode)}function vp(){Ho&&(Ho.detachEvent("onpropertychange",Uh),sl=Ho=null)}function Uh(e){if(e.propertyName==="value"&&ca(sl)){var t=[];Oh(t,sl,e,qc(e)),xh(iv,t)}}function uv(e,t,n){e==="focusin"?(vp(),Ho=t,sl=n,Ho.attachEvent("onpropertychange",Uh)):e==="focusout"&&vp()}function cv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ca(sl)}function dv(e,t){if(e==="click")return ca(t)}function fv(e,t){if(e==="input"||e==="change")return ca(t)}function pv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dn=typeof Object.is=="function"?Object.is:pv;function ol(e,t){if(dn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!zu.call(t,s)||!dn(e[s],t[s]))return!1}return!0}function wp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Sp(e,t){var n=wp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wp(n)}}function zh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $h(){for(var e=window,t=Ai();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ai(e.document)}return t}function ld(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mv(e){var t=$h(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&zh(n.ownerDocument.documentElement,n)){if(r!==null&&ld(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=Sp(n,o);var l=Sp(n,r);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hv=Wn&&"documentMode"in document&&11>=document.documentMode,Ns=null,oc=null,Vo=null,lc=!1;function bp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lc||Ns==null||Ns!==Ai(r)||(r=Ns,"selectionStart"in r&&ld(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vo&&ol(Vo,r)||(Vo=r,r=Fi(oc,"onSelect"),0<r.length&&(t=new rd("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ns)))}function ti(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ks={animationend:ti("Animation","AnimationEnd"),animationiteration:ti("Animation","AnimationIteration"),animationstart:ti("Animation","AnimationStart"),transitionend:ti("Transition","TransitionEnd")},cu={},Bh={};Wn&&(Bh=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function da(e){if(cu[e])return cu[e];if(!ks[e])return e;var t=ks[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Bh)return cu[e]=t[n];return e}var Wh=da("animationend"),Hh=da("animationiteration"),Vh=da("animationstart"),Kh=da("transitionend"),Gh=new Map,Np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){Gh.set(e,t),ss(t,[e])}for(var du=0;du<Np.length;du++){var fu=Np[du],gv=fu.toLowerCase(),yv=fu[0].toUpperCase()+fu.slice(1);Cr(gv,"on"+yv)}Cr(Wh,"onAnimationEnd");Cr(Hh,"onAnimationIteration");Cr(Vh,"onAnimationStart");Cr("dblclick","onDoubleClick");Cr("focusin","onFocus");Cr("focusout","onBlur");Cr(Kh,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mo));function kp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,gx(r,t,void 0,e),e.currentTarget=null}function Yh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var u=r[l],c=u.instance,f=u.currentTarget;if(u=u.listener,c!==o&&s.isPropagationStopped())break e;kp(s,u,f),o=c}else for(l=0;l<r.length;l++){if(u=r[l],c=u.instance,f=u.currentTarget,u=u.listener,c!==o&&s.isPropagationStopped())break e;kp(s,u,f),o=c}}}if(Ii)throw e=tc,Ii=!1,tc=null,e}function Ee(e,t){var n=t[dc];n===void 0&&(n=t[dc]=new Set);var r=e+"__bubble";n.has(r)||(Qh(t,e,2,!1),n.add(r))}function pu(e,t,n){var r=0;t&&(r|=4),Qh(n,e,r,t)}var ni="_reactListening"+Math.random().toString(36).slice(2);function ll(e){if(!e[ni]){e[ni]=!0,nh.forEach(function(n){n!=="selectionchange"&&(xv.has(n)||pu(n,!1,e),pu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ni]||(t[ni]=!0,pu("selectionchange",!1,t))}}function Qh(e,t,n,r){switch(Ph(t)){case 1:var s=Px;break;case 4:s=Ix;break;default:s=td}n=s.bind(null,t,n,e),s=void 0,!ec||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function mu(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;l=l.return}for(;u!==null;){if(l=Br(u),l===null)return;if(c=l.tag,c===5||c===6){r=o=l;continue e}u=u.parentNode}}r=r.return}xh(function(){var f=o,g=qc(n),w=[];e:{var S=Gh.get(e);if(S!==void 0){var R=rd,k=e;switch(e){case"keypress":if(xi(n)===0)break e;case"keydown":case"keyup":R=Yx;break;case"focusin":k="focus",R=iu;break;case"focusout":k="blur",R=iu;break;case"beforeblur":case"afterblur":R=iu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=Mx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=qx;break;case Wh:case Hh:case Vh:R=Ux;break;case Kh:R=Zx;break;case"scroll":R=Dx;break;case"wheel":R=tv;break;case"copy":case"cut":case"paste":R=$x;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=mp}var j=(t&4)!==0,Q=!j&&e==="scroll",h=j?S!==null?S+"Capture":null:S;j=[];for(var m=f,b;m!==null;){b=m;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,h!==null&&(_=el(m,h),_!=null&&j.push(il(m,_,b)))),Q)break;m=m.return}0<j.length&&(S=new R(S,k,null,n,g),w.push({event:S,listeners:j}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",S&&n!==Xu&&(k=n.relatedTarget||n.fromElement)&&(Br(k)||k[Hn]))break e;if((R||S)&&(S=g.window===g?g:(S=g.ownerDocument)?S.defaultView||S.parentWindow:window,R?(k=n.relatedTarget||n.toElement,R=f,k=k?Br(k):null,k!==null&&(Q=os(k),k!==Q||k.tag!==5&&k.tag!==6)&&(k=null)):(R=null,k=f),R!==k)){if(j=fp,_="onMouseLeave",h="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(j=mp,_="onPointerLeave",h="onPointerEnter",m="pointer"),Q=R==null?S:js(R),b=k==null?S:js(k),S=new j(_,m+"leave",R,n,g),S.target=Q,S.relatedTarget=b,_=null,Br(g)===f&&(j=new j(h,m+"enter",k,n,g),j.target=b,j.relatedTarget=Q,_=j),Q=_,R&&k)t:{for(j=R,h=k,m=0,b=j;b;b=xs(b))m++;for(b=0,_=h;_;_=xs(_))b++;for(;0<m-b;)j=xs(j),m--;for(;0<b-m;)h=xs(h),b--;for(;m--;){if(j===h||h!==null&&j===h.alternate)break t;j=xs(j),h=xs(h)}j=null}else j=null;R!==null&&jp(w,S,R,j,!1),k!==null&&Q!==null&&jp(w,Q,k,j,!0)}}e:{if(S=f?js(f):window,R=S.nodeName&&S.nodeName.toLowerCase(),R==="select"||R==="input"&&S.type==="file")var T=av;else if(yp(S))if(Fh)T=fv;else{T=cv;var $=uv}else(R=S.nodeName)&&R.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(T=dv);if(T&&(T=T(e,f))){Oh(w,T,n,g);break e}$&&$(e,S,f),e==="focusout"&&($=S._wrapperState)&&$.controlled&&S.type==="number"&&Gu(S,"number",S.value)}switch($=f?js(f):window,e){case"focusin":(yp($)||$.contentEditable==="true")&&(Ns=$,oc=f,Vo=null);break;case"focusout":Vo=oc=Ns=null;break;case"mousedown":lc=!0;break;case"contextmenu":case"mouseup":case"dragend":lc=!1,bp(w,n,g);break;case"selectionchange":if(hv)break;case"keydown":case"keyup":bp(w,n,g)}var B;if(od)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else bs?Lh(e,n)&&(z="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(Dh&&n.locale!=="ko"&&(bs||z!=="onCompositionStart"?z==="onCompositionEnd"&&bs&&(B=Ih()):(cr=g,nd="value"in cr?cr.value:cr.textContent,bs=!0)),$=Fi(f,z),0<$.length&&(z=new pp(z,e,null,n,g),w.push({event:z,listeners:$}),B?z.data=B:(B=Mh(n),B!==null&&(z.data=B)))),(B=rv?sv(e,n):ov(e,n))&&(f=Fi(f,"onBeforeInput"),0<f.length&&(g=new pp("onBeforeInput","beforeinput",null,n,g),w.push({event:g,listeners:f}),g.data=B))}Yh(w,t)})}function il(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fi(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=el(e,n),o!=null&&r.unshift(il(e,o,s)),o=el(e,t),o!=null&&r.push(il(e,o,s))),e=e.return}return r}function xs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jp(e,t,n,r,s){for(var o=t._reactName,l=[];n!==null&&n!==r;){var u=n,c=u.alternate,f=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&f!==null&&(u=f,s?(c=el(n,o),c!=null&&l.unshift(il(n,c,u))):s||(c=el(n,o),c!=null&&l.push(il(n,c,u)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var vv=/\r\n?/g,wv=/\u0000|\uFFFD/g;function Cp(e){return(typeof e=="string"?e:""+e).replace(vv,`
`).replace(wv,"")}function ri(e,t,n){if(t=Cp(t),Cp(e)!==t&&n)throw Error(M(425))}function Ui(){}var ic=null,ac=null;function uc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var cc=typeof setTimeout=="function"?setTimeout:void 0,Sv=typeof clearTimeout=="function"?clearTimeout:void 0,Ep=typeof Promise=="function"?Promise:void 0,bv=typeof queueMicrotask=="function"?queueMicrotask:typeof Ep<"u"?function(e){return Ep.resolve(null).then(e).catch(Nv)}:cc;function Nv(e){setTimeout(function(){throw e})}function hu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),rl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);rl(t)}function hr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var eo=Math.random().toString(36).slice(2),kn="__reactFiber$"+eo,al="__reactProps$"+eo,Hn="__reactContainer$"+eo,dc="__reactEvents$"+eo,kv="__reactListeners$"+eo,jv="__reactHandles$"+eo;function Br(e){var t=e[kn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Hn]||n[kn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Rp(e);e!==null;){if(n=e[kn])return n;e=Rp(e)}return t}e=n,n=e.parentNode}return null}function wl(e){return e=e[kn]||e[Hn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function js(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(M(33))}function fa(e){return e[al]||null}var fc=[],Cs=-1;function Er(e){return{current:e}}function Re(e){0>Cs||(e.current=fc[Cs],fc[Cs]=null,Cs--)}function je(e,t){Cs++,fc[Cs]=e.current,e.current=t}var kr={},wt=Er(kr),It=Er(!1),Jr=kr;function Ws(e,t){var n=e.type.contextTypes;if(!n)return kr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dt(e){return e=e.childContextTypes,e!=null}function zi(){Re(It),Re(wt)}function _p(e,t,n){if(wt.current!==kr)throw Error(M(168));je(wt,t),je(It,n)}function Jh(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(M(108,ux(e)||"Unknown",s));return Me({},n,r)}function $i(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||kr,Jr=wt.current,je(wt,e),je(It,It.current),!0}function Tp(e,t,n){var r=e.stateNode;if(!r)throw Error(M(169));n?(e=Jh(e,t,Jr),r.__reactInternalMemoizedMergedChildContext=e,Re(It),Re(wt),je(wt,e)):Re(It),je(It,n)}var Fn=null,pa=!1,gu=!1;function qh(e){Fn===null?Fn=[e]:Fn.push(e)}function Cv(e){pa=!0,qh(e)}function Rr(){if(!gu&&Fn!==null){gu=!0;var e=0,t=Se;try{var n=Fn;for(Se=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Fn=null,pa=!1}catch(s){throw Fn!==null&&(Fn=Fn.slice(e+1)),bh(Xc,Rr),s}finally{Se=t,gu=!1}}return null}var Es=[],Rs=0,Bi=null,Wi=0,Qt=[],Jt=0,qr=null,Un=1,zn="";function Ur(e,t){Es[Rs++]=Wi,Es[Rs++]=Bi,Bi=e,Wi=t}function Xh(e,t,n){Qt[Jt++]=Un,Qt[Jt++]=zn,Qt[Jt++]=qr,qr=e;var r=Un;e=zn;var s=32-un(r)-1;r&=~(1<<s),n+=1;var o=32-un(t)+s;if(30<o){var l=s-s%5;o=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Un=1<<32-un(t)+s|n<<s|r,zn=o+e}else Un=1<<o|n<<s|r,zn=e}function id(e){e.return!==null&&(Ur(e,1),Xh(e,1,0))}function ad(e){for(;e===Bi;)Bi=Es[--Rs],Es[Rs]=null,Wi=Es[--Rs],Es[Rs]=null;for(;e===qr;)qr=Qt[--Jt],Qt[Jt]=null,zn=Qt[--Jt],Qt[Jt]=null,Un=Qt[--Jt],Qt[Jt]=null}var Bt=null,$t=null,Pe=!1,ln=null;function Zh(e,t){var n=qt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Ap(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Bt=e,$t=hr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Bt=e,$t=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=qr!==null?{id:Un,overflow:zn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=qt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Bt=e,$t=null,!0):!1;default:return!1}}function pc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mc(e){if(Pe){var t=$t;if(t){var n=t;if(!Ap(e,t)){if(pc(e))throw Error(M(418));t=hr(n.nextSibling);var r=Bt;t&&Ap(e,t)?Zh(r,n):(e.flags=e.flags&-4097|2,Pe=!1,Bt=e)}}else{if(pc(e))throw Error(M(418));e.flags=e.flags&-4097|2,Pe=!1,Bt=e}}}function Pp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Bt=e}function si(e){if(e!==Bt)return!1;if(!Pe)return Pp(e),Pe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!uc(e.type,e.memoizedProps)),t&&(t=$t)){if(pc(e))throw eg(),Error(M(418));for(;t;)Zh(e,t),t=hr(t.nextSibling)}if(Pp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(M(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$t=hr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$t=null}}else $t=Bt?hr(e.stateNode.nextSibling):null;return!0}function eg(){for(var e=$t;e;)e=hr(e.nextSibling)}function Hs(){$t=Bt=null,Pe=!1}function ud(e){ln===null?ln=[e]:ln.push(e)}var Ev=Gn.ReactCurrentBatchConfig;function Co(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(M(309));var r=n.stateNode}if(!r)throw Error(M(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(l){var u=s.refs;l===null?delete u[o]:u[o]=l},t._stringRef=o,t)}if(typeof e!="string")throw Error(M(284));if(!n._owner)throw Error(M(290,e))}return e}function oi(e,t){throw e=Object.prototype.toString.call(t),Error(M(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ip(e){var t=e._init;return t(e._payload)}function tg(e){function t(h,m){if(e){var b=h.deletions;b===null?(h.deletions=[m],h.flags|=16):b.push(m)}}function n(h,m){if(!e)return null;for(;m!==null;)t(h,m),m=m.sibling;return null}function r(h,m){for(h=new Map;m!==null;)m.key!==null?h.set(m.key,m):h.set(m.index,m),m=m.sibling;return h}function s(h,m){return h=vr(h,m),h.index=0,h.sibling=null,h}function o(h,m,b){return h.index=b,e?(b=h.alternate,b!==null?(b=b.index,b<m?(h.flags|=2,m):b):(h.flags|=2,m)):(h.flags|=1048576,m)}function l(h){return e&&h.alternate===null&&(h.flags|=2),h}function u(h,m,b,_){return m===null||m.tag!==6?(m=Nu(b,h.mode,_),m.return=h,m):(m=s(m,b),m.return=h,m)}function c(h,m,b,_){var T=b.type;return T===Ss?g(h,m,b.props.children,_,b.key):m!==null&&(m.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===or&&Ip(T)===m.type)?(_=s(m,b.props),_.ref=Co(h,m,b),_.return=h,_):(_=ji(b.type,b.key,b.props,null,h.mode,_),_.ref=Co(h,m,b),_.return=h,_)}function f(h,m,b,_){return m===null||m.tag!==4||m.stateNode.containerInfo!==b.containerInfo||m.stateNode.implementation!==b.implementation?(m=ku(b,h.mode,_),m.return=h,m):(m=s(m,b.children||[]),m.return=h,m)}function g(h,m,b,_,T){return m===null||m.tag!==7?(m=Qr(b,h.mode,_,T),m.return=h,m):(m=s(m,b),m.return=h,m)}function w(h,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Nu(""+m,h.mode,b),m.return=h,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Yl:return b=ji(m.type,m.key,m.props,null,h.mode,b),b.ref=Co(h,null,m),b.return=h,b;case ws:return m=ku(m,h.mode,b),m.return=h,m;case or:var _=m._init;return w(h,_(m._payload),b)}if(Do(m)||So(m))return m=Qr(m,h.mode,b,null),m.return=h,m;oi(h,m)}return null}function S(h,m,b,_){var T=m!==null?m.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:u(h,m,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Yl:return b.key===T?c(h,m,b,_):null;case ws:return b.key===T?f(h,m,b,_):null;case or:return T=b._init,S(h,m,T(b._payload),_)}if(Do(b)||So(b))return T!==null?null:g(h,m,b,_,null);oi(h,b)}return null}function R(h,m,b,_,T){if(typeof _=="string"&&_!==""||typeof _=="number")return h=h.get(b)||null,u(m,h,""+_,T);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Yl:return h=h.get(_.key===null?b:_.key)||null,c(m,h,_,T);case ws:return h=h.get(_.key===null?b:_.key)||null,f(m,h,_,T);case or:var $=_._init;return R(h,m,b,$(_._payload),T)}if(Do(_)||So(_))return h=h.get(b)||null,g(m,h,_,T,null);oi(m,_)}return null}function k(h,m,b,_){for(var T=null,$=null,B=m,z=m=0,re=null;B!==null&&z<b.length;z++){B.index>z?(re=B,B=null):re=B.sibling;var Z=S(h,B,b[z],_);if(Z===null){B===null&&(B=re);break}e&&B&&Z.alternate===null&&t(h,B),m=o(Z,m,z),$===null?T=Z:$.sibling=Z,$=Z,B=re}if(z===b.length)return n(h,B),Pe&&Ur(h,z),T;if(B===null){for(;z<b.length;z++)B=w(h,b[z],_),B!==null&&(m=o(B,m,z),$===null?T=B:$.sibling=B,$=B);return Pe&&Ur(h,z),T}for(B=r(h,B);z<b.length;z++)re=R(B,h,z,b[z],_),re!==null&&(e&&re.alternate!==null&&B.delete(re.key===null?z:re.key),m=o(re,m,z),$===null?T=re:$.sibling=re,$=re);return e&&B.forEach(function(me){return t(h,me)}),Pe&&Ur(h,z),T}function j(h,m,b,_){var T=So(b);if(typeof T!="function")throw Error(M(150));if(b=T.call(b),b==null)throw Error(M(151));for(var $=T=null,B=m,z=m=0,re=null,Z=b.next();B!==null&&!Z.done;z++,Z=b.next()){B.index>z?(re=B,B=null):re=B.sibling;var me=S(h,B,Z.value,_);if(me===null){B===null&&(B=re);break}e&&B&&me.alternate===null&&t(h,B),m=o(me,m,z),$===null?T=me:$.sibling=me,$=me,B=re}if(Z.done)return n(h,B),Pe&&Ur(h,z),T;if(B===null){for(;!Z.done;z++,Z=b.next())Z=w(h,Z.value,_),Z!==null&&(m=o(Z,m,z),$===null?T=Z:$.sibling=Z,$=Z);return Pe&&Ur(h,z),T}for(B=r(h,B);!Z.done;z++,Z=b.next())Z=R(B,h,z,Z.value,_),Z!==null&&(e&&Z.alternate!==null&&B.delete(Z.key===null?z:Z.key),m=o(Z,m,z),$===null?T=Z:$.sibling=Z,$=Z);return e&&B.forEach(function(ze){return t(h,ze)}),Pe&&Ur(h,z),T}function Q(h,m,b,_){if(typeof b=="object"&&b!==null&&b.type===Ss&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Yl:e:{for(var T=b.key,$=m;$!==null;){if($.key===T){if(T=b.type,T===Ss){if($.tag===7){n(h,$.sibling),m=s($,b.props.children),m.return=h,h=m;break e}}else if($.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===or&&Ip(T)===$.type){n(h,$.sibling),m=s($,b.props),m.ref=Co(h,$,b),m.return=h,h=m;break e}n(h,$);break}else t(h,$);$=$.sibling}b.type===Ss?(m=Qr(b.props.children,h.mode,_,b.key),m.return=h,h=m):(_=ji(b.type,b.key,b.props,null,h.mode,_),_.ref=Co(h,m,b),_.return=h,h=_)}return l(h);case ws:e:{for($=b.key;m!==null;){if(m.key===$)if(m.tag===4&&m.stateNode.containerInfo===b.containerInfo&&m.stateNode.implementation===b.implementation){n(h,m.sibling),m=s(m,b.children||[]),m.return=h,h=m;break e}else{n(h,m);break}else t(h,m);m=m.sibling}m=ku(b,h.mode,_),m.return=h,h=m}return l(h);case or:return $=b._init,Q(h,m,$(b._payload),_)}if(Do(b))return k(h,m,b,_);if(So(b))return j(h,m,b,_);oi(h,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,m!==null&&m.tag===6?(n(h,m.sibling),m=s(m,b),m.return=h,h=m):(n(h,m),m=Nu(b,h.mode,_),m.return=h,h=m),l(h)):n(h,m)}return Q}var Vs=tg(!0),ng=tg(!1),Hi=Er(null),Vi=null,_s=null,cd=null;function dd(){cd=_s=Vi=null}function fd(e){var t=Hi.current;Re(Hi),e._currentValue=t}function hc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Us(e,t){Vi=e,cd=_s=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pt=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(cd!==e)if(e={context:e,memoizedValue:t,next:null},_s===null){if(Vi===null)throw Error(M(308));_s=e,Vi.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Wr=null;function pd(e){Wr===null?Wr=[e]:Wr.push(e)}function rg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,pd(t)):(n.next=s.next,s.next=n),t.interleaved=n,Vn(e,r)}function Vn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var lr=!1;function md(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,de&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Vn(e,n)}return s=r.interleaved,s===null?(t.next=t,pd(r)):(t.next=s.next,s.next=t),r.interleaved=t,Vn(e,n)}function vi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Zc(e,n)}}function Dp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=l:o=o.next=l,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ki(e,t,n,r){var s=e.updateQueue;lr=!1;var o=s.firstBaseUpdate,l=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var c=u,f=c.next;c.next=null,l===null?o=f:l.next=f,l=c;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==l&&(u===null?g.firstBaseUpdate=f:u.next=f,g.lastBaseUpdate=c))}if(o!==null){var w=s.baseState;l=0,g=f=c=null,u=o;do{var S=u.lane,R=u.eventTime;if((r&S)===S){g!==null&&(g=g.next={eventTime:R,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var k=e,j=u;switch(S=t,R=n,j.tag){case 1:if(k=j.payload,typeof k=="function"){w=k.call(R,w,S);break e}w=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=j.payload,S=typeof k=="function"?k.call(R,w,S):k,S==null)break e;w=Me({},w,S);break e;case 2:lr=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[u]:S.push(u))}else R={eventTime:R,lane:S,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(f=g=R,c=w):g=g.next=R,l|=S;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;S=u,u=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(g===null&&(c=w),s.baseState=c,s.firstBaseUpdate=f,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Zr|=l,e.lanes=l,e.memoizedState=w}}function Lp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(M(191,s));s.call(r)}}}var Sl={},Cn=Er(Sl),ul=Er(Sl),cl=Er(Sl);function Hr(e){if(e===Sl)throw Error(M(174));return e}function hd(e,t){switch(je(cl,t),je(ul,e),je(Cn,Sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qu(t,e)}Re(Cn),je(Cn,t)}function Ks(){Re(Cn),Re(ul),Re(cl)}function og(e){Hr(cl.current);var t=Hr(Cn.current),n=Qu(t,e.type);t!==n&&(je(ul,e),je(Cn,n))}function gd(e){ul.current===e&&(Re(Cn),Re(ul))}var De=Er(0);function Gi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var yu=[];function yd(){for(var e=0;e<yu.length;e++)yu[e]._workInProgressVersionPrimary=null;yu.length=0}var wi=Gn.ReactCurrentDispatcher,xu=Gn.ReactCurrentBatchConfig,Xr=0,Le=null,qe=null,ot=null,Yi=!1,Ko=!1,dl=0,Rv=0;function yt(){throw Error(M(321))}function xd(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!dn(e[n],t[n]))return!1;return!0}function vd(e,t,n,r,s,o){if(Xr=o,Le=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wi.current=e===null||e.memoizedState===null?Pv:Iv,e=n(r,s),Ko){o=0;do{if(Ko=!1,dl=0,25<=o)throw Error(M(301));o+=1,ot=qe=null,t.updateQueue=null,wi.current=Dv,e=n(r,s)}while(Ko)}if(wi.current=Qi,t=qe!==null&&qe.next!==null,Xr=0,ot=qe=Le=null,Yi=!1,t)throw Error(M(300));return e}function wd(){var e=dl!==0;return dl=0,e}function bn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?Le.memoizedState=ot=e:ot=ot.next=e,ot}function en(){if(qe===null){var e=Le.alternate;e=e!==null?e.memoizedState:null}else e=qe.next;var t=ot===null?Le.memoizedState:ot.next;if(t!==null)ot=t,qe=e;else{if(e===null)throw Error(M(310));qe=e,e={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},ot===null?Le.memoizedState=ot=e:ot=ot.next=e}return ot}function fl(e,t){return typeof t=="function"?t(e):t}function vu(e){var t=en(),n=t.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=e;var r=qe,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var l=s.next;s.next=o.next,o.next=l}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var u=l=null,c=null,f=o;do{var g=f.lane;if((Xr&g)===g)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:e(r,f.action);else{var w={lane:g,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(u=c=w,l=r):c=c.next=w,Le.lanes|=g,Zr|=g}f=f.next}while(f!==null&&f!==o);c===null?l=r:c.next=u,dn(r,t.memoizedState)||(Pt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,Le.lanes|=o,Zr|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wu(e){var t=en(),n=t.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do o=e(o,l.action),l=l.next;while(l!==s);dn(o,t.memoizedState)||(Pt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function lg(){}function ig(e,t){var n=Le,r=en(),s=t(),o=!dn(r.memoizedState,s);if(o&&(r.memoizedState=s,Pt=!0),r=r.queue,Sd(cg.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||ot!==null&&ot.memoizedState.tag&1){if(n.flags|=2048,pl(9,ug.bind(null,n,r,s,t),void 0,null),lt===null)throw Error(M(349));Xr&30||ag(n,t,s)}return s}function ag(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Le.updateQueue,t===null?(t={lastEffect:null,stores:null},Le.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ug(e,t,n,r){t.value=n,t.getSnapshot=r,dg(t)&&fg(e)}function cg(e,t,n){return n(function(){dg(t)&&fg(e)})}function dg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!dn(e,n)}catch{return!0}}function fg(e){var t=Vn(e,1);t!==null&&cn(t,e,1,-1)}function Mp(e){var t=bn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fl,lastRenderedState:e},t.queue=e,e=e.dispatch=Av.bind(null,Le,e),[t.memoizedState,e]}function pl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Le.updateQueue,t===null?(t={lastEffect:null,stores:null},Le.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function pg(){return en().memoizedState}function Si(e,t,n,r){var s=bn();Le.flags|=e,s.memoizedState=pl(1|t,n,void 0,r===void 0?null:r)}function ma(e,t,n,r){var s=en();r=r===void 0?null:r;var o=void 0;if(qe!==null){var l=qe.memoizedState;if(o=l.destroy,r!==null&&xd(r,l.deps)){s.memoizedState=pl(t,n,o,r);return}}Le.flags|=e,s.memoizedState=pl(1|t,n,o,r)}function Op(e,t){return Si(8390656,8,e,t)}function Sd(e,t){return ma(2048,8,e,t)}function mg(e,t){return ma(4,2,e,t)}function hg(e,t){return ma(4,4,e,t)}function gg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function yg(e,t,n){return n=n!=null?n.concat([e]):null,ma(4,4,gg.bind(null,t,e),n)}function bd(){}function xg(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&xd(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function vg(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&xd(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function wg(e,t,n){return Xr&21?(dn(n,t)||(n=jh(),Le.lanes|=n,Zr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pt=!0),e.memoizedState=n)}function _v(e,t){var n=Se;Se=n!==0&&4>n?n:4,e(!0);var r=xu.transition;xu.transition={};try{e(!1),t()}finally{Se=n,xu.transition=r}}function Sg(){return en().memoizedState}function Tv(e,t,n){var r=xr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bg(e))Ng(t,n);else if(n=rg(e,t,n,r),n!==null){var s=Et();cn(n,e,r,s),kg(n,t,r)}}function Av(e,t,n){var r=xr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bg(e))Ng(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var l=t.lastRenderedState,u=o(l,n);if(s.hasEagerState=!0,s.eagerState=u,dn(u,l)){var c=t.interleaved;c===null?(s.next=s,pd(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=rg(e,t,s,r),n!==null&&(s=Et(),cn(n,e,r,s),kg(n,t,r))}}function bg(e){var t=e.alternate;return e===Le||t!==null&&t===Le}function Ng(e,t){Ko=Yi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function kg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Zc(e,n)}}var Qi={readContext:Zt,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},Pv={readContext:Zt,useCallback:function(e,t){return bn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:Op,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Si(4194308,4,gg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Si(4194308,4,e,t)},useInsertionEffect:function(e,t){return Si(4,2,e,t)},useMemo:function(e,t){var n=bn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Tv.bind(null,Le,e),[r.memoizedState,e]},useRef:function(e){var t=bn();return e={current:e},t.memoizedState=e},useState:Mp,useDebugValue:bd,useDeferredValue:function(e){return bn().memoizedState=e},useTransition:function(){var e=Mp(!1),t=e[0];return e=_v.bind(null,e[1]),bn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Le,s=bn();if(Pe){if(n===void 0)throw Error(M(407));n=n()}else{if(n=t(),lt===null)throw Error(M(349));Xr&30||ag(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Op(cg.bind(null,r,o,e),[e]),r.flags|=2048,pl(9,ug.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bn(),t=lt.identifierPrefix;if(Pe){var n=zn,r=Un;n=(r&~(1<<32-un(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=dl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Rv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Iv={readContext:Zt,useCallback:xg,useContext:Zt,useEffect:Sd,useImperativeHandle:yg,useInsertionEffect:mg,useLayoutEffect:hg,useMemo:vg,useReducer:vu,useRef:pg,useState:function(){return vu(fl)},useDebugValue:bd,useDeferredValue:function(e){var t=en();return wg(t,qe.memoizedState,e)},useTransition:function(){var e=vu(fl)[0],t=en().memoizedState;return[e,t]},useMutableSource:lg,useSyncExternalStore:ig,useId:Sg,unstable_isNewReconciler:!1},Dv={readContext:Zt,useCallback:xg,useContext:Zt,useEffect:Sd,useImperativeHandle:yg,useInsertionEffect:mg,useLayoutEffect:hg,useMemo:vg,useReducer:wu,useRef:pg,useState:function(){return wu(fl)},useDebugValue:bd,useDeferredValue:function(e){var t=en();return qe===null?t.memoizedState=e:wg(t,qe.memoizedState,e)},useTransition:function(){var e=wu(fl)[0],t=en().memoizedState;return[e,t]},useMutableSource:lg,useSyncExternalStore:ig,useId:Sg,unstable_isNewReconciler:!1};function sn(e,t){if(e&&e.defaultProps){t=Me({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function gc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Me({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ha={isMounted:function(e){return(e=e._reactInternals)?os(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),s=xr(e),o=$n(r,s);o.payload=t,n!=null&&(o.callback=n),t=gr(e,o,s),t!==null&&(cn(t,e,s,r),vi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),s=xr(e),o=$n(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=gr(e,o,s),t!==null&&(cn(t,e,s,r),vi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=xr(e),s=$n(n,r);s.tag=2,t!=null&&(s.callback=t),t=gr(e,s,r),t!==null&&(cn(t,e,r,n),vi(t,e,r))}};function Fp(e,t,n,r,s,o,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,l):t.prototype&&t.prototype.isPureReactComponent?!ol(n,r)||!ol(s,o):!0}function jg(e,t,n){var r=!1,s=kr,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=Dt(t)?Jr:wt.current,r=t.contextTypes,o=(r=r!=null)?Ws(e,s):kr),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ha,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Up(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ha.enqueueReplaceState(t,t.state,null)}function yc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},md(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=Dt(t)?Jr:wt.current,s.context=Ws(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(gc(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ha.enqueueReplaceState(s,s.state,null),Ki(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Gs(e,t){try{var n="",r=t;do n+=ax(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Su(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function xc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Lv=typeof WeakMap=="function"?WeakMap:Map;function Cg(e,t,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){qi||(qi=!0,Rc=r),xc(e,t)},n}function Eg(e,t,n){n=$n(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){xc(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){xc(e,t),typeof r!="function"&&(yr===null?yr=new Set([this]):yr.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function zp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Lv;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Qv.bind(null,e,t,n),t.then(e,e))}function $p(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Bp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$n(-1,1),t.tag=2,gr(n,t,1))),n.lanes|=1),e)}var Mv=Gn.ReactCurrentOwner,Pt=!1;function Ct(e,t,n,r){t.child=e===null?ng(t,null,n,r):Vs(t,e.child,n,r)}function Wp(e,t,n,r,s){n=n.render;var o=t.ref;return Us(t,s),r=vd(e,t,n,r,o,s),n=wd(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kn(e,t,s)):(Pe&&n&&id(t),t.flags|=1,Ct(e,t,r,s),t.child)}function Hp(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!Td(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,Rg(e,t,o,r,s)):(e=ji(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var l=o.memoizedProps;if(n=n.compare,n=n!==null?n:ol,n(l,r)&&e.ref===t.ref)return Kn(e,t,s)}return t.flags|=1,e=vr(o,r),e.ref=t.ref,e.return=t,t.child=e}function Rg(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(ol(o,r)&&e.ref===t.ref)if(Pt=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(Pt=!0);else return t.lanes=e.lanes,Kn(e,t,s)}return vc(e,t,n,r,s)}function _g(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(As,zt),zt|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,je(As,zt),zt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,je(As,zt),zt|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,je(As,zt),zt|=r;return Ct(e,t,s,n),t.child}function Tg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function vc(e,t,n,r,s){var o=Dt(n)?Jr:wt.current;return o=Ws(t,o),Us(t,s),n=vd(e,t,n,r,o,s),r=wd(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kn(e,t,s)):(Pe&&r&&id(t),t.flags|=1,Ct(e,t,n,s),t.child)}function Vp(e,t,n,r,s){if(Dt(n)){var o=!0;$i(t)}else o=!1;if(Us(t,s),t.stateNode===null)bi(e,t),jg(t,n,r),yc(t,n,r,s),r=!0;else if(e===null){var l=t.stateNode,u=t.memoizedProps;l.props=u;var c=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Zt(f):(f=Dt(n)?Jr:wt.current,f=Ws(t,f));var g=n.getDerivedStateFromProps,w=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function";w||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||c!==f)&&Up(t,l,r,f),lr=!1;var S=t.memoizedState;l.state=S,Ki(t,r,l,s),c=t.memoizedState,u!==r||S!==c||It.current||lr?(typeof g=="function"&&(gc(t,n,g,r),c=t.memoizedState),(u=lr||Fp(t,n,u,r,S,c,f))?(w||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),l.props=r,l.state=c,l.context=f,r=u):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,sg(e,t),u=t.memoizedProps,f=t.type===t.elementType?u:sn(t.type,u),l.props=f,w=t.pendingProps,S=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=Dt(n)?Jr:wt.current,c=Ws(t,c));var R=n.getDerivedStateFromProps;(g=typeof R=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==w||S!==c)&&Up(t,l,r,c),lr=!1,S=t.memoizedState,l.state=S,Ki(t,r,l,s);var k=t.memoizedState;u!==w||S!==k||It.current||lr?(typeof R=="function"&&(gc(t,n,R,r),k=t.memoizedState),(f=lr||Fp(t,n,f,r,S,k,c)||!1)?(g||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,k,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,k,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=k),l.props=r,l.state=k,l.context=c,r=f):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return wc(e,t,n,r,o,s)}function wc(e,t,n,r,s,o){Tg(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return s&&Tp(t,n,!1),Kn(e,t,o);r=t.stateNode,Mv.current=t;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Vs(t,e.child,null,o),t.child=Vs(t,null,u,o)):Ct(e,t,u,o),t.memoizedState=r.state,s&&Tp(t,n,!0),t.child}function Ag(e){var t=e.stateNode;t.pendingContext?_p(e,t.pendingContext,t.pendingContext!==t.context):t.context&&_p(e,t.context,!1),hd(e,t.containerInfo)}function Kp(e,t,n,r,s){return Hs(),ud(s),t.flags|=256,Ct(e,t,n,r),t.child}var Sc={dehydrated:null,treeContext:null,retryLane:0};function bc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pg(e,t,n){var r=t.pendingProps,s=De.current,o=!1,l=(t.flags&128)!==0,u;if((u=l)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),je(De,s&1),e===null)return mc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=xa(l,r,0,null),e=Qr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=bc(n),t.memoizedState=Sc,e):Nd(t,l));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return Ov(e,t,l,r,u,s,n);if(o){o=r.fallback,l=t.mode,s=e.child,u=s.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=vr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?o=vr(u,o):(o=Qr(o,l,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=e.child.memoizedState,l=l===null?bc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Sc,r}return o=e.child,e=o.sibling,r=vr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Nd(e,t){return t=xa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function li(e,t,n,r){return r!==null&&ud(r),Vs(t,e.child,null,n),e=Nd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ov(e,t,n,r,s,o,l){if(n)return t.flags&256?(t.flags&=-257,r=Su(Error(M(422))),li(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=xa({mode:"visible",children:r.children},s,0,null),o=Qr(o,s,l,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Vs(t,e.child,null,l),t.child.memoizedState=bc(l),t.memoizedState=Sc,o);if(!(t.mode&1))return li(e,t,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(M(419)),r=Su(o,r,void 0),li(e,t,l,r)}if(u=(l&e.childLanes)!==0,Pt||u){if(r=lt,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Vn(e,s),cn(r,e,s,-1))}return _d(),r=Su(Error(M(421))),li(e,t,l,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Jv.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,$t=hr(s.nextSibling),Bt=t,Pe=!0,ln=null,e!==null&&(Qt[Jt++]=Un,Qt[Jt++]=zn,Qt[Jt++]=qr,Un=e.id,zn=e.overflow,qr=t),t=Nd(t,r.children),t.flags|=4096,t)}function Gp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),hc(e.return,t,n)}function bu(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Ig(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(Ct(e,t,r.children,n),r=De.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Gp(e,n,t);else if(e.tag===19)Gp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(je(De,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Gi(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),bu(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Gi(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}bu(t,!0,n,null,o);break;case"together":bu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Kn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Zr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(M(153));if(t.child!==null){for(e=t.child,n=vr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=vr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Fv(e,t,n){switch(t.tag){case 3:Ag(t),Hs();break;case 5:og(t);break;case 1:Dt(t.type)&&$i(t);break;case 4:hd(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;je(Hi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(je(De,De.current&1),t.flags|=128,null):n&t.child.childLanes?Pg(e,t,n):(je(De,De.current&1),e=Kn(e,t,n),e!==null?e.sibling:null);je(De,De.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Ig(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),je(De,De.current),r)break;return null;case 22:case 23:return t.lanes=0,_g(e,t,n)}return Kn(e,t,n)}var Dg,Nc,Lg,Mg;Dg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Nc=function(){};Lg=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Hr(Cn.current);var o=null;switch(n){case"input":s=Vu(e,s),r=Vu(e,r),o=[];break;case"select":s=Me({},s,{value:void 0}),r=Me({},r,{value:void 0}),o=[];break;case"textarea":s=Yu(e,s),r=Yu(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ui)}Ju(n,r);var l;n=null;for(f in s)if(!r.hasOwnProperty(f)&&s.hasOwnProperty(f)&&s[f]!=null)if(f==="style"){var u=s[f];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Xo.hasOwnProperty(f)?o||(o=[]):(o=o||[]).push(f,null));for(f in r){var c=r[f];if(u=s!=null?s[f]:void 0,r.hasOwnProperty(f)&&c!==u&&(c!=null||u!=null))if(f==="style")if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(o||(o=[]),o.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(o=o||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Xo.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Ee("scroll",e),o||u===c||(o=[])):(o=o||[]).push(f,c))}n&&(o=o||[]).push("style",n);var f=o;(t.updateQueue=f)&&(t.flags|=4)}};Mg=function(e,t,n,r){n!==r&&(t.flags|=4)};function Eo(e,t){if(!Pe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Uv(e,t,n){var r=t.pendingProps;switch(ad(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(t),null;case 1:return Dt(t.type)&&zi(),xt(t),null;case 3:return r=t.stateNode,Ks(),Re(It),Re(wt),yd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(si(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ln!==null&&(Ac(ln),ln=null))),Nc(e,t),xt(t),null;case 5:gd(t);var s=Hr(cl.current);if(n=t.type,e!==null&&t.stateNode!=null)Lg(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(M(166));return xt(t),null}if(e=Hr(Cn.current),si(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[kn]=t,r[al]=o,e=(t.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(s=0;s<Mo.length;s++)Ee(Mo[s],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":np(r,o),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ee("invalid",r);break;case"textarea":sp(r,o),Ee("invalid",r)}Ju(n,o),s=null;for(var l in o)if(o.hasOwnProperty(l)){var u=o[l];l==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&ri(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&ri(r.textContent,u,e),s=["children",""+u]):Xo.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&Ee("scroll",r)}switch(n){case"input":Ql(r),rp(r,o,!0);break;case"textarea":Ql(r),op(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ui)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ch(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[kn]=t,e[al]=r,Dg(e,t,!1,!1),t.stateNode=e;e:{switch(l=qu(n,r),n){case"dialog":Ee("cancel",e),Ee("close",e),s=r;break;case"iframe":case"object":case"embed":Ee("load",e),s=r;break;case"video":case"audio":for(s=0;s<Mo.length;s++)Ee(Mo[s],e);s=r;break;case"source":Ee("error",e),s=r;break;case"img":case"image":case"link":Ee("error",e),Ee("load",e),s=r;break;case"details":Ee("toggle",e),s=r;break;case"input":np(e,r),s=Vu(e,r),Ee("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Me({},r,{value:void 0}),Ee("invalid",e);break;case"textarea":sp(e,r),s=Yu(e,r),Ee("invalid",e);break;default:s=r}Ju(n,s),u=s;for(o in u)if(u.hasOwnProperty(o)){var c=u[o];o==="style"?ph(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&dh(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Zo(e,c):typeof c=="number"&&Zo(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Xo.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Ee("scroll",e):c!=null&&Gc(e,o,c,l))}switch(n){case"input":Ql(e),rp(e,r,!1);break;case"textarea":Ql(e),op(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Nr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Ls(e,!!r.multiple,o,!1):r.defaultValue!=null&&Ls(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ui)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xt(t),null;case 6:if(e&&t.stateNode!=null)Mg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(M(166));if(n=Hr(cl.current),Hr(Cn.current),si(t)){if(r=t.stateNode,n=t.memoizedProps,r[kn]=t,(o=r.nodeValue!==n)&&(e=Bt,e!==null))switch(e.tag){case 3:ri(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ri(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[kn]=t,t.stateNode=r}return xt(t),null;case 13:if(Re(De),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pe&&$t!==null&&t.mode&1&&!(t.flags&128))eg(),Hs(),t.flags|=98560,o=!1;else if(o=si(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(M(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(M(317));o[kn]=t}else Hs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xt(t),o=!1}else ln!==null&&(Ac(ln),ln=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||De.current&1?Xe===0&&(Xe=3):_d())),t.updateQueue!==null&&(t.flags|=4),xt(t),null);case 4:return Ks(),Nc(e,t),e===null&&ll(t.stateNode.containerInfo),xt(t),null;case 10:return fd(t.type._context),xt(t),null;case 17:return Dt(t.type)&&zi(),xt(t),null;case 19:if(Re(De),o=t.memoizedState,o===null)return xt(t),null;if(r=(t.flags&128)!==0,l=o.rendering,l===null)if(r)Eo(o,!1);else{if(Xe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Gi(e),l!==null){for(t.flags|=128,Eo(o,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return je(De,De.current&1|2),t.child}e=e.sibling}o.tail!==null&&Ge()>Ys&&(t.flags|=128,r=!0,Eo(o,!1),t.lanes=4194304)}else{if(!r)if(e=Gi(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Eo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Pe)return xt(t),null}else 2*Ge()-o.renderingStartTime>Ys&&n!==1073741824&&(t.flags|=128,r=!0,Eo(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(n=o.last,n!==null?n.sibling=l:t.child=l,o.last=l)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ge(),t.sibling=null,n=De.current,je(De,r?n&1|2:n&1),t):(xt(t),null);case 22:case 23:return Rd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?zt&1073741824&&(xt(t),t.subtreeFlags&6&&(t.flags|=8192)):xt(t),null;case 24:return null;case 25:return null}throw Error(M(156,t.tag))}function zv(e,t){switch(ad(t),t.tag){case 1:return Dt(t.type)&&zi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ks(),Re(It),Re(wt),yd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gd(t),null;case 13:if(Re(De),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(M(340));Hs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Re(De),null;case 4:return Ks(),null;case 10:return fd(t.type._context),null;case 22:case 23:return Rd(),null;case 24:return null;default:return null}}var ii=!1,vt=!1,$v=typeof WeakSet=="function"?WeakSet:Set,G=null;function Ts(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function kc(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var Yp=!1;function Bv(e,t){if(ic=Mi,e=$h(),ld(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var l=0,u=-1,c=-1,f=0,g=0,w=e,S=null;t:for(;;){for(var R;w!==n||s!==0&&w.nodeType!==3||(u=l+s),w!==o||r!==0&&w.nodeType!==3||(c=l+r),w.nodeType===3&&(l+=w.nodeValue.length),(R=w.firstChild)!==null;)S=w,w=R;for(;;){if(w===e)break t;if(S===n&&++f===s&&(u=l),S===o&&++g===r&&(c=l),(R=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=R}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ac={focusedElem:e,selectionRange:n},Mi=!1,G=t;G!==null;)if(t=G,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,G=e;else for(;G!==null;){t=G;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var j=k.memoizedProps,Q=k.memoizedState,h=t.stateNode,m=h.getSnapshotBeforeUpdate(t.elementType===t.type?j:sn(t.type,j),Q);h.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(_){Ue(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,G=e;break}G=t.return}return k=Yp,Yp=!1,k}function Go(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&kc(t,n,o)}s=s.next}while(s!==r)}}function ga(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function jc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Og(e){var t=e.alternate;t!==null&&(e.alternate=null,Og(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[kn],delete t[al],delete t[dc],delete t[kv],delete t[jv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fg(e){return e.tag===5||e.tag===3||e.tag===4}function Qp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Cc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ui));else if(r!==4&&(e=e.child,e!==null))for(Cc(e,t,n),e=e.sibling;e!==null;)Cc(e,t,n),e=e.sibling}function Ec(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ec(e,t,n),e=e.sibling;e!==null;)Ec(e,t,n),e=e.sibling}var ft=null,on=!1;function rr(e,t,n){for(n=n.child;n!==null;)Ug(e,t,n),n=n.sibling}function Ug(e,t,n){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(aa,n)}catch{}switch(n.tag){case 5:vt||Ts(n,t);case 6:var r=ft,s=on;ft=null,rr(e,t,n),ft=r,on=s,ft!==null&&(on?(e=ft,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ft.removeChild(n.stateNode));break;case 18:ft!==null&&(on?(e=ft,n=n.stateNode,e.nodeType===8?hu(e.parentNode,n):e.nodeType===1&&hu(e,n),rl(e)):hu(ft,n.stateNode));break;case 4:r=ft,s=on,ft=n.stateNode.containerInfo,on=!0,rr(e,t,n),ft=r,on=s;break;case 0:case 11:case 14:case 15:if(!vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&kc(n,t,l),s=s.next}while(s!==r)}rr(e,t,n);break;case 1:if(!vt&&(Ts(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ue(n,t,u)}rr(e,t,n);break;case 21:rr(e,t,n);break;case 22:n.mode&1?(vt=(r=vt)||n.memoizedState!==null,rr(e,t,n),vt=r):rr(e,t,n);break;default:rr(e,t,n)}}function Jp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new $v),t.forEach(function(r){var s=qv.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,l=t,u=l;e:for(;u!==null;){switch(u.tag){case 5:ft=u.stateNode,on=!1;break e;case 3:ft=u.stateNode.containerInfo,on=!0;break e;case 4:ft=u.stateNode.containerInfo,on=!0;break e}u=u.return}if(ft===null)throw Error(M(160));Ug(o,l,s),ft=null,on=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(f){Ue(s,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zg(t,e),t=t.sibling}function zg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),Sn(e),r&4){try{Go(3,e,e.return),ga(3,e)}catch(j){Ue(e,e.return,j)}try{Go(5,e,e.return)}catch(j){Ue(e,e.return,j)}}break;case 1:rn(t,e),Sn(e),r&512&&n!==null&&Ts(n,n.return);break;case 5:if(rn(t,e),Sn(e),r&512&&n!==null&&Ts(n,n.return),e.flags&32){var s=e.stateNode;try{Zo(s,"")}catch(j){Ue(e,e.return,j)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,l=n!==null?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&ah(s,o),qu(u,l);var f=qu(u,o);for(l=0;l<c.length;l+=2){var g=c[l],w=c[l+1];g==="style"?ph(s,w):g==="dangerouslySetInnerHTML"?dh(s,w):g==="children"?Zo(s,w):Gc(s,g,w,f)}switch(u){case"input":Ku(s,o);break;case"textarea":uh(s,o);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var R=o.value;R!=null?Ls(s,!!o.multiple,R,!1):S!==!!o.multiple&&(o.defaultValue!=null?Ls(s,!!o.multiple,o.defaultValue,!0):Ls(s,!!o.multiple,o.multiple?[]:"",!1))}s[al]=o}catch(j){Ue(e,e.return,j)}}break;case 6:if(rn(t,e),Sn(e),r&4){if(e.stateNode===null)throw Error(M(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(j){Ue(e,e.return,j)}}break;case 3:if(rn(t,e),Sn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rl(t.containerInfo)}catch(j){Ue(e,e.return,j)}break;case 4:rn(t,e),Sn(e);break;case 13:rn(t,e),Sn(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Cd=Ge())),r&4&&Jp(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(vt=(f=vt)||g,rn(t,e),vt=f):rn(t,e),Sn(e),r&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!g&&e.mode&1)for(G=e,g=e.child;g!==null;){for(w=G=g;G!==null;){switch(S=G,R=S.child,S.tag){case 0:case 11:case 14:case 15:Go(4,S,S.return);break;case 1:Ts(S,S.return);var k=S.stateNode;if(typeof k.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(j){Ue(r,n,j)}}break;case 5:Ts(S,S.return);break;case 22:if(S.memoizedState!==null){Xp(w);continue}}R!==null?(R.return=S,G=R):Xp(w)}g=g.sibling}e:for(g=null,w=e;;){if(w.tag===5){if(g===null){g=w;try{s=w.stateNode,f?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=w.stateNode,c=w.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=fh("display",l))}catch(j){Ue(e,e.return,j)}}}else if(w.tag===6){if(g===null)try{w.stateNode.nodeValue=f?"":w.memoizedProps}catch(j){Ue(e,e.return,j)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;g===w&&(g=null),w=w.return}g===w&&(g=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:rn(t,e),Sn(e),r&4&&Jp(e);break;case 21:break;default:rn(t,e),Sn(e)}}function Sn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Fg(n)){var r=n;break e}n=n.return}throw Error(M(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Zo(s,""),r.flags&=-33);var o=Qp(e);Ec(e,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,u=Qp(e);Cc(e,u,l);break;default:throw Error(M(161))}}catch(c){Ue(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wv(e,t,n){G=e,$g(e)}function $g(e,t,n){for(var r=(e.mode&1)!==0;G!==null;){var s=G,o=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||ii;if(!l){var u=s.alternate,c=u!==null&&u.memoizedState!==null||vt;u=ii;var f=vt;if(ii=l,(vt=c)&&!f)for(G=s;G!==null;)l=G,c=l.child,l.tag===22&&l.memoizedState!==null?Zp(s):c!==null?(c.return=l,G=c):Zp(s);for(;o!==null;)G=o,$g(o),o=o.sibling;G=s,ii=u,vt=f}qp(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,G=o):qp(e)}}function qp(e){for(;G!==null;){var t=G;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vt||ga(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!vt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:sn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Lp(t,o,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Lp(t,l,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var g=f.memoizedState;if(g!==null){var w=g.dehydrated;w!==null&&rl(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}vt||t.flags&512&&jc(t)}catch(S){Ue(t,t.return,S)}}if(t===e){G=null;break}if(n=t.sibling,n!==null){n.return=t.return,G=n;break}G=t.return}}function Xp(e){for(;G!==null;){var t=G;if(t===e){G=null;break}var n=t.sibling;if(n!==null){n.return=t.return,G=n;break}G=t.return}}function Zp(e){for(;G!==null;){var t=G;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ga(4,t)}catch(c){Ue(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ue(t,s,c)}}var o=t.return;try{jc(t)}catch(c){Ue(t,o,c)}break;case 5:var l=t.return;try{jc(t)}catch(c){Ue(t,l,c)}}}catch(c){Ue(t,t.return,c)}if(t===e){G=null;break}var u=t.sibling;if(u!==null){u.return=t.return,G=u;break}G=t.return}}var Hv=Math.ceil,Ji=Gn.ReactCurrentDispatcher,kd=Gn.ReactCurrentOwner,Xt=Gn.ReactCurrentBatchConfig,de=0,lt=null,Je=null,pt=0,zt=0,As=Er(0),Xe=0,ml=null,Zr=0,ya=0,jd=0,Yo=null,At=null,Cd=0,Ys=1/0,On=null,qi=!1,Rc=null,yr=null,ai=!1,dr=null,Xi=0,Qo=0,_c=null,Ni=-1,ki=0;function Et(){return de&6?Ge():Ni!==-1?Ni:Ni=Ge()}function xr(e){return e.mode&1?de&2&&pt!==0?pt&-pt:Ev.transition!==null?(ki===0&&(ki=jh()),ki):(e=Se,e!==0||(e=window.event,e=e===void 0?16:Ph(e.type)),e):1}function cn(e,t,n,r){if(50<Qo)throw Qo=0,_c=null,Error(M(185));xl(e,n,r),(!(de&2)||e!==lt)&&(e===lt&&(!(de&2)&&(ya|=n),Xe===4&&ur(e,pt)),Lt(e,r),n===1&&de===0&&!(t.mode&1)&&(Ys=Ge()+500,pa&&Rr()))}function Lt(e,t){var n=e.callbackNode;Ex(e,t);var r=Li(e,e===lt?pt:0);if(r===0)n!==null&&ap(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ap(n),t===1)e.tag===0?Cv(em.bind(null,e)):qh(em.bind(null,e)),bv(function(){!(de&6)&&Rr()}),n=null;else{switch(Ch(r)){case 1:n=Xc;break;case 4:n=Nh;break;case 16:n=Di;break;case 536870912:n=kh;break;default:n=Di}n=Qg(n,Bg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Bg(e,t){if(Ni=-1,ki=0,de&6)throw Error(M(327));var n=e.callbackNode;if(zs()&&e.callbackNode!==n)return null;var r=Li(e,e===lt?pt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Zi(e,r);else{t=r;var s=de;de|=2;var o=Hg();(lt!==e||pt!==t)&&(On=null,Ys=Ge()+500,Yr(e,t));do try{Gv();break}catch(u){Wg(e,u)}while(!0);dd(),Ji.current=o,de=s,Je!==null?t=0:(lt=null,pt=0,t=Xe)}if(t!==0){if(t===2&&(s=nc(e),s!==0&&(r=s,t=Tc(e,s))),t===1)throw n=ml,Yr(e,0),ur(e,r),Lt(e,Ge()),n;if(t===6)ur(e,r);else{if(s=e.current.alternate,!(r&30)&&!Vv(s)&&(t=Zi(e,r),t===2&&(o=nc(e),o!==0&&(r=o,t=Tc(e,o))),t===1))throw n=ml,Yr(e,0),ur(e,r),Lt(e,Ge()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(M(345));case 2:zr(e,At,On);break;case 3:if(ur(e,r),(r&130023424)===r&&(t=Cd+500-Ge(),10<t)){if(Li(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=cc(zr.bind(null,e,At,On),t);break}zr(e,At,On);break;case 4:if(ur(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var l=31-un(r);o=1<<l,l=t[l],l>s&&(s=l),r&=~o}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Hv(r/1960))-r,10<r){e.timeoutHandle=cc(zr.bind(null,e,At,On),r);break}zr(e,At,On);break;case 5:zr(e,At,On);break;default:throw Error(M(329))}}}return Lt(e,Ge()),e.callbackNode===n?Bg.bind(null,e):null}function Tc(e,t){var n=Yo;return e.current.memoizedState.isDehydrated&&(Yr(e,t).flags|=256),e=Zi(e,t),e!==2&&(t=At,At=n,t!==null&&Ac(t)),e}function Ac(e){At===null?At=e:At.push.apply(At,e)}function Vv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!dn(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ur(e,t){for(t&=~jd,t&=~ya,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-un(t),r=1<<n;e[n]=-1,t&=~r}}function em(e){if(de&6)throw Error(M(327));zs();var t=Li(e,0);if(!(t&1))return Lt(e,Ge()),null;var n=Zi(e,t);if(e.tag!==0&&n===2){var r=nc(e);r!==0&&(t=r,n=Tc(e,r))}if(n===1)throw n=ml,Yr(e,0),ur(e,t),Lt(e,Ge()),n;if(n===6)throw Error(M(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zr(e,At,On),Lt(e,Ge()),null}function Ed(e,t){var n=de;de|=1;try{return e(t)}finally{de=n,de===0&&(Ys=Ge()+500,pa&&Rr())}}function es(e){dr!==null&&dr.tag===0&&!(de&6)&&zs();var t=de;de|=1;var n=Xt.transition,r=Se;try{if(Xt.transition=null,Se=1,e)return e()}finally{Se=r,Xt.transition=n,de=t,!(de&6)&&Rr()}}function Rd(){zt=As.current,Re(As)}function Yr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Sv(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(ad(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zi();break;case 3:Ks(),Re(It),Re(wt),yd();break;case 5:gd(r);break;case 4:Ks();break;case 13:Re(De);break;case 19:Re(De);break;case 10:fd(r.type._context);break;case 22:case 23:Rd()}n=n.return}if(lt=e,Je=e=vr(e.current,null),pt=zt=t,Xe=0,ml=null,jd=ya=Zr=0,At=Yo=null,Wr!==null){for(t=0;t<Wr.length;t++)if(n=Wr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var l=o.next;o.next=s,r.next=l}n.pending=r}Wr=null}return e}function Wg(e,t){do{var n=Je;try{if(dd(),wi.current=Qi,Yi){for(var r=Le.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Yi=!1}if(Xr=0,ot=qe=Le=null,Ko=!1,dl=0,kd.current=null,n===null||n.return===null){Xe=1,ml=t,Je=null;break}e:{var o=e,l=n.return,u=n,c=t;if(t=pt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,g=u,w=g.tag;if(!(g.mode&1)&&(w===0||w===11||w===15)){var S=g.alternate;S?(g.updateQueue=S.updateQueue,g.memoizedState=S.memoizedState,g.lanes=S.lanes):(g.updateQueue=null,g.memoizedState=null)}var R=$p(l);if(R!==null){R.flags&=-257,Bp(R,l,u,o,t),R.mode&1&&zp(o,f,t),t=R,c=f;var k=t.updateQueue;if(k===null){var j=new Set;j.add(c),t.updateQueue=j}else k.add(c);break e}else{if(!(t&1)){zp(o,f,t),_d();break e}c=Error(M(426))}}else if(Pe&&u.mode&1){var Q=$p(l);if(Q!==null){!(Q.flags&65536)&&(Q.flags|=256),Bp(Q,l,u,o,t),ud(Gs(c,u));break e}}o=c=Gs(c,u),Xe!==4&&(Xe=2),Yo===null?Yo=[o]:Yo.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var h=Cg(o,c,t);Dp(o,h);break e;case 1:u=c;var m=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(yr===null||!yr.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var _=Eg(o,u,t);Dp(o,_);break e}}o=o.return}while(o!==null)}Kg(n)}catch(T){t=T,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Hg(){var e=Ji.current;return Ji.current=Qi,e===null?Qi:e}function _d(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),lt===null||!(Zr&268435455)&&!(ya&268435455)||ur(lt,pt)}function Zi(e,t){var n=de;de|=2;var r=Hg();(lt!==e||pt!==t)&&(On=null,Yr(e,t));do try{Kv();break}catch(s){Wg(e,s)}while(!0);if(dd(),de=n,Ji.current=r,Je!==null)throw Error(M(261));return lt=null,pt=0,Xe}function Kv(){for(;Je!==null;)Vg(Je)}function Gv(){for(;Je!==null&&!xx();)Vg(Je)}function Vg(e){var t=Yg(e.alternate,e,zt);e.memoizedProps=e.pendingProps,t===null?Kg(e):Je=t,kd.current=null}function Kg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=zv(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xe=6,Je=null;return}}else if(n=Uv(n,t,zt),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);Xe===0&&(Xe=5)}function zr(e,t,n){var r=Se,s=Xt.transition;try{Xt.transition=null,Se=1,Yv(e,t,n,r)}finally{Xt.transition=s,Se=r}return null}function Yv(e,t,n,r){do zs();while(dr!==null);if(de&6)throw Error(M(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(M(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Rx(e,o),e===lt&&(Je=lt=null,pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ai||(ai=!0,Qg(Di,function(){return zs(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Xt.transition,Xt.transition=null;var l=Se;Se=1;var u=de;de|=4,kd.current=null,Bv(e,n),zg(n,e),mv(ac),Mi=!!ic,ac=ic=null,e.current=n,Wv(n),vx(),de=u,Se=l,Xt.transition=o}else e.current=n;if(ai&&(ai=!1,dr=e,Xi=s),o=e.pendingLanes,o===0&&(yr=null),bx(n.stateNode),Lt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qi)throw qi=!1,e=Rc,Rc=null,e;return Xi&1&&e.tag!==0&&zs(),o=e.pendingLanes,o&1?e===_c?Qo++:(Qo=0,_c=e):Qo=0,Rr(),null}function zs(){if(dr!==null){var e=Ch(Xi),t=Xt.transition,n=Se;try{if(Xt.transition=null,Se=16>e?16:e,dr===null)var r=!1;else{if(e=dr,dr=null,Xi=0,de&6)throw Error(M(331));var s=de;for(de|=4,G=e.current;G!==null;){var o=G,l=o.child;if(G.flags&16){var u=o.deletions;if(u!==null){for(var c=0;c<u.length;c++){var f=u[c];for(G=f;G!==null;){var g=G;switch(g.tag){case 0:case 11:case 15:Go(8,g,o)}var w=g.child;if(w!==null)w.return=g,G=w;else for(;G!==null;){g=G;var S=g.sibling,R=g.return;if(Og(g),g===f){G=null;break}if(S!==null){S.return=R,G=S;break}G=R}}}var k=o.alternate;if(k!==null){var j=k.child;if(j!==null){k.child=null;do{var Q=j.sibling;j.sibling=null,j=Q}while(j!==null)}}G=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,G=l;else e:for(;G!==null;){if(o=G,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Go(9,o,o.return)}var h=o.sibling;if(h!==null){h.return=o.return,G=h;break e}G=o.return}}var m=e.current;for(G=m;G!==null;){l=G;var b=l.child;if(l.subtreeFlags&2064&&b!==null)b.return=l,G=b;else e:for(l=m;G!==null;){if(u=G,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:ga(9,u)}}catch(T){Ue(u,u.return,T)}if(u===l){G=null;break e}var _=u.sibling;if(_!==null){_.return=u.return,G=_;break e}G=u.return}}if(de=s,Rr(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(aa,e)}catch{}r=!0}return r}finally{Se=n,Xt.transition=t}}return!1}function tm(e,t,n){t=Gs(n,t),t=Cg(e,t,1),e=gr(e,t,1),t=Et(),e!==null&&(xl(e,1,t),Lt(e,t))}function Ue(e,t,n){if(e.tag===3)tm(e,e,n);else for(;t!==null;){if(t.tag===3){tm(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yr===null||!yr.has(r))){e=Gs(n,e),e=Eg(t,e,1),t=gr(t,e,1),e=Et(),t!==null&&(xl(t,1,e),Lt(t,e));break}}t=t.return}}function Qv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,lt===e&&(pt&n)===n&&(Xe===4||Xe===3&&(pt&130023424)===pt&&500>Ge()-Cd?Yr(e,0):jd|=n),Lt(e,t)}function Gg(e,t){t===0&&(e.mode&1?(t=Xl,Xl<<=1,!(Xl&130023424)&&(Xl=4194304)):t=1);var n=Et();e=Vn(e,t),e!==null&&(xl(e,t,n),Lt(e,n))}function Jv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Gg(e,n)}function qv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(t),Gg(e,n)}var Yg;Yg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||It.current)Pt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pt=!1,Fv(e,t,n);Pt=!!(e.flags&131072)}else Pt=!1,Pe&&t.flags&1048576&&Xh(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;bi(e,t),e=t.pendingProps;var s=Ws(t,wt.current);Us(t,n),s=vd(null,t,r,e,s,n);var o=wd();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dt(r)?(o=!0,$i(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,md(t),s.updater=ha,t.stateNode=s,s._reactInternals=t,yc(t,r,e,n),t=wc(null,t,r,!0,o,n)):(t.tag=0,Pe&&o&&id(t),Ct(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(bi(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Zv(r),e=sn(r,e),s){case 0:t=vc(null,t,r,e,n);break e;case 1:t=Vp(null,t,r,e,n);break e;case 11:t=Wp(null,t,r,e,n);break e;case 14:t=Hp(null,t,r,sn(r.type,e),n);break e}throw Error(M(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),vc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Vp(e,t,r,s,n);case 3:e:{if(Ag(t),e===null)throw Error(M(387));r=t.pendingProps,o=t.memoizedState,s=o.element,sg(e,t),Ki(t,r,null,n);var l=t.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Gs(Error(M(423)),t),t=Kp(e,t,r,n,s);break e}else if(r!==s){s=Gs(Error(M(424)),t),t=Kp(e,t,r,n,s);break e}else for($t=hr(t.stateNode.containerInfo.firstChild),Bt=t,Pe=!0,ln=null,n=ng(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hs(),r===s){t=Kn(e,t,n);break e}Ct(e,t,r,n)}t=t.child}return t;case 5:return og(t),e===null&&mc(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,l=s.children,uc(r,s)?l=null:o!==null&&uc(r,o)&&(t.flags|=32),Tg(e,t),Ct(e,t,l,n),t.child;case 6:return e===null&&mc(t),null;case 13:return Pg(e,t,n);case 4:return hd(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Vs(t,null,r,n):Ct(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Wp(e,t,r,s,n);case 7:return Ct(e,t,t.pendingProps,n),t.child;case 8:return Ct(e,t,t.pendingProps.children,n),t.child;case 12:return Ct(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,l=s.value,je(Hi,r._currentValue),r._currentValue=l,o!==null)if(dn(o.value,l)){if(o.children===s.children&&!It.current){t=Kn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var u=o.dependencies;if(u!==null){l=o.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=$n(-1,n&-n),c.tag=2;var f=o.updateQueue;if(f!==null){f=f.shared;var g=f.pending;g===null?c.next=c:(c.next=g.next,g.next=c),f.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),hc(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(o.tag===10)l=o.type===t.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(M(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),hc(l,n,t),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===t){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}Ct(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Us(t,n),s=Zt(s),r=r(s),t.flags|=1,Ct(e,t,r,n),t.child;case 14:return r=t.type,s=sn(r,t.pendingProps),s=sn(r.type,s),Hp(e,t,r,s,n);case 15:return Rg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),bi(e,t),t.tag=1,Dt(r)?(e=!0,$i(t)):e=!1,Us(t,n),jg(t,r,s),yc(t,r,s,n),wc(null,t,r,!0,e,n);case 19:return Ig(e,t,n);case 22:return _g(e,t,n)}throw Error(M(156,t.tag))};function Qg(e,t){return bh(e,t)}function Xv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(e,t,n,r){return new Xv(e,t,n,r)}function Td(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zv(e){if(typeof e=="function")return Td(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qc)return 11;if(e===Jc)return 14}return 2}function vr(e,t){var n=e.alternate;return n===null?(n=qt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ji(e,t,n,r,s,o){var l=2;if(r=e,typeof e=="function")Td(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ss:return Qr(n.children,s,o,t);case Yc:l=8,s|=8;break;case $u:return e=qt(12,n,t,s|2),e.elementType=$u,e.lanes=o,e;case Bu:return e=qt(13,n,t,s),e.elementType=Bu,e.lanes=o,e;case Wu:return e=qt(19,n,t,s),e.elementType=Wu,e.lanes=o,e;case oh:return xa(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rh:l=10;break e;case sh:l=9;break e;case Qc:l=11;break e;case Jc:l=14;break e;case or:l=16,r=null;break e}throw Error(M(130,e==null?e:typeof e,""))}return t=qt(l,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function Qr(e,t,n,r){return e=qt(7,e,r,t),e.lanes=n,e}function xa(e,t,n,r){return e=qt(22,e,r,t),e.elementType=oh,e.lanes=n,e.stateNode={isHidden:!1},e}function Nu(e,t,n){return e=qt(6,e,null,t),e.lanes=n,e}function ku(e,t,n){return t=qt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ew(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=su(0),this.expirationTimes=su(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=su(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ad(e,t,n,r,s,o,l,u,c){return e=new ew(e,t,n,u,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=qt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},md(o),e}function tw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Jg(e){if(!e)return kr;e=e._reactInternals;e:{if(os(e)!==e||e.tag!==1)throw Error(M(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(M(171))}if(e.tag===1){var n=e.type;if(Dt(n))return Jh(e,n,t)}return t}function qg(e,t,n,r,s,o,l,u,c){return e=Ad(n,r,!0,e,s,o,l,u,c),e.context=Jg(null),n=e.current,r=Et(),s=xr(n),o=$n(r,s),o.callback=t??null,gr(n,o,s),e.current.lanes=s,xl(e,s,r),Lt(e,r),e}function va(e,t,n,r){var s=t.current,o=Et(),l=xr(s);return n=Jg(n),t.context===null?t.context=n:t.pendingContext=n,t=$n(o,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=gr(s,t,l),e!==null&&(cn(e,s,l,o),vi(e,s,l)),l}function ea(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pd(e,t){nm(e,t),(e=e.alternate)&&nm(e,t)}function nw(){return null}var Xg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Id(e){this._internalRoot=e}wa.prototype.render=Id.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(M(409));va(e,t,null,null)};wa.prototype.unmount=Id.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;es(function(){va(null,e,null,null)}),t[Hn]=null}};function wa(e){this._internalRoot=e}wa.prototype.unstable_scheduleHydration=function(e){if(e){var t=_h();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ar.length&&t!==0&&t<ar[n].priority;n++);ar.splice(n,0,e),n===0&&Ah(e)}};function Dd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rm(){}function rw(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var f=ea(l);o.call(f)}}var l=qg(t,r,e,0,null,!1,!1,"",rm);return e._reactRootContainer=l,e[Hn]=l.current,ll(e.nodeType===8?e.parentNode:e),es(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var f=ea(c);u.call(f)}}var c=Ad(e,0,!1,null,null,!1,!1,"",rm);return e._reactRootContainer=c,e[Hn]=c.current,ll(e.nodeType===8?e.parentNode:e),es(function(){va(t,c,n,r)}),c}function ba(e,t,n,r,s){var o=n._reactRootContainer;if(o){var l=o;if(typeof s=="function"){var u=s;s=function(){var c=ea(l);u.call(c)}}va(t,l,e,s)}else l=rw(n,t,e,s,r);return ea(l)}Eh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Lo(t.pendingLanes);n!==0&&(Zc(t,n|1),Lt(t,Ge()),!(de&6)&&(Ys=Ge()+500,Rr()))}break;case 13:es(function(){var r=Vn(e,1);if(r!==null){var s=Et();cn(r,e,1,s)}}),Pd(e,1)}};ed=function(e){if(e.tag===13){var t=Vn(e,134217728);if(t!==null){var n=Et();cn(t,e,134217728,n)}Pd(e,134217728)}};Rh=function(e){if(e.tag===13){var t=xr(e),n=Vn(e,t);if(n!==null){var r=Et();cn(n,e,t,r)}Pd(e,t)}};_h=function(){return Se};Th=function(e,t){var n=Se;try{return Se=e,t()}finally{Se=n}};Zu=function(e,t,n){switch(t){case"input":if(Ku(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=fa(r);if(!s)throw Error(M(90));ih(r),Ku(r,s)}}}break;case"textarea":uh(e,n);break;case"select":t=n.value,t!=null&&Ls(e,!!n.multiple,t,!1)}};gh=Ed;yh=es;var sw={usingClientEntryPoint:!1,Events:[wl,js,fa,mh,hh,Ed]},Ro={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ow={bundleType:Ro.bundleType,version:Ro.version,rendererPackageName:Ro.rendererPackageName,rendererConfig:Ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wh(e),e===null?null:e.stateNode},findFiberByHostInstance:Ro.findFiberByHostInstance||nw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ui.isDisabled&&ui.supportsFiber)try{aa=ui.inject(ow),jn=ui}catch{}}Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sw;Ht.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dd(t))throw Error(M(200));return tw(e,t,null,n)};Ht.createRoot=function(e,t){if(!Dd(e))throw Error(M(299));var n=!1,r="",s=Xg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ad(e,1,!1,null,null,n,!1,r,s),e[Hn]=t.current,ll(e.nodeType===8?e.parentNode:e),new Id(t)};Ht.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(M(188)):(e=Object.keys(e).join(","),Error(M(268,e)));return e=wh(t),e=e===null?null:e.stateNode,e};Ht.flushSync=function(e){return es(e)};Ht.hydrate=function(e,t,n){if(!Sa(t))throw Error(M(200));return ba(null,e,t,!0,n)};Ht.hydrateRoot=function(e,t,n){if(!Dd(e))throw Error(M(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",l=Xg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=qg(t,null,e,1,n??null,s,!1,o,l),e[Hn]=t.current,ll(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new wa(t)};Ht.render=function(e,t,n){if(!Sa(t))throw Error(M(200));return ba(null,e,t,!1,n)};Ht.unmountComponentAtNode=function(e){if(!Sa(e))throw Error(M(40));return e._reactRootContainer?(es(function(){ba(null,null,e,!1,function(){e._reactRootContainer=null,e[Hn]=null})}),!0):!1};Ht.unstable_batchedUpdates=Ed;Ht.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Sa(n))throw Error(M(200));if(e==null||e._reactInternals===void 0)throw Error(M(38));return ba(e,t,n,!1,r)};Ht.version="18.3.1-next-f1338f8080-20240426";function Zg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zg)}catch(e){console.error(e)}}Zg(),Zm.exports=Ht;var lw=Zm.exports,sm=lw;Uu.createRoot=sm.createRoot,Uu.hydrateRoot=sm.hydrateRoot;const iw={1:[{rows:1,cols:1}],2:[{rows:1,cols:2},{rows:2,cols:1}],3:[{rows:2,cols:2},{rows:1,cols:3},{rows:3,cols:1}],4:[{rows:2,cols:2},{rows:1,cols:4},{rows:4,cols:1}],5:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:5},{rows:5,cols:1}],6:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:6},{rows:6,cols:1}],7:[{rows:2,cols:4},{rows:4,cols:2}],8:[{rows:2,cols:4},{rows:4,cols:2},{rows:3,cols:3}],9:[{rows:3,cols:3},{rows:2,cols:5},{rows:5,cols:2}],10:[{rows:2,cols:5},{rows:5,cols:2}]},$s=(e,t)=>{if(!Number.isFinite(e))return t;const n=Math.floor(e);return n>0?n:t};function aw(e){const t=$s(e,1);return(iw[t]||[]).map(r=>({...r}))}function Pc(e,t){if(!e)return null;const n=$s(t,1),r=$s(e.rows,1),s=$s(e.cols,1),o=r*s;if(o<n)return null;let l=e.emptySeatIndex??null;return o>n?(l==null||l<0||l>=o)&&(l=o-1):l=null,{rows:r,cols:s,emptySeatIndex:l}}const om=(e,t)=>{const n=$s(e,1),r=(t||0)===90,s=Math.ceil(Math.sqrt(n)),o=r?s:Math.ceil(n/s),l=Math.ceil(n/o);return Pc({rows:o,cols:l},n)||{rows:1,cols:n}};function e0(e,t,n){const r=$s(e,1),s=Pc(n,r);if(s)return s;const o=aw(r);if(!o.length)return om(r,t);const l=(t||0)===90,c=o.filter(f=>l?f.rows>=f.cols:f.cols>=f.rows)[0]||o[0];return Pc(c,r)||om(r,t)}const uw="newui_app_state",Ic=1,cw=e=>!!e&&typeof e=="object";function dw(e){const t=Math.max(0,e.capacity||0),n=Array.isArray(e.preferredSeatIndexes)?e.preferredSeatIndexes:[],r=[];for(const s of n){const o=typeof s=="number"?s:parseInt(String(s),10);!Number.isFinite(o)||!Number.isInteger(o)||o<0||o>=t||r.push(o)}return Array.from(new Set(r)).sort((s,o)=>s-o)}function fw(e){const t=(e.seatIds??[]).slice(),n=Math.max(0,e.capacity||0);if(t.length<n)for(let l=t.length;l<n;l++)t[l]=String(e.id)+"_s"+l;else t.length>n&&(t.length=n);const r=dw(e),s=e0(n,e.rotation||0,e.seatLayout),o=cw(e.meta)?e.meta:void 0;return{...e,seatIds:t,preferredSeatIndexes:r,seatLayout:s,meta:o}}function pw(e){return{...e,tables:e.tables.map(fw)}}function mw(e){const n=((e||{layouts:[]}).layouts||[]).map(pw);return{version:Ic,layouts:n}}function hw(){try{const e=localStorage.getItem(uw);if(!e)return{version:Ic,layouts:[]};const t=JSON.parse(e);return mw(t)}catch{return{version:Ic,layouts:[]}}}function gw(){return hw().layouts}const yw="newui_periods_state";function xw(){try{const e=localStorage.getItem(yw);if(!e)return{periods:[],currentId:null};const t=JSON.parse(e);return{periods:t.periods??[],currentId:t.currentId??null}}catch{return{periods:[],currentId:null}}}function Dc(){return xw()}const vw="newui_tags_state_v1";function ww(){try{const e=localStorage.getItem(vw);return e?{version:1,tags:JSON.parse(e).tags??[]}:{version:1,tags:[]}}catch{return{version:1,tags:[]}}}function Sw(){return ww().tags}const bw=d.createContext(null),Nw="newui_students_state_v1";function kw(){try{const e=localStorage.getItem(Nw);return e?{version:1,students:JSON.parse(e).students??[]}:{version:1,students:[]}}catch{return{version:1,students:[]}}}function jw(){return kw().students}const Cw={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","6xl":"max-w-6xl","7xl":"max-w-7xl"};function ta({isOpen:e,onRequestClose:t,title:n,subtitle:r,headerRight:s,footer:o,children:l,maxWidth:u="6xl",bodyClassName:c,bodyPadding:f=!0,showCloseX:g=!1}){if(d.useEffect(()=>{if(!e)return;const S=R=>{R.key==="Escape"&&t()};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,t]),!e)return null;const w=f?"px-5 py-4":"";return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40",style:{width:"100dvw",height:"100dvh"},onMouseDown:t}),i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{width:"100dvw",height:"100dvh"},children:i.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative w-full rounded-xl bg-white shadow-xl border border-slate-200 max-h-[90vh] overflow-hidden flex flex-col ${Cw[u]}`,onMouseDown:S=>S.stopPropagation(),children:[i.jsx("div",{className:"border-b border-slate-200 px-5 py-4 bg-white",children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"min-w-0",children:[n&&i.jsx("div",{className:"text-lg font-semibold text-slate-900",children:n}),r&&i.jsx("div",{className:"text-sm text-slate-500",children:r})]}),(s||g)&&i.jsxs("div",{className:"flex items-center gap-2",children:[s,g&&i.jsx("button",{type:"button","aria-label":"Close",onClick:t,className:"rounded-md p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:i.jsx("span",{"aria-hidden":"true",className:"text-lg leading-none",children:""})})]})]})}),i.jsx("div",{className:`flex-1 min-h-0 overflow-y-auto overscroll-contain ${w} ${c??""}`,children:l}),o&&i.jsx("div",{className:"border-t border-slate-200 px-5 py-4 bg-slate-50",children:o})]})})]})}function Ew(){return"pro"}function Rw(e=Ew()){return{tier:e,canUseDriveSync:e!=="free",canUseLocalSave:!0,canExportPDF:e!=="free",canUseAdvancedReports:e==="school"||e==="pro",canUseImports:!0,canUseMobile:!0}}function _w({studentId:e,hasPhoto:t=!1,src:n=null,onClick:r,widthPx:s,heightPx:o,sizePx:l=44}){const f={width:s??l,height:o??l};return i.jsx("button",{type:"button","aria-label":t?"Update student photo":"Add student photo",className:"flex-shrink-0 rounded-xl border border-slate-200 bg-white/60 overflow-hidden active:scale-[0.98]",style:f,onClick:g=>{g.stopPropagation(),r==null||r(e)},children:t&&n?i.jsx("img",{src:n,alt:"Student photo",className:"w-full h-full object-cover",draggable:!1}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18","aria-hidden":"true",className:"text-slate-500",children:i.jsx("path",{fill:"currentColor",d:"M9.5 4.5h5l1.2 1.8H19a2.5 2.5 0 0 1 2.5 2.5v8.7A2.5 2.5 0 0 1 19 20H5a2.5 2.5 0 0 1-2.5-2.5V8.8A2.5 2.5 0 0 1 5 6.3h3.3l1.2-1.8ZM12 9a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 1.7a2.3 2.3 0 1 1 0 4.6 2.3 2.3 0 0 1 0-4.6Z"})})})})}function t0(e){const t=(e||"").trim();if(!t)return{first:"Unknown",last:"Unknown"};if(t.includes(",")){const[o,l]=t.split(",",2),u=(o||"").trim()||"Unknown";return{first:(l||"").trim().split(/\s+/).filter(Boolean)[0]||"Unknown",last:u}}const n=t.split(/\s+/).filter(Boolean);if(n.length===1)return{first:n[0],last:"Unknown"};const r=n[0]||"Unknown",s=n[n.length-1]||"Unknown";return{first:r,last:s}}function na(e){return(e||"").trim().replace(/\s+/g,"_").replace(/[^A-Za-z0-9_-]/g,"").replace(/_+/g,"_")||"Unknown"}function Ld(e,t){const n=t0(t),r=na(n.first);return`${na(n.last)}_${r}__id_${e}.jpg`}var zm,$m;const Lc=(($m=(zm=import.meta)==null?void 0:zm.env)==null?void 0:$m.VITE_GOOGLE_CLIENT_ID)??"403722152172-rm3rvd6kba8s10a8svv60jbj2s93kv1e.apps.googleusercontent.com",Tw="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email",to="ClassSeats";function Aw(e){return e?e.startsWith(".")?e:`.${e}`:""}function Pw(e,t,n){const r=t0(t),s=na(r.first),o=na(r.last),l=Aw(n);return`${o}_${s}__audio__id_${e}${l}`}const n0="classseats_mobile_drive_session_v2",Md="classseats_mobile_drive_folder_v1",Od="classseats_student_docs_folder_v1",r0={classseats:"data_v1"},lm="Student Docs",im="studentPhotos",am="audio",Iw=new Set(["announcements_state_v1.json"]),s0="Oops!  Please choose another filename.  'ClassSeats' is already being used by the system.";function Dw(e){return Iw.has(String(e||"").trim().toLowerCase())}function Lw(e){return String(e||"").trim().replace(/\.json$/i,"").trim()}function o0(e){return Lw(e).toLowerCase()===to.toLowerCase()}const l0="https://us-east1-classseats-sync.cloudfunctions.net/exchangecode",Ci="classseats_mobile_drive_pkce_verifier",Jo="classseats_mobile_drive_return_to",Ei="classseats_mobile_drive_redirect_uri",i0="https://app.classseats.app/ClassSeatsMobile";function Mw(){if(typeof window>"u")return i0;const e=window.location.origin;return e==="https://app.classseats.app"?"https://app.classseats.app/ClassSeatsMobile":e==="https://mifish3474.github.io"?"https://mifish3474.github.io/ClassSeats-Mobile-Testing/ClassSeatsMobile":`${e}/ClassSeatsMobile`}const Ow=45*60*1e3,Fw="classseats_auth",Uw=1,jr="driveSession",ra="singleton";let $r=null,Nn=null,Oo=!1,Ri="none";function zw(e){const{sessionLoaded:t}=e,n=(e.lastWriteReason||"").trim();return t?"ok":n?n==="explicit-disconnect"?"user-logged-out":n==="fatal-oauth-error"?"oauth-failure":n==="login-success"?"device-storage-wipe":"unknown":"no-session-yet"}function Fd(){return new Promise((e,t)=>{const n=indexedDB.open(Fw,Uw);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(jr)||r.createObjectStore(jr,{keyPath:"id"})},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error||new Error("IndexedDB open failed"))})}async function $w(){const e=await Fd();return new Promise((t,n)=>{const o=e.transaction(jr,"readonly").objectStore(jr).get(ra);o.onsuccess=()=>{const l=o.result;if(l){Nn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason};const{id:u,lastWriteAt:c,lastWriteReason:f,...g}=l;t(g)}else t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}async function a0(e,t){const n=await Fd();return new Promise((r,s)=>{const o=n.transaction(jr,"readwrite"),l=o.objectStore(jr);if(!e)console.info("[Drive][IDB] CLEAR session",{reason:t}),l.delete(ra),Nn={lastWriteAt:Date.now(),lastWriteReason:t};else{const u={id:ra,...e,lastWriteAt:Date.now(),lastWriteReason:t};console.info("[Drive][IDB] WRITE session",{reason:t,hasRefresh:!!e.refreshToken,expiresAt:e.expiresAt}),l.put(u),Nn={lastWriteAt:u.lastWriteAt,lastWriteReason:u.lastWriteReason}}o.oncomplete=()=>r(),o.onerror=()=>s(o.error||new Error("IDB put/delete failed"))})}async function Bw(){try{const e=await Fd();return await new Promise((t,n)=>{const o=e.transaction(jr,"readonly").objectStore(jr).get(ra);o.onsuccess=()=>{const l=o.result;l?(Nn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason},t(l)):t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}catch(e){return console.warn("[Drive][IDB] getDriveSessionRecord failed",e),null}}async function Ww(){const e=await Bw(),t=!!e,n=!!(e!=null&&e.refreshToken),r=(e==null?void 0:e.expiresAt)??null,s=(e==null?void 0:e.lastWriteAt)??(Nn==null?void 0:Nn.lastWriteAt)??null,o=(e==null?void 0:e.lastWriteReason)??(Nn==null?void 0:Nn.lastWriteReason)??null,l=e?"idb":"none",u=e==null?void 0:e.profile,c=zw({sessionLoaded:t,lastWriteReason:o}),f={sessionLoaded:t,hasRefresh:n,expiresAt:r,source:l,lastWriteAt:s,lastWriteReason:o,state:c,profile:u};return console.info("startup:",f),console.info("[Drive] startupSessionState",{state:c,lastWriteReason:o}),f}function Hw(){if(typeof window>"u")return null;try{const e=window.localStorage.getItem(n0);return e?JSON.parse(e):null}catch{return null}}function Vw(){typeof window>"u"||window.localStorage.removeItem(n0)}async function Na(){if(Oo)return $r;try{const t=await $w();if(t)return $r=t,Ri="idb",Oo=!0,$r}catch{}const e=Hw();if(e){$r=e,Ri="legacy",Oo=!0;try{await a0(e,"startup-migration")}catch{}return $r}return $r=null,Ri="none",Oo=!0,null}async function Ud(e,t){$r=e,Oo=!0,Ri=e?"idb":"none";try{await a0(e,t)}catch(n){console.warn("[Drive][IDB] persistSession failed",n)}}async function u0(e){await Ud(null,e),Vw()}async function Kw(){return Na()}function Gw(e,t=5*60*1e3){return!e||e.expiresAt<=Date.now()+t}function Yw(e){return e.replace(/^#/,"").split("&").map(t=>t.split("=")).reduce((t,[n,r])=>(n&&(t[decodeURIComponent(n)]=decodeURIComponent(r||"")),t),{})}function c0(e,t,n,r){const s=t?t*1e3:Ow;return{accessToken:e,expiresAt:Date.now()+s-60*1e3,refreshToken:n,profile:r}}async function d0(e){try{const t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return;const n=await t.json();return{email:n.email,name:n.name,picture:n.picture}}catch{return}}async function Qw(){const e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jw(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=Array.from(new Uint8Array(r));return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function qw(e,t){const n=await Qw(),r=await Jw(n),s=btoa(JSON.stringify({v:n,r:t||null}));return window.localStorage.setItem(Ci,n),t?window.localStorage.setItem(Jo,t):window.localStorage.removeItem(Jo),window.localStorage.setItem(Ei,e),`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:Lc,redirect_uri:e,response_type:"code",scope:Tw,include_granted_scopes:"true",state:s,prompt:"consent",access_type:"offline",code_challenge:r,code_challenge_method:"S256"}).toString()}`}async function Xw(e,t,n){const r={grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:n,client_id:Lc};console.info("[Drive] Exchanging code",{redirect_uri:n,client_id:Lc,code_preview:e?`${e.slice(0,4)}...${e.slice(-4)}`:"none"});const s=await fetch(l0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const o=await s.text().catch(()=>"");throw new Error(o||"Failed to exchange code for tokens.")}return s.json()}async function Zw(){if(typeof window>"u")return null;const e=window.location.search||"",t=new URLSearchParams(e);let n=t.get("code"),r=t.get("state");if(!n&&window.location.hash){const u=Yw(window.location.hash);n=u.code||n,r=u.state||r}if(!n)return null;let s=null,o=null,l=null;if(r)try{const u=JSON.parse(atob(r));u!=null&&u.v&&typeof u.v=="string"&&(s=u.v),u!=null&&u.r&&typeof u.r=="string"&&(o=u.r),u!=null&&u.d&&typeof u.d=="string"&&(l=u.d)}catch{}if(s||(s=window.localStorage.getItem(Ci)),o||(o=window.localStorage.getItem(Jo)),l||(l=window.localStorage.getItem(Ei)||i0),!s)return null;try{const u=await Xw(n,s,l),c=await d0(u.access_token),f=c0(u.access_token,u.expires_in,u.refresh_token,c||void 0);return await Ud(f,"login-success"),window.localStorage.removeItem(Ci),window.localStorage.removeItem(Jo),window.localStorage.removeItem(Ei),o&&o!==l?window.location.replace(o):window.history.replaceState(null,document.title,l),f}catch{return window.localStorage.removeItem(Ci),window.localStorage.removeItem(Jo),window.localStorage.removeItem(Ei),null}}async function eS(e,t){if(typeof window>"u")throw new Error("Browser required.");const n=Mw(),r=await qw(n,window.location.href);return window.location.href=r,new Promise(()=>{})}async function f0(){const e=await Na();if(!e)return console.warn("[Drive] refreshDriveSession: no stored session"),null;if(e.expiresAt>Date.now()+60*1e3)return console.debug("[Drive] refreshDriveSession: not expiring soon; skipping refresh",{expiresAt:e.expiresAt}),e;if(!e.refreshToken)return console.warn("[Drive] refreshDriveSession: missing refresh token; cannot refresh; keeping existing session",{expiresAt:e.expiresAt}),e;try{const t=await fetch(l0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"refresh_token",refresh_token:e.refreshToken})});if(!t.ok){const o=await t.text().catch(()=>"");throw console.warn("[Drive] refreshDriveSession: HTTP error from token endpoint",{status:t.status,statusText:t.statusText,bodySnippet:o.slice(0,200)}),new Error("Refresh failed: "+t.status)}const n=await t.json(),r=await d0(n.access_token),s=c0(n.access_token,n.expires_in,e.refreshToken,r||e.profile);return await Ud(s,"refresh-success"),s}catch(t){const n=String((t==null?void 0:t.message)||"");return console.warn("[Drive] refreshDriveSession: caught error",{message:n}),/invalid_grant|invalid_client/i.test(n)?(console.warn("[Drive] refreshDriveSession: treating as fatal OAuth error; clearing session"),await u0("fatal-oauth-error")):console.warn("[Drive] refreshDriveSession: non-fatal error; keeping stored session in IDB"),null}}async function En(e){let t=e??await Na();return t?Gw(t)?await f0():t:null}async function tS(){const e=await Zw();if(e)return e;const t=await Na();return t&&t.expiresAt>Date.now()+60*1e3?t:f0()}async function nS(){await u0("explicit-disconnect")}async function we(e,t,n){const r=await fetch(t,{...n,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",...(n==null?void 0:n.headers)||{}}});if(!r.ok){const s=await r.text().catch(()=>"");throw new Error(s||"Google Drive request failed.")}return r}function Rn(e){return e.replace(/'/g,"\\'")}async function ka(e){const t=await h0(e,{createIfMissing:!0});if(!t)throw new Error("Unable to prepare ClassSeats folder.");return t}async function p0(e){return h0(e,{createIfMissing:!1})}async function rS(e){const t=new URLSearchParams({q:`name='${Rn(to)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive",pageSize:"25"}),r=await(await we(e,`https://www.googleapis.com/drive/v3/files?${t.toString()}`)).json(),s=Array.isArray(r.files)?r.files.map(o=>String((o==null?void 0:o.id)||"")).filter(Boolean):[];return Array.from(new Set(s))}async function m0(e,t){if(!t)return!1;const n=new URLSearchParams({q:`'${t}' in parents and trashed=false and mimeType='application/json'`,fields:"files(id)",spaces:"drive",pageSize:"1"}),s=await(await we(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();return Array.isArray(s.files)&&s.files.length>0}async function h0(e,t){const n=(t==null?void 0:t.createIfMissing)!==!1,r=await rS(e);if(r.length===0){if(sS(),!n)return null;const f=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:to,mimeType:"application/vnd.google-apps.folder"})})).json();if(!(f!=null&&f.id))throw new Error("Unable to create ClassSeats folder.");return ju(f.id),f.id}if(r.length===1)return ju(r[0]),r[0];const s=g0(),o=await Promise.all(r.map(async c=>{try{return await m0(e,c)}catch{return!1}})),l=r.filter((c,f)=>o[f]);let u;return s&&l.includes(s)?u=s:l.length>0?u=l[0]:s&&r.includes(s)?u=s:u=r[0],ju(u),u}function ju(e){if(typeof window>"u")return;const t=g0();t&&t!==e&&zd(),window.localStorage.setItem(Md,e)}function g0(){return typeof window>"u"?null:window.localStorage.getItem(Md)}function sS(){typeof window>"u"||(window.localStorage.removeItem(Md),zd())}function um(e){typeof window>"u"||window.localStorage.setItem(Od,e)}function oS(){return typeof window>"u"?null:window.localStorage.getItem(Od)}function zd(){typeof window>"u"||window.localStorage.removeItem(Od)}async function lS(e,t){try{const r=await(await we(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,mimeType,trashed`)).json();return!!(r!=null&&r.id)&&(r==null?void 0:r.mimeType)==="application/vnd.google-apps.folder"&&(r==null?void 0:r.trashed)!==!0}catch{return!1}}async function iS(e){const t=oS();if(t){if(await lS(e,t))return t;zd()}const n=await ka(e),r=new URLSearchParams({q:`'${n}' in parents and name='${Rn(lm)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await we(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json();if(Array.isArray(o.files)&&o.files.length>0)return um(o.files[0].id),o.files[0].id;const u=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:lm,mimeType:"application/vnd.google-apps.folder",parents:[n]})})).json();if(!(u!=null&&u.id))throw new Error("Unable to create Student Docs folder.");return um(u.id),u.id}async function aS(e){const t=await ka(e),n=new URLSearchParams({q:`'${t}' in parents and name='${Rn(im)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await we(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:im,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student photos folder.");return l.id}async function uS(e){const t=await ka(e),n=new URLSearchParams({q:`'${t}' in parents and name='${Rn(am)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await we(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:am,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student audio folder.");return l.id}async function cS(e,t,n){const r=(n||"").trim();if(!r)throw new Error("Document title is required.");const o=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.document",parents:[t]})})).json();if(!(o!=null&&o.id))throw new Error("Unable to create Google Doc.");return{fileId:o.id,title:o.name||r}}async function dS(e){const t=await En();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await aS(n),s=Ld(e.studentId,e.studentFullName);let o=e.fileId?String(e.fileId):null;if(!o){const w=`name='${Rn(s)}' and '${r}' in parents and trashed=false`,S=new URLSearchParams({q:w,fields:"files(id)",spaces:"drive"}),k=await(await we(n,`https://www.googleapis.com/drive/v3/files?${S.toString()}`)).json();o=Array.isArray(k.files)&&k.files.length>0?k.files[0].id:null}if(!o){const w=`student_${e.studentId}.jpg`,S=`name='${Rn(w)}' and '${r}' in parents and trashed=false`,R=new URLSearchParams({q:S,fields:"files(id)",spaces:"drive"}),j=await(await we(n,`https://www.googleapis.com/drive/v3/files?${R.toString()}`)).json();o=Array.isArray(j.files)&&j.files.length>0?j.files[0].id:null}const l=o?{name:s,mimeType:"image/jpeg"}:{name:s,parents:[r],mimeType:"image/jpeg"},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.jpegBlob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const w=await f.text().catch(()=>"");throw new Error(w||"Failed to upload student photo.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student photo.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function fS(e){const t=await En();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await uS(n),s=Pw(e.studentId,e.studentFullName,e.extension),o=e.fileId?String(e.fileId):null,l=o?{name:s,mimeType:e.mimeType}:{name:s,parents:[r],mimeType:e.mimeType},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.blob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const w=await f.text().catch(()=>"");throw new Error(w||"Failed to upload student audio.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student audio.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function pS(e){if(!e)throw new Error("File ID is required.");const t=await En();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");await we(t.accessToken,`https://www.googleapis.com/drive/v3/files/${e}`,{method:"DELETE"})}async function Cu(e){const t=await p0(e);if(!t)return[];const n=new URLSearchParams({q:`'${t}' in parents and trashed=false and mimeType='application/json'`,fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"}),s=await(await we(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();return(Array.isArray(s.files)?s.files.filter(l=>!Dw(l==null?void 0:l.name)):[]).map(ts)}async function Eu(e,t){const r=await(await we(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId,appProperties`,{method:"GET"})).json();return ts(r)}async function mS(e){const t=[`name='${Rn(to)}'`,"mimeType='application/vnd.google-apps.folder'"],n=new URLSearchParams({q:[...t,"trashed=true"].join(" and "),fields:"files(id)",spaces:"drive",pageSize:"10"}),r=new URLSearchParams({q:[...t,"trashed=false"].join(" and "),fields:"files(id)",spaces:"drive",pageSize:"10"}),[s,o]=await Promise.all([we(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`),we(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)]),[l,u]=await Promise.all([s.json(),o.json()]),c=Array.isArray(l.files)?l.files:[],f=Array.isArray(u.files)?u.files:[],g=f.map(h=>String((h==null?void 0:h.id)||"")).filter(Boolean),w=c.map(h=>String((h==null?void 0:h.id)||"")).filter(Boolean),S=await Promise.all(g.map(async h=>{try{return await m0(e,h)}catch{return!1}})),R=await Promise.all(w.map(async h=>{const m=new URLSearchParams({q:`'${h}' in parents`,fields:"files(id)",spaces:"drive",pageSize:"1"}),_=await(await we(e,`https://www.googleapis.com/drive/v3/files?${m.toString()}`)).json();return Array.isArray(_.files)&&_.files.length>0})),k=S.filter(Boolean).length,j=R.filter(Boolean).length,Q=w.slice().sort().join(",");return{hasTrashedManagedFolder:c.length>0,trashedFolderCount:c.length,hasActiveManagedFolder:f.length>0,activeFolderCount:f.length,hasMultipleActiveManagedFolders:f.length>1,activeFolderWithDataCount:k,hasTrashedManagedFolderWithData:j>0,trashedFolderWithDataCount:j,trashedFolderIds:w,trashedFolderSignature:Q}}async function hS(e,t,n){const r=t.trim();if(!r)throw new Error("Folder name is required.");const s=["mimeType='application/vnd.google-apps.folder'",`name='${Rn(r)}'`,"trashed=false"];n&&s.push(`'${n}' in parents`);const o=new URLSearchParams({q:s.join(" and "),fields:"files(id)",spaces:"drive"}),u=await(await we(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return u.files[0].id;const f=await(await we(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.folder",parents:n?[n]:void 0})})).json();if(!(f!=null&&f.id))throw new Error("Unable to create folder.");return f.id}async function gS(e,t,n){const r=(t||[]).map(o=>o.trim()).filter(Boolean);if(r.length===0)throw new Error("Folder path is required.");let s=null;for(const o of r){if(!s&&o===to){if(s=await p0(e),!s)throw new Error("ClassSeats folder is not available.");continue}s=await hS(e,o,s)}if(!s)throw new Error("Unable to resolve folder path.");return s}async function yS(e,t){const n=t.trim();if(!n)return!1;const r=new URLSearchParams({q:`'root' in parents and mimeType='application/vnd.google-apps.folder' and name='${Rn(n)}' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await we(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json(),l=Array.isArray(o.files)&&o.files.length>0?o.files[0].id:null;if(!l)return!1;const u=new URLSearchParams({q:`'${l}' in parents and trashed=false`,fields:"files(id)",spaces:"drive",pageSize:"1"}),f=await(await we(e,`https://www.googleapis.com/drive/v3/files?${u.toString()}`)).json();return Array.isArray(f.files)&&f.files.length>0?!1:(await we(e,`https://www.googleapis.com/drive/v3/files/${l}`,{method:"PATCH",body:JSON.stringify({trashed:!0})}),!0)}async function xS(e,t,n){if(!t)throw new Error("File ID is required.");if(!n)throw new Error("Folder ID is required.");let r=null;try{const l=await(await we(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=parents`,{method:"GET"})).json();Array.isArray(l.parents)&&l.parents.length>0&&(r=l.parents.join(","))}catch{r=null}const s=new URLSearchParams({addParents:n,fields:"id,parents"});r&&s.set("removeParents",r),await we(e,`https://www.googleapis.com/drive/v3/files/${t}?${s.toString()}`,{method:"PATCH",body:JSON.stringify({})})}async function vS(e,t,n){const r=String(t||"").trim();if(!r)throw new Error("File name is required.");if(o0(r))throw new Error(s0);const s=await ka(e),o="classseats_drive_boundary",l={name:r,mimeType:"application/json",parents:[s],appProperties:r0},u=[`--${o}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(l),`--${o}`,"Content-Type: application/json","",n,`--${o}--`,""].join(`\r
`),c=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${o}`},body:u});if(!c.ok){const g=await c.text().catch(()=>"");throw new Error(g||"Failed to create Google Drive file.")}const f=await c.json();return ts(f)}async function wS(e,t,n,r="{}"){const s=n.trim();if(!s)throw new Error("File name is required.");const o=new URLSearchParams({q:`'${t}' in parents and name='${Rn(s)}' and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",spaces:"drive"}),u=await(await we(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return ts(u.files[0]);const c="classseats_drive_boundary",f={name:s,mimeType:"application/json",parents:[t],appProperties:r0},g=[`--${c}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(f),`--${c}`,"Content-Type: application/json","",r,`--${c}--`,""].join(`\r
`),w=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${c}`},body:g});if(!w.ok){const R=await w.text().catch(()=>"");throw new Error(R||"Failed to create Google Drive file.")}const S=await w.json();return ts(S)}async function vs(e,t){return(await we(e,`https://www.googleapis.com/drive/v3/files/${t}?alt=media`,{method:"GET"})).text()}async function cm(e,t,n){const r=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${t}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:n});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(l||"Failed to upload file to Google Drive.")}const o=await(await we(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId`,{method:"GET"})).json();return ts(o)}function ts(e){var t;return e?{id:e.id,name:e.name,modifiedTime:e.modifiedTime,size:e.size,revisionId:e.headRevisionId||e.revisionId||((t=e==null?void 0:e.appProperties)==null?void 0:t.revisionId)}:{id:"",name:""}}async function Ru(e){const t=new URLSearchParams({q:"mimeType='application/json' and trashed=false",fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await we(e,`https://www.googleapis.com/drive/v3/files?${t.toString()}`)).json()).files||[]).map(ts)}const Vr=new Map;function y0(e,t){const n=Vr.get(e);if((n==null?void 0:n.value)!==void 0)return Promise.resolve(n.value);if(n!=null&&n.promise)return n.promise;const r=t().then(s=>(Vr.set(e,{value:s}),s)).catch(s=>{throw Vr.delete(e),s});return Vr.set(e,{promise:r}),r}function Qs(e){if(!e){Vr.clear();return}for(const t of Vr.keys())t.startsWith(e)&&Vr.delete(t)}const SS="classseats-cache",bS=1,Bn="driveFolders",wr="studentPhotoMap",Sr="photoBlobs";function ja(){return typeof indexedDB>"u"?Promise.resolve(null):new Promise(e=>{const t=indexedDB.open(SS,bS);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Bn)||n.createObjectStore(Bn,{keyPath:"key"}),n.objectStoreNames.contains(wr)||n.createObjectStore(wr,{keyPath:"studentId"}),n.objectStoreNames.contains(Sr)||n.createObjectStore(Sr,{keyPath:"fileId"})},t.onsuccess=()=>e(t.result),t.onerror=()=>e(null)})}function $d(e,t){return t?Date.now()-e>t:!1}async function no(e,t){const n=await ja();return n?new Promise(r=>{const s=n.transaction(e,"readonly"),l=s.objectStore(e).get(t);l.onsuccess=()=>r(l.result||null),l.onerror=()=>r(null),s.onabort=()=>r(null)}):null}async function Ca(e,t){const n=await ja();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).put(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function Js(e,t){const n=await ja();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).delete(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function _u(e){const t=await ja();if(t)return new Promise(n=>{const r=t.transaction(e,"readwrite");r.objectStore(e).clear(),r.oncomplete=()=>n(),r.onerror=()=>n(),r.onabort=()=>n()})}async function x0(e,t,n){const r=await no(Bn,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(Bn,e),null):$d(r.updatedAt,t)?(await Js(Bn,e),null):r:null}async function v0(e){await Ca(Bn,e)}async function NS(e,t,n){const r=await no(wr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(wr,e),null):$d(r.fetchedAt,t)?(await Js(wr,e),null):r:null}async function kS(e,t){const n=await no(wr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function jS(e){await Ca(wr,e)}async function CS(e,t,n){const r=await no(Sr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(Sr,e),null):$d(r.fetchedAt,t)?(await Js(Sr,e),null):r:null}async function ES(e,t){const n=await no(Sr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function w0(e){await Ca(Sr,e)}async function RS(){await Promise.all([_u(Bn),_u(wr),_u(Sr)])}const S0="driveAccountKey";async function _S(){const e=await no(Bn,S0);return(e==null?void 0:e.value)||null}async function TS(e){const t={key:S0,value:e,updatedAt:Date.now(),accountKey:e};await Ca(Bn,t)}const dm="ClassSeats",fm="studentPhotos",b0=30*24*60*60*1e3,AS=7*24*60*60*1e3,PS=7*24*60*60*1e3,IS=5*60*1e3,DS="classseats_studentPhotoRefs_v1",LS=()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},Kr=(e,t)=>{LS()&&console.debug(`[PhotoService] ${e}`,t)},Tu={folderLookups:0,photoMetaLookups:0,mediaDownloads:0};function qs(e){Tu[e]+=1,Kr(`${e}=${Tu[e]}`,{count:Tu[e]})}const sa=new Map,oa=new Map,ns=new Map;let _i=null;const N0=(e,t)=>`${e}:${t||0}`;function k0(e){return e.replace(/'/g,"\\'")}function MS(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(DS);if(!t)return null;const n=JSON.parse(t);if(!n||typeof n!="object")return null;const r=n[e];return!r||typeof r.fileId!="string"?null:r.fileId}catch{return null}}function j0(e){let t=0;const n=[],r=()=>{if(t>=e)return;const s=n.shift();s&&s()};return async function(o){t>=e&&await new Promise(l=>n.push(l)),t+=1;try{return await o()}finally{t-=1,r()}}}const Bd=j0(4),pm=j0(3);async function rs(e,t,n){const r={Authorization:`Bearer ${e}`},s=(n==null?void 0:n.body)instanceof FormData;n!=null&&n.body&&!s&&(r["Content-Type"]="application/json");const o=await fetch(t,{...n,headers:{...r,...(n==null?void 0:n.headers)||{}}});if(!o.ok){const l=await o.text().catch(()=>"");throw new Error(l||"Google Drive request failed.")}return o}async function OS(e){var n,r,s,o,l;if((r=(n=e.driveSession)==null?void 0:n.profile)!=null&&r.email)return e.driveSession.profile.email;if((s=e.driveClient)!=null&&s.getStatus)try{const u=await e.driveClient.getStatus();if(u.connected)return((o=u.profile)==null?void 0:o.email)||null}catch{}const t=await En(e.driveSession);return((l=t==null?void 0:t.profile)==null?void 0:l.email)||null}async function bl(e){const t=await OS(e);if(!t)return null;_i&&_i!==t&&await Ps("account-change");const n=await _S();return n&&n!==t&&await Ps("account-change"),_i=t,n!==t&&await TS(t),t}async function Ea(e){var n,r;if(((n=e.driveClient)==null?void 0:n.kind)==="desktop")return null;const t=await En(e.driveSession);return t!=null&&t.accessToken?t.accessToken:(r=e.driveSession)!=null&&r.accessToken?(Kr("falling back to existing drive session token"),e.driveSession.accessToken):null}async function Wd(e,t){const n=await y0(e,t);return n==null&&Qs(e),n}function Fo(e,t){const n=ns.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return ns.set(e,{url:r}),r}function FS(e){const t=ns.get(e);return(t==null?void 0:t.url)||null}function C0(e,t){const n=`${e}:`;for(const[r,s]of ns.entries())r!==e&&!r.startsWith(n)||t&&r===t||(s!=null&&s.url&&URL.revokeObjectURL(s.url),ns.delete(r))}function US(e){const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),t}function zS(e){const t=e.replace(/\s+/g,"");return t.length<32||t.length%4!==0?!1:/^[A-Za-z0-9+/=]+$/.test(t)}function mm(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"image/jpeg"})}catch{return null}}function $S(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e))return new Blob([US(e)]);if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=mm(t[1],n==null?void 0:n[1]);if(r)return r}}if(zS(e)){const t=mm(e);if(t)return t}return new Blob([e])}return null}async function hm(e,t,n,r){const s=`name='${k0(n)}' and '${t}' in parents and trashed=false`,o=new URLSearchParams({q:s,fields:"files(id,name,modifiedTime)",spaces:"drive"});return qs("photoMetaLookups"),Bd(async()=>{const u=await(await rs(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET",signal:r})).json();return!Array.isArray(u.files)||u.files.length===0?null:u.files[0]})}async function BS(e,t,n){return qs("photoMetaLookups"),Bd(async()=>{const s=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"GET",signal:n})).json();return s!=null&&s.id?{id:s.id,name:s.name,modifiedTime:s.modifiedTime}:null})}async function WS(e,t,n,r){return Bd(async()=>{const o=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"PATCH",body:JSON.stringify({name:n}),signal:r})).json();return o!=null&&o.id?{id:o.id,name:o.name,modifiedTime:o.modifiedTime}:null})}async function HS(e){return Wd("driveFolder:classSeats",async()=>{const t=await bl(e),n=await x0("classSeatsFolderId",b0,t||void 0);if(n!=null&&n.value)return n.value;const r=await Ea(e);if(!r)return null;qs("folderLookups");const s=new URLSearchParams({q:`name='${dm}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),l=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${s.toString()}`,{method:"GET"})).json();let u=null;if(Array.isArray(l.files)&&l.files.length>0&&(u=l.files[0].id),!u){const f=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:dm,mimeType:"application/vnd.google-apps.folder"})})).json();u=(f==null?void 0:f.id)||null}return u?(await v0({key:"classSeatsFolderId",value:u,updatedAt:Date.now(),accountKey:t||void 0}),u):null})}async function VS(e){return Wd("driveFolder:studentPhotos",async()=>{const t=await bl(e),n=await x0("studentPhotosFolderId",b0,t||void 0);if(n!=null&&n.value)return n.value;const r=await Ea(e);if(!r)return null;const s=await HS(e);if(!s)return null;qs("folderLookups");const o=new URLSearchParams({q:`'${s}' in parents and name='${k0(fm)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),u=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET"})).json();let c=null;if(Array.isArray(u.files)&&u.files.length>0&&(c=u.files[0].id),!c){const g=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:fm,mimeType:"application/vnd.google-apps.folder",parents:[s]})})).json();c=(g==null?void 0:g.id)||null}return c?(await v0({key:"studentPhotosFolderId",value:c,updatedAt:Date.now(),accountKey:t||void 0}),c):null})}async function Uo(e){sa.set(e.studentId,e),oa.delete(e.studentId),Qs(`studentPhoto:${e.studentId}`),await jS(e)}async function KS(e,t,n,r){const s=String(e),o=await bl(n),l=sa.get(s);if(l&&(!o||l.accountKey===o))return l;const u=await NS(s,AS,o||void 0);if(u)return sa.set(s,u),u;const c=await kS(s,o||void 0),f=oa.get(s);if(f&&Date.now()-f<IS)return c||null;const g=await Ea(n);if(!g)return c||null;if(c!=null&&c.fileId)try{const k=await BS(g,c.fileId,r);if(k){const j={studentId:s,fileId:k.id,fileName:k.name,updatedTime:k.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(j),j}}catch{}const w=await VS(n);if(!w)return c||null;const S=t?Ld(e,t):c==null?void 0:c.fileName;if(S)try{const k=await hm(g,w,S,r);if(k){const j={studentId:s,fileId:k.id,fileName:k.name,updatedTime:k.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(j),j}}catch{return c||null}try{const k=`student_${e}.jpg`,j=await hm(g,w,k,r);if(j){let Q=j.name,h=j.modifiedTime;if(S&&j.name!==S){const b=await WS(g,j.id,S,r);b!=null&&b.name&&(Q=b.name,h=b.modifiedTime)}const m={studentId:s,fileId:j.id,fileName:Q,updatedTime:h,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(m),m}}catch{return c||null}const R=MS(s);if(R){const k={studentId:s,fileId:R,fileName:S||void 0,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(k),k}return oa.set(s,Date.now()),c||null}async function GS(e,t,n){var s;if(((s=t.driveClient)==null?void 0:s.kind)==="desktop"&&t.driveClient.downloadFile)return qs("mediaDownloads"),pm(async()=>{var l,u;const o=await((u=(l=t.driveClient)==null?void 0:l.downloadFile)==null?void 0:u.call(l,e));return $S(o==null?void 0:o.data)});const r=await Ea(t);return r?(qs("mediaDownloads"),pm(async()=>{const o=`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,l=async S=>await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${S}`},signal:n}),u=await l(r);if(u.ok)return u.blob();if(Kr("photo download failed",{fileId:e,status:u.status}),!(u.status===401||u.status===403))return null;const f=await En(t.driveSession),g=f==null?void 0:f.accessToken;if(!g)return Kr("photo download retry skipped: no refreshed token",{fileId:e}),null;const w=await l(g);return w.ok?(Kr("photo download recovered after token refresh",{fileId:e}),w.blob()):(Kr("photo download retry failed",{fileId:e,status:w.status}),null)})):null}async function YS(e,t,n,r){const s=N0(e,t);C0(e,s);const o=FS(s);if(o)return o;const l=await bl(n),u=await CS(s,PS,l||void 0);if(u)return Fo(s,u.blob);const c=await ES(s,l||void 0);try{const f=await y0(`photoBlob:${s}`,async()=>GS(e,n,r));if(!f)return Qs(`photoBlob:${s}`),c?Fo(s,c.blob):null;const g={fileId:s,blob:f,fetchedAt:Date.now(),accountKey:l||void 0};return await w0(g),Fo(s,f)}catch{return Qs(`photoBlob:${s}`),c?Fo(s,c.blob):null}}async function QS(e){const t=e.photoFileId?String(e.photoFileId):"";if(!t)return{fileId:null,url:null};const n=await YS(t,e.photoUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}async function JS(e){const t=`studentPhoto:${String(e.studentId)}`;return Wd(t,async()=>KS(e.studentId,e.fullName,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal))}async function qS(e){const t=N0(e.fileId,e.photoUpdatedAt);Qs(`photoBlob:${t}`);const n=String(e.studentId),r=await bl({driveClient:e.driveClient,driveSession:e.driveSession}),s=Ld(e.studentId,e.fullName),o={studentId:n,fileId:e.fileId,fileName:s,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await Uo(o);const l={fileId:t,blob:e.blob,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await w0(l),C0(e.fileId,t),Fo(t,e.blob)}async function Ps(e){e&&Kr("cache clear",{reason:e});for(const t of ns.values())URL.revokeObjectURL(t.url);ns.clear(),sa.clear(),oa.clear(),_i=null,Qs(),await RS()}function E0({studentId:e,fullName:t,photoFileId:n,photoUpdatedAt:r,driveClient:s,driveSession:o,driveAccountKey:l}){const[u,c]=d.useState(null),[f,g]=d.useState(null),[w,S]=d.useState(!1),R=d.useMemo(()=>String(e),[e]),k=d.useMemo(()=>n?String(n):"",[n]),j=(o==null?void 0:o.accessToken)||"",Q=l||"";return d.useEffect(()=>{let h=!0;const m=new AbortController;return k?(S(!0),c(null),QS({photoFileId:k,photoUpdatedAt:r,driveClient:s,driveSession:o,signal:m.signal}).then(b=>{h&&(c(b.url),g(b.fileId))}).catch(()=>{h&&(c(null),g(null))}).finally(()=>{h&&S(!1)}),()=>{h=!1,m.abort()}):(c(null),g(null),S(!1),()=>{h=!1,m.abort()})},[R,k,r,s,o,j,Q,t]),{photoUrl:u,fileId:f,loading:w}}const hl=new Map,XS=(e,t)=>`${e}:${t||0}`;function ZS(e){return/^[A-Za-z0-9+/=\s]+$/.test(e)&&e.length%4===0}function gm(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"audio/webm"})}catch{return null}}function e1(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e)){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=new Uint8Array(t.length);return n.set(t),new Blob([n.buffer])}if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=gm(t[1],n==null?void 0:n[1]);if(r)return r}}if(ZS(e)){const t=gm(e);if(t)return t}return new Blob([e])}return null}async function t1(e){var n,r;if((n=e.driveSession)!=null&&n.accessToken)return e.driveSession.accessToken;if(((r=e.driveClient)==null?void 0:r.kind)==="desktop")return null;const t=await En(e.driveSession);return(t==null?void 0:t.accessToken)||null}function n1(e,t){const n=hl.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return hl.set(e,{url:r}),r}function r1(e){const t=hl.get(e);return(t==null?void 0:t.url)||null}function s1(e,t){for(const[n,r]of hl.entries())n.startsWith(`${e}:`)&&(t&&n===t||(r.url&&URL.revokeObjectURL(r.url),hl.delete(n)))}async function o1(e,t,n){var o;if(((o=t.driveClient)==null?void 0:o.kind)==="desktop"&&t.driveClient.downloadFile){const l=await t.driveClient.downloadFile(e);return e1(l==null?void 0:l.data)}const r=await t1(t);if(!r)return null;const s=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{method:"GET",headers:{Authorization:`Bearer ${r}`},signal:n});return s.ok?s.blob():null}async function l1(e,t,n,r){const s=XS(e,t);s1(e,s);const o=r1(s);if(o)return o;const l=await o1(e,n,r);return l?n1(s,l):null}async function i1(e){const t=e.audioFileId?String(e.audioFileId):"";if(!t)return{fileId:null,url:null};const n=await l1(t,e.audioUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}function Hd({studentId:e,audioFileId:t,audioUpdatedAt:n,driveClient:r,driveSession:s}){const[o,l]=d.useState(null),[u,c]=d.useState(null),[f,g]=d.useState(!1),w=d.useMemo(()=>String(e),[e]),S=d.useMemo(()=>t?String(t):"",[t]),R=(s==null?void 0:s.accessToken)||"";return d.useEffect(()=>{let k=!0;const j=new AbortController;return S?(g(!0),l(null),i1({audioFileId:S,audioUpdatedAt:n,driveClient:r,driveSession:s,signal:j.signal}).then(Q=>{k&&(l(Q.url),c(Q.fileId))}).catch(()=>{k&&(l(null),c(null))}).finally(()=>{k&&g(!1)}),()=>{k=!1,j.abort()}):(l(null),c(null),g(!1),()=>{k=!1,j.abort()})},[w,S,n,r,s,R]),{audioUrl:o,fileId:u,loading:f}}const a1="newui_constraints_v1";function u1(){try{const e=localStorage.getItem(a1);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function c1(){return u1()}const R0=d.createContext(null);function d1({children:e}){const[t,n]=d.useState([]),r=d.useCallback(l=>{n(u=>u.filter(c=>c.id!==l))},[]),s=d.useCallback(l=>{const u=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`,c=l.tone||"info",f=l.duration??4e3;n(g=>[...g,{...l,id:u,tone:c}]),f>0&&typeof window<"u"&&window.setTimeout(()=>r(u),f)},[r]),o=d.useMemo(()=>s,[s]);return i.jsxs(R0.Provider,{value:o,children:[e,i.jsx("div",{className:"pointer-events-none fixed top-6 left-1/2 -translate-x-1/2 z-[1000] flex flex-col gap-4 w-full max-w-lg items-center",children:t.map(l=>{const u=l.tone==="success"?"bg-emerald-600 text-white shadow-emerald-500/40":l.tone==="error"?"bg-rose-600 text-white shadow-rose-500/40":l.tone==="warning"?"bg-amber-500 text-slate-900 shadow-amber-400/40":"bg-slate-800 text-white shadow-slate-900/40";return i.jsxs("div",{className:`pointer-events-auto rounded-3xl px-5 py-4 shadow-2xl flex items-start gap-4 text-base font-semibold w-full ${u}`,children:[i.jsx("div",{className:"flex-1 text-sm font-semibold",children:l.message}),i.jsx("button",{className:"text-base font-bold opacity-80 hover:opacity-100",onClick:()=>r(l.id),"aria-label":"Dismiss notification",children:""})]},l.id)})})]})}function Vd(){const e=d.useContext(R0);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}const f1="newui_history_v1";function p1(){try{const e=localStorage.getItem(f1);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function m1(){return p1()}const h1="newui_groupings_v1";function g1(){try{const e=localStorage.getItem(h1);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function y1(){return g1()}console.log(" GroupingAlgorithm.js (FIXED v2) file loaded!");console.log(" GroupingAlgorithm v2 loaded successfully!");const x1="newui_print_settings_v1",v1={seatingChartEditor:{lastUpdated:new Date(0).toISOString()}};function w1(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function sr(e,t,n,r){const s=typeof e=="number"?e:parseFloat(String(e));return Number.isFinite(s)?Math.min(r,Math.max(n,s)):t}function S1(e){return e==="a4"||e==="legal"||e==="tabloid"?e:"letter"}function b1(e){return Array.isArray(e)?e.filter(t=>typeof t=="string"||typeof t=="number"):null}function N1(e){return e==="posterTiled"?e:"single"}function k1(){var n,r,s,o,l;const e=w1(localStorage.getItem(x1)),t=(e==null?void 0:e.seatingChartEditor)??{};return{seatingChartEditor:{paper:S1(t.paper),orientation:t.orientation==="portrait"?"portrait":"landscape",marginMode:t.marginMode==="max"?"max":"safe",showPhotos:t.showPhotos!==!1,showTags:t.showTags!==!1,showSeatNumbers:t.showSeatNumbers===!0,showTableHeader:t.showTableHeader!==!1,selectedTagIds:b1(t.selectedTagIds),textScale:sr(t.textScale,1,.5,2.5),photoScale:sr(t.photoScale,1,.5,2),zoom:sr(t.zoom,1,.1,4),offsetX:sr(t.offsetX,0,-5e3,5e3),offsetY:sr(t.offsetY,0,-5e3,5e3),seatingChartLayoutMode:N1(t.seatingChartLayoutMode),poster:{mode:((n=t.poster)==null?void 0:n.mode)==="manual"?"manual":"auto",rows:Math.round(sr((r=t.poster)==null?void 0:r.rows,2,1,10)),cols:Math.round(sr((s=t.poster)==null?void 0:s.cols,2,1,10)),overlapIn:sr((o=t.poster)==null?void 0:o.overlapIn,.25,0,.5),showPageLabels:((l=t.poster)==null?void 0:l.showPageLabels)!==!1},lastUpdated:typeof t.lastUpdated=="string"?t.lastUpdated:v1.seatingChartEditor.lastUpdated}}}function _0(e,t=50){const n=t>0?t:50,r=Math.ceil(n*.9),s=Math.ceil(n*.7),o=Math.ceil(n*.5);return e>=r?{label:"Good Standing",color:"green",emoji:"",min:r}:e>=s?{label:"Caution",color:"yellow",emoji:"",min:s,max:r-1}:e>=o?{label:"Warning",color:"orange",emoji:"",min:o,max:s-1}:{label:"Alert",color:"red",emoji:"",min:0,max:o-1}}function j1(){return{periods:Dc().periods.map(t=>({id:t.id,behaviorNotes:t.behaviorNotes||{},pointsByStudent:t.pointsByStudent||{},pointsHistory:t.pointsHistory||[],pointsEnabled:t.pointsEnabled,startingPoints:t.startingPoints}))}}const C1=e=>{const[t,n,r]=e.split("-").map(s=>Number(s));return!Number.isFinite(t)||!Number.isFinite(n)||!Number.isFinite(r)?null:new Date(Date.UTC(t,n-1,r))},E1=e=>{const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return`${t}-${n}-${r}`},R1=e=>{const t=C1(e);return t?(t.setUTCDate(t.getUTCDate()-1),E1(t)):e},T0=(e,t,n)=>{if(!e)return null;const r=e[String(t)];return r&&r[n]||null},_1=e=>{if(!e)return null;const t=Object.keys(e);return t.length===0?null:t.reduce((n,r)=>r<n?r:n,t[0])};function Au(e){var g;const{attendance:t,studentId:n,date:r,status:s,resets:o}=e;if(!t)return 0;const l=String(n),c=T0(o,n,s==="left_early"?"leftEarly":s==="tardy"?"tardy":"absent");let f=0;for(const w of Object.keys(t))w>r||c&&w<c||((g=t[w])==null?void 0:g[l])===s&&(f+=1);return f}function T1(e){var S,R;const{attendance:t,studentId:n,date:r,resets:s}=e;if(!t)return 0;const o=String(n),l=T0(s,n,"absent");if(l&&r<l)return 0;const u=Object.keys(t).filter(k=>k<=r&&(!l||k>=l)).sort((k,j)=>j.localeCompare(k));if(u.length===0)return 0;let c=null;for(const k of u){const j=((S=t[k])==null?void 0:S[o])||"unmarked";if(j!=="unmarked"){if(j!=="absent")return 0;c=k;break}}if(!c)return 0;const f=_1(t);let g=c,w=0;for(;!(l&&g<l);){const k=((R=t[g])==null?void 0:R[o])||"unmarked";if(k==="absent")w+=1;else if(k!=="unmarked")break;if(!f||g<=f)break;g=R1(g)}return w}const A0="https://www.classseats.com/updates",Kd="https://classseats.com",A1=`${Kd}/privacy.html`,P1=`${Kd}/terms.html`;function I1({variant:e="floating",className:t}){const n=new Date().getFullYear(),r=i.jsxs("div",{className:"w-full max-w-[460px] rounded-xl border border-indigo-100 bg-white/95 px-3 py-3 text-left text-slate-800 shadow-lg backdrop-blur",children:[i.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-700 flex flex-wrap items-center gap-1",children:[i.jsx("span",{children:"Early Access"}),i.jsx("span",{children:""}),i.jsx("a",{href:A0,target:"_blank",rel:"noreferrer",className:"text-indigo-700 underline decoration-indigo-300 decoration-2 underline-offset-4 hover:text-indigo-800",children:"Updates"}),i.jsx("span",{children:""}),i.jsxs("span",{children:["(c) ",n," ClassWare Solutions, LLC"]})]}),i.jsx("p",{className:"mt-1 text-[11px] leading-snug text-slate-700",children:"ClassSeats is in development. Features and pricing may change."})]});return e==="floating"?i.jsx("div",{className:`pointer-events-none fixed bottom-3 left-3 right-3 z-40 flex justify-end md:left-auto md:right-4 md:max-w-[420px] ${t??""}`,children:i.jsx("div",{className:"pointer-events-auto w-full md:w-auto",children:r})}):i.jsx("div",{className:t,children:r})}const D1="0.1.0",L1=new Date().toLocaleDateString();function M1({open:e,onClose:t,buildRevision:n}){const r=new Date().getFullYear();return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),i.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-700",children:["ClassSeats",i.jsx("sup",{className:"text-[6px] font-normal align-super",children:"TM"})," (Early Access)"]}),i.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"About"})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:t,"aria-label":"Close about",children:""})]}),i.jsx("p",{className:"mt-2 text-sm leading-relaxed text-slate-700",children:"ClassSeats is in active development. Features and pricing may change. Data is stored in your Google Drive or locally on your device  ClassWare Solutions, LLC does not store student data on its servers."}),i.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm text-slate-800 space-y-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"App version"}),i.jsx("span",{children:D1})]}),n&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build revision"}),i.jsxs("span",{children:["Rev ",n]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build date"}),i.jsx("span",{children:L1})]})]}),i.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[i.jsx(ci,{href:Kd,label:"Home"}),i.jsx(ci,{href:A1,label:"Privacy"}),i.jsx(ci,{href:P1,label:"Terms"}),i.jsx(ci,{href:A0,label:"Get updates"})]}),i.jsxs("p",{className:"mt-4 text-[11px] text-slate-500",children:[" ",r," ClassWare Solutions, LLC. All rights reserved."]}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Google Drive is a trademark of Google LLC"}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"ClassSeats is a product of ClassWare Solutions, LLC"})]})]}):null}function ci({href:e,label:t}){return i.jsxs("a",{href:e,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-800 shadow-sm hover:border-indigo-200 hover:text-indigo-700",children:[t,i.jsx("span",{"aria-hidden":"true",children:""})]})}function O1(e){const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function F1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function U1({isOpen:e,onRequestClose:t,unreadMessages:n,allMessages:r,dismissedIds:s,onDismiss:o}){const[l,u]=Ds.useState("unread"),c=Ds.useRef(!1);Ds.useEffect(()=>{if(!e){c.current=!1;return}c.current||(c.current=!0,u("unread"))},[e]);const f=l==="all"?r:n;return i.jsxs(ta,{isOpen:e,onRequestClose:t,title:"Messages",subtitle:"Updates and notes from ClassSeats",maxWidth:"md",footer:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsxs("p",{className:"text-xs text-slate-600",children:["Need Help? Email"," ",i.jsx("a",{className:"font-semibold text-slate-700 hover:text-slate-900",href:"mailto:support@classseats.com",children:"support@classseats.com"})]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 text-sm font-semibold",onClick:t,children:"Close"})]}),children:[i.jsxs("div",{className:"mb-3 inline-flex items-center rounded-full border border-slate-200 bg-slate-100 p-1",children:[i.jsxs("button",{type:"button",onClick:()=>u("unread"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="unread"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["Unread (",n.length,")"]}),i.jsxs("button",{type:"button",onClick:()=>u("all"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["All (",r.length,")"]})]}),f.length===0?i.jsx("div",{className:"py-6",children:l==="unread"?i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No new messages right now."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"You're all caught up."})]}):i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No messages available yet."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Published messages will appear here."})]})}):i.jsx("div",{className:"flex flex-col gap-3 py-1",children:f.map(g=>{var w,S;return i.jsxs("article",{className:"rounded-xl border border-slate-200 bg-white",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("h3",{className:"text-sm font-extrabold text-slate-900 truncate",children:g.title}),g.priority==="high"&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-100 text-rose-800 px-2 py-0.5 text-[11px] font-semibold",children:"Important"}),l==="all"&&s.has(g.id)&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2 py-0.5 text-[11px] font-semibold",children:"Dismissed"})]}),i.jsx("div",{className:"mt-1 text-xs text-slate-500",children:O1(g.publishedAt)})]}),l==="all"&&s.has(g.id)?i.jsx("span",{className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-600 px-2.5 py-1 text-[11px] font-semibold",children:"Dismissed"}):i.jsx("button",{type:"button",className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2.5 py-1 text-[11px] font-semibold hover:bg-slate-200",onClick:()=>o(g.id),title:"Dismiss this message",children:"Dismiss"})]}),i.jsxs("div",{className:"px-4 py-3",children:[i.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:g.body}),((w=g.cta)==null?void 0:w.label)&&((S=g.cta)==null?void 0:S.href)&&F1(g.cta.href)&&i.jsx("div",{className:"mt-3",children:i.jsxs("a",{className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 text-white px-3 py-2 text-sm font-semibold hover:bg-indigo-700",href:g.cta.href,target:"_blank",rel:"noopener noreferrer",children:[g.cta.label,i.jsx("span",{"aria-hidden":!0,children:""})]})})]})]},g.id)})})]})}function z1({current:e,onGoDesktop:t,onGoMobile:n}){const r="px-3 py-1.5 text-xs font-semibold rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500",s="bg-slate-900 text-white",o="bg-white text-slate-700 border border-slate-200 hover:bg-slate-50";return i.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white/80 p-1 shadow-sm",children:[i.jsx("button",{type:"button","aria-pressed":e==="desktop",className:`${r} ${e==="desktop"?s:o}`,onClick:t,children:"Desktop"}),i.jsx("button",{type:"button","aria-pressed":e==="mobile",className:`${r} ${e==="mobile"?s:o}`,onClick:n,children:"Mobile"})]})}function $1(){var n;if(typeof navigator>"u")return!1;const e=(n=navigator.userAgentData)==null?void 0:n.mobile;if(typeof e=="boolean")return e;const t=navigator.userAgent||"";return/iPhone|Android.+Mobile|Windows Phone|iPod/i.test(t)}function B1(e,t,n){const r=Dc().currentId,s=r!=null?String(r):null,o=new Date().toISOString();return{schemaVersion:1,version:1,exportedAt:o,updatedAt:o,lastWriter:"unknown",layouts:gw(),periodsState:Dc(),lastEditedPeriodId:s,lastEditedDate:null,students:n||jw(),tags:Sw(),behaviorState:j1(),constraintsState:c1(),historyState:m1(),groupingsState:y1(),printSettings:k1()}}const ir=e=>!!e&&typeof e=="object",W1=e=>e===!0||e==="true"||e===1||e==="1",Gr=e=>{const t=typeof e=="number"?e:parseInt(String(e),10);return Number.isFinite(t)&&Number.isInteger(t)?t:null};function H1(e){if(!ir(e))return;const t=e.singleSeat;if(!ir(t))return;const n=t.template;if(n!=="grid"&&n!=="arc")return;const r=Gr(t.row)??void 0,s=Gr(t.col)??void 0,o=Gr(t.arcIndex)??void 0,l=Gr(t.seatIndex)??void 0,u=t.angle,c=Number.isFinite(u)?Number(u):void 0;return{singleSeat:{template:n,row:r,col:s,arcIndex:o,seatIndex:l,angle:c}}}function V1(e,t){if(!Array.isArray(e))return[];const n=[];for(const r of e){const s=Gr(r);s!=null&&(s<0||s>=t||n.push(s))}return Array.from(new Set(n)).sort((r,s)=>r-s)}function K1(e){var u;if(!e||typeof e!="object"||(e.schemaVersion??(e.version===1?1:void 0))!==1)return null;const n=typeof e.exportedAt=="string"?e.exportedAt:new Date().toISOString(),r=typeof e.updatedAt=="string"?e.updatedAt:n,s=e.lastWriter==="desktop"||e.lastWriter==="mobile"||e.lastWriter==="unknown"?e.lastWriter:"unknown",o={...e,schemaVersion:1,version:e.version??1,exportedAt:n,updatedAt:r,lastWriter:s};if(o.behaviorState=ir(e.behaviorState)?e.behaviorState:{},!ir(o.periodsState)||!Array.isArray((u=o.periodsState)==null?void 0:u.periods)||!Array.isArray(o.students)||!Array.isArray(o.layouts)||!ir(o.behaviorState)||!ir(o.constraintsState)||!ir(o.historyState)||!ir(o.groupingsState))return null;switch((e.schemaVersion!==o.schemaVersion||e.updatedAt!==o.updatedAt||e.exportedAt!==o.exportedAt||e.lastWriter!==o.lastWriter)&&console.log("[Payload] migrated to schema v1",{hadSchemaVersion:e.schemaVersion,hadVersion:e.version,addedUpdatedAt:e.updatedAt!==o.updatedAt,addedLastWriter:e.lastWriter!==o.lastWriter}),o.schemaVersion){case 1:return o.students=(o.students||[]).map(c=>({...c,needsPreferredSeating:W1(c.needsPreferredSeating),quickNote:(typeof c.quickNote=="string",c.quickNote),quickNoteUpdatedAt:(typeof c.quickNoteUpdatedAt=="string",c.quickNoteUpdatedAt),photoFileId:typeof c.photoFileId=="string"?c.photoFileId:c.photoFileId==null?null:String(c.photoFileId),photoUpdatedAt:Gr(c.photoUpdatedAt),audioFileId:typeof c.audioFileId=="string"?c.audioFileId:c.audioFileId==null?null:String(c.audioFileId),audioUpdatedAt:Gr(c.audioUpdatedAt)})),o.layouts=(o.layouts||[]).map(c=>({...c,tables:(c.tables||[]).map(f=>{const g=Math.max(0,f.capacity||0),w=H1(f.meta);return{...f,meta:w,preferredSeatIndexes:V1(f.preferredSeatIndexes,g),seatLayout:e0(g||1,f.rotation||0,f.seatLayout||null)}})})),o;default:return null}}function G1(e){return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.hasFile?e.dirty?{action:"upload",reason:"ready"}:{action:"skip",reason:"clean"}:{action:"skip",reason:"no-file"}}function Y1(e){const t=e.graceMs;return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.dirty?{action:"skip",reason:"dirty"}:e.lastLocalEditAt&&e.now-e.lastLocalEditAt<t?{action:"skip",reason:"grace-window"}:{action:"pull",reason:"ready"}}function Q1(e){if(e.incomingRevisionId&&e.lastRevisionId)return e.incomingRevisionId===e.lastRevisionId?{action:"skip",reason:"same-revision"}:{action:"apply",reason:"fresh-revision"};const t=e.incomingUpdatedAt?Date.parse(e.incomingUpdatedAt):NaN,n=e.lastAppliedUpdatedAt?Date.parse(e.lastAppliedUpdatedAt):NaN;return Number.isFinite(t)&&Number.isFinite(n)&&t<=n?{action:"skip",reason:"stale-updatedAt"}:{action:"apply",reason:"fresh"}}const J1=new Set(["students","periodsState","layouts","tags","constraintsState","historyState","groupingsState","behaviorNotes","attendance","notes","alerts","payload"]),Mc=(e,t,n)=>{if(J1.has(t))return"[omitted]";if(typeof e=="string")return e.length>200?`[string ${e.length}]`:e;if(Array.isArray(e)){const r=e.slice(0,5).map(s=>Mc(s,"",n+1));return e.length>5&&r.push(`[+${e.length-5} more]`),n>1?`[array len=${e.length}]`:r}if(e&&typeof e=="object"){if(n>1)return"[object]";const r=Object.entries(e).slice(0,10).map(([s,o])=>[s,Mc(o,s,n+1)]);return r.length===0?e:Object.fromEntries(r)}return e};function _o(e,t){if(!(typeof console>"u"))try{const n=t?Mc(t,"",0):void 0;n!==void 0?console.log(e,n):console.log(e)}catch{console.log(e)}}const ym="classseats_first_seen_at_v1",P0="classseats_announcements_dismissed_v1",q1="classseats_announcements_last_read_published_at_v1",I0="classseats_announcements_cache_v1",Gd="classseats_announcements_cache_at_v1",Oc="appPrefs",la="announcements_state_v1.json";function gl(){return new Date().toISOString()}function zo(e){const t=Date.parse(e);return Number.isFinite(t)?t:0}function an(e){return typeof e=="string"?e.trim():""}function Yd(e){const t=an(e);return t&&Number.isFinite(Date.parse(t))?t:null}function X1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function Z1(e){return!!e&&typeof e=="object"&&e.schema===1&&Array.isArray(e.messages)}function eb(e){if(!e||typeof e!="object")return null;const t=e,n=an(t.id),r=t.audience==="onboarding"?"onboarding":t.audience==="all"?"all":null,s=t.priority==="high"?"high":t.priority==="normal"?"normal":null,o=an(t.publishedAt),l=an(t.title),u=an(t.body);if(!n||!r||!s||!o||!l||!u)return null;let c;const f=t.cta;if(f&&typeof f=="object"){const g=f,w=an(g.label),S=an(g.href);w&&S&&X1(S)&&(c={label:w,href:S})}return{id:n,audience:r,publishedAt:o,title:l,body:u,priority:s,...c?{cta:c}:{}}}function tb(e){if(!e||typeof e!="object")return null;const t=e;if(t.schema!==1&&t.schema!==2)return null;const n=an(t.updatedAt),r=Array.isArray(t.dismissed)?t.dismissed:[],s=Array.from(new Set(r.map(l=>an(l)).filter(Boolean))),o=Yd(t.lastReadPublishedAt);return{schema:2,updatedAt:n||gl(),dismissed:s,lastReadPublishedAt:o}}function D0(e){if(!Z1(e))return null;const t=new Set,n=[];for(const r of e.messages){const s=eb(r);s&&(t.has(s.id)||(t.add(s.id),n.push(s)))}return{schema:1,messages:n}}function nb(){try{const e=localStorage.getItem(ym);if(e)return e;const t=gl();return localStorage.setItem(ym,t),t}catch{return gl()}}function qo(){try{const e=localStorage.getItem(P0);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.map(n=>String(n))):new Set}catch{return new Set}}function Fc(e){try{localStorage.setItem(P0,JSON.stringify(Array.from(e)))}catch{}}function rb(){try{const e=localStorage.getItem(q1);return Yd(e)}catch{return null}}function sb(e){const t=qo();t.add(String(e)),Fc(t)}function xm(e,t){return{schema:2,updatedAt:gl(),dismissed:Array.from(new Set(Array.from(e).map(n=>an(n)).filter(Boolean))),lastReadPublishedAt:Yd(t)}}function vm(e){try{const t=JSON.parse(e);return tb(t)}catch{return null}}function wm(e,t){const n=new Set(Array.from(e).map(String));for(const r of t){const s=an(r);s&&n.add(s)}return n}function ob(e,t){const n=zo(t),r=e.messages.filter(s=>s.audience==="onboarding"?!0:zo(s.publishedAt)>n);return r.sort((s,o)=>{const l=s.priority==="high"?1:0,u=o.priority==="high"?1:0;return l!==u?u-l:zo(o.publishedAt)-zo(s.publishedAt)}),r}function L0(){try{const e=localStorage.getItem(I0),t=localStorage.getItem(Gd);if(!e)return{wrapper:null,cacheAt:t||null};const n=JSON.parse(e);return{wrapper:D0(n),cacheAt:t||null}}catch{return{wrapper:null,cacheAt:null}}}function lb(e){try{localStorage.setItem(I0,JSON.stringify(e)),localStorage.setItem(Gd,gl())}catch{}}function ib(e,t){return e?Date.now()-zo(e)>t*60*60*1e3:!0}async function ab(e,t){const n=new AbortController,r=window.setTimeout(()=>n.abort(),t);try{const s=await fetch(e,{cache:"no-store",signal:n.signal});return s.ok?await s.json():null}catch{return null}finally{window.clearTimeout(r)}}function Ti(e,t){const n=nb(),r=qo(),s=rb(),o=e?ob(e,n):[],l=o.filter(u=>!r.has(u.id));return{fetchedAt:t,messages:l,allMessages:o,dismissedIds:new Set(r),lastReadPublishedAt:s,unreadCount:l.length}}function di(){const{wrapper:e,cacheAt:t}=L0();return Ti(e,t)}async function Sm(e=12,t=!1){const{wrapper:n,cacheAt:r}=L0();if(!t&&!ib(r,e))return Ti(n,r);const s=await ab("/announcements.json",3e3),o=D0(s);if(!o)return Ti(n,r);lb(o);const l=(()=>{try{return localStorage.getItem(Gd)}catch{return r}})();return Ti(o,l)}const bm="https://app.classseats.app";function ub({open:e,onBypass:t}){const[n,r]=d.useState(!1);if(d.useEffect(()=>{if(!e)return;const o=document.documentElement.style.overflow,l=document.body.style.overflow;return document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",()=>{document.documentElement.style.overflow=o,document.body.style.overflow=l}},[e]),!e)return null;const s=async()=>{try{await navigator.clipboard.writeText(bm),r(!0),window.setTimeout(()=>r(!1),1200)}catch{r(!1)}};return i.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Mobile setup required",style:{position:"fixed",inset:0,zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:16,background:"rgba(0,0,0,0.55)"},children:i.jsxs("div",{style:{width:"min(520px, 100%)",borderRadius:16,background:"white",color:"#0f172a",padding:18,boxShadow:"0 12px 40px rgba(0,0,0,0.25)"},children:[i.jsx("div",{style:{fontSize:22,fontWeight:700,marginBottom:10},children:"Hi! "}),i.jsxs("div",{style:{fontSize:15,lineHeight:1.45,marginBottom:14},children:[i.jsx("div",{style:{marginBottom:10},children:"Thanks for your interest in ClassSeats. It looks like youre on a mobile device."}),i.jsxs("div",{style:{marginBottom:10},children:["ClassSeats setup must be done on a desktop or laptop.",i.jsx("br",{}),"Mobile becomes available after youve set up your first class."]}),i.jsx("div",{children:"See you on desktop! "})]}),i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsx("button",{onClick:s,style:{borderRadius:12,padding:"10px 14px",border:"1px solid rgba(0,0,0,0.12)",fontWeight:600,cursor:"pointer",background:"white"},children:"Copy desktop link"}),n&&i.jsx("span",{style:{fontSize:13,fontWeight:600},children:"Copied!"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:t,style:{border:"none",background:"transparent",padding:0,fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"Ive already set up my class"})}),i.jsx("div",{style:{marginTop:10,fontSize:12,opacity:.75,userSelect:"text"},children:bm})]})})}const Nm=e=>e?{...e}:{},km=(e,t)=>{if(t.size===0)return e;const n={...e};return t.forEach(r=>{delete n[r]}),n},cb=e=>{if(!e||typeof e!="object"||typeof e.note!="string")return null;const t=typeof e.timestamp=="string"?e.timestamp:"";return{note:e.note,timestamp:t}},db=e=>{const t=e!=null&&e.note&&typeof e.note=="object"?e.note:e,n={};return Object.entries(t||{}).forEach(([r,s])=>{const o=cb(s);o&&(n[String(r)]=o)}),n};function jm(e,t,n){const r={};return Object.entries(e||{}).forEach(([o,l])=>{const u=km(Nm(l),n);Object.keys(u).length>0&&(r[o]=u)}),t&&Object.entries(t).forEach(([o,l])=>{const u=km(Nm(l),n);Object.keys(u).length===0?delete r[o]:r[o]=u}),r}function Cm(e,t,n,r){const s={};return Object.entries(e||{}).forEach(([l,u])=>{const c={};Object.entries(db(u)).forEach(([f,g])=>{n.has(f)||(c[f]=g)}),Object.keys(c).length>0&&(s[l]=c)}),t&&Object.entries(t).forEach(([l,u])=>{const c=s[l]||{},f={};Object.entries(u||{}).forEach(([g,w])=>{if(n.has(g))return;const S=c[g];S&&S.note===w?f[g]=S:f[g]={note:w,timestamp:r}}),Object.keys(f).length===0?delete s[l]:s[l]=f}),s}function fb({children:e}){return i.jsx(i.Fragment,{children:e})}const To=10,pb=250,mb=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a.40.2","audio/mp4"];function hb(){if(typeof MediaRecorder>"u")return"";for(const e of mb)if(MediaRecorder.isTypeSupported(e))return e;return""}function gb(e){const t=e.toLowerCase();return t.includes("webm")?".webm":t.includes("mp4")?".m4a":".webm"}function M0({open:e,studentId:t,studentFullName:n,existingAudioFileId:r,existingAudioUpdatedAt:s,driveSession:o,onClose:l,onUploadComplete:u,onDeleteComplete:c}){const f=Vd(),[g,w]=d.useState("idle"),[S,R]=d.useState(To),[k,j]=d.useState(!1),[Q,h]=d.useState(!1),[m,b]=d.useState(null),[_,T]=d.useState(0),[$,B]=d.useState(!1),z=d.useRef(null),re=d.useRef(null),Z=d.useRef([]),me=d.useRef(null),ze=d.useRef(null),it=d.useRef(null),Ze=d.useRef(null),$e=d.useRef(null),{audioUrl:et}=Hd({studentId:t,audioFileId:r||null,audioUpdatedAt:s??null,driveSession:o}),tt=!!r&&!k&&!Q&&g!=="recording",U=()=>{b(fe=>(fe!=null&&fe.url&&URL.revokeObjectURL(fe.url),null))},q=()=>{me.current&&(window.clearInterval(me.current),me.current=null)},X=()=>{$e.current&&(cancelAnimationFrame($e.current),$e.current=null),it.current=null,Ze.current=null,ze.current&&(ze.current.close().catch(()=>{}),ze.current=null),B(!1),T(0)},se=()=>{re.current&&(re.current.getTracks().forEach(fe=>fe.stop()),re.current=null)},D=()=>{const fe=z.current;fe&&fe.state!=="inactive"&&fe.stop()},Be=()=>{D(),X(),se(),z.current=null,Z.current=[],q()};d.useEffect(()=>(e||(Be(),U(),w("idle"),R(To)),()=>{e&&Be()}),[e]);const I=async()=>{if(g!=="recording"){if(typeof MediaRecorder>"u"){f({message:"Audio recording is not supported on this device.",tone:"error"});return}try{const fe=await navigator.mediaDevices.getUserMedia({audio:!0}),St=hb(),We=new MediaRecorder(fe,St?{mimeType:St}:void 0);re.current=fe,z.current=We,Z.current=[];try{const He=window.AudioContext||window.webkitAudioContext;if(He){const Mt=new He,fn=Mt.createMediaStreamSource(fe),H=Mt.createAnalyser();H.fftSize=512,fn.connect(H);const ae=new Uint8Array(new ArrayBuffer(H.frequencyBinCount));ze.current=Mt,it.current=H,Ze.current=ae,B(!0);const pe=()=>{const gt=it.current,pn=Ze.current;if(!gt||!pn)return;gt.getByteTimeDomainData(pn);let _n=0;for(let O=0;O<pn.length;O+=1){const Y=(pn[O]-128)/128;_n+=Y*Y}const mn=Math.sqrt(_n/pn.length),N=Math.min(1,Math.sqrt(mn)*2.2);T(N),$e.current=requestAnimationFrame(pe)};$e.current=requestAnimationFrame(pe)}}catch{B(!1)}We.ondataavailable=He=>{He.data&&He.data.size>0&&Z.current.push(He.data)},We.onstop=()=>{q(),X(),se();const He=We.mimeType||St,Mt=new Blob(Z.current,{type:He});if(Z.current=[],!Mt.size){w("idle"),R(To),f({message:"We could not save that recording. Please try again.",tone:"error"});return}const fn=URL.createObjectURL(Mt);b({blob:Mt,url:fn,mimeType:He}),w("draft"),R(To)},w("recording"),R(To),We.start(pb),me.current=window.setInterval(()=>{R(He=>He<=1?(D(),0):He-1)},1e3)}catch{Be(),w("idle"),f({message:"We could not access your microphone. Please allow access and try again.",tone:"error"})}}},_e=()=>{D()},Oe=async()=>{if(!(!m||k)){j(!0);try{const fe=m.mimeType||m.blob.type||"audio/webm",St=gb(fe),We=await fS({studentId:t,studentFullName:n,blob:m.blob,mimeType:fe,extension:St,fileId:r||null}),He=Date.now();u({fileId:We.fileId,audioUpdatedAt:He}),U(),l()}catch(fe){const We=(fe instanceof Error?fe.message:"").toLowerCase();We.includes("sign in")&&We.includes("drive")?f({message:"Please reconnect Google Drive to upload audio.",tone:"error"}):f({message:"Couldn't upload the audio. Please try again.",tone:"error"})}finally{j(!1)}}},Te=async()=>{if(!(!r||Q||!window.confirm("Delete this audio clip?"))){h(!0);try{await pS(r)}catch{f({message:"Audio was removed from the student, but we couldn't delete it from Drive.",tone:"warning"})}finally{h(!1),c(),l()}}},Kt=!!r,ht=!m&&Kt,Yn=g==="idle"&&!m;return e?i.jsx(ta,{isOpen:e,onRequestClose:l,title:"Record Audio",subtitle:"Name & Audio Intro (=10s)",maxWidth:"md",showCloseX:!0,footer:g==="draft"?i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:()=>{U(),w("idle")},disabled:k,children:"Re-record"}),i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:k,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:Oe,disabled:k,children:k?"Uploading":"Accept"})]}):i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[i.jsx("div",{children:tt&&i.jsx("button",{className:"rounded border border-rose-200 px-3 py-2 text-sm text-rose-700 hover:bg-rose-50",onClick:Te,children:"Delete audio"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:k||Q,children:"Close"}),Yn&&i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:I,disabled:k||Q,children:Kt?"Record new":"Record"})]})]}),children:i.jsxs("div",{className:"space-y-4",children:[g==="recording"&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm font-semibold text-slate-700",children:[i.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-rose-600 animate-pulse"}),"Recording"]}),$&&i.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-200",children:i.jsx("div",{className:"h-full rounded-full bg-rose-500 transition-[width]",style:{width:`${Math.min(100,Math.max(8,Math.round(_*100)))}%`}})}),i.jsxs("div",{className:"mt-2 text-3xl font-bold text-slate-900",children:[S,"s"]}),i.jsx("button",{className:"mt-3 rounded bg-rose-600 px-4 py-2 text-sm font-semibold text-white",onClick:_e,children:"Stop"})]}),g==="draft"&&m&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Preview"}),i.jsx("audio",{controls:!0,src:m.url,className:"w-full"})]}),ht&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Current audio"}),et?i.jsx("audio",{controls:!0,src:et,className:"w-full"}):i.jsx("div",{className:"text-sm text-slate-500",children:"Loading audio"})]}),Yn&&!Kt&&i.jsx("div",{className:"text-sm text-slate-500",children:"Tap record to capture a short name pronunciation."})]})}):null}function yb(e){const t=e.slice();for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function Yt(e){return String(e)}function Em(e){try{const t=localStorage.getItem(e);if(!t)return new Set;const n=JSON.parse(t);return Array.isArray(n)?new Set(n.map(String)):new Set}catch{return new Set}}function Pu(e,t){try{localStorage.setItem(e,JSON.stringify(Array.from(t)))}catch{}}function Rm({open:e,title:t,body:n,confirmText:r,cancelText:s,onConfirm:o,onCancel:l,danger:u}){return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center p-4 sm:items-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:l}),i.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[i.jsxs("div",{className:"space-y-2 p-5",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:t}),i.jsx("div",{className:"text-sm text-slate-600",children:n})]}),i.jsxs("div",{className:"flex gap-2 p-4 pt-0",children:[i.jsx("button",{className:"flex-1 rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:l,children:s}),i.jsx("button",{className:`flex-1 rounded-xl px-4 py-2.5 text-sm font-semibold text-white ${u?"bg-rose-600 hover:bg-rose-700":"bg-violet-600 hover:bg-violet-700"}`,onClick:o,children:r})]})]})]}):null}function xb({students:e,periodId:t,driveFileId:n,driveClient:r,driveSession:s,onAudioSaved:o,onAudioDeleted:l}){const u=n??"local",c=`cs_mobile_flashcards_learned_v1:${u}:${t}`,[f,g]=d.useState(!1),[w,S]=d.useState(()=>Em(c)),R=d.useRef(w);d.useEffect(()=>{R.current=w},[w]),d.useEffect(()=>{const H=Em(c);R.current=H,S(H),g(!1)},[c]);const k=e.length,[j,Q]=d.useState([]),[h,m]=d.useState(0),[b,_]=d.useState(!1),[T,$]=d.useState(null),[B,z]=d.useState(null),[re,Z]=d.useState(!1),me=d.useMemo(()=>{if(f)return e;const H=w;return e.filter(ae=>!H.has(Yt(ae.id))||Yt(ae.id)===T)},[e,f,w,T]),ze=d.useMemo(()=>e.map(H=>Yt(H.id)).join("|"),[e]),it=d.useMemo(()=>me.map(H=>Yt(H.id)).join("|"),[me]),Ze=d.useMemo(()=>{const H=new Set(e.map(pe=>Yt(pe.id)));let ae=0;return w.forEach(pe=>{H.has(pe)&&ae++}),ae},[e,w]),$e=Math.max(0,k-Ze),[et,tt]=d.useState(!1),[U,q]=d.useState(!1);d.useEffect(()=>{const H=R.current,ae=(f?e:e.filter(pe=>!H.has(Yt(pe.id)))).map(pe=>Yt(pe.id));Q(ae),m(0),_(!1),$(null),z(null)},[f,t,u,ze]),d.useEffect(()=>{const H=new Set(me.map(ae=>Yt(ae.id)));Q(ae=>{const pe=ae.filter(gt=>H.has(gt));return pe.length===ae.length?ae:(m(gt=>Math.min(gt,Math.max(0,pe.length-1))),pe)})},[it]);const X=d.useMemo(()=>new Map(me.map(H=>[Yt(H.id),H])),[me]),se=j[h]??null,D=se?X.get(se)??null:null,{photoUrl:Be}=E0({studentId:(D==null?void 0:D.id)??"unknown",fullName:(D==null?void 0:D.fullName)??null,photoFileId:(D==null?void 0:D.photoFileId)??null,photoUpdatedAt:(D==null?void 0:D.photoUpdatedAt)??null,driveClient:r,driveSession:s}),{audioUrl:I}=Hd({studentId:(D==null?void 0:D.id)??"unknown",audioFileId:(D==null?void 0:D.audioFileId)??null,audioUpdatedAt:(D==null?void 0:D.audioUpdatedAt)??null,driveSession:s}),_e=d.useRef(null),[Oe,Te]=d.useState(!1);d.useEffect(()=>{Te(!1)},[I]);const Kt=H=>!se||T!==se||f?!1:(Q(ae=>{const pe=ae.filter(gt=>gt!==se);return m(gt=>pe.length===0?0:H==="prev"?Math.max(0,gt-1):Math.min(gt,pe.length-1)),pe}),$(null),!0),ht=()=>{_(!1),z(null),!Kt("next")&&m(H=>j.length===0?0:Math.min(H+1,j.length-1))},Yn=()=>{_(!1),z(null),!Kt("prev")&&m(H=>Math.max(0,H-1))},fe=async()=>{if(!I)return;const H=_e.current;if(H){if(Oe){H.pause(),Te(!1);return}try{await H.play(),Te(!0)}catch{}}},St=()=>{if(!D)return;const H=Yt(D.id);z(null),S(ae=>{const pe=new Set(ae);return pe.add(H),Pu(c,pe),pe}),$(H)},We=()=>{if(!D)return;const H=Yt(D.id);$(null),z(ae=>ae===H?null:H),S(ae=>{if(!ae.has(H))return ae;const pe=new Set(ae);return pe.delete(H),Pu(c,pe),pe})},He=()=>{tt(!1),_(!1),$(null),z(null),Q(H=>yb(H)),m(0)},Mt=()=>{q(!1),_(!1),$(null),z(null);const H=new Set;S(H),Pu(c,H);const ae=e.map(pe=>Yt(pe.id));Q(ae),m(0)},fn=!f&&$e===0&&k>0;return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsxs("div",{className:"space-y-0.5",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Flashcards"}),i.jsxs("div",{className:"text-xs text-slate-600",children:["Learned ",Ze," / ",k,"  Remaining ",$e]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:j.length<2,onClick:()=>tt(!0),children:"Shuffle"}),i.jsx("button",{className:`rounded-xl border px-3 py-2 text-xs font-semibold ${f?"border-violet-200 bg-violet-50 text-violet-900":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"}`,onClick:()=>{g(H=>!H),_(!1),$(null),z(null)},children:f?"Including learned":"Include learned"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>q(!0),children:"Clear learned"})]})]}),fn?i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"All learned!"}),i.jsx("div",{className:"text-sm text-slate-600",children:"Youve marked everyone in this period as learned."}),i.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[i.jsx("button",{className:"rounded-xl bg-violet-600 px-4 py-3 text-sm font-semibold text-white hover:bg-violet-700",onClick:()=>g(!0),children:"Review learned students"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>q(!0),children:"Clear learned for this period"})]})]}):i.jsx("div",{className:"space-y-3",children:D?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"relative w-full",style:{perspective:1200},children:i.jsx("button",{type:"button",onClick:()=>_(H=>!H),className:"w-full text-left","aria-label":"Flip flashcard",children:i.jsxs("div",{className:"relative h-[380px] w-full",style:{transformStyle:"preserve-3d",transition:"transform 420ms cubic-bezier(0.2, 0.8, 0.2, 1)",transform:b?"rotateY(180deg)":"rotateY(0deg)"},children:[i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden"},children:i.jsxs("div",{className:"h-full w-full bg-slate-50 flex items-center justify-center",children:[Be?i.jsx("img",{src:Be,alt:"",className:"h-full w-full object-cover"}):i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-200 text-2xl font-bold text-slate-700",children:D.fullName.split(" ").slice(0,2).map(H=>{var ae;return((ae=H[0])==null?void 0:ae.toUpperCase())??""}).join("")}),i.jsx("div",{className:"mt-3 text-sm text-slate-500",children:"No photo"})]}),i.jsx("div",{className:"absolute bottom-3 left-0 right-0 text-center text-xs font-semibold text-slate-500",children:"Tap to flip"})]})}),i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:i.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold leading-tight text-slate-900",children:D.fullName}),i.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"Tap again to see photo"}),i.jsxs("div",{className:"mt-4 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${I?"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50":"border border-slate-200 bg-white text-slate-400 cursor-not-allowed"}`,onClick:H=>{H.preventDefault(),H.stopPropagation(),fe()},disabled:!I,children:Oe?"Pause audio":"Play audio"}),i.jsx("button",{className:"w-full rounded-2xl px-4 py-3 text-sm font-semibold transition border border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100",onClick:H=>{H.preventDefault(),H.stopPropagation(),Z(!0)},children:D.audioFileId?"Re-record audio":"Record audio"})]}),i.jsx("audio",{ref:_e,src:I||void 0,onEnded:()=>Te(!1),onPause:()=>Te(!1)}),i.jsxs("div",{className:"mt-6 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${T===se?"bg-emerald-600 text-white hover:bg-emerald-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:H=>{H.preventDefault(),H.stopPropagation(),St()},children:" Ive learned this"}),i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${B===se?"bg-violet-600 text-white hover:bg-violet-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:H=>{H.preventDefault(),H.stopPropagation(),We()},children:" Still learning"})]})]})})]})})}),i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:h===0,onClick:Yn,children:"Prev"}),i.jsx("div",{className:"px-2 text-xs font-semibold text-slate-500",children:j.length===0?"0 / 0":`${h+1} / ${j.length}`}),i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:j.length===0||h>=j.length-1,onClick:ht,children:"Next"})]}),re&&D&&i.jsx(M0,{open:!0,studentId:D.id,studentFullName:D.fullName,existingAudioFileId:D.audioFileId??null,existingAudioUpdatedAt:D.audioUpdatedAt??null,driveSession:s,onClose:()=>Z(!1),onUploadComplete:({fileId:H,audioUpdatedAt:ae})=>{o(D.id,H,ae),Z(!1)},onDeleteComplete:()=>{l(D.id),Z(!1)}})]}):i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"No students found."}),i.jsx("div",{className:"text-sm text-slate-600",children:"This period doesnt have any students yet."})]})}),i.jsx(Rm,{open:et,title:"Shuffle deck?",body:"This will randomize the order of the current deck once.",confirmText:"Shuffle",cancelText:"Cancel",onConfirm:He,onCancel:()=>tt(!1)}),i.jsx(Rm,{open:U,title:"Clear learned students?",body:"This resets learned progress for this period on this device.",confirmText:"Clear",cancelText:"Cancel",danger:!0,onConfirm:Mt,onCancel:()=>q(!1)})]})}const vb=.85,wb=900,Sb=1200,bb=4,Nb=60,kb=160;function jb({studentId:e,studentFullName:t,existingPhotoFileId:n,open:r,onClose:s,onAccept:o,onUploadComplete:l,title:u="Take Photo"}){const c=Vd(),f=d.useRef(null),g=d.useRef(null),w=d.useRef(null),S=d.useRef(null),R=d.useRef(null),k=d.useRef(!1),j=d.useRef(new Map),Q=d.useRef(null),h=d.useRef(null),m=d.useRef(1),b=d.useRef(null),_=d.useRef(null),[T,$]=d.useState(null),[B,z]=d.useState(!1),[re,Z]=d.useState(!1),[me,ze]=d.useState(!1),[it,Ze]=d.useState(1),[$e,et]=d.useState(!1),[tt,U]=d.useState(!1),q=d.useRef(null),X=d.useMemo(()=>{if(typeof navigator>"u")return{isIOS:!1,isAndroid:!1};const N=navigator.userAgent||"",O=/iPad|iPhone|iPod/i.test(N)||N.includes("Mac")&&typeof document<"u"&&"ontouchend"in document,Y=/Android/i.test(N);return{isIOS:O,isAndroid:Y}},[]),se=()=>{j.current.clear(),Q.current=null,b.current&&(cancelAnimationFrame(b.current),b.current=null),_.current=null},D=()=>{S.current=null,h.current=null,m.current=1,Ze(1),ze(!1),se()},Be=()=>(q.current||(q.current=document.createElement("canvas")),q.current),I=N=>{const O=Be(),Y=O.getContext("2d");if(!Y)return 0;const J=kb,ue=Math.max(N.width,N.height)/J,ce=Math.max(1,Math.round(N.width/(ue||1))),ge=Math.max(1,Math.round(N.height/(ue||1)));O.width=ce,O.height=ge,Y.drawImage(N,0,0,ce,ge);const ye=Y.getImageData(0,0,ce,ge).data;let Ce=0;for(let Fe=0;Fe<ge;Fe++){const hn=Fe*ce*4;for(let at=0;at<ce;at++){const bt=hn+at*4,gn=(ye[bt]+ye[bt+1]+ye[bt+2])/3;if(at<ce-1){const Ve=bt+4,ro=(ye[Ve]+ye[Ve+1]+ye[Ve+2])/3;Ce+=Math.abs(gn-ro)}if(Fe<ge-1){const Ve=bt+ce*4,ro=(ye[Ve]+ye[Ve+1]+ye[Ve+2])/3;Ce+=Math.abs(gn-ro)}}}return Ce},_e=N=>{const{width:O,height:Y}=N;if(!O||!Y)return N;const J=wb/O,ue=Sb/Y,ce=Math.min(1,J,ue);if(ce>=.999)return N;const ge=Math.max(1,Math.round(O*ce)),ye=Math.max(1,Math.round(Y*ce)),Ce=document.createElement("canvas");Ce.width=ge,Ce.height=ye;const Fe=Ce.getContext("2d");return Fe?(Fe.drawImage(N,0,0,ge,ye),Ce):N},Oe=async N=>new Promise(O=>{N.toBlob(Y=>{if(Y){O(Y);return}N.toBlob(J=>O(J),"image/png")},"image/jpeg",vb)}),Te=async N=>{const O=_e(N);return Oe(O)},Kt=async N=>{try{const O=await createImageBitmap(N),Y=document.createElement("canvas");Y.width=O.width,Y.height=O.height;const J=Y.getContext("2d");if(!J)return null;if(J.drawImage(O,0,0),"close"in O)try{O.close()}catch{}return Y}catch{return new Promise(O=>{const Y=URL.createObjectURL(N),J=new Image;J.onload=()=>{const ue=document.createElement("canvas");ue.width=J.naturalWidth||J.width,ue.height=J.naturalHeight||J.height;const ce=ue.getContext("2d");if(URL.revokeObjectURL(Y),!ce){O(null);return}ce.drawImage(J,0,0),O(ue)},J.onerror=()=>{URL.revokeObjectURL(Y),O(null)},J.src=Y})}},ht=async(N,O)=>{const Y=f.current,J=g.current;if(!Y||!J)return null;const ue=Y.videoWidth,ce=Y.videoHeight;if(!ue||!ce)return null;J.width=ue,J.height=ce;const ge=J.getContext("2d");if(!ge)return null;let ye=-1/0,Ce=null;for(let Fe=0;Fe<N;Fe++){if(!k.current)return null;Fe===0?await new Promise(at=>requestAnimationFrame(()=>at())):O>0&&await new Promise(at=>setTimeout(at,O)),ge.drawImage(Y,0,0,ue,ce);const hn=I(J);if(hn>=ye){ye=hn,Ce||(Ce=document.createElement("canvas")),Ce.width=ue,Ce.height=ce;const at=Ce.getContext("2d");at&&at.drawImage(J,0,0,ue,ce)}}return Ce||J},Yn=async()=>{if(typeof window>"u")return null;const N=S.current,O=window.ImageCapture;if(!N||!O)return null;try{const Y=new O(N);return typeof Y.takePhoto!="function"?null:await Y.takePhoto()}catch{return null}},fe=()=>{w.current&&(w.current.getTracks().forEach(N=>N.stop()),w.current=null),f.current&&(f.current.srcObject=null),D()},St=()=>{T&&URL.revokeObjectURL(T),R.current=null,$(null)},We=()=>{fe(),St(),z(!1),et(!1),U(!1),s()},He=N=>{const O=h.current;if(!O)return N;let Y=Math.min(O.max,Math.max(O.min,N));if(typeof O.step=="number"&&O.step>0){const J=Math.round((Y-O.min)/O.step);Y=O.min+J*O.step,Y=Math.min(O.max,Math.max(O.min,Y))}return Y},Mt=N=>{const O=S.current;if(!O)return;const Y=He(N);_.current=Y,!b.current&&(b.current=requestAnimationFrame(()=>{b.current=null;const J=_.current;_.current=null,typeof J=="number"&&O.applyConstraints({advanced:[{zoom:J}]}).then(()=>{m.current=J,Ze(J)}).catch(()=>{})}))},fn=async N=>{var O,Y;Z(!0),z(!1),D();try{let J;try{J=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"},width:{ideal:1280},height:{ideal:960},frameRate:{ideal:30}},audio:!1})}catch{J=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}if(!N()){J.getTracks().forEach(ce=>ce.stop());return}w.current=J;const ue=J.getVideoTracks()[0]||null;if(S.current=ue,ue){const ce=(O=ue.getCapabilities)==null?void 0:O.call(ue),ge=ce==null?void 0:ce.zoom;if(ge&&typeof ge.min=="number"&&typeof ge.max=="number"){h.current={min:ge.min,max:ge.max,step:typeof ge.step=="number"?ge.step:void 0};const ye=(Y=ue.getSettings)==null?void 0:Y.call(ue),Ce=typeof(ye==null?void 0:ye.zoom)=="number"?ye.zoom:ge.min,Fe=He(Ce);m.current=Fe,Ze(Fe),ze(!0)}}if(f.current){f.current.srcObject=J;try{await f.current.play()}catch{}}}catch{N()&&z(!0),fe()}finally{N()&&Z(!1)}};d.useEffect(()=>{let N=!0;return k.current=r,r?fn(()=>N):(fe(),St(),z(!1),U(!1)),()=>{N=!1,k.current=!1,fe(),St(),z(!1),U(!1)}},[r]);const H=async()=>{if(!tt){U(!0);try{let N=null;if(X.isAndroid){const Y=await Yn();if(Y){const J=await Kt(Y);J&&(N=await Te(J))}}if(!N){const Y=X.isIOS?bb:1,J=X.isIOS?Nb:0,ue=await ht(Y,J);ue&&(N=await Te(ue))}if(!N)return;R.current=N;const O=URL.createObjectURL(N);$(O),fe()}finally{U(!1)}}},ae=async()=>{if($e)return;const N=R.current;if(N){o(N),et(!0);try{const O=n?null:await JS({studentId:e,fullName:t}),Y=await dS({studentId:e,studentFullName:t,jpegBlob:N,fileId:n||(O==null?void 0:O.fileId)}),J=Date.now();await qS({studentId:e,fullName:t,fileId:Y.fileId,updatedTime:Y.modifiedTime,photoUpdatedAt:J,blob:N}),l==null||l({fileId:Y.fileId,photoUpdatedAt:J}),We()}catch(O){et(!1);const J=(O instanceof Error?O.message:"").toLowerCase();J.includes("sign in")&&J.includes("drive")?c({message:"Please reconnect Google Drive to upload photos.",tone:"error"}):c({message:"Couldn't upload the photo. Your preview is still saved here - try again.",tone:"error"})}}},pe=()=>{St(),U(!1),fn(()=>k.current)},gt=N=>{if(!(!me||T)&&(N.preventDefault(),N.currentTarget.setPointerCapture(N.pointerId),j.current.set(N.pointerId,{x:N.clientX,y:N.clientY}),j.current.size===2)){const O=Array.from(j.current.values()),Y=Math.hypot(O[0].x-O[1].x,O[0].y-O[1].y);Q.current={initialDistance:Y,initialZoom:m.current}}},pn=N=>{if(!me||T||!j.current.has(N.pointerId)||(N.preventDefault(),j.current.set(N.pointerId,{x:N.clientX,y:N.clientY}),j.current.size<2||!Q.current))return;const O=Array.from(j.current.values()),Y=Math.hypot(O[0].x-O[1].x,O[0].y-O[1].y);if(Q.current.initialDistance<=0)return;const J=Y/Q.current.initialDistance,ue=Q.current.initialZoom*J;Mt(ue)},_n=N=>{me&&(j.current.delete(N.pointerId),j.current.size<2&&(Q.current=null))};if(!r)return null;const mn=me&&!T;return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:We}),i.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white p-4 shadow-2xl space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:u}),i.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-700",onClick:We,"aria-label":"Close",children:""})]}),B?i.jsxs("div",{className:"space-y-3",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Camera unavailable. Check permissions and try again."}),i.jsx("button",{type:"button",className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:We,children:"Close"})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"w-full aspect-[3/4] rounded-xl bg-slate-100 overflow-hidden flex items-center justify-center",onPointerDown:mn?gt:void 0,onPointerMove:mn?pn:void 0,onPointerUp:mn?_n:void 0,onPointerCancel:mn?_n:void 0,style:mn?{touchAction:"none"}:void 0,children:T?i.jsx("img",{src:T,alt:"",className:"w-full h-full object-cover"}):i.jsx("video",{ref:f,className:"w-full h-full object-cover",playsInline:!0,muted:!0})}),T?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm disabled:opacity-50",onClick:pe,disabled:$e,children:"Retake"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:ae,disabled:$e,children:$e?"Uploading...":"Accept"})]}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:H,disabled:re||tt,children:tt?"Capturing...":"Take Photo"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm",onClick:We,children:"Cancel"})]})]})]}),i.jsx("canvas",{ref:g,className:"hidden"})]})}const _m=!1,Tm="795",Cb="https://app.classseats.app",Ao="cs_mobile_last_drive_file",Eb="cs_mobile_local_draft_v2",Iu="cs_mobile_students_mode_v1",Du="cs_mobile_notes_sort_v1",Lu="cs_mobile_table_sort_v1",Mu="cs_mobile_seat_number_sort_v1",Rb=14*24*60*60*1e3,Am=2e5,Pm=14,_b=2e4,Im="classseats_mobile_setup_gate_bypass_v1",Tb="cs_drive_trash_ack_v1";function Po(e){return e?`${Eb}:${e}`:null}function O0(e){const t=String(e||"unknown").trim().toLowerCase()||"unknown";return`${Tb}:${t}`}function Ab(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(O0(e));if(!t)return null;const n=JSON.parse(t);return typeof n=="string"?n:typeof(n==null?void 0:n.signature)=="string"?n.signature:null}catch{return null}}function Pb(e,t){if(!(typeof window>"u")&&t)try{window.localStorage.setItem(O0(e),JSON.stringify({signature:t,ackedAt:Date.now()}))}catch{}}function fi(e){return e!=null&&e.id?[e.id,e.revisionId||"",e.modifiedTime||"",e.size||""].join("|"):null}function Ib(e){const t=String(e||"").trim().toLowerCase();return t===la.toLowerCase()||t===Oc.toLowerCase()}function Is(e){if(!(e!=null&&e.modifiedTime))return 0;const t=Date.parse(e.modifiedTime);return Number.isFinite(t)?t:0}function Dm(e){return e.filter(n=>!!(n!=null&&n.id)&&n.name===la).sort((n,r)=>Is(r)-Is(n))[0]||null}function Db(e,t){var n,r;return!e||!t?!1:(e.accessToken||"")===(t.accessToken||"")&&(e.refreshToken||"")===(t.refreshToken||"")&&(e.expiresAt||"")===(t.expiresAt||"")&&(((n=e.profile)==null?void 0:n.email)||"")===(((r=t.profile)==null?void 0:r.email)||"")}function F0(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function Lm(e,t){const n={};return Object.entries(e||{}).forEach(([r,s])=>{const o=Object.keys(s||{}).filter(u=>F0(u));o.sort((u,c)=>c.localeCompare(u)),o.slice(0,t).forEach(u=>{const c=(s==null?void 0:s[u])||{};Object.keys(c).length!==0&&(n[r]||(n[r]={}),n[r][u]={...c})})}),n}function pi(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s={};Object.entries(r||{}).forEach(([o,l])=>{s[o]={...l||{}}}),Object.keys(s).length>0&&(t[n]=s)}),t}function Lb({student:e,attendance:t,points:n,pointsEnabled:r,maxPoints:s,hasNote:o,absenceTotal:l,absenceStreak:u,tardyCount:c,leftEarlyCount:f,customCounter:g,onShowAbsenceHelp:w,onShowTardyHelp:S,onShowLeftEarlyHelp:R,onShowCustomHelp:k,seatNumber:j,showSeatNumber:Q=!1,statusBg:h,statusLabel:m,tempPhotoUrl:b,onOpenPhoto:_,onOpenMenu:T,driveClient:$,driveSession:B}){const z=_0(n,s),{photoUrl:re}=E0({studentId:e.id,fullName:e.fullName,photoFileId:e.photoFileId,photoUpdatedAt:e.photoUpdatedAt,driveClient:$,driveSession:B}),[Z,...me]=(e.fullName||"").split(" "),ze=me.join(" "),it=(()=>{switch(t){case"present":return"";case"absent":return"";case"tardy":return"";case"left_early":return"";default:return""}})(),Ze=m(t),$e=b||re,et=l??0,tt=u??0,U=c??0,q=f??0,X=g??0,se=et===0&&tt===0,D=U===0,Be=q===0,I=X===0;return i.jsx("div",{className:`w-full rounded-2xl border px-4 py-3 shadow-sm ${h(t)}`,children:i.jsxs("div",{className:"flex items-start gap-2",children:[Q&&i.jsx("div",{className:"flex h-[80px] w-8 shrink-0 items-center justify-center text-sm font-semibold text-slate-500",children:j||""}),i.jsx(_w,{studentId:e.id,hasPhoto:!!$e,src:$e,onClick:_,widthPx:60,heightPx:80}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"text-left min-w-0 flex-1",children:[i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:Z}),i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:ze||""})]}),i.jsx("button",{className:"text-xl text-slate-600 px-3 py-2 rounded-full hover:bg-slate-200 flex-shrink-0",onClick:_e=>{_e.stopPropagation(),T()},children:""})]}),i.jsxs("div",{className:"mt-1 flex items-center justify-between text-sm px-1",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:it}),i.jsx("span",{className:"text-slate-700",children:Ze})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${se?"text-slate-600 bg-slate-100 border-slate-300":"text-rose-700 bg-rose-100 border-rose-200"}`,onClick:w,children:["A",et,"/S",tt]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${D?"text-slate-600 bg-slate-100 border-slate-300":"text-amber-700 bg-amber-100 border-amber-200"}`,onClick:S,children:["T",U]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${Be?"text-slate-600 bg-slate-100 border-slate-300":"text-orange-700 bg-orange-100 border-orange-200"}`,onClick:R,children:["LE",q]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${I?"text-slate-600 bg-slate-100 border-slate-300":"text-slate-800 bg-slate-100 border-slate-400"}`,onClick:k,children:["",X]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[r&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-lg",children:z.emoji}),i.jsx("span",{className:"text-emerald-700 font-semibold",children:n})]}),o&&i.jsx("span",{className:"text-indigo-600 text-lg",children:""})]})]})]})]})})}function Mb(e,t,n){var w,S,R;if(!(e!=null&&e.activeGrouping)||!(e!=null&&e.tableAssignments))return null;let r=-1,s=-1;if(e.activeGrouping.forEach((k,j)=>{const Q=k==null?void 0:k.findIndex(h=>String(h)===String(n));Q!==-1&&(r=j,s=Q)}),r===-1||s===-1)return null;const o=e.tableAssignments[String(r)];if(!o)return null;const l=String(o),u=((w=e.tableNumbering)==null?void 0:w.perTableSeatNumbers)&&e.tableNumbering.perTableSeatNumbers[l],c=(R=(S=t==null?void 0:t.tables)==null?void 0:S.find(k=>String(k.id)===l))==null?void 0:R.seatNumbers,f=u||c;if(!f)return null;const g=f[s];return g!=null?String(g):null}function Ou(e,t){const n=e==null?void 0:e[t];if(!n||typeof n!="object")return{};const r=n.note&&typeof n.note=="object"?n.note:n,s={};return Object.entries(r||{}).forEach(([o,l])=>{l&&typeof l=="object"&&typeof l.note=="string"&&(s[String(o)]=l.note)}),s}function Ob(){var Bf,Wf,Hf,Vf,Kf,Gf;const e=Vd(),t=$1(),n=d.useMemo(()=>Rw(),[]),r=d.useMemo(()=>({kind:"web",openExternal:a=>typeof window<"u"?window.open(a,"_blank","noopener,noreferrer"):null}),[]),s=!n.canUseDriveSync,o="Drive sync is disabled.",[l,u]=d.useState(null),[c,f]=d.useState([]),[g,w]=d.useState(!1),[S,R]=d.useState(null),[k,j]=d.useState(null),[Q,h]=d.useState(!1),[m,b]=d.useState(null),[_,T]=d.useState(()=>s?o:null),[$,B]=d.useState(!1),[z,re]=d.useState(!1),[Z,me]=d.useState(null),[ze,it]=d.useState(!1),[Ze,$e]=d.useState([]),[et,tt]=d.useState(""),[U,q]=d.useState(!1),[X,se]=d.useState(!1),[D,Be]=d.useState(null),[I,_e]=d.useState(null),[Oe,Te]=d.useState(!1),[Kt,ht]=d.useState(!1),[Yn,fe]=d.useState(!1),[St,We]=d.useState(!1),[He,Mt]=d.useState([]),[fn,H]=d.useState([]),[ae,pe]=d.useState(new Set),[gt,pn]=d.useState(0),[_n,mn]=d.useState(null),[N,O]=d.useState(null),[Y,J]=d.useState({}),[ue,ce]=d.useState({}),[ge,ye]=d.useState({}),[Ce,Fe]=d.useState({}),[hn,at]=d.useState(null),[bt,gn]=d.useState({note:"",delta:0,reason:""}),[Ve,ro]=d.useState({pointsEnabled:!1,startingPoints:50,currentPoints:0,predictedPoints:0}),[Ra,so]=d.useState(null),[Qd,Jd]=d.useState(""),[qd,Nl]=d.useState(null),[ls,Xd]=d.useState(null),[_r,Zd]=d.useState(null),[_a,B0]=d.useState({}),ef=d.useRef({}),[W0,iN]=d.useState({}),[Qn,oo]=d.useState(null),[tf,kl]=d.useState(0),[nf,jl]=d.useState(null),[rf,Ta]=d.useState(""),[ut,is]=d.useState(null),[aN,H0]=d.useState([]),[uN,sf]=d.useState(!1),[cN,Aa]=d.useState(null),[dN,fN]=d.useState(!1),[xe,Nt]=d.useState(null),[nt,of]=d.useState(null),[lf,af]=d.useState(null),[Jn,lo]=d.useState(null),[Cl,Tr]=d.useState(null),[Ar,uf]=d.useState(!1),[El,as]=d.useState(null),[qn,Ye]=d.useState(!1),[pN,Ot]=d.useState(null),us=d.useRef(null),cf=d.useRef(null),[df,cs]=d.useState(!1),Pa=typeof navigator<"u"?navigator.onLine:!0,[ff,io]=d.useState(Pa),[pf,Ia]=d.useState(Pa),[he,ao]=d.useState(!Pa),V0=d.useRef(null),K0=d.useRef(!1),Xn=d.useRef(!1),G0=d.useRef(15e3),Y0=d.useRef(0),mf=d.useRef(!1),Tn=d.useRef(!1),Pr=d.useRef(!1),Da=d.useRef(new Set),Ft=d.useRef(null),La=d.useRef(async()=>{}),Ma=d.useRef(0),hf=d.useRef(null),gf=d.useRef(void 0),yf=d.useRef(null),Oa=()=>{const a=new Date,p=a.getFullYear(),y=String(a.getMonth()+1).padStart(2,"0"),x=String(a.getDate()).padStart(2,"0");return`${p}-${y}-${x}`},[oe,uo]=d.useState(Oa()),[Ir,Q0]=d.useState("table"),[Tt,Fa]=d.useState(()=>{try{const a=localStorage.getItem(Iu);return a==="notes"||a==="flashcards"?a:"attendance"}catch{return"attendance"}});d.useEffect(()=>{try{localStorage.setItem(Iu,Tt)}catch{}},[Tt]);const[Rl,J0]=d.useState(()=>{try{return localStorage.getItem(Du)==="last-first"?"last-first":"first-last"}catch{return"first-last"}});d.useEffect(()=>{try{localStorage.setItem(Du,Rl)}catch{}},[Rl]);const[co,q0]=d.useState(()=>{try{return localStorage.getItem(Lu)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Lu,co)}catch{}},[co]);const[_l,X0]=d.useState(()=>{try{return localStorage.getItem(Mu)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Mu,_l)}catch{}},[_l]);const Z0=d.useMemo(()=>new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),[]);d.useEffect(()=>{ef.current=_a},[_a]),d.useEffect(()=>()=>{Object.values(ef.current).forEach(a=>URL.revokeObjectURL(a))},[]);const[Ke,An]=d.useState(!1),[Ua,ey]=d.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem(Im)==="1"}catch{return!1}}),Zn=d.useRef(0),Ut=d.useRef(null),xf=d.useRef({}),vf=d.useRef({}),Tl=d.useRef(null),ds=d.useRef({}),fs=d.useRef({}),er=d.useRef(null),Al=d.useRef(!1),za=d.useRef(!1),$a=d.useRef(!1),ps=d.useRef(null),fo=d.useRef(0),po=d.useRef(!1),wf=d.useRef(0),tn=d.useCallback(a=>{Mt(a.messages),H(a.allMessages),pn(a.unreadCount),pe(new Set(a.dismissedIds))},[]),Dr=d.useRef(null),Sf=d.useRef(null),Pl=d.useRef(!1),Ba=d.useRef(!1),[bf,ms]=d.useState(!1),Il=d.useRef(0),Pn=d.useRef(null),Wa=d.useRef(!1),Nf=1500,kf=3e4,Lr=d.useRef(null),Dl=d.useCallback(a=>a?xf.current[a]??null:null,[]),kt=d.useCallback((a,p)=>{a&&(xf.current[a]=p||null)},[]),Ll=d.useCallback(a=>a||"__local__",[]),jf=d.useCallback(a=>vf.current[Ll(a)]??null,[Ll]),Mr=d.useCallback((a,p)=>{p&&(vf.current[Ll(a)]=p)},[Ll]),yn=d.useCallback(a=>{ds.current={},fs.current={};const p=Po(a??(I==null?void 0:I.id));if(p)try{window.localStorage.removeItem(p)}catch{}Dr.current&&(window.clearTimeout(Dr.current),Dr.current=null)},[I==null?void 0:I.id]),hs=d.useCallback((a,p,y)=>{const x=ds.current;x[a]||(x[a]={}),x[a][p]={...y}},[]),Cf=d.useCallback((a,p,y)=>{const x=fs.current;x[a]||(x[a]={}),x[a][p]={...y}},[]),Ef=d.useCallback(()=>{const a=I==null?void 0:I.id,p=Po(a);if(!p)return;const y=Lm(pi(ds.current),Pm),x=Lm(pi(fs.current),Pm),v={savedAt:Date.now(),lastEditAt:Lr.current??Date.now(),selectedDate:oe,selectedPeriodId:ut,pendingAttendanceByDate:y,pendingNotesByDate:x,pointsLocal:ge,pointsHistoryLocal:Ce};let C=JSON.stringify(v);if(C.length>Am){const E={...v,pointsHistoryLocal:{}};C=JSON.stringify(E)}if(!(C.length>Am))try{window.localStorage.setItem(p,C)}catch{}},[I==null?void 0:I.id,Ce,ge,oe,ut]),Rf=d.useCallback(()=>{Ke&&(Dr.current&&window.clearTimeout(Dr.current),Dr.current=window.setTimeout(()=>{Ef(),Dr.current=null},250))},[Ke,Ef]),Ha=a=>{var p;return JSON.stringify({periodsState:((p=a.periodsState)==null?void 0:p.periods)||[],students:a.students||[]})},In=d.useRef(0),[mN,mo]=d.useState("unknown"),[hN,Va]=d.useState(0),ho=d.useRef(null),Ka=d.useRef(!1);d.useEffect(()=>{ho.current=l},[l]);const Ml=d.useCallback(a=>{if(!a)return!1;const p=ho.current;return Db(p,a)?!1:(ho.current=a,u(a),!0)},[]);d.useCallback(async()=>{const a=await En(ho.current);return a&&Ml(a),a},[Ml]);const _f=d.useCallback(()=>{if(ze)return!0;if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[ze]),xn=d.useCallback(a=>{if(!_f())return;const p=`${new Date().toISOString()} ${a}`;$e(y=>[p,...y].slice(0,200))},[_f]);d.useEffect(()=>{s&&T(o)},[o,s]);const ty=d.useCallback(async()=>{var p;const a=await Ww();if(me(a),xn(`startup info: state=${a.state} sessionLoaded=${a.sessionLoaded} hasRefresh=${a.hasRefresh} expiresAt=${a.expiresAt} source=${a.source} lastWriteAt=${a.lastWriteAt} lastWriteReason=${a.lastWriteReason}`),a.state==="ok"){const y=await Kw();y&&(u(y),(p=y.profile)!=null&&p.email&&T(null))}return a},[xn]),gs=d.useCallback(async a=>{const p=ho.current,y=(p==null?void 0:p.expiresAt)||null,x=await En(p);return xn(`${a}: ensureFreshDriveSession ok=${!!x} before=${y} new=${x==null?void 0:x.expiresAt} hasRefresh=${!!(x!=null&&x.refreshToken)}`),x&&(Ml(x),B(!1)),x},[xn,Ml]),ny=d.useCallback(()=>{Il.current+=1,Pn.current&&window.clearTimeout(Pn.current),Pn.current=window.setTimeout(()=>{Il.current=0,Pn.current=null},2e3),Il.current>=5&&(it(a=>!a),Il.current=0,Pn.current&&(window.clearTimeout(Pn.current),Pn.current=null))},[]),ry=()=>{const a=new URL(Cb);new URL(window.location.href).searchParams.forEach((y,x)=>a.searchParams.set(x,y)),a.searchParams.set("from","mobile"),window.location.assign(a.toString())},sy=a=>{var x,v;if(!N)return;const p=N.students.find(C=>String(C.id)===String(a));if(!p)return;const y=((x=p.periodIds)==null?void 0:x[0])||ut||((v=N.periods[0])!=null&&v.id?String(N.periods[0].id):"");lo({name:p.fullName,gender:p.gender||"F",periodId:y?String(y):""}),af({id:String(a)})},Ol=()=>{af(null),lo(null)},oy=a=>{if(!N)return;const p=N.students.find(x=>String(x.id)===String(a));!p||!window.confirm(`Delete ${p.fullName}? This removes them from this class list.`)||(Da.current.add(String(a)),O(x=>{if(!x)return x;const v=x.students.filter(E=>String(E.id)!==String(a)),C=x.periods.map(E=>{const L={...E.attendance||{}};Object.keys(L).forEach(P=>{const F={...L[P]||{}};delete F[String(a)],Object.keys(F).length===0?delete L[P]:L[P]=F});const V={...E.behaviorNotes||{}};Object.keys(V).forEach(P=>{const F={...V[P]||{}};delete F[String(a)],Object.keys(F).length===0?delete V[P]:V[P]=F});const A={...E.pointsByStudent||{}};delete A[String(a)];const K={...E.customCounterByStudent||{}};delete K[String(a)];const W={...E.attendanceResets||{}};delete W[String(a)];const le=E.activeGrouping?E.activeGrouping.map(P=>P.filter(F=>String(F)!==String(a))):E.activeGrouping;return{...E,attendance:L,behaviorNotes:V,pointsByStudent:A,customCounterByStudent:K,attendanceResets:W,activeGrouping:le}});return{...x,students:v,periods:C}}),J(x=>{const v={...x||{}};return Object.keys(v).forEach(C=>{if(v[C]){const E={...v[C]||{}};delete E[String(a)],v[C]=E}}),v}),ce(x=>{const v={...x||{}};return Object.keys(v).forEach(C=>{if(v[C]){const E={...v[C]||{}};delete E[String(a)],v[C]=E}}),v}),ye(x=>{const v={...x||{}};return Object.keys(v).forEach(C=>{if(v[C]){const E={...v[C]||{}};delete E[String(a)],v[C]=E}}),v}),Fe(x=>{const v={...x||{}};return Object.keys(v).forEach(C=>{v[C]=(v[C]||[]).filter(E=>String(E.studentId)!==String(a))}),v}),Ie(),rt({silent:!0}),Nt(null),of(null),Ol())};d.useEffect(()=>()=>{Pn.current&&window.clearTimeout(Pn.current)},[]),d.useEffect(()=>{ao(!ff||!pf)},[ff,pf]);const Tf=d.useCallback(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[]),go=d.useCallback(a=>{Tf()&&console.debug(a.startsWith("[Ping]")?a:`[Ping] ${a}`)},[Tf]);d.useEffect(()=>{Xn.current=!1;const a=V0,p=K0,y=G0,x=Y0,v=()=>{a.current&&(window.clearTimeout(a.current),a.current=null)},C=K=>{if(Xn.current)return;v();const W=typeof K=="number"?K:y.current;go(`[Ping] next ${W}`),a.current=window.setTimeout(()=>{a.current=null,E()},W)},E=async()=>{if(Xn.current)return;if(x.current=Date.now(),go("[Ping] tick"),typeof document<"u"&&document.visibilityState!=="visible"){C(5e3);return}if(p.current){C(2e3);return}p.current=!0;const K=new AbortController,W=window.setTimeout(()=>K.abort(),5e3),le=(()=>{try{return new URL(`/ping.txt?t=${Date.now()}`,window.location.origin).toString()}catch{return`/ping.txt?t=${Date.now()}`}})();let P=!1;try{const F=await fetch(le,{cache:"no-store",signal:K.signal});P=!!(F!=null&&F.ok),P?(io(!0),Ia(!0),ao(!1),y.current=15e3,go("[Ping] ok")):(io(!1),Ia(!1),ao(!0),y.current=Math.min(6e4,y.current*2),go(`[Ping] fail status=${F==null?void 0:F.status}`))}catch(F){io(!1),Ia(!1),ao(!0),y.current=Math.min(6e4,y.current*2),go(`[Ping] fail ${(F==null?void 0:F.message)||F}`)}finally{window.clearTimeout(W),p.current=!1,Xn.current||C()}},L=()=>{Xn.current||(io(!0),E())},V=()=>{Xn.current||(io(!1),ao(!0),C(2e3))},A=()=>{Xn.current||typeof document<"u"&&document.visibilityState==="visible"&&E()};return E(),window.addEventListener("online",L),window.addEventListener("offline",V),document.addEventListener("visibilitychange",A),()=>{Xn.current=!0,v(),window.removeEventListener("online",L),window.removeEventListener("offline",V),document.removeEventListener("visibilitychange",A)}},[]);const Fl=d.useCallback((a,p)=>{J(p.periods.reduce((y,x)=>{var C,E;const v=(C=ds.current[String(x.id)])==null?void 0:C[a];return y[x.id]=v?{...v}:(E=x.attendance)!=null&&E[a]?{...x.attendance[a]}:{},y},{})),ce(p.periods.reduce((y,x)=>{var C;const v=(C=fs.current[String(x.id)])==null?void 0:C[a];return y[x.id]=v?{...v}:Ou(x.behaviorNotes,a),y},{}))},[]);d.useEffect(()=>{if(!N)return;const a=gf.current!==N.periods,p=yf.current!==oe;!a&&!p||(gf.current=N.periods,yf.current=oe,Fl(oe,N))},[Fl,N,oe]),d.useEffect(()=>{const a=I==null?void 0:I.id;if(!a||Sf.current===a)return;Sf.current=a;const p=Po(a);if(!p)return;let y=null;try{const C=window.localStorage.getItem(p);if(!C)return;y=JSON.parse(C)}catch{return}if(!y||typeof y.savedAt!="number")return;if(Date.now()-y.savedAt>Rb){yn(a);return}ds.current=y.pendingAttendanceByDate||{},fs.current=y.pendingNotesByDate||{},y.pointsLocal&&ye(y.pointsLocal),y.pointsHistoryLocal&&Fe(y.pointsHistoryLocal),y.selectedPeriodId&&is(y.selectedPeriodId),y.lastEditAt&&(Lr.current=y.lastEditAt);const x=y.selectedDate&&F0(y.selectedDate)?y.selectedDate:oe;y.selectedDate&&x!==oe&&uo(x),N&&Fl(x,N),(Object.keys(y.pendingAttendanceByDate||{}).length>0||Object.keys(y.pendingNotesByDate||{}).length>0||Object.keys(y.pointsHistoryLocal||{}).length>0)&&(Zn.current+=1,An(!0),Ye(!0))},[I==null?void 0:I.id,yn,Fl,N,oe]),d.useEffect(()=>{Rf()},[Y,ue,ge,Ce,Ke,Rf]);const Af=d.useCallback(a=>{const p={};return!a||typeof a!="object"||Object.entries(a).forEach(([y,x])=>{if(!x||typeof x!="object")return;const v={},C=x.note&&typeof x.note=="object"?x.note:x;Object.entries(C).forEach(([E,L])=>{L&&typeof L=="object"&&typeof L.note=="string"&&(v[String(E)]={note:L.note,timestamp:L.timestamp||new Date().toISOString()})}),Object.keys(v).length>0&&(p[y]=v)}),p},[]),Or=a=>e({tone:"success",message:a}),ct=a=>e({tone:"error",message:a}),vn=a=>e({tone:"info",message:a}),Ul=["unmarked","absent","tardy","left_early","present"],ly=["present","absent","tardy","left_early","unmarked"],zl=d.useCallback(a=>{if(!a)return!1;const p=a.toLowerCase();return p.includes("401")||p.includes("unauthorized")||p.includes("403")||p.includes("sign in with google drive first")},[]),iy=a=>{switch(a){case"present":return"bg-emerald-50 border-emerald-100";case"absent":return"bg-rose-50 border-rose-100";case"tardy":return"bg-amber-50 border-amber-100";case"left_early":return"bg-blue-50 border-blue-100";default:return"bg-slate-50 border-slate-200"}},Pf=a=>{switch(a){case"present":return"Present";case"absent":return"Absent";case"tardy":return"Tardy";case"left_early":return"Left Early";default:return"Unmarked"}},Ga=(a,p)=>_0(a,p).emoji,ay=()=>`${Date.now()}-${Math.random().toString(36).slice(2)}`,uy=a=>{const p=String(a.getMonth()+1).padStart(2,"0"),y=String(a.getDate()).padStart(2,"0");return`${p}-${y}-${a.getFullYear()}`},Ya=a=>`https://docs.google.com/document/d/${a}/edit`,Qa=d.useCallback(a=>{if(!a)return;const p=Date.now(),y=hf.current;if(y&&y.url===a&&p-y.at<600)return;hf.current={url:a,at:p};try{if(r!=null&&r.openExternal){r.openExternal(a);return}}catch{}window.open(a,"_blank","noopener,noreferrer")||T==null||T("Pop-up blocked  please allow pop-ups to open Google Docs.")},[r]),Dn=d.useCallback(a=>K1(a),[]),Ae=d.useCallback(async(a,p="preflight")=>{if(s)return T(o),null;if(he)return T("Offline  will sync when back online."),B(!0),xn(`${p}: offline; skipping refresh`),null;try{const y=await gs(p);if(y)return y}catch(y){console.warn("[Drive] refresh failed",y),xn(`${p}: refresh failed ${(y==null?void 0:y.message)||y}`)}if(!a)return B(!0),T("Reconnect to Google Drive to continue syncing."),xn(`${p}: interactive=false; would trigger OAuth if allowed`),null;xn(`triggerOAuth: reason=${p} hadSession=${!!l} hasRefresh=${!!(l!=null&&l.refreshToken)}`);try{await eS()}catch(y){ct((y==null?void 0:y.message)||"Google sign-in was cancelled.")}return null},[o,l,s,ct,he,xn,gs]),If=d.useCallback(async()=>{if(s||he||Al.current)return!1;Al.current=!0;try{const a=await Ae(!1,"announcements-sync");if(!(a!=null&&a.accessToken))return!1;const p=a.accessToken,y=await gS(p,[to,Oc],{createManagedRootIfMissing:!1});let x=er.current;if(x)try{const P=await Eu(p,x);P!=null&&P.id||(x=null,er.current=null)}catch{x=null,er.current=null}const v=await Ru(p),C=Dm(v);if(C!=null&&C.id){const P=x?await Eu(p,x).catch(()=>null):null,F=Is(P||null),ne=Is(C);(!x||C.id!==x||ne>=F)&&(x=C.id,er.current=C.id,ps.current=fi(C)),fo.current=0,await xS(p,C.id,y)}if(!x){const P=JSON.stringify(xm(qo(),null),null,2),F=await wS(p,y,la,P);if(!(F!=null&&F.id))return!1;x=F.id,er.current=F.id,ps.current=fi(F),fo.current=0}const E=await vs(p,x),L=vm(E),V=qo(),A=wm(V,(L==null?void 0:L.dismissed)||[]),K=A.size!==V.size;K&&Fc(A);const W=new Set(((L==null?void 0:L.dismissed)||[]).map(String));let le=A.size!==W.size;if(!le){for(const P of A)if(!W.has(P)){le=!0;break}}if(le){const P=JSON.stringify(xm(A,null),null,2),F=await cm(p,x,P);ps.current=fi(F)}else ps.current=null;if(K||le){const P=di();tn(P)}return await yS(p,Oc),!0}catch{return!1}finally{Al.current=!1}},[tn,s,Ae,he]),$l=d.useCallback(async()=>{if(!(!l||s||he)&&!(za.current||Al.current)){za.current=!0;try{const a=await Ae(!1,"announcements-poll");if(!(a!=null&&a.accessToken))return;const p=a.accessToken;let y=null,x=er.current;if(x)try{y=await Eu(p,x)}catch{y=null,x=null,er.current=null}const v=await Ru(p),C=Dm(v);if(C!=null&&C.id){const ne=Is(y||null),te=Is(C);(!x||C.id!==x||te>=ne)&&(x=C.id,y=C,er.current=C.id),fo.current=0}else if(!x){if(Date.now()<fo.current)return;fo.current=Date.now()+12e4;return}if(!x)return;const E=fi(y||{id:x,name:la}),L=Date.now(),V=L-wf.current>=_b;if(E&&E===ps.current&&!V)return;const A=await vs(p,x),K=vm(A);if(wf.current=L,ps.current=E,!K)return;const W=qo(),le=wm(W,K.dismissed||[]);if(!(le.size!==W.size))return;Fc(le);const F=di();tn(F)}catch{}finally{za.current=!1}}},[tn,l,s,Ae,he]),Ln=d.useCallback(async a=>{if($a.current){a==="manual"&&po.current&&window.setTimeout(()=>{Ln("manual")},350);return}$a.current=!0;try{l&&!s&&!he&&(a==="manual"&&po.current?await If()&&(po.current=!1):await $l());const x=await Sm(a==="heartbeat"?24:12,a==="manual");tn(x)}catch{}finally{$a.current=!1}},[tn,l,s,he,$l,If]),cy=d.useCallback(()=>{We(!0),Ln("manual")},[Ln]),dy=d.useCallback(()=>{We(!1),po.current&&Ln("manual")},[Ln]),fy=d.useCallback(a=>{sb(a),po.current=!0;const p=di();tn(p)},[tn]);d.useEffect(()=>{let a=!0;const p=di();return a&&tn(p),(async()=>{const y=await Sm(12,!0);a&&tn(y)})(),()=>{a=!1}},[tn]),d.useEffect(()=>{let a=!0;const p=60*60*1e3,y=window.setInterval(()=>{(async()=>a&&await Ln("heartbeat"))()},p);return()=>{a=!1,window.clearInterval(y)}},[Ln]),d.useEffect(()=>{if(!(l!=null&&l.accessToken)){Ka.current=!1;return}Ka.current||(Ka.current=!0,Ln("drive-connect"))},[l==null?void 0:l.accessToken,Ln]),d.useEffect(()=>{if(!l||s||he)return;let a=!0;const p=()=>{a&&(typeof document<"u"&&document.visibilityState!=="visible"||$l())};p();const y=window.setInterval(p,2e4),x=()=>{document.visibilityState==="visible"&&p()},v=()=>p();return document.addEventListener("visibilitychange",x),window.addEventListener("online",v),()=>{a=!1,window.clearInterval(y),document.removeEventListener("visibilitychange",x),window.removeEventListener("online",v)}},[l,s,he,$l]);const Bl=d.useCallback(async(a,p,y)=>{let x=!1;const v=async()=>{let C=y;if(C||(C=await Ae(!0,`${p}-download`)),!C)throw new Error("Reconnect to Google Drive to continue.");try{return{data:await vs(C.accessToken,a)}}catch(E){const L=(E==null?void 0:E.message)||"";if(!x&&zl(L))return x=!0,_o("[Drive][Mobile] auth error on download, retrying once",{context:p,error:L}),y=null,v();throw E}};return v()},[Ae,zl]),Df=d.useCallback(async(a,p,y,x)=>{let v=!1;const C=async()=>{let E=x;if(E||(E=await Ae(!0,`${y}-upload`)),!E)throw new Error("Reconnect to Google Drive to continue.");try{return await cm(E.accessToken,a,p)}catch(L){const V=(L==null?void 0:L.message)||"";if(!v&&zl(V))return v=!0,_o("[Drive][Mobile] auth error on upload, retrying once",{context:y,error:V}),x=null,C();throw L}};return C()},[Ae,zl]),tr=d.useCallback((a,p,y)=>{var V;if(!((V=a==null?void 0:a.periodsState)!=null&&V.periods)||!(a!=null&&a.students))return"failed";const x=Ha(a),v=(p==null?void 0:p.id)||Ut.current;if(v&&!(y!=null&&y.force)){const A=Q1({incomingUpdatedAt:a.updatedAt,lastAppliedUpdatedAt:jf(v),incomingRevisionId:(p==null?void 0:p.revisionId)||null,lastRevisionId:Dl(v)??null});if(_o("[Sync][Mobile] apply decision",{fileKey:v,decision:A}),A.action==="skip")return p&&(Ut.current=p.id,_e(p),kt(p.id,p.revisionId||null)),In.current=Date.now(),"skipped"}Zn.current=0,Tn.current=!1,Pr.current=!1,An(!1),Ye(!1),Ot(null),ms(!1),yn(),Ft.current&&(window.clearTimeout(Ft.current),Ft.current=null);const C=(a.layouts||[]).reduce((A,K)=>(A[String(K.id)]={id:String(K.id),name:K.name,tables:(K.tables||[]).map(W=>({id:String(W.id),name:W.name||"Table",seatNumbers:Array.isArray(W.seatNumbers)?W.seatNumbers:void 0}))},A),{}),E=a.periodsState.periods.map(A=>({id:String(A.id),name:A.name,layoutId:A.layoutId||null,tableAssignments:A.tableAssignments||{},activeGrouping:A.activeGrouping||[],tableNumbering:A.tableNumbering||void 0,attendance:A.attendance||{},attendanceResets:A.attendanceResets||{},customCounterByStudent:A.customCounterByStudent||{},behaviorNotes:Af(A.behaviorNotes),pointsByStudent:A.pointsByStudent||{},pointsEnabled:A.pointsEnabled??!1,startingPoints:A.startingPoints??50,pointsHistory:A.pointsHistory||[]})),L=(a.students||[]).map(A=>{var K;return{id:String(A.id),fullName:A.fullName||A.name||"Student",gender:typeof A.gender=="string"?A.gender:void 0,periodIds:((K=A.periodIds)==null?void 0:K.map(W=>String(W)))||[],profileUpdatedAt:typeof A.profileUpdatedAt=="string"?A.profileUpdatedAt:void 0,quickNote:typeof A.quickNote=="string"?A.quickNote:void 0,quickNoteUpdatedAt:typeof A.quickNoteUpdatedAt=="string"?A.quickNoteUpdatedAt:void 0,photoFileId:typeof A.photoFileId=="string"?A.photoFileId:A.photoFileId==null?null:String(A.photoFileId),photoUpdatedAt:(()=>{if(typeof A.photoUpdatedAt=="number")return A.photoUpdatedAt;if(typeof A.photoUpdatedAt=="string"){const W=Number.parseInt(A.photoUpdatedAt,10);return Number.isFinite(W)?W:null}return null})(),audioFileId:typeof A.audioFileId=="string"?A.audioFileId:A.audioFileId==null?null:String(A.audioFileId),audioUpdatedAt:(()=>{if(typeof A.audioUpdatedAt=="number")return A.audioUpdatedAt;if(typeof A.audioUpdatedAt=="string"){const W=Number.parseInt(A.audioUpdatedAt,10);return Number.isFinite(W)?W:null}return null})(),docs:Array.isArray(A.docs)?A.docs.map(W=>({...W,id:String(W.id),driveFileId:String(W.driveFileId)})):[]}});return O({periods:E,students:L,layouts:C}),is(A=>{var F;const K=A?String(A):null,W=a.periodsState.currentId?String(a.periodsState.currentId):null;return[K,W,((F=E[0])==null?void 0:F.id)||null].filter(Boolean).find(ne=>E.some(te=>String(te.id)===ne))||null}),J(E.reduce((A,K)=>{var W;return A[K.id]=(W=K.attendance)!=null&&W[oe]?{...K.attendance[oe]}:{},A},{})),ce(E.reduce((A,K)=>(A[K.id]=Ou(K.behaviorNotes,oe),A),{})),ye(E.reduce((A,K)=>{var le;const W=K.pointsByStudent?{...K.pointsByStudent}:{};return K.pointsEnabled&&((le=K.studentsIds)==null||le.forEach(P=>{W[P]===void 0&&(W[P]=K.startingPoints??50)})),A[K.id]=W,A},{})),Tl.current=x,mo(a.lastWriter||"unknown"),p?(Ut.current=p.id,_e(p),kt(p.id,p.revisionId||null)):kt(Ut.current,null),as(null),Va(A=>A+1),Mr(v,a.updatedAt),In.current=Date.now(),"applied"},[oe,jf,Af,Ou,J,ce,ye,is,O,An,Ye,_e,kt,Ot,ms,mo,as,Va,Mr,yn]),Ie=d.useCallback(()=>{Zn.current+=1,Lr.current=Date.now(),An(!0),Ye(!0)},[]),Ja=d.useCallback((a,p,y)=>{O(x=>x&&{...x,periods:x.periods.map(v=>{if(String(v.id)!==String(a))return v;const C={...v.attendanceResets||{}},E={...C[String(p)]||{}};return E[y]=oe,C[String(p)]=E,{...v,attendanceResets:C}})}),Ie()},[Ie,oe]),Lf=d.useCallback((a,p,y)=>{const x=Math.trunc(y);!Number.isFinite(x)||x===0||(O(v=>v&&{...v,periods:v.periods.map(C=>{if(String(C.id)!==String(a))return C;const E={...C.customCounterByStudent||{}},L=Number(E[String(p)]||0),V=Math.max(0,L+x);return V<=0?delete E[String(p)]:E[String(p)]=V,{...C,customCounterByStudent:E}})}),Ie())},[Ie]),py=d.useCallback((a,p)=>{O(y=>y&&{...y,periods:y.periods.map(x=>{if(String(x.id)!==String(a))return x;const v={...x.customCounterByStudent||{}};return delete v[String(p)],{...x,customCounterByStudent:v}})}),Ie()},[Ie]),qa=d.useCallback((a,p,y)=>{J(x=>{const v={...x||{}};return v[a]={...v[a]||{}},y==="unmarked"?delete v[a][p]:v[a][p]=y,hs(String(a),oe,v[a]),v}),Ie()},[Ie,oe,hs]);d.useCallback((a,p)=>{var C;const y=((C=Y[a])==null?void 0:C[p])||"unmarked",x=Ul.indexOf(y),v=Ul[(x+1)%Ul.length];qa(a,p,v)},[Y,qa,Ul]);const Wl=d.useCallback((a,p)=>{J(y=>{const x={...y||{}};return x[a]={...x[a]||{}},p.forEach(v=>{x[a][v]||(x[a][v]="present")}),hs(String(a),oe,x[a]),x}),Ie()},[Ie,oe,hs]),my=d.useCallback((a,p,y,x)=>{if(y===0||p.length===0)return;const v=(x==null?void 0:x.trim())||"Bulk points update",C=N==null?void 0:N.periods.find(L=>L.id===a),E=(C==null?void 0:C.startingPoints)??50;ye(L=>{const V={...L||{}};return V[a]={...V[a]||{}},p.forEach(A=>{const K=V[a][A]??E;V[a][A]=Math.max(0,K+y)}),V}),Fe(L=>{const V={...L||{}},A=V[a]?[...V[a]]:[];return p.forEach(K=>A.push({studentId:K,delta:y,reason:v,date:oe})),V[a]=A,V}),Ie()},[N==null?void 0:N.periods,oe,Ie]),Mf=d.useCallback(a=>{J(p=>{const y={...p||{}};return y[a]={},hs(String(a),oe,y[a]),y}),vn("Reset attendance to unmarked for this date."),Ie()},[vn,Ie,oe,hs]),hy=d.useCallback(()=>{if(!hn)return;const{periodId:a,studentId:p}=hn,{note:y,delta:x,reason:v}=bt,C=Ve;if(C.pointsEnabled&&x!==0&&!v.trim()){ct("Please provide a reason when changing points.");return}ce(E=>{const L={...E||{}};return L[a]={...L[a]||{}},y.trim()?L[a][p]=y.trim():delete L[a][p],Cf(String(a),oe,L[a]),L}),C.pointsEnabled&&x!==0&&(ye(E=>{const L={...E||{}};L[a]={...L[a]||{}};const V=L[a][p]??C.startingPoints??0,A=Math.max(0,V+x);return L[a][p]=A,L}),Fe(E=>{const L={...E||{}},V=L[a]?[...L[a]]:[];return V.push({studentId:p,delta:x,reason:v||"Behavior note",date:oe}),L[a]=V,L})),Ie(),at(null),gn({note:"",delta:0,reason:""})},[hn,bt,Ve,Ie,oe,Cf,ce,ye,ct]),Of=d.useCallback((a,p,y)=>{var L,V;const x=((L=ue[a])==null?void 0:L[p])||"",v=N==null?void 0:N.periods.find(A=>A.id===a),C=(v==null?void 0:v.startingPoints)??50,E=((V=ge[a])==null?void 0:V[p])??C;gn({note:x,delta:0,reason:""}),ro({pointsEnabled:!!(v!=null&&v.pointsEnabled),startingPoints:C,currentPoints:E,predictedPoints:E}),at({periodId:a,studentId:p,studentName:y})},[ue,ge,N]),gy=d.useCallback((a,p,y)=>{Of(a,p,y)},[Of]);d.useEffect(()=>{if(s){T(o),re(!0);return}let a=!0;return(async()=>{await ty();const y=await tS().catch(()=>null);if(!y||!a){a&&re(!0);return}const x=await En(y),v=x||y;if(xn(`startup refresh result: ok=${!!x} expiresAt=${x==null?void 0:x.expiresAt}`),!!a){if(u(v),mf.current){re(!0);return}mf.current=!0;try{const C=localStorage.getItem(Ao);if(!C){Pl.current=!0,re(!0);return}const E=JSON.parse(C);if(E!=null&&E.id&&(E!=null&&E.name)){Ba.current=!0;const L={id:E.id,name:E.name,modifiedTime:E.modifiedTime,size:E.size,revisionId:E.revisionId};Be(L),T(`Restoring ${L.name}`);const V=await vs(y.accessToken,L.id),A=typeof V=="string"?JSON.parse(V):V,K=Dn(A);if(!K)throw new Error("Drive file could not be parsed.");const W=tr(K,L);W==="applied"?(_e(L),T(`Loaded ${L.name} from Drive.`),as(new Date().toISOString())):W==="skipped"&&(_e(L),T("Drive file is older than current data  keeping existing state."))}Pl.current=!0,re(!0)}catch(C){console.error("[Drive] Restore failed",C),T("Google sign-in failed. Please try again."),Ba.current=!1,Pl.current=!0,re(!0)}}})(),()=>{a=!1}},[]),d.useEffect(()=>{var v;if(s||!z||Oe)return;const a=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,p=t||a,y=(((v=N==null?void 0:N.periods)==null?void 0:v.length)??0)>0;if(!(p&&!y&&!Ua&&!he)){if(!l){Te(!0);return}N||I!=null&&I.id||Pl.current&&(Ba.current||Te(!0))}},[I,l,s,he,t,N,Ua,z,Oe]),d.useEffect(()=>{Oe||ht(!1)},[Oe]),d.useEffect(()=>{if(!Kt)return;const a=p=>{var x;const y=p.target;y&&((x=cf.current)!=null&&x.contains(y)||ht(!1))};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[Kt]),d.useEffect(()=>{const a=window.setInterval(async()=>{l&&await gs("timer")},3e5);return()=>window.clearInterval(a)},[l,gs]),d.useEffect(()=>{const a=async()=>{l&&await gs("visibility")};return document.addEventListener("visibilitychange",a),()=>document.removeEventListener("visibilitychange",a)},[l,gs]),d.useEffect(()=>{if(g){const a=window.setTimeout(()=>{w(!1),R("Still loading Drive files. Try Sign in with Google then tap Refresh Cloud Files.")},12e3);return mn(a),()=>window.clearTimeout(a)}_n&&(window.clearTimeout(_n),mn(null)),Ft.current&&(window.clearTimeout(Ft.current),Ft.current=null)},[g,_n]);const yy=d.useCallback(()=>{nS(),u(null),f([]),j(null),h(!1),b(null),Be(null),_e(null),T(null),vn("Signed out of Google Drive."),Ps("drive-disconnect")},[vn,Ps]),xy=d.useCallback(()=>{if(!window.confirm("Clear local ClassSeats data on this device? This removes local class data and drafts on this device only. Google Drive files will not be changed."))return;const p=Po(I==null?void 0:I.id),y=Po(D==null?void 0:D.id);try{window.localStorage.removeItem(Ao),window.localStorage.removeItem(Iu),window.localStorage.removeItem(Du),window.localStorage.removeItem(Lu),window.localStorage.removeItem(Mu),p&&window.localStorage.removeItem(p),y&&y!==p&&window.localStorage.removeItem(y)}catch{}O(null),J({}),ce({}),ye({}),Fe({}),is(null),Be(null),_e(null),An(!1),Ye(!1),Ot(null),yn(),Ps("local-clear"),ht(!1),T("Local data cleared on this device."),vn("Local ClassSeats data cleared from this device.")},[I==null?void 0:I.id,Ps,yn,D==null?void 0:D.id,vn]),vy=d.useCallback(async()=>{var a;!I||!((a=window.desktopBridge)!=null&&a.uploadDriveFile)||confirm(`Delete ${I.name} from Drive? This cannot be undone.`)&&(await window.desktopBridge.uploadDriveFile({fileId:I.id,content:JSON.stringify({deleted:!0,message:"File deleted by user."})}),O(null),J({}),ce({}),ye({}),Fe({}),yn(),_e(null),is(null),T("Deleted active file from Drive."))},[I,yn]);d.useCallback(async()=>{},[tr,Dn,_e,kt]);const Hl=d.useCallback(async(a=!0,p=!1)=>{var y,x;if(!(g&&!p)){w(!0),R(null),j(null);try{const v=await Ae(a,"refreshFiles");if(!v){R("Sign in with Google to view cloud files."),h(!1),b(null);return}const C=(await Cu(v.accessToken)).filter(E=>!Ib(E==null?void 0:E.name));f(C);try{const E=await mS(v.accessToken);b(E);const L=((y=v.profile)==null?void 0:y.email)||((x=l==null?void 0:l.profile)==null?void 0:x.email)||null,V=Ab(L),A=!!(E!=null&&E.trashedFolderSignature)&&V===E.trashedFolderSignature,K=!!(E!=null&&E.hasTrashedManagedFolder)&&!A;h(K),K?j(null):E!=null&&E.hasTrashedManagedFolder?E.hasTrashedManagedFolderWithData&&A?j("A previously acknowledged trashed ClassSeats folder was detected. You can continue starting fresh."):j("A trashed ClassSeats folder was detected. If this was intentional, continue starting fresh."):E!=null&&E.hasMultipleActiveManagedFolders?j("Multiple active ClassSeats folders were detected. ClassSeats is using the folder that contains your class files."):j(null)}catch{h(!1),b(null),j(null)}T(null)}catch(v){const C=(v==null?void 0:v.message)||"Unable to load Drive files.";R(C),j(null),h(!1),ct(C)}finally{w(!1)}}},[Ae,ct,g,(Bf=l==null?void 0:l.profile)==null?void 0:Bf.email]),wy=d.useCallback(()=>{window.open("https://drive.google.com/drive/trash","_blank","noopener,noreferrer")},[]),Sy=d.useCallback(()=>{var y;if(!window.confirm("Start fresh? Trashed files are not permanently deleted and can still be restored from Google Drive Trash."))return;const p=((y=l==null?void 0:l.profile)==null?void 0:y.email)||null;m!=null&&m.trashedFolderSignature&&Pb(p,m.trashedFolderSignature),h(!1),j("Starting fresh. Create a new class file on desktop, then refresh here.")},[(Wf=l==null?void 0:l.profile)==null?void 0:Wf.email,m]);d.useEffect(()=>{if(!Oe){Wa.current=!1;return}s||l&&(Wa.current||(Wa.current=!0,Hl(!0)))},[l,s,Hl,Oe]),d.useCallback(async()=>{sf(!0),Aa(null);try{const a=await Ae(!0,"importList");if(!a){Aa("Sign in first to import.");return}const p=await Ru(a.accessToken);H0(p)}catch(a){const p=(a==null?void 0:a.message)||"Unable to list Drive files.";Aa(p),ct(p)}finally{sf(!1)}},[Ae,ct]);const by=d.useCallback(async()=>{if(!D){R("Select a cloud file first.");return}if(Tn.current){R("Sync in progress. Please wait.");return}if(Ke||qn)if(window.confirm("You have unsynced changes. Sync them to Drive before switching files? Click OK to sync, Cancel to discard changes.")){if(await rt({silent:!0}),Ke||qn){R("Sync did not complete. Try again before switching files.");return}}else{if(!window.confirm("Discard unsynced changes and load the selected file?"))return;Zn.current=0,An(!1),Ye(!1),Ot(null)}if(await Ae(!0,"loadSelected")){se(!0);try{const p=await Bl(D.id,"loadSelected"),y=typeof p.data=="string"?JSON.parse(p.data):p.data,x=Dn(y);if(!x)throw new Error("File could not be parsed.");const v=tr(x,D,{force:!0});if(v==="applied")T(`Loaded ${D.name}. Data available locally.`),Te(!1),ht(!1);else if(v==="skipped")T("Drive file is older than current data. Keeping existing data."),Te(!1),ht(!1);else throw new Error("File could not be parsed.");localStorage.setItem(Ao,JSON.stringify({id:D.id,name:D.name,modifiedTime:D.modifiedTime,size:D.size,revisionId:D.revisionId})),Or(`Loaded ${D.name} from Drive.`)}catch(p){const y=(p==null?void 0:p.message)||"Unable to load Drive file.";R(y),ct(y)}finally{se(!1)}}},[Ae,D,ct,Or,tr,Dn,Ke,qn,Bl]);d.useCallback(async()=>{const a=et.trim();if(!a){R("Enter a file name first.");return}if(o0(a)){R(s0);return}const p=await Ae(!0,"createFile");if(p){q(!0),R(null);try{const x={...B1(void 0,void 0,N==null?void 0:N.students),lastWriter:"mobile",updatedAt:new Date().toISOString()},v=await vS(p.accessToken,a,JSON.stringify(x,null,2));f(C=>[v,...C]),_e(v),Ut.current=v.id,kt(v.id,v.revisionId||null),Mr(v.id,x.updatedAt),Be(v),tt(""),localStorage.setItem(Ao,JSON.stringify({id:v.id,name:v.name,modifiedTime:v.modifiedTime,size:v.size,revisionId:v.revisionId})),Or(`Created ${v.name} in Drive.`)}catch(y){const x=(y==null?void 0:y.message)||"Unable to create Drive file.";R(x),ct(x)}finally{q(!1)}}},[et,Ae,N,Mr,ct,Or]);const Ff=d.useCallback((a,p)=>{const y={...a||{}};return Object.entries(p||{}).forEach(([x,v])=>{if(!v||typeof v!="object")return;const C=y[x]||{},E={...C};["absent","tardy","leftEarly"].forEach(L=>{const V=v[L],A=C[L];V&&(!A||V>A)?E[L]=V:A&&(E[L]=A)}),y[x]=E}),y},[]),rt=d.useCallback(async a=>{var y,x,v;if(s){T(o);return}if(Tn.current)return;if(a!=null&&a.silent&&!Ke){Ye(!1),Ot(null);return}if(!((y=N==null?void 0:N.periods)!=null&&y.length)||!((x=N==null?void 0:N.students)!=null&&x.length)){T("Cannot sync until data is loaded. Open a file first.");return}if(he){Ye(!0),Ot("Offline - changes will sync when back online."),ms(!0);return}if(Pr.current){T("Sync already running.");return}const p=Zn.current;try{const C=await Ae(!(a!=null&&a.silent),"syncUpload");if(!C){Ot("Reconnect to Google Drive to continue syncing."),Ye(!0);return}if(!I){T("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ye(!0);return}const E=G1({isOffline:he,isLocked:Pr.current,inFlight:Tn.current,hasSession:!0,hasFile:!!I,dirty:Ke,now:Date.now(),lastLocalEditAt:Lr.current,graceMs:Nf});if(_o("[Sync][Mobile] upload decision",E),E.action==="skip"){if(E.reason==="clean"&&!(a!=null&&a.silent)){const ee=I.id,be=(await Cu(C.accessToken)).find(ys=>ys.id===ee),st=be||I,jt=await vs(C.accessToken,ee),dt=typeof jt=="string"?JSON.parse(jt):jt,wn=Dn(dt);if(!wn)throw new Error("Drive file could not be parsed.");const nr=tr(wn,st);if(nr==="failed")throw new Error("Drive file could not be parsed.");nr==="applied"&&vn("Updated from Drive."),be!=null&&be.revisionId&&kt(ee,be.revisionId||null),In.current=Date.now(),as(new Date().toISOString()),Ye(!1),Ot(null),T("Synced with Google Drive."),Or("Synced with Google Drive.");return}E.reason==="no-file"&&(T("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ye(!0));return}Pr.current=!0,Tn.current=!0,uf(!0);const L=pi(ds.current),V=pi(fs.current),A=await Bl(I.id,"syncUpload",C),K=typeof A.data=="string"?JSON.parse(A.data):A.data,W=Dn(K);if(!((v=W==null?void 0:W.periodsState)!=null&&v.periods))throw new Error("Drive file missing periods.");const le=Da.current,P=new Date().toISOString(),F=(W.periodsState.periods||[]).map(ee=>{const ve=String(ee.id),be=ge[ve]||{},st=Array.isArray(ee.pointsHistory)?[...ee.pointsHistory]:[],jt=Ce[ve]||[],dt=N==null?void 0:N.periods.find(nn=>String(nn.id)===ve),wn=Ff(ee.attendanceResets||{},(dt==null?void 0:dt.attendanceResets)||{}),nr=jm(ee.attendance,L[ve],le),ys=Cm(ee.behaviorNotes,V[ve],le,P),vo=[...st,...jt].filter(nn=>!le.has(String(nn.studentId))),wo={...be};le.forEach(nn=>{delete wo[nn]});const Yf={...wn||{}};le.forEach(nn=>{delete Yf[nn]});const Qf={...ee.customCounterByStudent||{},...(dt==null?void 0:dt.customCounterByStudent)||{}};le.forEach(nn=>{delete Qf[nn]});const Py=ee.activeGrouping?ee.activeGrouping.map(nn=>nn.filter(Iy=>!le.has(String(Iy)))):ee.activeGrouping;return{...ee,attendance:nr,attendanceResets:Yf,customCounterByStudent:Qf,behaviorNotes:ys,pointsByStudent:wo,pointsHistory:vo,activeGrouping:Py}}),ne=W.students||[],te=(N==null?void 0:N.students)||[],Ne=new Map(te.map(ee=>[String(ee.id),ee])),Qe=ne.filter(ee=>!le.has(String(ee.id))).map(ee=>{const ve=Ne.get(String(ee.id));if(!ve)return ee;let be={...ee};const st=ve.profileUpdatedAt||"",jt=ee.profileUpdatedAt||"";st&&(!jt||st>jt)&&(be={...be,fullName:ve.fullName,gender:ve.gender,periodIds:ve.periodIds,profileUpdatedAt:st});const dt=ve.quickNoteUpdatedAt||"",wn=ee.quickNoteUpdatedAt||"";dt&&(!wn||dt>wn)&&(be={...be,quickNote:ve.quickNote,quickNoteUpdatedAt:ve.quickNoteUpdatedAt});const nr=typeof ve.photoUpdatedAt=="number"?ve.photoUpdatedAt:0,ys=typeof ee.photoUpdatedAt=="number"?ee.photoUpdatedAt:0;nr&&(!ys||nr>ys)&&(be={...be,photoFileId:ve.photoFileId??null,photoUpdatedAt:nr});const vo=typeof ve.audioUpdatedAt=="number"?ve.audioUpdatedAt:0,wo=typeof ee.audioUpdatedAt=="number"?ee.audioUpdatedAt:0;return vo&&(!wo||vo>wo)&&(be={...be,audioFileId:ve.audioFileId??null,audioUpdatedAt:vo}),be}),Fr=new Set(ne.map(ee=>String(ee.id)));te.forEach(ee=>{le.has(String(ee.id))||Fr.has(String(ee.id))||Qe.push(ee)});const Mn={...W,schemaVersion:1,version:1,lastWriter:"mobile",lastEditedPeriodId:ut?String(ut):null,lastEditedDate:oe,updatedAt:P,students:Qe,periodsState:{...W.periodsState,periods:F}},xo=JSON.stringify(Mn,null,2),ke=await Df(I.id,xo,"syncUpload",C);Fe(ee=>{const ve={...ee||{}};return delete ve[ut||""],ve}),ke?(Tl.current=Ha(Mn),kt(ke.id,ke.revisionId||null),Ut.current=ke.id,_e(ke),Mr(ke.id,Mn.updatedAt),In.current=Date.now()):Mr(I.id,Mn.updatedAt),Da.current.clear(),mo("mobile"),a!=null&&a.silent||(T("Synced with Google Drive."),Or("Synced with Google Drive.")),as(new Date().toISOString()),Ye(!1),localStorage.setItem(Ao,JSON.stringify({id:(ke==null?void 0:ke.id)||I.id,name:(ke==null?void 0:ke.name)||I.name,modifiedTime:(ke==null?void 0:ke.modifiedTime)||I.modifiedTime,size:(ke==null?void 0:ke.size)||I.size,revisionId:(ke==null?void 0:ke.revisionId)||I.revisionId})),Zn.current===p&&(O(ee=>{if(!ee)return ee;const ve=ee.periods.map(be=>{const st=String(be.id),jt=jm(be.attendance,L[st],new Set),dt=Cm(be.behaviorNotes,V[st],new Set,P);return{...be,attendance:jt,behaviorNotes:dt}});return{...ee,periods:ve}}),An(!1),Ye(!1),yn())}catch(C){const E=(C==null?void 0:C.message)||"Failed to sync with Drive.";T(E),a!=null&&a.silent||ct(E),Ye(!0)}finally{uf(!1),Tn.current=!1,Pr.current=!1}},[I,Ae,tr,ct,vn,Or,ge,Ce,N,oe,ut,Ke,o,s,he,Dn,yn,O,Dl,Mr,kt,Bl,Df,Ff]),Vl=d.useCallback(()=>{s||he||Ke&&I&&l&&(Ye(!0),rt({silent:!0}))},[Ke,I,l,s,rt,he]);d.useEffect(()=>{const a=()=>{document.visibilityState==="visible"&&(Vl(),!Ke&&!Ar&&!he&&I&&La.current())};return window.addEventListener("online",Vl),document.addEventListener("visibilitychange",a),()=>{window.removeEventListener("online",Vl),document.removeEventListener("visibilitychange",a)}},[Vl,Ke,Ar,he,I]),d.useEffect(()=>{if(he){ms(!0);return}if(!bf||!I||!l)return;(async()=>{if(!Ke){Ye(!1),Ot(null),ms(!1);return}Ye(!0),Ot("Reconnected  refreshing data"),await rt({silent:!0}),ms(!1),Ot(null)})()},[he,bf,I,l,Ke,rt]),d.useEffect(()=>{if(!I||!Ke&&!qn||Tn.current)return;const a=window.setTimeout(()=>{rt({silent:!0})},500);return()=>window.clearTimeout(a)},[Ke,qn,I,rt,Y,ue,ge,Ce]),d.useEffect(()=>{if(!qn||s||he||!I)return;const a=window.setInterval(()=>{Tn.current||Pr.current||rt({silent:!0})},2500);return()=>window.clearInterval(a)},[qn,s,he,I,rt]),d.useEffect(()=>{I&&kt(I.id,I.revisionId||null)},[I,kt]),d.useEffect(()=>{Ut.current=(I==null?void 0:I.id)||null,Ma.current=0},[I]);const Kl=d.useCallback(async()=>{if(s)return;const a=Ut.current;if(!a)return;const p=Y1({isOffline:he,isLocked:Pr.current||Ar,inFlight:Tn.current,dirty:Ke,now:Date.now(),lastLocalEditAt:Lr.current,lastPullAt:In.current,graceMs:Nf});if(_o("[Sync][Mobile] pull decision",p),p.action==="skip")return;const y=await Ae(!1,"pull");if(y&&Ut.current===a)try{const x=await Cu(y.accessToken);if(Ut.current!==a)return;const v=x.find(V=>V.id===a),C=Dl(a),E=!(v!=null&&v.revisionId)||v.revisionId!==C,L=Date.now()-Ma.current>=kf;if(E||L){Ma.current=Date.now();const V=await vs(y.accessToken,a);if(Ut.current!==a)return;const A=typeof V=="string"?JSON.parse(V):V,K=Dn(A);if(!K)return;const W=Ha(K);if(Tl.current&&W===Tl.current){v!=null&&v.revisionId&&kt(a,v.revisionId||null),In.current=Date.now(),mo(K.lastWriter||"unknown");return}const le=tr(K,v);le==="applied"&&Ut.current===a?(as(new Date().toISOString()),v!=null&&v.revisionId&&kt(a,v.revisionId||null),In.current=Date.now(),mo(K.lastWriter||"unknown"),Va(P=>P+1),vn("Updated from Drive.")):le==="skipped"&&(v!=null&&v.revisionId&&kt(a,v.revisionId||null),In.current=Date.now())}else In.current=Date.now()}catch{}},[tr,Ae,Dn,vn,Ke,Ar,he,s,Dl,kt,kf]);d.useEffect(()=>{La.current=Kl},[Kl]),d.useEffect(()=>{if(s)return;const a=()=>{La.current()},p=window.setTimeout(a,2e3),y=window.setInterval(a,1e4);return()=>{window.clearTimeout(p),window.clearInterval(y)}},[s]),d.useEffect(()=>{if(Ft.current&&(window.clearTimeout(Ft.current),Ft.current=null),!s&&!(Ke||Ar||he||!I))return Ft.current=window.setTimeout(()=>{Kl()},5e3),()=>{Ft.current&&(window.clearTimeout(Ft.current),Ft.current=null)}},[Ke,Ar,he,I,s,Kl]);const Uf=xe&&nt&&(N!=null&&N.periods)&&N.periods.find(a=>String(a.id)===String(nt))||null,Gt=d.useMemo(()=>!xe||!N?null:N.students.find(a=>String(a.id)===String(xe.id))||null,[xe,N]),{audioUrl:yo}=Hd({studentId:(Gt==null?void 0:Gt.id)??"menu",audioFileId:(Gt==null?void 0:Gt.audioFileId)??null,audioUpdatedAt:(Gt==null?void 0:Gt.audioUpdatedAt)??null,driveSession:l}),Xa=!!(Gt!=null&&Gt.audioFileId),zf=Uf&&xe?Math.max(0,Number(((Hf=Uf.customCounterByStudent)==null?void 0:Hf[String(xe.id)])||0)):null;d.useEffect(()=>{xe||(cs(!1),us.current&&us.current.pause())},[xe]),d.useEffect(()=>{cs(!1),us.current&&us.current.pause()},[yo]);const Ny=async()=>{if(!yo)return;const a=us.current;if(a){if(df){a.pause(),cs(!1);return}try{await a.play(),cs(!0)}catch{e({message:"Could not play audio. Please try again.",tone:"error"})}}},ky=Tt==="attendance"&&!!N&&!!ut,jy="132px",Cy=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,Ey=t||Cy,Ry=(((Vf=N==null?void 0:N.periods)==null?void 0:Vf.length)??0)>0,_y=Ey&&z&&!Ry&&!Ua&&!he,$f=!(!s&&!l),Ty=D?`Open "${D.name}"`:"Open File",Ay=d.useCallback(()=>{try{window.localStorage.setItem(Im,"1")}catch{}ey(!0)},[]);return i.jsx(fb,{children:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"min-h-[100dvh] h-[100dvh] bg-gradient-to-b from-violet-900 to-indigo-800 text-white flex flex-col relative",children:[i.jsxs("div",{className:"bg-emerald-50 text-emerald-900 text-xs px-4 py-1 text-center",children:[i.jsx("span",{role:"img","aria-label":"lock",className:"mr-1",children:""}),"Privacy: Data stays on this device and in your Google Drive. Use your school Google account. No data is sent to our servers."]}),he&&i.jsx("div",{className:"bg-slate-900 text-white text-xs px-4 py-1 text-center",children:"Offline  edits are saved locally and will sync when youre back online."}),i.jsxs("div",{className:"px-4 pt-2 flex items-center justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow",onClick:ny,title:"Version",type:"button",children:["Rev ",Tm]}),i.jsx("button",{className:"text-[11px] px-2 py-1 rounded border border-white/60 bg-white/20 text-white shadow hover:bg-white/30",onClick:()=>fe(!0),type:"button",children:"About"}),i.jsx("a",{href:"https://help.classseats.app/",target:"_blank",rel:"noopener noreferrer",className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow hover:bg-white",title:"Open ClassSeats Help Center",children:" Help"})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[i.jsx("span",{className:"text-[16px] font-bold tracking-wide text-white/90 whitespace-nowrap",children:"ClassSeats Mobile"}),!t&&i.jsx(z1,{current:"mobile",onGoDesktop:ry,onGoMobile:()=>{}})]})]}),i.jsx("div",{className:"px-4 pt-2",children:i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsx("div",{className:"inline-flex w-full rounded-xl border border-slate-200 bg-slate-50 p-1",children:i.jsxs("div",{className:"grid w-full grid-cols-3 gap-1",children:[i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Tt==="attendance"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Fa("attendance"),children:"Attendance"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Tt==="notes"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Fa("notes"),children:"Notes"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Tt==="flashcards"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Fa("flashcards"),children:"Flashcards"})]})})})}),ky&&i.jsx("div",{className:"mt-[33px]"}),_m,Tt==="attendance"&&N&&ut&&(()=>{const a=N.periods.find(W=>W.id===ut);if(!a)return null;const p=N.students.filter(W=>{var le;return(le=W.periodIds)==null?void 0:le.includes(String(a.id))}),y=Y[a.id]||{},x=p.length||1,v=p.filter(W=>y[W.id]==="present").length,C=p.filter(W=>y[W.id]==="absent").length,E=p.filter(W=>y[W.id]==="tardy").length,L=p.filter(W=>y[W.id]==="left_early").length,V=v+C+E+L,A=Math.round(V/x*100),K=Math.round(v/x*100);return i.jsx("div",{className:"fixed left-0 right-0 z-40 px-4 pt-2",style:{top:jy},children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow px-3 py-2 flex flex-wrap items-center gap-2 text-xs text-slate-800",children:[i.jsxs("span",{className:"font-semibold",children:["Progress: ",A,"%  Present: ",K,"%"]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 font-semibold",children:[" Present: ",v]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-rose-100 text-rose-800 font-semibold",children:[" Absent: ",C]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-amber-100 text-amber-800 font-semibold",children:[" Tardy: ",E]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-800 font-semibold",children:[" Left Early: ",L]})]})})})(),i.jsxs("main",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-28 pt-20 space-y-6 relative",children:[i.jsx(I1,{variant:"inline"}),s&&i.jsx("p",{className:"max-w-2xl mx-auto text-sm text-rose-100 text-left",children:"Drive sync is disabled."}),ze&&i.jsxs("section",{className:"max-w-2xl mx-auto bg-slate-900 text-slate-100 rounded-2xl shadow-inner p-3 space-y-2 text-xs",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"font-semibold",children:"Drive Debug"}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>it(!1),children:"Close"})]}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>$e([]),children:"Clear"})]}),i.jsxs("div",{className:"border border-slate-700 rounded p-2 h-48 overflow-y-auto space-y-1 bg-slate-800/70",children:[Ze.length===0&&i.jsx("div",{className:"text-slate-400",children:"No debug entries yet."}),Ze.map((a,p)=>i.jsx("div",{className:"font-mono text-[11px] whitespace-pre-wrap break-all",children:a},p))]})]}),i.jsxs("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-6 space-y-6",children:[N&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsx("div",{children:i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:Tt==="attendance"?"Attendance & Behavior":Tt==="notes"?"Student Notes":"Flashcards"})}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[Tt==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Date:"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(oe);a.setDate(a.getDate()-1),uo(a.toISOString().slice(0,10))},children:""}),i.jsx("input",{type:"date",className:"rounded border border-slate-300 px-2 py-1 text-sm",value:oe,onChange:a=>uo(a.target.value||Oa())}),i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(oe);a.setDate(a.getDate()+1),uo(a.toISOString().slice(0,10))},children:""}),i.jsx("button",{className:"px-2 py-1 rounded border border-emerald-200 bg-emerald-50 text-emerald-700 text-sm font-semibold",onClick:()=>uo(Oa()),children:"Today"})]})]}),Tt==="notes"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Sort:"}),i.jsxs("select",{className:"rounded border border-slate-300 bg-white text-slate-900 px-3 py-2 text-sm shadow-sm",value:Rl,onChange:a=>J0(a.target.value),children:[i.jsx("option",{value:"first-last",children:"First Last"}),i.jsx("option",{value:"last-first",children:"Last, First"})]})]}),Tt==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"View:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:Ir,onChange:a=>Q0(a.target.value),children:[i.jsx("option",{value:"table",children:"Table View"}),i.jsx("option",{value:"list-last-first",children:"List (Last, First)"}),i.jsx("option",{value:"list-first-last",children:"List (First Last)"}),i.jsx("option",{value:"list-seat-number",children:"List (Seat Number)"})]}),Ir==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Table Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:co,onChange:a=>q0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3 / A, B, C)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1 / C, B, A)"})]})]}),Ir==="list-seat-number"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Seat Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:_l,onChange:a=>X0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1)"})]})]})]}),N.periods.length>0&&i.jsx("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:ut||"",onChange:a=>is(a.target.value||null),children:N.periods.map(a=>i.jsx("option",{value:a.id,children:a.name},a.id))})]})]}),ut?(()=>{const a=N.periods.find(P=>P.id===ut);if(!a)return i.jsx("p",{className:"text-sm text-slate-500",children:"Period not found."});if(Tt==="notes"){const P=N.students.filter(F=>{var ne;return(ne=F.periodIds)==null?void 0:ne.includes(String(ut))}).slice().sort((F,ne)=>{const[te,...Ne]=F.fullName.split(" "),[Qe,...Fr]=ne.fullName.split(" ");return Rl==="last-first"?Ne.join(" ").localeCompare(Fr.join(" ")):te.localeCompare(Qe)});return i.jsx("div",{className:"space-y-3",children:P.length===0?i.jsx("p",{className:"text-sm text-slate-500",children:"No students found."}):P.map(F=>{var te;const ne=(te=F.docs)==null?void 0:te.find(Ne=>Ne.pinned);return i.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm",children:i.jsx("div",{className:"flex flex-col gap-3",children:i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800 truncate",children:[F.fullName,"  QuickNote"]}),F.quickNote&&i.jsxs("div",{className:"relative mt-1",children:[i.jsx("div",{className:"text-xs text-slate-600 whitespace-pre-wrap break-words max-h-28 overflow-hidden pr-2",children:F.quickNote}),F.quickNote.length>180&&i.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t from-white to-transparent"}),i.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Open Quick Note to view/edit more."})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{Jd(F.quickNote||""),so({studentId:F.id,studentName:F.fullName})},children:"Quick Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:!ne,onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),ne&&Qa(Ya(ne.driveFileId))},children:"Pinned Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>Nl({studentId:F.id,studentName:F.fullName}),children:"Docs"})]})]})})},F.id)})})}if(Tt==="flashcards"){const P=N.students.filter(F=>{var ne;return(ne=F.periodIds)==null?void 0:ne.includes(String(ut))});return i.jsx(xb,{students:P,periodId:String(ut),driveFileId:Ut.current,driveClient:r,driveSession:l,onAudioSaved:(F,ne,te)=>{O(Ne=>Ne&&{...Ne,students:Ne.students.map(Qe=>String(Qe.id)===String(F)?{...Qe,audioFileId:ne,audioUpdatedAt:te}:Qe)}),Ie(),rt({silent:!0})},onAudioDeleted:F=>{O(ne=>ne&&{...ne,students:ne.students.map(te=>String(te.id)===String(F)?{...te,audioFileId:null,audioUpdatedAt:null}:te)}),Ie(),rt({silent:!0})}})}const p=a.layoutId?N.layouts[a.layoutId]:null,y=N.students.filter(P=>{var F;return(F=P.periodIds)==null?void 0:F.includes(String(a.id))}),x=y.reduce((P,F)=>(P[String(F.id)]=F,P),{}),v={};p==null||p.tables.forEach(P=>v[P.id]={id:P.id,name:P.name,students:[]});const C=[],E=a.tableAssignments||{};Array.isArray(a.activeGrouping)&&Object.keys(E||{}).length>0?(a.activeGrouping.forEach((P,F)=>{const ne=E[String(F)]||E[F],te=ne?v[ne]:null;P==null||P.forEach(Ne=>{const Qe=x[String(Ne)];Qe&&(te?te.students.push(Qe):C.push(Qe))})}),y.forEach(P=>{(a.activeGrouping||[]).some(ne=>ne==null?void 0:ne.some(te=>String(te)===String(P.id)))||C.push(P)})):y.forEach(P=>{const F=E[String(P.id)]||E[P.id];F&&v[F]?v[F].students.push(P):C.push(P)});const L=Object.values(v).sort((P,F)=>{const ne=P.name||"",te=F.name||"",Ne=Z0.compare(ne,te);if(Ne!==0)return co==="asc"?Ne:-Ne;const Qe=String(P.id).localeCompare(String(F.id));return co==="asc"?Qe:-Qe}),V=Y[a.id]||{},A={...a.attendance||{},[oe]:V},K=a.attendanceResets||{};ue[a.id];const W=ge[a.id]||{};W0[a.id];const le=(P,F,ne)=>{var be,st;const te=V[P.id],Ne=Au({attendance:A,studentId:P.id,date:oe,status:"absent",resets:K}),Qe=T1({attendance:A,studentId:P.id,date:oe,resets:K}),Fr=Au({attendance:A,studentId:P.id,date:oe,status:"tardy",resets:K}),Mn=Au({attendance:A,studentId:P.id,date:oe,status:"left_early",resets:K}),xo=Math.max(0,Number(((be=a.customCounterByStudent)==null?void 0:be[String(P.id)])||0)),ke=typeof W[P.id]=="number"?W[P.id]:a.startingPoints??50,ee=!!((st=ue[a.id])!=null&&st[P.id]),ve=_a[String(P.id)]||null;return i.jsx(Lb,{student:P,attendance:te,points:ke,pointsEnabled:!!a.pointsEnabled,maxPoints:a.startingPoints??50,hasNote:ee,absenceTotal:Ne,absenceStreak:Qe,tardyCount:Fr,leftEarlyCount:Mn,customCounter:xo,onShowAbsenceHelp:()=>Tr("absent"),onShowTardyHelp:()=>Tr("tardy"),onShowLeftEarlyHelp:()=>Tr("leftEarly"),onShowCustomHelp:()=>Tr("custom"),seatNumber:F,showSeatNumber:ne,statusBg:iy,statusLabel:Pf,tempPhotoUrl:ve,onOpenPhoto:()=>{Xd({id:String(P.id),fullName:P.fullName,photoFileId:P.photoFileId??null})},onOpenMenu:()=>{Nt({id:P.id,name:P.fullName}),of(a.id)},driveClient:r,driveSession:l},P.id)};if(Ir!=="table"){const P=new Map;y.forEach(te=>{P.set(String(te.id),Mb(a,p,te.id))});const F=Ir==="list-seat-number",ne=[...y].sort((te,Ne)=>{const[Qe,...Fr]=te.fullName.split(" "),[Mn,...xo]=Ne.fullName.split(" "),ke=Fr.join(" "),ee=xo.join(" ");if(Ir==="list-seat-number"){const ve=P.get(String(te.id)),be=P.get(String(Ne.id)),st=parseInt(String(ve??""),10),jt=parseInt(String(be??""),10),dt=Number.isFinite(st),wn=Number.isFinite(jt);return dt!==wn?dt?-1:1:dt&&wn&&st!==jt?_l==="asc"?st-jt:jt-st:`${te.fullName||""}`.localeCompare(`${Ne.fullName||""}`)}return Ir==="list-last-first"?`${ke} ${Qe}`.localeCompare(`${ee} ${Mn}`):`${Qe} ${ke}`.localeCompare(`${Mn} ${ee}`)});return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Wl(a.id,y.map(te=>te.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>Mf(a.id),children:"Reset Today"})]}),i.jsx("div",{className:"space-y-2",children:ne.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students found."}):ne.map(te=>le(te,F?P.get(String(te.id)):null,F))})]})}return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Wl(a.id,y.map(P=>P.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>Mf(a.id),children:"Reset Today"})]}),L.map(P=>{const F=P.students.filter(te=>V[te.id]!=="absent").map(te=>te.id),ne=P.name.replace("Table","").trim()||P.name;return i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200 gap-3",children:[i.jsxs("div",{className:"flex flex-col leading-tight text-center min-w-[54px]",children:[i.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Table"}),i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:ne})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Wl(a.id,P.students.map(te=>te.id)),children:"Mark Rest Present"}),a.pointsEnabled&&i.jsx("button",{className:"text-[11px] rounded bg-amber-600 text-white px-3 py-2 font-semibold",onClick:()=>{jl(null),kl(0),Ta(""),oo({periodId:a.id,tableName:P.name,studentIds:F})},children:"Table Points"})]})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:P.students.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students assigned."}):P.students.map(te=>le(te))})]},P.id)}),i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Unassigned"}),i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Wl(a.id,C.map(P=>P.id)),children:"Mark Rest Present"})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:C.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No unassigned students."}):C.map(P=>le(P))})]})]})})():i.jsx("p",{className:"text-sm text-slate-500",children:"Load and select a period to begin."})]}),ls&&i.jsx(jb,{open:!0,studentId:ls.id,studentFullName:ls.fullName,existingPhotoFileId:ls.photoFileId,onClose:()=>Xd(null),onAccept:a=>{const p=ls.id;if(!p)return;const y=URL.createObjectURL(a);B0(x=>{const v=x[p];return v&&URL.revokeObjectURL(v),{...x,[p]:y}})},onUploadComplete:({fileId:a,photoUpdatedAt:p})=>{const y=ls.id;O(x=>x&&{...x,students:x.students.map(v=>v.id===y?{...v,photoFileId:a,photoUpdatedAt:p}:v)}),Ie(),rt({silent:!0})}}),_r&&i.jsx(M0,{open:!0,studentId:_r.id,studentFullName:_r.fullName,existingAudioFileId:_r.audioFileId,existingAudioUpdatedAt:_r.audioUpdatedAt,driveSession:l,onClose:()=>Zd(null),onUploadComplete:({fileId:a,audioUpdatedAt:p})=>{const y=_r.id;O(x=>x&&{...x,students:x.students.map(v=>v.id===y?{...v,audioFileId:a,audioUpdatedAt:p}:v)}),Ie(),rt({silent:!0})},onDeleteComplete:()=>{const a=_r.id;O(p=>p&&{...p,students:p.students.map(y=>y.id===a?{...y,audioFileId:null,audioUpdatedAt:null}:y)}),Ie(),rt({silent:!0})}}),lf&&Jn&&i.jsx(ta,{isOpen:!0,onRequestClose:Ol,title:"Edit Student",maxWidth:"md",showCloseX:!0,footer:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:Ol,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:()=>{const a=Jn.name.trim();if(!a||!Jn.periodId){alert("Name and period are required.");return}const p=lf.id;O(y=>y&&{...y,students:y.students.map(x=>String(x.id)===String(p)?{...x,fullName:a,gender:Jn.gender,periodIds:[String(Jn.periodId)],profileUpdatedAt:new Date().toISOString()}:x)}),Ie(),rt({silent:!0}),Ol()},children:"Save"})]}),children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Full Name"}),i.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:Jn.name,onChange:a=>lo(p=>p&&{...p,name:a.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Gender"}),i.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Jn.gender,onChange:a=>lo(p=>p&&{...p,gender:a.target.value}),children:[i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"O",children:"Other/Prefer not"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Class Period"}),i.jsx("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Jn.periodId,onChange:a=>lo(p=>p&&{...p,periodId:a.target.value}),children:((N==null?void 0:N.periods)||[]).map(a=>i.jsx("option",{value:String(a.id),children:a.name},String(a.id)))})]})]})}),xe&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center px-4",onClick:()=>Nt(null),children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-4 w-full max-w-sm space-y-3",onClick:a=>a.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:xe.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Actions"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{type:"button",className:"rounded-md p-1 text-slate-600 hover:text-slate-800",onClick:()=>{Nt(null),sy(xe.id)},"aria-label":"Edit student",children:""}),i.jsx("button",{type:"button",className:"rounded-md p-1 text-rose-600 hover:text-rose-700",onClick:()=>oy(xe.id),"aria-label":"Delete student",children:""}),i.jsx("button",{className:"rounded-md p-1 text-slate-500 hover:text-slate-700",onClick:()=>Nt(null),children:""})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:ly.map(a=>i.jsx("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{nt&&qa(nt,xe.id,a),Nt(null)},children:Pf(a)},a))}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{className:"w-full rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{nt&&gy(nt,xe.id,xe.name),Nt(null)},children:" Notes and Points"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:`rounded-lg border px-2 py-2 text-xs text-left ${Xa&&yo?"border-slate-200 text-slate-700 hover:bg-slate-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:()=>{Ny()},disabled:!Xa||!yo,children:df?" Pause audio":" Play audio"}),i.jsxs("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{const a=N==null?void 0:N.students.find(p=>String(p.id)===String(xe.id));Zd({id:xe.id,fullName:xe.name,audioFileId:(a==null?void 0:a.audioFileId)??null,audioUpdatedAt:(a==null?void 0:a.audioUpdatedAt)??null}),Nt(null)},children:[" ",Xa?"Re-record audio":"Record audio"]})]})]}),i.jsx("audio",{ref:us,src:yo||void 0,onEnded:()=>cs(!1),onPause:()=>cs(!1)}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{nt&&xe&&Lf(nt,xe.id,1),Nt(null)},children:[""," +1 counter ",typeof zf=="number"?`(${zf})`:""]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{nt&&xe&&Lf(nt,xe.id,-1),Nt(null)},children:[""," -1 counter"]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{nt&&xe&&py(nt,xe.id),Nt(null)},children:[""," Reset counter"]}),i.jsx("button",{className:"w-full rounded-lg border border-rose-200 px-2 py-2 text-xs text-left hover:bg-rose-50 text-rose-700",onClick:()=>{nt&&xe&&Ja(nt,xe.id,"absent"),Nt(null)},children:" Reset absence streak"}),i.jsx("button",{className:"w-full rounded-lg border border-amber-200 px-2 py-2 text-xs text-left hover:bg-amber-50 text-amber-700",onClick:()=>{nt&&xe&&Ja(nt,xe.id,"tardy"),Nt(null)},children:" Reset tardy counter"}),i.jsx("button",{className:"w-full rounded-lg border border-orange-200 px-2 py-2 text-xs text-left hover:bg-orange-50 text-orange-700",onClick:()=>{nt&&xe&&Ja(nt,xe.id,"leftEarly"),Nt(null)},children:" Reset left early counter"})]}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>Nt(null),children:"Close"})]})}),Cl&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Tr(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"About this badge"}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Tr(null),children:""})]}),Cl==="absent"?i.jsx("p",{className:"text-sm text-slate-700",children:"A# is total absences since reset. S# is the latest absence streak ending on the most recent marked day (unmarked days are skipped)."}):Cl==="leftEarly"?i.jsx("p",{className:"text-sm text-slate-700",children:"LE# shows the left early count since the last reset."}):Cl==="custom"?i.jsxs("p",{className:"text-sm text-slate-700",children:["","# is your custom teacher counter since the last reset."]}):i.jsx("p",{className:"text-sm text-slate-700",children:"T# shows the tardy count since the last reset."}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>Tr(null),children:"Got it"})]})]}),hn&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>at(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:["Behavior for ",hn.studentName]}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Today  Points ",Ve.pointsEnabled?`${Ga(Ve.currentPoints,Ve.startingPoints)} ${Ve.currentPoints}`:"disabled"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>at(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:bt.note,onChange:a=>gn(p=>({...p,note:a.target.value})),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:4,placeholder:"Enter behavior note...",autoFocus:!0,onMouseDown:a=>a.stopPropagation(),onClick:a=>a.stopPropagation()}),i.jsx("div",{className:"flex flex-wrap gap-2",children:[" Excellent participation"," Needs redirection"," Academic progress"," Positive peer interactions"].map(a=>i.jsx("button",{onClick:()=>gn(p=>({...p,note:p.note?p.note+" "+a:a})),className:"text-[11px] px-2.5 py-1 rounded-lg bg-slate-100 hover:bg-slate-200 border border-slate-200 text-slate-700",children:a},a))})]}),Ve.pointsEnabled&&i.jsxs("div",{className:"space-y-3 border border-slate-200 rounded-xl p-3 bg-slate-50",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Points"}),i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsxs("span",{children:[Ga(Ve.currentPoints,Ve.startingPoints)," ",Ve.currentPoints]}),i.jsx("span",{className:"text-slate-400",children:""}),i.jsxs("span",{children:[Ga(Math.max(0,Ve.currentPoints+bt.delta),Ve.startingPoints)," ",Math.max(0,Ve.currentPoints+bt.delta)]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,0,-1,-2].map(a=>i.jsx("button",{onClick:()=>gn(p=>({...p,delta:a,reason:p.reason})),className:`px-3 py-1.5 rounded border text-sm font-semibold ${bt.delta===a?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-700 border-slate-300 hover:bg-indigo-50"}`,children:a>0?`+${a}`:a},a)),i.jsx("button",{onClick:()=>{const a=prompt("Enter custom point change:",String(bt.delta));if(a===null)return;const p=parseInt(a,10);Number.isNaN(p)||gn(y=>({...y,delta:p,reason:y.reason}))},className:"px-3 py-1.5 rounded border text-sm font-semibold bg-white text-slate-700 border-slate-300 hover:bg-indigo-50",children:"Custom"})]}),bt.delta!==0&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Reason (required)"}),i.jsx("input",{value:bt.reason,onChange:a=>gn(p=>({...p,reason:a.target.value})),className:"w-full border border-slate-300 rounded px-2 py-1 text-sm",placeholder:"Enter reason for point change"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:hy,children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>at(null),children:"Cancel"})]})]})]}),Ra&&N&&(()=>{const a=N.students.find(p=>p.id===Ra.studentId);return a?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>so(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Quick Note"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>so(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:Qd,onChange:p=>Jd(p.target.value),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:5,placeholder:"Add a quick note...",autoFocus:!0,onMouseDown:p=>p.stopPropagation(),onClick:p=>p.stopPropagation()})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:()=>{const p=Ra.studentId,y=Qd;O(x=>x&&{...x,students:x.students.map(v=>v.id===p?{...v,quickNote:y,quickNoteUpdatedAt:new Date().toISOString()}:v)}),Zn.current+=1,An(!0),Ye(!0),Lr.current=Date.now(),rt({silent:!0}),so(null)},children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>so(null),children:"Cancel"})]})]})]}):null})(),qd&&N&&(()=>{const a=N.students.find(v=>v.id===qd.studentId);if(!a)return null;const p=N.periods.find(v=>v.id===ut),x=(a.docs||[]).slice().sort((v,C)=>{if(v.pinned&&!C.pinned)return-1;if(!v.pinned&&C.pinned)return 1;const E=v.createdAt?new Date(v.createdAt).getTime():0;return(C.createdAt?new Date(C.createdAt).getTime():0)-E});return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Nl(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Student Docs"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Nl(null),children:""})]}),i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-xs text-slate-500",children:"Tap a doc to open it in Google Docs."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"To protect privacy, ClassSeats can only see the documents it helps create."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"All documents are created in the ClassSeats/Student Docs folder in your Google Drive."})]}),i.jsx("button",{className:"rounded-lg bg-emerald-600 text-white text-xs font-semibold px-3 py-2 disabled:opacity-50",disabled:!n.canUseDriveSync,onClick:async()=>{if(n.canUseDriveSync)try{const v=await Ae(!0,"studentDocCreate");if(!v)return;const C=(p==null?void 0:p.name)||"Period",E=`Notes - ${a.fullName} - ${C} ${uy(new Date)}`,L=window.prompt("Name this Doc:",E);if(!L||!L.trim())return;const V=L.trim(),A=await iS(v.accessToken),K=await cS(v.accessToken,A,V),W=new Date().toISOString(),le={id:ay(),driveFileId:K.fileId,title:K.title||V,createdAt:W,lastOpenedAt:W};O(P=>P&&{...P,students:P.students.map(F=>F.id===a.id?{...F,docs:[...F.docs||[],le]}:F)}),Zn.current+=1,An(!0),Ye(!0),Lr.current=Date.now(),Qa(Ya(K.fileId))}catch(v){ct((v==null?void 0:v.message)||"Unable to create Google Doc.")}},children:"+ New Doc"})]}),i.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2",children:x.length===0?i.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3 text-sm text-slate-600",children:"No Docs yet."}):x.map(v=>i.jsx("button",{className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",onClick:C=>{C.preventDefault(),C.stopPropagation(),Qa(Ya(v.driveFileId))},children:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{className:"font-semibold text-slate-900",children:v.title}),v.pinned&&i.jsx("span",{className:"text-[10px] font-semibold text-emerald-700 bg-emerald-100 px-2 py-0.5 rounded-full",children:"PINNED"})]})},v.id))}),i.jsx("button",{className:"w-full rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>Nl(null),children:"Close"})]})]})})(),!N&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"No class file loaded yet."}),i.jsx("p",{className:"text-sm text-slate-600",children:"To take attendance or track points, open a class file from your Google Drive."}),i.jsx("button",{className:"w-full rounded-lg bg-emerald-600 text-white font-semibold py-2",onClick:()=>{if(s){T(o);return}return l?Te(!0):void Ae(!0,"empty-state")},disabled:s,title:s?o:void 0,children:"Manage Files"})]}),Qn&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>oo(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:Qn.tableName}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Apply points to ",Qn.studentIds.length," present student",Qn.studentIds.length===1?"":"s"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>oo(null),children:""})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note (required)"}),i.jsx("textarea",{className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Describe why youre adjusting points",value:rf,onChange:a=>Ta(a.target.value),rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Choose points"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,-1,-2].map(a=>{const p=nf===a;return i.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm font-semibold border ${p?"bg-amber-600 text-white border-amber-600":"bg-white text-amber-800 border-amber-300"}`,onClick:()=>{jl(a),kl(0)},children:[a>0?`+${a}`:a," pts"]},a)}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"number",className:"w-24 rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Custom",value:tf,onFocus:()=>jl(null),onChange:a=>kl(Number(a.target.value)||0)})})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-amber-600 text-white font-semibold py-2",onClick:()=>{const a=rf.trim(),p=nf??tf;if(!a){ct("Enter a note for the point change.");return}if(!p){ct("Select a point value.");return}my(Qn.periodId,Qn.studentIds,p,a),jl(null),kl(0),Ta(""),oo(null)},children:"Apply"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>oo(null),children:"Cancel"})]}),i.jsx("p",{className:"text-[11px] text-slate-500",children:"Only present students at this table receive the adjustment. Absent students are skipped."}),(()=>{const a=(Ce[Qn.periodId]||[]).filter(y=>{var x;return((x=y.date)==null?void 0:x.startsWith(oe))&&Qn.studentIds.includes(String(y.studentId))});if(a.length===0)return null;const p=y=>{var x;return((x=N==null?void 0:N.students.find(v=>String(v.id)===String(y)))==null?void 0:x.fullName)||`Student ${y}`};return i.jsxs("div",{className:"border-t border-slate-200 pt-2 space-y-1",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Todays table adjustments"}),i.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:a.map((y,x)=>i.jsxs("div",{className:"text-xs text-slate-700 flex justify-between",children:[i.jsx("span",{className:"font-semibold",children:p(y.studentId)}),i.jsxs("span",{children:[y.delta>0?"+":"",y.delta,"  ",y.reason||"No note"]})]},`${y.studentId}-${x}`))})]})})()]})]})]}),Oe&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:$f?()=>{Te(!1),ht(!1)}:void 0}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Select Your ClassSeats File"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Choose the file you use on desktop to continue."})]}),i.jsxs("div",{ref:cf,className:"relative flex items-center gap-3",children:[l&&i.jsx("button",{type:"button",className:"text-slate-600 hover:text-slate-800 text-sm font-semibold px-2 py-1 rounded-lg border border-slate-200","aria-label":"More actions",onClick:()=>ht(a=>!a),children:"More"}),$f&&i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>{Te(!1),ht(!1)},children:""}),Kt&&l&&i.jsxs("div",{className:"absolute right-0 top-8 min-w-[220px] rounded-xl border border-slate-200 bg-white shadow-lg p-1 z-10 text-sm",children:[i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-slate-800",onClick:()=>{ht(!1),yy()},children:"Sign out of Google Drive"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 disabled:text-slate-400 disabled:hover:bg-transparent text-rose-700",disabled:!I,onClick:()=>{ht(!1),vy()},children:"Delete active class file"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-rose-700",onClick:xy,children:"Clear local ClassSeats data (this device)"})]})]})]}),s?i.jsx("div",{className:"space-y-2 text-sm text-rose-700",children:i.jsx("p",{children:o})}):l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-600",children:i.jsxs("div",{children:[i.jsxs("p",{children:["Signed in as: ",i.jsx("span",{className:"font-semibold text-slate-900",children:((Kf=l.profile)==null?void 0:Kf.email)||"your account"})]}),i.jsxs("p",{children:["Current file: ",i.jsx("span",{className:"font-semibold text-slate-900",children:(I==null?void 0:I.name)||(D==null?void 0:D.name)||"None selected"})]})]})}),_m,i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Your files"}),i.jsx("button",{type:"button","aria-label":"Refresh file list",className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>void Hl(!0),children:""})]}),i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-3 max-h-64 overflow-auto space-y-2",children:[g&&i.jsx("p",{className:"text-sm text-slate-500",children:"Loading Drive files"}),S&&i.jsx("p",{className:"text-sm text-rose-600",children:S}),!S&&k&&i.jsx("p",{className:"rounded-lg border border-amber-200 bg-amber-50 px-2 py-1 text-sm text-amber-800",children:k}),!g&&!S&&c.length===0&&i.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[i.jsx("p",{className:"font-semibold",children:"No ClassSeats files found yet."}),i.jsx("p",{className:"text-slate-500",children:"Create your class file on desktop first, then tap refresh."})]}),!g&&!S&&c.length>0&&c.map(a=>{const p=(D==null?void 0:D.id)===a.id,y=(I==null?void 0:I.id)===a.id;return i.jsxs("button",{className:`w-full text-left rounded-xl border px-3 py-2 transition ${p?"border-indigo-400 bg-indigo-50 text-indigo-900":y?"border-emerald-400 bg-emerald-50 text-emerald-900":"border-slate-200 bg-white hover:bg-slate-100"}`,onClick:()=>Be(a),children:[i.jsx("p",{className:"text-sm font-semibold",children:a.name}),i.jsxs("p",{className:"text-[11px] text-slate-500",children:["Updated ",a.modifiedTime?new Date(a.modifiedTime).toLocaleString():"",a.size?`  ${(Number(a.size)/1024).toFixed(1)} KB`:""]}),y&&i.jsx("p",{className:"text-[11px] text-emerald-700 font-semibold",children:"Active"})]},a.id)})]}),i.jsx("button",{className:"w-full rounded-2xl bg-emerald-600 text-white font-semibold py-2 disabled:opacity-50",onClick:by,disabled:!D||X,children:X?"Loading":Ty})]})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm text-slate-700",children:"Hi! you need a Class File already set up in your Google Drive to access mobile. Let's get you connected."}),i.jsx("button",{className:"w-full rounded-2xl bg-indigo-600 text-white font-semibold py-2",onClick:()=>{Ae(!0)},children:"Connect to Google Drive"})]})]})]})]})]}),i.jsx("div",{className:"fixed inset-x-0 bottom-0 px-4 pb-[env(safe-area-inset-bottom)]",children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow-lg px-4 py-3 flex flex-wrap items-center gap-2 text-xs text-slate-700",children:[i.jsxs("div",{className:"flex-1 min-w-[180px]",children:[i.jsx("p",{className:"font-semibold text-slate-900",children:Ar?"Saving":El?`Synced ${new Date(El).toLocaleTimeString()}`:"Ready"}),i.jsxs("p",{className:"text-[11px] text-slate-500 truncate",children:[l?((Gf=l.profile)==null?void 0:Gf.email)||"Signed in":"Not signed in"," "," ",(I==null?void 0:I.name)||(D==null?void 0:D.name)||"No file selected",he&&"  Offline"]}),qn&&i.jsx("p",{className:"text-[11px] text-amber-700",children:"Pending sync"})]}),i.jsxs("div",{className:"flex w-full items-center gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded-full bg-violet-600 text-white px-3 py-2 text-xs font-semibold disabled:opacity-50 flex-none hover:bg-violet-700",disabled:!l||!I,onClick:()=>void rt(),children:"Sync Now"}),i.jsx("button",{className:"rounded-full border border-slate-900 bg-white text-slate-900 px-3 py-2 text-xs font-semibold flex-none hover:bg-slate-100",onClick:()=>l?Te(!0):void Ae(!0,"cta"),children:"Open Files"})]}),i.jsxs("button",{type:"button",onClick:cy,className:"relative ml-auto inline-flex h-9 w-9 items-center justify-center rounded-full bg-slate-100 text-slate-700 hover:bg-slate-200 flex-none",title:"Messages","aria-label":"Messages",children:[i.jsx("span",{"aria-hidden":!0,className:"text-2xl leading-none",children:""}),gt>0&&i.jsx("span",{className:"absolute -top-1 -right-1 inline-flex min-w-[16px] items-center justify-center rounded-full bg-violet-600 text-white px-1 py-0.5 text-[10px] font-semibold",children:gt})]})]})]})}),i.jsx(ta,{isOpen:Q,onRequestClose:()=>{},title:"ClassSeats Folder Found In Trash",subtitle:"Restore your ClassSeats folder in Google Drive Trash to access your existing class files.",maxWidth:"md",footer:i.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[i.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:wy,children:"Open Google Drive Trash"}),i.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:Sy,children:"Start Fresh Instead"}),i.jsx("button",{type:"button",className:"rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-500",onClick:()=>{h(!1),Hl(!0,!0)},children:"I restored it, refresh files"})]}),children:i.jsxs("div",{className:"space-y-3 text-sm text-slate-700",children:[i.jsxs("p",{children:["We found a trashed ",i.jsx("strong",{children:"ClassSeats"})," folder in your Drive. Your existing files may be inside it."]}),i.jsx("p",{children:"Restore the folder first, or choose Start Fresh to intentionally begin with a new file."}),m!=null&&m.trashedFolderCount?i.jsxs("p",{className:"text-xs text-slate-500",children:["Trashed ClassSeats folders detected: ",m.trashedFolderCount]}):null,m!=null&&m.trashedFolderWithDataCount?i.jsxs("p",{className:"text-xs text-slate-500",children:["Trashed folders with contents: ",m.trashedFolderWithDataCount]}):null,m!=null&&m.hasMultipleActiveManagedFolders?i.jsxs("p",{className:"text-xs text-slate-500",children:["Active ClassSeats folders detected: ",m.activeFolderCount]}):null]})}),i.jsx(U1,{isOpen:St,onRequestClose:dy,unreadMessages:He,allMessages:fn,dismissedIds:ae,onDismiss:fy}),i.jsx(M1,{open:Yn,onClose:()=>fe(!1),buildRevision:Tm}),i.jsx(ub,{open:_y,onBypass:Ay})]}),he&&i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-4 text-center space-y-2 text-slate-900",children:[i.jsx("p",{className:"text-base font-semibold",children:"Mobile paused while offline"}),i.jsx("p",{className:"text-sm text-slate-600",children:"Edits are disabled while offline. Reconnect to resume."}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Last sync: ",El?new Date(El).toLocaleTimeString():"No sync yet"]})]})})]})})}function Fb({toasts:e}){return i.jsx("div",{className:"fixed right-4 top-4 z-[1000] flex w-[320px] max-w-[calc(100vw-2rem)] flex-col gap-2",children:e.map(t=>{const n=t.kind==="success"?"border-emerald-200 bg-emerald-50 text-emerald-900":t.kind==="error"?"border-rose-200 bg-rose-50 text-rose-900":t.kind==="warning"?"border-amber-200 bg-amber-50 text-amber-900":"border-slate-200 bg-slate-50 text-slate-800",r=t.kind==="success"?"":t.kind==="error"?"":t.kind==="warning"?"":"";return i.jsx("div",{className:`rounded-xl border px-3 py-2 shadow-sm ${n}`,children:i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx("span",{"aria-hidden":"true",children:r}),i.jsx("div",{className:"leading-snug",children:t.message})]})},t.id)})})}function Ub({open:e,opts:t,onCancel:n,onConfirm:r}){if(!e||!t)return null;const s=t.tone??"default",o=t.confirmText??"Confirm",l=t.cancelText===null,u=t.cancelText??"Cancel",c=s==="danger"?"bg-rose-600 hover:bg-rose-700 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 flex items-center justify-end gap-2",children:[!l&&i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:`rounded-xl px-4 py-2 text-sm font-semibold ${c}`,onClick:r,children:o})]})]})})}function zb({open:e,opts:t,onCancel:n,onConfirm:r}){const[s,o]=d.useState("");if(d.useEffect(()=>{e&&t&&o(t.defaultValue??"")},[e,t]),!e||!t)return null;const l=t.confirmText??"OK",u=t.cancelText??"Cancel",c=t.inputType??"text";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),t.message&&i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 space-y-3",children:[i.jsx("input",{autoFocus:!0,type:c,value:s,onChange:f=>o(f.target.value),placeholder:t.placeholder??"",className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"}),i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700",onClick:()=>r(s),children:l})]})]})]})})}function $b(){return Math.random().toString(16).slice(2)+Date.now().toString(16)}function Bb({children:e}){const[t,n]=d.useState([]),r=d.useRef(null),[s,o]=d.useState(!1),[l,u]=d.useState(null),c=d.useRef(null),[f,g]=d.useState(!1),[w,S]=d.useState(null),R=d.useCallback((h,m,b=2500)=>{const _=$b(),T={id:_,kind:h,message:m,durationMs:b};n($=>[...$,T]),window.setTimeout(()=>{n($=>$.filter(B=>B.id!==_))},b)},[]),k=d.useCallback(h=>(u(h),o(!0),new Promise(m=>{r.current=m})),[]),j=d.useCallback(h=>(S(h),g(!0),new Promise(m=>{c.current=m})),[]),Q=d.useMemo(()=>({toast:R,confirm:k,prompt:j}),[R,k,j]);return i.jsxs(bw.Provider,{value:Q,children:[e,i.jsx(Fb,{toasts:t}),i.jsx(Ub,{open:s,opts:l,onCancel:()=>{o(!1);const h=r.current;r.current=null,h==null||h(!1)},onConfirm:()=>{o(!1);const h=r.current;r.current=null,h==null||h(!0)}}),i.jsx(zb,{open:f,opts:w,onCancel:()=>{g(!1);const h=c.current;c.current=null,h==null||h(null)},onConfirm:h=>{g(!1);const m=c.current;c.current=null,m==null||m(h)}})]})}const br={waiting:!1,registration:null},Uc=new Set;let Mm=null;const zc="cs_sw_update_requested_v1",Wb=2*60*1e3;function U0(){for(const e of Uc)e({...br})}function Om(e){e&&Mm===e||(e&&(Mm=e),!br.waiting&&(br.waiting=!0,U0()))}function Hb(e){return Uc.add(e),e({...br}),()=>{Uc.delete(e)}}async function Vb(){var e,t,n;if("serviceWorker"in navigator&&!window.__cs_sw_registered){window.__cs_sw_registered=!0;try{const o=await navigator.serviceWorker.register("/service-worker.js?rev=365601b626477f1fe8c8ab7983369cd73f949dd0",{updateViaCache:"none"});br.registration=o;const l=()=>{try{const f=window.sessionStorage.getItem(zc);if(!f)return!1;const g=Number(f);if(!Number.isFinite(g))return!1;const w=Date.now()-g<Wb;return w||window.sessionStorage.removeItem(zc),w}catch{return!1}};if(o.waiting&&navigator.serviceWorker.controller){const f=l();console.info("[PWA] waiting SW detected",{active:(e=o.active)==null?void 0:e.scriptURL,waiting:(t=o.waiting)==null?void 0:t.scriptURL,controller:(n=navigator.serviceWorker.controller)==null?void 0:n.scriptURL,updateRequested:f}),f?o.waiting.postMessage({type:"SKIP_WAITING"}):Om(o.waiting.scriptURL)}o.addEventListener("updatefound",()=>{const f=o.installing;f&&f.addEventListener("statechange",()=>{var g,w,S,R;if(f.state==="installed"&&navigator.serviceWorker.controller){const k=l();console.info("[PWA] SW installed update",{active:(g=o.active)==null?void 0:g.scriptURL,waiting:(w=o.waiting)==null?void 0:w.scriptURL,installing:f.scriptURL,controller:(S=navigator.serviceWorker.controller)==null?void 0:S.scriptURL,updateRequested:k}),k?(R=o.waiting)==null||R.postMessage({type:"SKIP_WAITING"}):Om(f.scriptURL)}})});const u=()=>{br.waiting||o.update().catch(()=>{})};window.addEventListener("focus",u),window.setInterval(u,6e4),U0();let c=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{c||(c=!0,br.waiting=!1,window.location.reload())})}catch(r){console.warn("[PWA] SW registration failed",r)}}}async function Kb(){var t,n,r;const e=br.registration;if(e!=null&&e.waiting){console.info("[PWA] activate update",{active:(t=e.active)==null?void 0:t.scriptURL,waiting:(n=e.waiting)==null?void 0:n.scriptURL,controller:(r=navigator.serviceWorker.controller)==null?void 0:r.scriptURL});try{window.sessionStorage.setItem(zc,String(Date.now()))}catch{}e.waiting.postMessage({type:"SKIP_WAITING"})}}function Gb(){const[e,t]=d.useState({waiting:!1,registration:null});return d.useEffect(()=>Hb(t),[]),e.waiting?i.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-[9999]",children:i.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-slate-900 text-white px-4 py-3 shadow-xl",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Update available"}),i.jsx("button",{className:"rounded-xl bg-white/15 hover:bg-white/25 px-3 py-1 text-sm font-semibold",onClick:async()=>{await Kb()},children:"Refresh"})]})}):null}const Yb=["classseats_","classseats.","newui_"],Qb=new Set(["attendance:lastDate"]),Jb=["classseats_auth","classseats-cache"],Fu={border:"1px solid #cbd5e1",borderRadius:"10px",padding:"10px 14px",background:"#ffffff",color:"#0f172a",fontWeight:600,cursor:"pointer"};function qb(){try{const e=[];for(let t=0;t<window.localStorage.length;t+=1){const n=window.localStorage.key(t);if(!n)continue;(Yb.some(s=>n.startsWith(s))||Qb.has(n))&&e.push(n)}for(const t of e)window.localStorage.removeItem(t)}catch{}}function Xb(){try{window.sessionStorage.clear()}catch{}}function Zb(){return"indexedDB"in window?Promise.all(Jb.map(e=>new Promise(t=>{try{const n=window.indexedDB.deleteDatabase(e);n.onsuccess=()=>t(),n.onerror=()=>t(),n.onblocked=()=>t()}catch{t()}}))).then(()=>{}):Promise.resolve()}async function eN(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(t=>t.unregister()))}catch{}}async function tN(){if("caches"in window)try{const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t)))}catch{}}function Fm(){window.location.reload()}class nN extends Ds.Component{constructor(){super(...arguments),this.state={hasError:!1,details:""},this.onReload=()=>{Fm()},this.onRefresh=async()=>{await eN(),await tN(),Fm()},this.onRestart=async()=>{window.confirm("Restart will clear local ClassSeats data on this device, then reload the app. Continue?")&&(qb(),Xb(),await Zb(),await this.onRefresh())}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t){const n=t instanceof Error?t.message:String(t||"Unknown error");this.setState({details:n})}render(){return this.state.hasError?i.jsx("div",{role:"alert",style:{minHeight:"100dvh",display:"grid",placeItems:"center",background:"#f8fafc",color:"#0f172a",padding:"24px"},children:i.jsxs("div",{style:{width:"100%",maxWidth:"560px",background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"14px",padding:"20px",boxShadow:"0 10px 30px rgba(15, 23, 42, 0.08)"},children:[i.jsx("h1",{style:{margin:"0 0 8px",fontSize:"1.1rem"},children:"Oops - the most recent update did not install properly. This happens sometimes. Sorry! "}),i.jsx("p",{style:{margin:"0 0 12px",lineHeight:1.45},children:"Try the buttons below, in order, to try to get things running again."}),i.jsx("p",{style:{margin:"0 0 16px",lineHeight:1.45,color:"#334155"},children:"If that does not work, delete the shortcut on your home screen, go to mobile.classseats.app, and add a new shortcut to your home screen."}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsx("button",{type:"button",onClick:this.onReload,style:Fu,children:"Reload"}),i.jsx("button",{type:"button",onClick:this.onRefresh,style:Fu,children:"Refresh"}),i.jsx("button",{type:"button",onClick:this.onRestart,style:Fu,children:"Restart"})]}),this.state.details?i.jsxs("p",{style:{margin:"12px 0 0",fontSize:"0.86rem",color:"#475569"},children:["Error details: ",this.state.details]}):null]})}):this.props.children}}const rN=document.getElementById("root"),Um="cs_chunk_recovery";function sN(){window.__cs_boot_mounted=!0,window.dispatchEvent(new Event("classseats:boot-mounted"))}function oN(){return Ds.useEffect(()=>{sN()},[]),null}function z0(e){if(!e)return!1;const t=typeof e=="string"?e:typeof e.message=="string"?e.message:"";return t.includes("Loading chunk")||t.includes("ChunkLoadError")||t.includes("Failed to fetch dynamically imported module")||t.includes("Importing a module script failed")}function $0(){sessionStorage.getItem(Um)||(sessionStorage.setItem(Um,"1"),"serviceWorker"in navigator?navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(t=>t.unregister()))).finally(()=>window.location.reload()):window.location.reload())}async function lN(){}window.addEventListener("error",e=>{z0(e.error||e.message)&&$0()});window.addEventListener("unhandledrejection",e=>{z0(e.reason)&&$0()});(async()=>{await lN(),Uu.createRoot(rN).render(i.jsx(Ds.StrictMode,{children:i.jsx(nN,{children:i.jsx(d1,{children:i.jsxs(Bb,{children:[i.jsx(oN,{}),i.jsx(Ob,{}),i.jsx(Gb,{})]})})})})),Vb()})();
