(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function gy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Im={exports:{}},ra={},Dm={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=Symbol.for("react.element"),yy=Symbol.for("react.portal"),xy=Symbol.for("react.fragment"),vy=Symbol.for("react.strict_mode"),wy=Symbol.for("react.profiler"),Sy=Symbol.for("react.provider"),by=Symbol.for("react.context"),Ny=Symbol.for("react.forward_ref"),ky=Symbol.for("react.suspense"),jy=Symbol.for("react.memo"),Cy=Symbol.for("react.lazy"),Ff=Symbol.iterator;function Ey(e){return e===null||typeof e!="object"?null:(e=Ff&&e[Ff]||e["@@iterator"],typeof e=="function"?e:null)}var Lm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Om=Object.assign,Mm={};function Xs(e,t,n){this.props=e,this.context=t,this.refs=Mm,this.updater=n||Lm}Xs.prototype.isReactComponent={};Xs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Um(){}Um.prototype=Xs.prototype;function Lc(e,t,n){this.props=e,this.context=t,this.refs=Mm,this.updater=n||Lm}var Oc=Lc.prototype=new Um;Oc.constructor=Lc;Om(Oc,Xs.prototype);Oc.isPureReactComponent=!0;var zf=Array.isArray,Fm=Object.prototype.hasOwnProperty,Mc={current:null},zm={key:!0,ref:!0,__self:!0,__source:!0};function $m(e,t,n){var r,s={},o=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(o=""+t.key),t)Fm.call(t,r)&&!zm.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var c=Array(u),f=0;f<u;f++)c[f]=arguments[f+2];s.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:gl,type:e,key:o,ref:l,props:s,_owner:Mc.current}}function _y(e,t){return{$$typeof:gl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uc(e){return typeof e=="object"&&e!==null&&e.$$typeof===gl}function Ry(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var $f=/\/+/g;function Ya(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ry(""+e.key):t.toString(36)}function di(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case gl:case yy:l=!0}}if(l)return l=e,s=s(l),e=r===""?"."+Ya(l,0):r,zf(s)?(n="",e!=null&&(n=e.replace($f,"$&/")+"/"),di(s,t,n,"",function(f){return f})):s!=null&&(Uc(s)&&(s=_y(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace($f,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=r===""?".":r+":",zf(e))for(var u=0;u<e.length;u++){o=e[u];var c=r+Ya(o,u);l+=di(o,t,n,c,s)}else if(c=Ey(e),typeof c=="function")for(e=c.call(e),u=0;!(o=e.next()).done;)o=o.value,c=r+Ya(o,u++),l+=di(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Hl(e,t,n){if(e==null)return e;var r=[],s=0;return di(e,r,"","",function(o){return t.call(n,o,s++)}),r}function Ty(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Et={current:null},fi={transition:null},Ay={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:fi,ReactCurrentOwner:Mc};function Bm(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Hl,forEach:function(e,t,n){Hl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Hl(e,function(){t++}),t},toArray:function(e){return Hl(e,function(t){return t})||[]},only:function(e){if(!Uc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ae.Component=Xs;ae.Fragment=xy;ae.Profiler=wy;ae.PureComponent=Lc;ae.StrictMode=vy;ae.Suspense=ky;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ay;ae.act=Bm;ae.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Om({},e.props),s=e.key,o=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,l=Mc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)Fm.call(t,c)&&!zm.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&u!==void 0?u[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];r.children=u}return{$$typeof:gl,type:e.type,key:s,ref:o,props:r,_owner:l}};ae.createContext=function(e){return e={$$typeof:by,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Sy,_context:e},e.Consumer=e};ae.createElement=$m;ae.createFactory=function(e){var t=$m.bind(null,e);return t.type=e,t};ae.createRef=function(){return{current:null}};ae.forwardRef=function(e){return{$$typeof:Ny,render:e}};ae.isValidElement=Uc;ae.lazy=function(e){return{$$typeof:Cy,_payload:{_status:-1,_result:e},_init:Ty}};ae.memo=function(e,t){return{$$typeof:jy,type:e,compare:t===void 0?null:t}};ae.startTransition=function(e){var t=fi.transition;fi.transition={};try{e()}finally{fi.transition=t}};ae.unstable_act=Bm;ae.useCallback=function(e,t){return Et.current.useCallback(e,t)};ae.useContext=function(e){return Et.current.useContext(e)};ae.useDebugValue=function(){};ae.useDeferredValue=function(e){return Et.current.useDeferredValue(e)};ae.useEffect=function(e,t){return Et.current.useEffect(e,t)};ae.useId=function(){return Et.current.useId()};ae.useImperativeHandle=function(e,t,n){return Et.current.useImperativeHandle(e,t,n)};ae.useInsertionEffect=function(e,t){return Et.current.useInsertionEffect(e,t)};ae.useLayoutEffect=function(e,t){return Et.current.useLayoutEffect(e,t)};ae.useMemo=function(e,t){return Et.current.useMemo(e,t)};ae.useReducer=function(e,t,n){return Et.current.useReducer(e,t,n)};ae.useRef=function(e){return Et.current.useRef(e)};ae.useState=function(e){return Et.current.useState(e)};ae.useSyncExternalStore=function(e,t,n){return Et.current.useSyncExternalStore(e,t,n)};ae.useTransition=function(){return Et.current.useTransition()};ae.version="18.3.1";Dm.exports=ae;var d=Dm.exports;const Ds=gy(d);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py=d,Iy=Symbol.for("react.element"),Dy=Symbol.for("react.fragment"),Ly=Object.prototype.hasOwnProperty,Oy=Py.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,My={key:!0,ref:!0,__self:!0,__source:!0};function Wm(e,t,n){var r,s={},o=null,l=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Ly.call(t,r)&&!My.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Iy,type:e,key:o,ref:l,props:s,_owner:Oy.current}}ra.Fragment=Dy;ra.jsx=Wm;ra.jsxs=Wm;Im.exports=ra;var i=Im.exports,Iu={},Hm={exports:{}},Wt={},Vm={exports:{}},Km={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,H){var q=N.length;N.push(H);e:for(;0<q;){var re=q-1>>>1,V=N[re];if(0<s(V,H))N[re]=H,N[q]=V,q=re;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var H=N[0],q=N.pop();if(q!==H){N[0]=q;e:for(var re=0,V=N.length,Ne=V>>>1;re<Ne;){var ze=2*(re+1)-1,wt=N[ze],pt=ze+1,Xe=N[pt];if(0>s(wt,q))pt<V&&0>s(Xe,wt)?(N[re]=Xe,N[pt]=q,re=pt):(N[re]=wt,N[ze]=q,re=ze);else if(pt<V&&0>s(Xe,q))N[re]=Xe,N[pt]=q,re=pt;else break e}}return H}function s(N,H){var q=N.sortIndex-H.sortIndex;return q!==0?q:N.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var c=[],f=[],g=1,S=null,b=3,E=!1,j=!1,k=!1,J=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(N){for(var H=n(f);H!==null;){if(H.callback===null)r(f);else if(H.startTime<=N)r(f),H.sortIndex=H.expirationTime,t(c,H);else break;H=n(f)}}function T(N){if(k=!1,v(N),!j)if(n(c)!==null)j=!0,ne(O);else{var H=n(f);H!==null&&Oe(T,H.startTime-N)}}function O(N,H){j=!1,k&&(k=!1,y(z),z=-1),E=!0;var q=b;try{for(v(H),S=n(c);S!==null&&(!(S.expirationTime>H)||N&&!pe());){var re=S.callback;if(typeof re=="function"){S.callback=null,b=S.priorityLevel;var V=re(S.expirationTime<=H);H=e.unstable_now(),typeof V=="function"?S.callback=V:S===n(c)&&r(c),v(H)}else r(c);S=n(c)}if(S!==null)var Ne=!0;else{var ze=n(f);ze!==null&&Oe(T,ze.startTime-H),Ne=!1}return Ne}finally{S=null,b=q,E=!1}}var F=!1,$=null,z=-1,ue=5,X=-1;function pe(){return!(e.unstable_now()-X<ue)}function Je(){if($!==null){var N=e.unstable_now();X=N;var H=!0;try{H=$(!0,N)}finally{H?ot():(F=!1,$=null)}}else F=!1}var ot;if(typeof m=="function")ot=function(){m(Je)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Fe=qe.port2;qe.port1.onmessage=Je,ot=function(){Fe.postMessage(null)}}else ot=function(){J(Je,0)};function ne(N){$=N,F||(F=!0,ot())}function Oe(N,H){z=J(function(){N(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){j||E||(j=!0,ne(O))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(N){switch(b){case 1:case 2:case 3:var H=3;break;default:H=b}var q=b;b=H;try{return N()}finally{b=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,H){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var q=b;b=N;try{return H()}finally{b=q}},e.unstable_scheduleCallback=function(N,H,q){var re=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?re+q:re):q=re,N){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=q+V,N={id:g++,callback:H,priorityLevel:N,startTime:q,expirationTime:V,sortIndex:-1},q>re?(N.sortIndex=q,t(f,N),n(c)===null&&N===n(f)&&(k?(y(z),z=-1):k=!0,Oe(T,q-re))):(N.sortIndex=V,t(c,N),j||E||(j=!0,ne(O))),N},e.unstable_shouldYield=pe,e.unstable_wrapCallback=function(N){var H=b;return function(){var q=b;b=H;try{return N.apply(this,arguments)}finally{b=q}}}})(Km);Vm.exports=Km;var Uy=Vm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fy=d,Bt=Uy;function I(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gm=new Set,qo={};function ss(e,t){Bs(e,t),Bs(e+"Capture",t)}function Bs(e,t){for(qo[e]=t,e=0;e<t.length;e++)Gm.add(t[e])}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Du=Object.prototype.hasOwnProperty,zy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bf={},Wf={};function $y(e){return Du.call(Wf,e)?!0:Du.call(Bf,e)?!1:zy.test(e)?Wf[e]=!0:(Bf[e]=!0,!1)}function By(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Wy(e,t,n,r){if(t===null||typeof t>"u"||By(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _t(e,t,n,r,s,o,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ft[e]=new _t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ft[t]=new _t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ft[e]=new _t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ft[e]=new _t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ft[e]=new _t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ft[e]=new _t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ft[e]=new _t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ft[e]=new _t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ft[e]=new _t(e,5,!1,e.toLowerCase(),null,!1,!1)});var Fc=/[\-:]([a-z])/g;function zc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Fc,zc);ft[t]=new _t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Fc,zc);ft[t]=new _t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Fc,zc);ft[t]=new _t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ft[e]=new _t(e,1,!1,e.toLowerCase(),null,!1,!1)});ft.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ft[e]=new _t(e,1,!1,e.toLowerCase(),null,!0,!0)});function $c(e,t,n,r){var s=ft.hasOwnProperty(t)?ft[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Wy(t,n,s,r)&&(n=null),r||s===null?$y(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Bn=Fy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Ss=Symbol.for("react.fragment"),Bc=Symbol.for("react.strict_mode"),Lu=Symbol.for("react.profiler"),Ym=Symbol.for("react.provider"),Qm=Symbol.for("react.context"),Wc=Symbol.for("react.forward_ref"),Ou=Symbol.for("react.suspense"),Mu=Symbol.for("react.suspense_list"),Hc=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),Jm=Symbol.for("react.offscreen"),Hf=Symbol.iterator;function wo(e){return e===null||typeof e!="object"?null:(e=Hf&&e[Hf]||e["@@iterator"],typeof e=="function"?e:null)}var Le=Object.assign,Qa;function Po(e){if(Qa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Qa=t&&t[1]||""}return`
`+Qa+e}var Ja=!1;function qa(e,t){if(!e||Ja)return"";Ja=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var r=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){r=f}e.call(t.prototype)}else{try{throw Error()}catch(f){r=f}e()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var s=f.stack.split(`
`),o=r.stack.split(`
`),l=s.length-1,u=o.length-1;1<=l&&0<=u&&s[l]!==o[u];)u--;for(;1<=l&&0<=u;l--,u--)if(s[l]!==o[u]){if(l!==1||u!==1)do if(l--,u--,0>u||s[l]!==o[u]){var c=`
`+s[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=u);break}}}finally{Ja=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Po(e):""}function Hy(e){switch(e.tag){case 5:return Po(e.type);case 16:return Po("Lazy");case 13:return Po("Suspense");case 19:return Po("SuspenseList");case 0:case 2:case 15:return e=qa(e.type,!1),e;case 11:return e=qa(e.type.render,!1),e;case 1:return e=qa(e.type,!0),e;default:return""}}function Uu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ss:return"Fragment";case ws:return"Portal";case Lu:return"Profiler";case Bc:return"StrictMode";case Ou:return"Suspense";case Mu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qm:return(e.displayName||"Context")+".Consumer";case Ym:return(e._context.displayName||"Context")+".Provider";case Wc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Hc:return t=e.displayName||null,t!==null?t:Uu(e.type)||"Memo";case rr:t=e._payload,e=e._init;try{return Uu(e(t))}catch{}}return null}function Vy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uu(t);case 8:return t===Bc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ky(e){var t=qm(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Kl(e){e._valueTracker||(e._valueTracker=Ky(e))}function Xm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=qm(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function _i(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fu(e,t){var n=t.checked;return Le({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vf(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Sr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zm(e,t){t=t.checked,t!=null&&$c(e,"checked",t,!1)}function zu(e,t){Zm(e,t);var n=Sr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$u(e,t.type,n):t.hasOwnProperty("defaultValue")&&$u(e,t.type,Sr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Kf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function $u(e,t,n){(t!=="number"||_i(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Io=Array.isArray;function Ls(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Sr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Bu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(I(91));return Le({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(I(92));if(Io(n)){if(1<n.length)throw Error(I(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Sr(n)}}function eh(e,t){var n=Sr(t.value),r=Sr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Yf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function th(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?th(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gl,nh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gl=Gl||document.createElement("div"),Gl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gy=["Webkit","ms","Moz","O"];Object.keys(zo).forEach(function(e){Gy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zo[t]=zo[e]})});function rh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zo.hasOwnProperty(e)&&zo[e]?(""+t).trim():t+"px"}function sh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=rh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Yy=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hu(e,t){if(t){if(Yy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(I(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(I(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(I(61))}if(t.style!=null&&typeof t.style!="object")throw Error(I(62))}}function Vu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=null;function Vc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gu=null,Os=null,Ms=null;function Qf(e){if(e=vl(e)){if(typeof Gu!="function")throw Error(I(280));var t=e.stateNode;t&&(t=aa(t),Gu(e.stateNode,e.type,t))}}function oh(e){Os?Ms?Ms.push(e):Ms=[e]:Os=e}function lh(){if(Os){var e=Os,t=Ms;if(Ms=Os=null,Qf(e),t)for(e=0;e<t.length;e++)Qf(t[e])}}function ih(e,t){return e(t)}function ah(){}var Xa=!1;function uh(e,t,n){if(Xa)return e(t,n);Xa=!0;try{return ih(e,t,n)}finally{Xa=!1,(Os!==null||Ms!==null)&&(ah(),lh())}}function Zo(e,t){var n=e.stateNode;if(n===null)return null;var r=aa(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(I(231,t,typeof n));return n}var Yu=!1;if(Un)try{var So={};Object.defineProperty(So,"passive",{get:function(){Yu=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{Yu=!1}function Qy(e,t,n,r,s,o,l,u,c){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(g){this.onError(g)}}var $o=!1,Ri=null,Ti=!1,Qu=null,Jy={onError:function(e){$o=!0,Ri=e}};function qy(e,t,n,r,s,o,l,u,c){$o=!1,Ri=null,Qy.apply(Jy,arguments)}function Xy(e,t,n,r,s,o,l,u,c){if(qy.apply(this,arguments),$o){if($o){var f=Ri;$o=!1,Ri=null}else throw Error(I(198));Ti||(Ti=!0,Qu=f)}}function os(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ch(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jf(e){if(os(e)!==e)throw Error(I(188))}function Zy(e){var t=e.alternate;if(!t){if(t=os(e),t===null)throw Error(I(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return Jf(s),e;if(o===r)return Jf(s),t;o=o.sibling}throw Error(I(188))}if(n.return!==r.return)n=s,r=o;else{for(var l=!1,u=s.child;u;){if(u===n){l=!0,n=s,r=o;break}if(u===r){l=!0,r=s,n=o;break}u=u.sibling}if(!l){for(u=o.child;u;){if(u===n){l=!0,n=o,r=s;break}if(u===r){l=!0,r=o,n=s;break}u=u.sibling}if(!l)throw Error(I(189))}}if(n.alternate!==r)throw Error(I(190))}if(n.tag!==3)throw Error(I(188));return n.stateNode.current===n?e:t}function dh(e){return e=Zy(e),e!==null?fh(e):null}function fh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fh(e);if(t!==null)return t;e=e.sibling}return null}var ph=Bt.unstable_scheduleCallback,qf=Bt.unstable_cancelCallback,ex=Bt.unstable_shouldYield,tx=Bt.unstable_requestPaint,Be=Bt.unstable_now,nx=Bt.unstable_getCurrentPriorityLevel,Kc=Bt.unstable_ImmediatePriority,mh=Bt.unstable_UserBlockingPriority,Ai=Bt.unstable_NormalPriority,rx=Bt.unstable_LowPriority,hh=Bt.unstable_IdlePriority,sa=null,bn=null;function sx(e){if(bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(sa,e,void 0,(e.current.flags&128)===128)}catch{}}var un=Math.clz32?Math.clz32:ix,ox=Math.log,lx=Math.LN2;function ix(e){return e>>>=0,e===0?32:31-(ox(e)/lx|0)|0}var Yl=64,Ql=4194304;function Do(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,l=n&268435455;if(l!==0){var u=l&~s;u!==0?r=Do(u):(o&=l,o!==0&&(r=Do(o)))}else l=n&~s,l!==0?r=Do(l):o!==0&&(r=Do(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-un(t),s=1<<n,r|=e[n],t&=~s;return r}function ax(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ux(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-un(o),u=1<<l,c=s[l];c===-1?(!(u&n)||u&r)&&(s[l]=ax(u,t)):c<=t&&(e.expiredLanes|=u),o&=~u}}function Ju(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gh(){var e=Yl;return Yl<<=1,!(Yl&4194240)&&(Yl=64),e}function Za(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-un(t),e[t]=n}function cx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-un(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Gc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-un(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var we=0;function yh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xh,Yc,vh,wh,Sh,qu=!1,Jl=[],cr=null,dr=null,fr=null,el=new Map,tl=new Map,lr=[],dx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xf(e,t){switch(e){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":el.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(t.pointerId)}}function bo(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=vl(t),t!==null&&Yc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function fx(e,t,n,r,s){switch(t){case"focusin":return cr=bo(cr,e,t,n,r,s),!0;case"dragenter":return dr=bo(dr,e,t,n,r,s),!0;case"mouseover":return fr=bo(fr,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return el.set(o,bo(el.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,tl.set(o,bo(tl.get(o)||null,e,t,n,r,s)),!0}return!1}function bh(e){var t=Br(e.target);if(t!==null){var n=os(t);if(n!==null){if(t=n.tag,t===13){if(t=ch(n),t!==null){e.blockedOn=t,Sh(e.priority,function(){vh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function pi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ku=r,n.target.dispatchEvent(r),Ku=null}else return t=vl(n),t!==null&&Yc(t),e.blockedOn=n,!1;t.shift()}return!0}function Zf(e,t,n){pi(e)&&n.delete(t)}function px(){qu=!1,cr!==null&&pi(cr)&&(cr=null),dr!==null&&pi(dr)&&(dr=null),fr!==null&&pi(fr)&&(fr=null),el.forEach(Zf),tl.forEach(Zf)}function No(e,t){e.blockedOn===t&&(e.blockedOn=null,qu||(qu=!0,Bt.unstable_scheduleCallback(Bt.unstable_NormalPriority,px)))}function nl(e){function t(s){return No(s,e)}if(0<Jl.length){No(Jl[0],e);for(var n=1;n<Jl.length;n++){var r=Jl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(cr!==null&&No(cr,e),dr!==null&&No(dr,e),fr!==null&&No(fr,e),el.forEach(t),tl.forEach(t),n=0;n<lr.length;n++)r=lr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<lr.length&&(n=lr[0],n.blockedOn===null);)bh(n),n.blockedOn===null&&lr.shift()}var Us=Bn.ReactCurrentBatchConfig,Ii=!0;function mx(e,t,n,r){var s=we,o=Us.transition;Us.transition=null;try{we=1,Qc(e,t,n,r)}finally{we=s,Us.transition=o}}function hx(e,t,n,r){var s=we,o=Us.transition;Us.transition=null;try{we=4,Qc(e,t,n,r)}finally{we=s,Us.transition=o}}function Qc(e,t,n,r){if(Ii){var s=Xu(e,t,n,r);if(s===null)uu(e,t,r,Di,n),Xf(e,r);else if(fx(s,e,t,n,r))r.stopPropagation();else if(Xf(e,r),t&4&&-1<dx.indexOf(e)){for(;s!==null;){var o=vl(s);if(o!==null&&xh(o),o=Xu(e,t,n,r),o===null&&uu(e,t,r,Di,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else uu(e,t,r,null,n)}}var Di=null;function Xu(e,t,n,r){if(Di=null,e=Vc(r),e=Br(e),e!==null)if(t=os(e),t===null)e=null;else if(n=t.tag,n===13){if(e=ch(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Di=e,null}function Nh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nx()){case Kc:return 1;case mh:return 4;case Ai:case rx:return 16;case hh:return 536870912;default:return 16}default:return 16}}var ar=null,Jc=null,mi=null;function kh(){if(mi)return mi;var e,t=Jc,n=t.length,r,s="value"in ar?ar.value:ar.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===s[o-r];r++);return mi=s.slice(e,1<r?1-r:void 0)}function hi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ql(){return!0}function ep(){return!1}function Ht(e){function t(n,r,s,o,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ql:ep,this.isPropagationStopped=ep,this}return Le(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),t}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qc=Ht(Zs),xl=Le({},Zs,{view:0,detail:0}),gx=Ht(xl),eu,tu,ko,oa=Le({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ko&&(ko&&e.type==="mousemove"?(eu=e.screenX-ko.screenX,tu=e.screenY-ko.screenY):tu=eu=0,ko=e),eu)},movementY:function(e){return"movementY"in e?e.movementY:tu}}),tp=Ht(oa),yx=Le({},oa,{dataTransfer:0}),xx=Ht(yx),vx=Le({},xl,{relatedTarget:0}),nu=Ht(vx),wx=Le({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),Sx=Ht(wx),bx=Le({},Zs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Nx=Ht(bx),kx=Le({},Zs,{data:0}),np=Ht(kx),jx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ex={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _x(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ex[e])?!!t[e]:!1}function Xc(){return _x}var Rx=Le({},xl,{key:function(e){if(e.key){var t=jx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xc,charCode:function(e){return e.type==="keypress"?hi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Tx=Ht(Rx),Ax=Le({},oa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rp=Ht(Ax),Px=Le({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xc}),Ix=Ht(Px),Dx=Le({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lx=Ht(Dx),Ox=Le({},oa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mx=Ht(Ox),Ux=[9,13,27,32],Zc=Un&&"CompositionEvent"in window,Bo=null;Un&&"documentMode"in document&&(Bo=document.documentMode);var Fx=Un&&"TextEvent"in window&&!Bo,jh=Un&&(!Zc||Bo&&8<Bo&&11>=Bo),sp=" ",op=!1;function Ch(e,t){switch(e){case"keyup":return Ux.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Eh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bs=!1;function zx(e,t){switch(e){case"compositionend":return Eh(t);case"keypress":return t.which!==32?null:(op=!0,sp);case"textInput":return e=t.data,e===sp&&op?null:e;default:return null}}function $x(e,t){if(bs)return e==="compositionend"||!Zc&&Ch(e,t)?(e=kh(),mi=Jc=ar=null,bs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jh&&t.locale!=="ko"?null:t.data;default:return null}}var Bx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bx[e.type]:t==="textarea"}function _h(e,t,n,r){oh(r),t=Li(t,"onChange"),0<t.length&&(n=new qc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wo=null,rl=null;function Wx(e){Fh(e,0)}function la(e){var t=js(e);if(Xm(t))return e}function Hx(e,t){if(e==="change")return t}var Rh=!1;if(Un){var ru;if(Un){var su="oninput"in document;if(!su){var ip=document.createElement("div");ip.setAttribute("oninput","return;"),su=typeof ip.oninput=="function"}ru=su}else ru=!1;Rh=ru&&(!document.documentMode||9<document.documentMode)}function ap(){Wo&&(Wo.detachEvent("onpropertychange",Th),rl=Wo=null)}function Th(e){if(e.propertyName==="value"&&la(rl)){var t=[];_h(t,rl,e,Vc(e)),uh(Wx,t)}}function Vx(e,t,n){e==="focusin"?(ap(),Wo=t,rl=n,Wo.attachEvent("onpropertychange",Th)):e==="focusout"&&ap()}function Kx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return la(rl)}function Gx(e,t){if(e==="click")return la(t)}function Yx(e,t){if(e==="input"||e==="change")return la(t)}function Qx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dn=typeof Object.is=="function"?Object.is:Qx;function sl(e,t){if(dn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Du.call(t,s)||!dn(e[s],t[s]))return!1}return!0}function up(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cp(e,t){var n=up(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=up(n)}}function Ah(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ah(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ph(){for(var e=window,t=_i();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=_i(e.document)}return t}function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Jx(e){var t=Ph(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ah(n.ownerDocument.documentElement,n)){if(r!==null&&ed(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=cp(n,o);var l=cp(n,r);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var qx=Un&&"documentMode"in document&&11>=document.documentMode,Ns=null,Zu=null,Ho=null,ec=!1;function dp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ec||Ns==null||Ns!==_i(r)||(r=Ns,"selectionStart"in r&&ed(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ho&&sl(Ho,r)||(Ho=r,r=Li(Zu,"onSelect"),0<r.length&&(t=new qc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ns)))}function Xl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ks={animationend:Xl("Animation","AnimationEnd"),animationiteration:Xl("Animation","AnimationIteration"),animationstart:Xl("Animation","AnimationStart"),transitionend:Xl("Transition","TransitionEnd")},ou={},Ih={};Un&&(Ih=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function ia(e){if(ou[e])return ou[e];if(!ks[e])return e;var t=ks[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ih)return ou[e]=t[n];return e}var Dh=ia("animationend"),Lh=ia("animationiteration"),Oh=ia("animationstart"),Mh=ia("transitionend"),Uh=new Map,fp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(e,t){Uh.set(e,t),ss(t,[e])}for(var lu=0;lu<fp.length;lu++){var iu=fp[lu],Xx=iu.toLowerCase(),Zx=iu[0].toUpperCase()+iu.slice(1);jr(Xx,"on"+Zx)}jr(Dh,"onAnimationEnd");jr(Lh,"onAnimationIteration");jr(Oh,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(Mh,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ev=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function pp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Xy(r,t,void 0,e),e.currentTarget=null}function Fh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var u=r[l],c=u.instance,f=u.currentTarget;if(u=u.listener,c!==o&&s.isPropagationStopped())break e;pp(s,u,f),o=c}else for(l=0;l<r.length;l++){if(u=r[l],c=u.instance,f=u.currentTarget,u=u.listener,c!==o&&s.isPropagationStopped())break e;pp(s,u,f),o=c}}}if(Ti)throw e=Qu,Ti=!1,Qu=null,e}function _e(e,t){var n=t[oc];n===void 0&&(n=t[oc]=new Set);var r=e+"__bubble";n.has(r)||(zh(t,e,2,!1),n.add(r))}function au(e,t,n){var r=0;t&&(r|=4),zh(n,e,r,t)}var Zl="_reactListening"+Math.random().toString(36).slice(2);function ol(e){if(!e[Zl]){e[Zl]=!0,Gm.forEach(function(n){n!=="selectionchange"&&(ev.has(n)||au(n,!1,e),au(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zl]||(t[Zl]=!0,au("selectionchange",!1,t))}}function zh(e,t,n,r){switch(Nh(t)){case 1:var s=mx;break;case 4:s=hx;break;default:s=Qc}n=s.bind(null,t,n,e),s=void 0,!Yu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function uu(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;l=l.return}for(;u!==null;){if(l=Br(u),l===null)return;if(c=l.tag,c===5||c===6){r=o=l;continue e}u=u.parentNode}}r=r.return}uh(function(){var f=o,g=Vc(n),S=[];e:{var b=Uh.get(e);if(b!==void 0){var E=qc,j=e;switch(e){case"keypress":if(hi(n)===0)break e;case"keydown":case"keyup":E=Tx;break;case"focusin":j="focus",E=nu;break;case"focusout":j="blur",E=nu;break;case"beforeblur":case"afterblur":E=nu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=tp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=xx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Ix;break;case Dh:case Lh:case Oh:E=Sx;break;case Mh:E=Lx;break;case"scroll":E=gx;break;case"wheel":E=Mx;break;case"copy":case"cut":case"paste":E=Nx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=rp}var k=(t&4)!==0,J=!k&&e==="scroll",y=k?b!==null?b+"Capture":null:b;k=[];for(var m=f,v;m!==null;){v=m;var T=v.stateNode;if(v.tag===5&&T!==null&&(v=T,y!==null&&(T=Zo(m,y),T!=null&&k.push(ll(m,T,v)))),J)break;m=m.return}0<k.length&&(b=new E(b,j,null,n,g),S.push({event:b,listeners:k}))}}if(!(t&7)){e:{if(b=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",b&&n!==Ku&&(j=n.relatedTarget||n.fromElement)&&(Br(j)||j[Fn]))break e;if((E||b)&&(b=g.window===g?g:(b=g.ownerDocument)?b.defaultView||b.parentWindow:window,E?(j=n.relatedTarget||n.toElement,E=f,j=j?Br(j):null,j!==null&&(J=os(j),j!==J||j.tag!==5&&j.tag!==6)&&(j=null)):(E=null,j=f),E!==j)){if(k=tp,T="onMouseLeave",y="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(k=rp,T="onPointerLeave",y="onPointerEnter",m="pointer"),J=E==null?b:js(E),v=j==null?b:js(j),b=new k(T,m+"leave",E,n,g),b.target=J,b.relatedTarget=v,T=null,Br(g)===f&&(k=new k(y,m+"enter",j,n,g),k.target=v,k.relatedTarget=J,T=k),J=T,E&&j)t:{for(k=E,y=j,m=0,v=k;v;v=xs(v))m++;for(v=0,T=y;T;T=xs(T))v++;for(;0<m-v;)k=xs(k),m--;for(;0<v-m;)y=xs(y),v--;for(;m--;){if(k===y||y!==null&&k===y.alternate)break t;k=xs(k),y=xs(y)}k=null}else k=null;E!==null&&mp(S,b,E,k,!1),j!==null&&J!==null&&mp(S,J,j,k,!0)}}e:{if(b=f?js(f):window,E=b.nodeName&&b.nodeName.toLowerCase(),E==="select"||E==="input"&&b.type==="file")var O=Hx;else if(lp(b))if(Rh)O=Yx;else{O=Kx;var F=Vx}else(E=b.nodeName)&&E.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(O=Gx);if(O&&(O=O(e,f))){_h(S,O,n,g);break e}F&&F(e,b,f),e==="focusout"&&(F=b._wrapperState)&&F.controlled&&b.type==="number"&&$u(b,"number",b.value)}switch(F=f?js(f):window,e){case"focusin":(lp(F)||F.contentEditable==="true")&&(Ns=F,Zu=f,Ho=null);break;case"focusout":Ho=Zu=Ns=null;break;case"mousedown":ec=!0;break;case"contextmenu":case"mouseup":case"dragend":ec=!1,dp(S,n,g);break;case"selectionchange":if(qx)break;case"keydown":case"keyup":dp(S,n,g)}var $;if(Zc)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else bs?Ch(e,n)&&(z="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(jh&&n.locale!=="ko"&&(bs||z!=="onCompositionStart"?z==="onCompositionEnd"&&bs&&($=kh()):(ar=g,Jc="value"in ar?ar.value:ar.textContent,bs=!0)),F=Li(f,z),0<F.length&&(z=new np(z,e,null,n,g),S.push({event:z,listeners:F}),$?z.data=$:($=Eh(n),$!==null&&(z.data=$)))),($=Fx?zx(e,n):$x(e,n))&&(f=Li(f,"onBeforeInput"),0<f.length&&(g=new np("onBeforeInput","beforeinput",null,n,g),S.push({event:g,listeners:f}),g.data=$))}Fh(S,t)})}function ll(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Li(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Zo(e,n),o!=null&&r.unshift(ll(e,o,s)),o=Zo(e,t),o!=null&&r.push(ll(e,o,s))),e=e.return}return r}function xs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function mp(e,t,n,r,s){for(var o=t._reactName,l=[];n!==null&&n!==r;){var u=n,c=u.alternate,f=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&f!==null&&(u=f,s?(c=Zo(n,o),c!=null&&l.unshift(ll(n,c,u))):s||(c=Zo(n,o),c!=null&&l.push(ll(n,c,u)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var tv=/\r\n?/g,nv=/\u0000|\uFFFD/g;function hp(e){return(typeof e=="string"?e:""+e).replace(tv,`
`).replace(nv,"")}function ei(e,t,n){if(t=hp(t),hp(e)!==t&&n)throw Error(I(425))}function Oi(){}var tc=null,nc=null;function rc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sc=typeof setTimeout=="function"?setTimeout:void 0,rv=typeof clearTimeout=="function"?clearTimeout:void 0,gp=typeof Promise=="function"?Promise:void 0,sv=typeof queueMicrotask=="function"?queueMicrotask:typeof gp<"u"?function(e){return gp.resolve(null).then(e).catch(ov)}:sc;function ov(e){setTimeout(function(){throw e})}function cu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),nl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);nl(t)}function pr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var eo=Math.random().toString(36).slice(2),Sn="__reactFiber$"+eo,il="__reactProps$"+eo,Fn="__reactContainer$"+eo,oc="__reactEvents$"+eo,lv="__reactListeners$"+eo,iv="__reactHandles$"+eo;function Br(e){var t=e[Sn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Fn]||n[Sn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=yp(e);e!==null;){if(n=e[Sn])return n;e=yp(e)}return t}e=n,n=e.parentNode}return null}function vl(e){return e=e[Sn]||e[Fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function js(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(I(33))}function aa(e){return e[il]||null}var lc=[],Cs=-1;function Cr(e){return{current:e}}function Re(e){0>Cs||(e.current=lc[Cs],lc[Cs]=null,Cs--)}function Ce(e,t){Cs++,lc[Cs]=e.current,e.current=t}var br={},vt=Cr(br),Pt=Cr(!1),Jr=br;function Ws(e,t){var n=e.type.contextTypes;if(!n)return br;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function It(e){return e=e.childContextTypes,e!=null}function Mi(){Re(Pt),Re(vt)}function xp(e,t,n){if(vt.current!==br)throw Error(I(168));Ce(vt,t),Ce(Pt,n)}function $h(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(I(108,Vy(e)||"Unknown",s));return Le({},n,r)}function Ui(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||br,Jr=vt.current,Ce(vt,e),Ce(Pt,Pt.current),!0}function vp(e,t,n){var r=e.stateNode;if(!r)throw Error(I(169));n?(e=$h(e,t,Jr),r.__reactInternalMemoizedMergedChildContext=e,Re(Pt),Re(vt),Ce(vt,e)):Re(Pt),Ce(Pt,n)}var In=null,ua=!1,du=!1;function Bh(e){In===null?In=[e]:In.push(e)}function av(e){ua=!0,Bh(e)}function Er(){if(!du&&In!==null){du=!0;var e=0,t=we;try{var n=In;for(we=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}In=null,ua=!1}catch(s){throw In!==null&&(In=In.slice(e+1)),ph(Kc,Er),s}finally{we=t,du=!1}}return null}var Es=[],_s=0,Fi=null,zi=0,Qt=[],Jt=0,qr=null,Dn=1,Ln="";function Fr(e,t){Es[_s++]=zi,Es[_s++]=Fi,Fi=e,zi=t}function Wh(e,t,n){Qt[Jt++]=Dn,Qt[Jt++]=Ln,Qt[Jt++]=qr,qr=e;var r=Dn;e=Ln;var s=32-un(r)-1;r&=~(1<<s),n+=1;var o=32-un(t)+s;if(30<o){var l=s-s%5;o=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Dn=1<<32-un(t)+s|n<<s|r,Ln=o+e}else Dn=1<<o|n<<s|r,Ln=e}function td(e){e.return!==null&&(Fr(e,1),Wh(e,1,0))}function nd(e){for(;e===Fi;)Fi=Es[--_s],Es[_s]=null,zi=Es[--_s],Es[_s]=null;for(;e===qr;)qr=Qt[--Jt],Qt[Jt]=null,Ln=Qt[--Jt],Qt[Jt]=null,Dn=Qt[--Jt],Qt[Jt]=null}var $t=null,zt=null,Ae=!1,ln=null;function Hh(e,t){var n=qt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function wp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$t=e,zt=pr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$t=e,zt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=qr!==null?{id:Dn,overflow:Ln}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=qt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,$t=e,zt=null,!0):!1;default:return!1}}function ic(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ac(e){if(Ae){var t=zt;if(t){var n=t;if(!wp(e,t)){if(ic(e))throw Error(I(418));t=pr(n.nextSibling);var r=$t;t&&wp(e,t)?Hh(r,n):(e.flags=e.flags&-4097|2,Ae=!1,$t=e)}}else{if(ic(e))throw Error(I(418));e.flags=e.flags&-4097|2,Ae=!1,$t=e}}}function Sp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$t=e}function ti(e){if(e!==$t)return!1;if(!Ae)return Sp(e),Ae=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rc(e.type,e.memoizedProps)),t&&(t=zt)){if(ic(e))throw Vh(),Error(I(418));for(;t;)Hh(e,t),t=pr(t.nextSibling)}if(Sp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(I(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){zt=pr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}zt=null}}else zt=$t?pr(e.stateNode.nextSibling):null;return!0}function Vh(){for(var e=zt;e;)e=pr(e.nextSibling)}function Hs(){zt=$t=null,Ae=!1}function rd(e){ln===null?ln=[e]:ln.push(e)}var uv=Bn.ReactCurrentBatchConfig;function jo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(I(309));var r=n.stateNode}if(!r)throw Error(I(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(l){var u=s.refs;l===null?delete u[o]:u[o]=l},t._stringRef=o,t)}if(typeof e!="string")throw Error(I(284));if(!n._owner)throw Error(I(290,e))}return e}function ni(e,t){throw e=Object.prototype.toString.call(t),Error(I(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bp(e){var t=e._init;return t(e._payload)}function Kh(e){function t(y,m){if(e){var v=y.deletions;v===null?(y.deletions=[m],y.flags|=16):v.push(m)}}function n(y,m){if(!e)return null;for(;m!==null;)t(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(y,m){return y=yr(y,m),y.index=0,y.sibling=null,y}function o(y,m,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<m?(y.flags|=2,m):v):(y.flags|=2,m)):(y.flags|=1048576,m)}function l(y){return e&&y.alternate===null&&(y.flags|=2),y}function u(y,m,v,T){return m===null||m.tag!==6?(m=xu(v,y.mode,T),m.return=y,m):(m=s(m,v),m.return=y,m)}function c(y,m,v,T){var O=v.type;return O===Ss?g(y,m,v.props.children,T,v.key):m!==null&&(m.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&bp(O)===m.type)?(T=s(m,v.props),T.ref=jo(y,m,v),T.return=y,T):(T=bi(v.type,v.key,v.props,null,y.mode,T),T.ref=jo(y,m,v),T.return=y,T)}function f(y,m,v,T){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=vu(v,y.mode,T),m.return=y,m):(m=s(m,v.children||[]),m.return=y,m)}function g(y,m,v,T,O){return m===null||m.tag!==7?(m=Qr(v,y.mode,T,O),m.return=y,m):(m=s(m,v),m.return=y,m)}function S(y,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=xu(""+m,y.mode,v),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Vl:return v=bi(m.type,m.key,m.props,null,y.mode,v),v.ref=jo(y,null,m),v.return=y,v;case ws:return m=vu(m,y.mode,v),m.return=y,m;case rr:var T=m._init;return S(y,T(m._payload),v)}if(Io(m)||wo(m))return m=Qr(m,y.mode,v,null),m.return=y,m;ni(y,m)}return null}function b(y,m,v,T){var O=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return O!==null?null:u(y,m,""+v,T);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Vl:return v.key===O?c(y,m,v,T):null;case ws:return v.key===O?f(y,m,v,T):null;case rr:return O=v._init,b(y,m,O(v._payload),T)}if(Io(v)||wo(v))return O!==null?null:g(y,m,v,T,null);ni(y,v)}return null}function E(y,m,v,T,O){if(typeof T=="string"&&T!==""||typeof T=="number")return y=y.get(v)||null,u(m,y,""+T,O);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Vl:return y=y.get(T.key===null?v:T.key)||null,c(m,y,T,O);case ws:return y=y.get(T.key===null?v:T.key)||null,f(m,y,T,O);case rr:var F=T._init;return E(y,m,v,F(T._payload),O)}if(Io(T)||wo(T))return y=y.get(v)||null,g(m,y,T,O,null);ni(m,T)}return null}function j(y,m,v,T){for(var O=null,F=null,$=m,z=m=0,ue=null;$!==null&&z<v.length;z++){$.index>z?(ue=$,$=null):ue=$.sibling;var X=b(y,$,v[z],T);if(X===null){$===null&&($=ue);break}e&&$&&X.alternate===null&&t(y,$),m=o(X,m,z),F===null?O=X:F.sibling=X,F=X,$=ue}if(z===v.length)return n(y,$),Ae&&Fr(y,z),O;if($===null){for(;z<v.length;z++)$=S(y,v[z],T),$!==null&&(m=o($,m,z),F===null?O=$:F.sibling=$,F=$);return Ae&&Fr(y,z),O}for($=r(y,$);z<v.length;z++)ue=E($,y,z,v[z],T),ue!==null&&(e&&ue.alternate!==null&&$.delete(ue.key===null?z:ue.key),m=o(ue,m,z),F===null?O=ue:F.sibling=ue,F=ue);return e&&$.forEach(function(pe){return t(y,pe)}),Ae&&Fr(y,z),O}function k(y,m,v,T){var O=wo(v);if(typeof O!="function")throw Error(I(150));if(v=O.call(v),v==null)throw Error(I(151));for(var F=O=null,$=m,z=m=0,ue=null,X=v.next();$!==null&&!X.done;z++,X=v.next()){$.index>z?(ue=$,$=null):ue=$.sibling;var pe=b(y,$,X.value,T);if(pe===null){$===null&&($=ue);break}e&&$&&pe.alternate===null&&t(y,$),m=o(pe,m,z),F===null?O=pe:F.sibling=pe,F=pe,$=ue}if(X.done)return n(y,$),Ae&&Fr(y,z),O;if($===null){for(;!X.done;z++,X=v.next())X=S(y,X.value,T),X!==null&&(m=o(X,m,z),F===null?O=X:F.sibling=X,F=X);return Ae&&Fr(y,z),O}for($=r(y,$);!X.done;z++,X=v.next())X=E($,y,z,X.value,T),X!==null&&(e&&X.alternate!==null&&$.delete(X.key===null?z:X.key),m=o(X,m,z),F===null?O=X:F.sibling=X,F=X);return e&&$.forEach(function(Je){return t(y,Je)}),Ae&&Fr(y,z),O}function J(y,m,v,T){if(typeof v=="object"&&v!==null&&v.type===Ss&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Vl:e:{for(var O=v.key,F=m;F!==null;){if(F.key===O){if(O=v.type,O===Ss){if(F.tag===7){n(y,F.sibling),m=s(F,v.props.children),m.return=y,y=m;break e}}else if(F.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&bp(O)===F.type){n(y,F.sibling),m=s(F,v.props),m.ref=jo(y,F,v),m.return=y,y=m;break e}n(y,F);break}else t(y,F);F=F.sibling}v.type===Ss?(m=Qr(v.props.children,y.mode,T,v.key),m.return=y,y=m):(T=bi(v.type,v.key,v.props,null,y.mode,T),T.ref=jo(y,m,v),T.return=y,y=T)}return l(y);case ws:e:{for(F=v.key;m!==null;){if(m.key===F)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(y,m.sibling),m=s(m,v.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else t(y,m);m=m.sibling}m=vu(v,y.mode,T),m.return=y,y=m}return l(y);case rr:return F=v._init,J(y,m,F(v._payload),T)}if(Io(v))return j(y,m,v,T);if(wo(v))return k(y,m,v,T);ni(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(y,m.sibling),m=s(m,v),m.return=y,y=m):(n(y,m),m=xu(v,y.mode,T),m.return=y,y=m),l(y)):n(y,m)}return J}var Vs=Kh(!0),Gh=Kh(!1),$i=Cr(null),Bi=null,Rs=null,sd=null;function od(){sd=Rs=Bi=null}function ld(e){var t=$i.current;Re($i),e._currentValue=t}function uc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Fs(e,t){Bi=e,sd=Rs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(At=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(sd!==e)if(e={context:e,memoizedValue:t,next:null},Rs===null){if(Bi===null)throw Error(I(308));Rs=e,Bi.dependencies={lanes:0,firstContext:e}}else Rs=Rs.next=e;return t}var Wr=null;function id(e){Wr===null?Wr=[e]:Wr.push(e)}function Yh(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,id(t)):(n.next=s.next,s.next=n),t.interleaved=n,zn(e,r)}function zn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var sr=!1;function ad(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function On(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,zn(e,n)}return s=r.interleaved,s===null?(t.next=t,id(r)):(t.next=s.next,s.next=t),r.interleaved=t,zn(e,n)}function gi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gc(e,n)}}function Np(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=l:o=o.next=l,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wi(e,t,n,r){var s=e.updateQueue;sr=!1;var o=s.firstBaseUpdate,l=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var c=u,f=c.next;c.next=null,l===null?o=f:l.next=f,l=c;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==l&&(u===null?g.firstBaseUpdate=f:u.next=f,g.lastBaseUpdate=c))}if(o!==null){var S=s.baseState;l=0,g=f=c=null,u=o;do{var b=u.lane,E=u.eventTime;if((r&b)===b){g!==null&&(g=g.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var j=e,k=u;switch(b=t,E=n,k.tag){case 1:if(j=k.payload,typeof j=="function"){S=j.call(E,S,b);break e}S=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=k.payload,b=typeof j=="function"?j.call(E,S,b):j,b==null)break e;S=Le({},S,b);break e;case 2:sr=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,b=s.effects,b===null?s.effects=[u]:b.push(u))}else E={eventTime:E,lane:b,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(f=g=E,c=S):g=g.next=E,l|=b;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;b=u,u=b.next,b.next=null,s.lastBaseUpdate=b,s.shared.pending=null}}while(!0);if(g===null&&(c=S),s.baseState=c,s.firstBaseUpdate=f,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Zr|=l,e.lanes=l,e.memoizedState=S}}function kp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(I(191,s));s.call(r)}}}var wl={},Nn=Cr(wl),al=Cr(wl),ul=Cr(wl);function Hr(e){if(e===wl)throw Error(I(174));return e}function ud(e,t){switch(Ce(ul,t),Ce(al,e),Ce(Nn,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Wu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Wu(t,e)}Re(Nn),Ce(Nn,t)}function Ks(){Re(Nn),Re(al),Re(ul)}function Jh(e){Hr(ul.current);var t=Hr(Nn.current),n=Wu(t,e.type);t!==n&&(Ce(al,e),Ce(Nn,n))}function cd(e){al.current===e&&(Re(Nn),Re(al))}var Ie=Cr(0);function Hi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fu=[];function dd(){for(var e=0;e<fu.length;e++)fu[e]._workInProgressVersionPrimary=null;fu.length=0}var yi=Bn.ReactCurrentDispatcher,pu=Bn.ReactCurrentBatchConfig,Xr=0,De=null,Ye=null,rt=null,Vi=!1,Vo=!1,cl=0,cv=0;function gt(){throw Error(I(321))}function fd(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!dn(e[n],t[n]))return!1;return!0}function pd(e,t,n,r,s,o){if(Xr=o,De=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yi.current=e===null||e.memoizedState===null?mv:hv,e=n(r,s),Vo){o=0;do{if(Vo=!1,cl=0,25<=o)throw Error(I(301));o+=1,rt=Ye=null,t.updateQueue=null,yi.current=gv,e=n(r,s)}while(Vo)}if(yi.current=Ki,t=Ye!==null&&Ye.next!==null,Xr=0,rt=Ye=De=null,Vi=!1,t)throw Error(I(300));return e}function md(){var e=cl!==0;return cl=0,e}function vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?De.memoizedState=rt=e:rt=rt.next=e,rt}function en(){if(Ye===null){var e=De.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=rt===null?De.memoizedState:rt.next;if(t!==null)rt=t,Ye=e;else{if(e===null)throw Error(I(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},rt===null?De.memoizedState=rt=e:rt=rt.next=e}return rt}function dl(e,t){return typeof t=="function"?t(e):t}function mu(e){var t=en(),n=t.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=e;var r=Ye,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var l=s.next;s.next=o.next,o.next=l}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var u=l=null,c=null,f=o;do{var g=f.lane;if((Xr&g)===g)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:e(r,f.action);else{var S={lane:g,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(u=c=S,l=r):c=c.next=S,De.lanes|=g,Zr|=g}f=f.next}while(f!==null&&f!==o);c===null?l=r:c.next=u,dn(r,t.memoizedState)||(At=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,De.lanes|=o,Zr|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hu(e){var t=en(),n=t.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do o=e(o,l.action),l=l.next;while(l!==s);dn(o,t.memoizedState)||(At=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function qh(){}function Xh(e,t){var n=De,r=en(),s=t(),o=!dn(r.memoizedState,s);if(o&&(r.memoizedState=s,At=!0),r=r.queue,hd(tg.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||rt!==null&&rt.memoizedState.tag&1){if(n.flags|=2048,fl(9,eg.bind(null,n,r,s,t),void 0,null),st===null)throw Error(I(349));Xr&30||Zh(n,t,s)}return s}function Zh(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function eg(e,t,n,r){t.value=n,t.getSnapshot=r,ng(t)&&rg(e)}function tg(e,t,n){return n(function(){ng(t)&&rg(e)})}function ng(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!dn(e,n)}catch{return!0}}function rg(e){var t=zn(e,1);t!==null&&cn(t,e,1,-1)}function jp(e){var t=vn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dl,lastRenderedState:e},t.queue=e,e=e.dispatch=pv.bind(null,De,e),[t.memoizedState,e]}function fl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function sg(){return en().memoizedState}function xi(e,t,n,r){var s=vn();De.flags|=e,s.memoizedState=fl(1|t,n,void 0,r===void 0?null:r)}function ca(e,t,n,r){var s=en();r=r===void 0?null:r;var o=void 0;if(Ye!==null){var l=Ye.memoizedState;if(o=l.destroy,r!==null&&fd(r,l.deps)){s.memoizedState=fl(t,n,o,r);return}}De.flags|=e,s.memoizedState=fl(1|t,n,o,r)}function Cp(e,t){return xi(8390656,8,e,t)}function hd(e,t){return ca(2048,8,e,t)}function og(e,t){return ca(4,2,e,t)}function lg(e,t){return ca(4,4,e,t)}function ig(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ag(e,t,n){return n=n!=null?n.concat([e]):null,ca(4,4,ig.bind(null,t,e),n)}function gd(){}function ug(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fd(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function cg(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fd(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function dg(e,t,n){return Xr&21?(dn(n,t)||(n=gh(),De.lanes|=n,Zr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,At=!0),e.memoizedState=n)}function dv(e,t){var n=we;we=n!==0&&4>n?n:4,e(!0);var r=pu.transition;pu.transition={};try{e(!1),t()}finally{we=n,pu.transition=r}}function fg(){return en().memoizedState}function fv(e,t,n){var r=gr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},pg(e))mg(t,n);else if(n=Yh(e,t,n,r),n!==null){var s=Ct();cn(n,e,r,s),hg(n,t,r)}}function pv(e,t,n){var r=gr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(pg(e))mg(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var l=t.lastRenderedState,u=o(l,n);if(s.hasEagerState=!0,s.eagerState=u,dn(u,l)){var c=t.interleaved;c===null?(s.next=s,id(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Yh(e,t,s,r),n!==null&&(s=Ct(),cn(n,e,r,s),hg(n,t,r))}}function pg(e){var t=e.alternate;return e===De||t!==null&&t===De}function mg(e,t){Vo=Vi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gc(e,n)}}var Ki={readContext:Zt,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},mv={readContext:Zt,useCallback:function(e,t){return vn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:Cp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,xi(4194308,4,ig.bind(null,t,e),n)},useLayoutEffect:function(e,t){return xi(4194308,4,e,t)},useInsertionEffect:function(e,t){return xi(4,2,e,t)},useMemo:function(e,t){var n=vn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=fv.bind(null,De,e),[r.memoizedState,e]},useRef:function(e){var t=vn();return e={current:e},t.memoizedState=e},useState:jp,useDebugValue:gd,useDeferredValue:function(e){return vn().memoizedState=e},useTransition:function(){var e=jp(!1),t=e[0];return e=dv.bind(null,e[1]),vn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=De,s=vn();if(Ae){if(n===void 0)throw Error(I(407));n=n()}else{if(n=t(),st===null)throw Error(I(349));Xr&30||Zh(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Cp(tg.bind(null,r,o,e),[e]),r.flags|=2048,fl(9,eg.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vn(),t=st.identifierPrefix;if(Ae){var n=Ln,r=Dn;n=(r&~(1<<32-un(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=cl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=cv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hv={readContext:Zt,useCallback:ug,useContext:Zt,useEffect:hd,useImperativeHandle:ag,useInsertionEffect:og,useLayoutEffect:lg,useMemo:cg,useReducer:mu,useRef:sg,useState:function(){return mu(dl)},useDebugValue:gd,useDeferredValue:function(e){var t=en();return dg(t,Ye.memoizedState,e)},useTransition:function(){var e=mu(dl)[0],t=en().memoizedState;return[e,t]},useMutableSource:qh,useSyncExternalStore:Xh,useId:fg,unstable_isNewReconciler:!1},gv={readContext:Zt,useCallback:ug,useContext:Zt,useEffect:hd,useImperativeHandle:ag,useInsertionEffect:og,useLayoutEffect:lg,useMemo:cg,useReducer:hu,useRef:sg,useState:function(){return hu(dl)},useDebugValue:gd,useDeferredValue:function(e){var t=en();return Ye===null?t.memoizedState=e:dg(t,Ye.memoizedState,e)},useTransition:function(){var e=hu(dl)[0],t=en().memoizedState;return[e,t]},useMutableSource:qh,useSyncExternalStore:Xh,useId:fg,unstable_isNewReconciler:!1};function sn(e,t){if(e&&e.defaultProps){t=Le({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Le({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var da={isMounted:function(e){return(e=e._reactInternals)?os(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ct(),s=gr(e),o=On(r,s);o.payload=t,n!=null&&(o.callback=n),t=mr(e,o,s),t!==null&&(cn(t,e,s,r),gi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ct(),s=gr(e),o=On(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=mr(e,o,s),t!==null&&(cn(t,e,s,r),gi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ct(),r=gr(e),s=On(n,r);s.tag=2,t!=null&&(s.callback=t),t=mr(e,s,r),t!==null&&(cn(t,e,r,n),gi(t,e,r))}};function Ep(e,t,n,r,s,o,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,l):t.prototype&&t.prototype.isPureReactComponent?!sl(n,r)||!sl(s,o):!0}function gg(e,t,n){var r=!1,s=br,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=It(t)?Jr:vt.current,r=t.contextTypes,o=(r=r!=null)?Ws(e,s):br),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=da,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function _p(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&da.enqueueReplaceState(t,t.state,null)}function dc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ad(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=It(t)?Jr:vt.current,s.context=Ws(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(cc(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&da.enqueueReplaceState(s,s.state,null),Wi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Gs(e,t){try{var n="",r=t;do n+=Hy(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function gu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var yv=typeof WeakMap=="function"?WeakMap:Map;function yg(e,t,n){n=On(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Yi||(Yi=!0,bc=r),fc(e,t)},n}function xg(e,t,n){n=On(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fc(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){fc(e,t),typeof r!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Rp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new yv;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Av.bind(null,e,t,n),t.then(e,e))}function Tp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ap(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=On(-1,1),t.tag=2,mr(n,t,1))),n.lanes|=1),e)}var xv=Bn.ReactCurrentOwner,At=!1;function jt(e,t,n,r){t.child=e===null?Gh(t,null,n,r):Vs(t,e.child,n,r)}function Pp(e,t,n,r,s){n=n.render;var o=t.ref;return Fs(t,s),r=pd(e,t,n,r,o,s),n=md(),e!==null&&!At?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Ae&&n&&td(t),t.flags|=1,jt(e,t,r,s),t.child)}function Ip(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!kd(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,vg(e,t,o,r,s)):(e=bi(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var l=o.memoizedProps;if(n=n.compare,n=n!==null?n:sl,n(l,r)&&e.ref===t.ref)return $n(e,t,s)}return t.flags|=1,e=yr(o,r),e.ref=t.ref,e.return=t,t.child=e}function vg(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(sl(o,r)&&e.ref===t.ref)if(At=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(At=!0);else return t.lanes=e.lanes,$n(e,t,s)}return pc(e,t,n,r,s)}function wg(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(As,Ft),Ft|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ce(As,Ft),Ft|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ce(As,Ft),Ft|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ce(As,Ft),Ft|=r;return jt(e,t,s,n),t.child}function Sg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function pc(e,t,n,r,s){var o=It(n)?Jr:vt.current;return o=Ws(t,o),Fs(t,s),n=pd(e,t,n,r,o,s),r=md(),e!==null&&!At?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Ae&&r&&td(t),t.flags|=1,jt(e,t,n,s),t.child)}function Dp(e,t,n,r,s){if(It(n)){var o=!0;Ui(t)}else o=!1;if(Fs(t,s),t.stateNode===null)vi(e,t),gg(t,n,r),dc(t,n,r,s),r=!0;else if(e===null){var l=t.stateNode,u=t.memoizedProps;l.props=u;var c=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Zt(f):(f=It(n)?Jr:vt.current,f=Ws(t,f));var g=n.getDerivedStateFromProps,S=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function";S||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||c!==f)&&_p(t,l,r,f),sr=!1;var b=t.memoizedState;l.state=b,Wi(t,r,l,s),c=t.memoizedState,u!==r||b!==c||Pt.current||sr?(typeof g=="function"&&(cc(t,n,g,r),c=t.memoizedState),(u=sr||Ep(t,n,u,r,b,c,f))?(S||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),l.props=r,l.state=c,l.context=f,r=u):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,Qh(e,t),u=t.memoizedProps,f=t.type===t.elementType?u:sn(t.type,u),l.props=f,S=t.pendingProps,b=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=It(n)?Jr:vt.current,c=Ws(t,c));var E=n.getDerivedStateFromProps;(g=typeof E=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==S||b!==c)&&_p(t,l,r,c),sr=!1,b=t.memoizedState,l.state=b,Wi(t,r,l,s);var j=t.memoizedState;u!==S||b!==j||Pt.current||sr?(typeof E=="function"&&(cc(t,n,E,r),j=t.memoizedState),(f=sr||Ep(t,n,f,r,b,j,c)||!1)?(g||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,j,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,j,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=j),l.props=r,l.state=j,l.context=c,r=f):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),r=!1)}return mc(e,t,n,r,o,s)}function mc(e,t,n,r,s,o){Sg(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return s&&vp(t,n,!1),$n(e,t,o);r=t.stateNode,xv.current=t;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Vs(t,e.child,null,o),t.child=Vs(t,null,u,o)):jt(e,t,u,o),t.memoizedState=r.state,s&&vp(t,n,!0),t.child}function bg(e){var t=e.stateNode;t.pendingContext?xp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xp(e,t.context,!1),ud(e,t.containerInfo)}function Lp(e,t,n,r,s){return Hs(),rd(s),t.flags|=256,jt(e,t,n,r),t.child}var hc={dehydrated:null,treeContext:null,retryLane:0};function gc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ng(e,t,n){var r=t.pendingProps,s=Ie.current,o=!1,l=(t.flags&128)!==0,u;if((u=l)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ce(Ie,s&1),e===null)return ac(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=ma(l,r,0,null),e=Qr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=gc(n),t.memoizedState=hc,e):yd(t,l));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return vv(e,t,l,r,u,s,n);if(o){o=r.fallback,l=t.mode,s=e.child,u=s.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=yr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?o=yr(u,o):(o=Qr(o,l,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=e.child.memoizedState,l=l===null?gc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=hc,r}return o=e.child,e=o.sibling,r=yr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yd(e,t){return t=ma({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ri(e,t,n,r){return r!==null&&rd(r),Vs(t,e.child,null,n),e=yd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function vv(e,t,n,r,s,o,l){if(n)return t.flags&256?(t.flags&=-257,r=gu(Error(I(422))),ri(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=ma({mode:"visible",children:r.children},s,0,null),o=Qr(o,s,l,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Vs(t,e.child,null,l),t.child.memoizedState=gc(l),t.memoizedState=hc,o);if(!(t.mode&1))return ri(e,t,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(I(419)),r=gu(o,r,void 0),ri(e,t,l,r)}if(u=(l&e.childLanes)!==0,At||u){if(r=st,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,zn(e,s),cn(r,e,s,-1))}return Nd(),r=gu(Error(I(421))),ri(e,t,l,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Pv.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,zt=pr(s.nextSibling),$t=t,Ae=!0,ln=null,e!==null&&(Qt[Jt++]=Dn,Qt[Jt++]=Ln,Qt[Jt++]=qr,Dn=e.id,Ln=e.overflow,qr=t),t=yd(t,r.children),t.flags|=4096,t)}function Op(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),uc(e.return,t,n)}function yu(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function kg(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(jt(e,t,r.children,n),r=Ie.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Op(e,n,t);else if(e.tag===19)Op(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ce(Ie,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Hi(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),yu(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Hi(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}yu(t,!0,n,null,o);break;case"together":yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $n(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Zr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(I(153));if(t.child!==null){for(e=t.child,n=yr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=yr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function wv(e,t,n){switch(t.tag){case 3:bg(t),Hs();break;case 5:Jh(t);break;case 1:It(t.type)&&Ui(t);break;case 4:ud(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ce($i,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ce(Ie,Ie.current&1),t.flags|=128,null):n&t.child.childLanes?Ng(e,t,n):(Ce(Ie,Ie.current&1),e=$n(e,t,n),e!==null?e.sibling:null);Ce(Ie,Ie.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return kg(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Ie,Ie.current),r)break;return null;case 22:case 23:return t.lanes=0,wg(e,t,n)}return $n(e,t,n)}var jg,yc,Cg,Eg;jg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yc=function(){};Cg=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Hr(Nn.current);var o=null;switch(n){case"input":s=Fu(e,s),r=Fu(e,r),o=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),o=[];break;case"textarea":s=Bu(e,s),r=Bu(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Oi)}Hu(n,r);var l;n=null;for(f in s)if(!r.hasOwnProperty(f)&&s.hasOwnProperty(f)&&s[f]!=null)if(f==="style"){var u=s[f];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(qo.hasOwnProperty(f)?o||(o=[]):(o=o||[]).push(f,null));for(f in r){var c=r[f];if(u=s!=null?s[f]:void 0,r.hasOwnProperty(f)&&c!==u&&(c!=null||u!=null))if(f==="style")if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(o||(o=[]),o.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(o=o||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(qo.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&_e("scroll",e),o||u===c||(o=[])):(o=o||[]).push(f,c))}n&&(o=o||[]).push("style",n);var f=o;(t.updateQueue=f)&&(t.flags|=4)}};Eg=function(e,t,n,r){n!==r&&(t.flags|=4)};function Co(e,t){if(!Ae)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function yt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Sv(e,t,n){var r=t.pendingProps;switch(nd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(t),null;case 1:return It(t.type)&&Mi(),yt(t),null;case 3:return r=t.stateNode,Ks(),Re(Pt),Re(vt),dd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ti(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ln!==null&&(jc(ln),ln=null))),yc(e,t),yt(t),null;case 5:cd(t);var s=Hr(ul.current);if(n=t.type,e!==null&&t.stateNode!=null)Cg(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(I(166));return yt(t),null}if(e=Hr(Nn.current),ti(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Sn]=t,r[il]=o,e=(t.mode&1)!==0,n){case"dialog":_e("cancel",r),_e("close",r);break;case"iframe":case"object":case"embed":_e("load",r);break;case"video":case"audio":for(s=0;s<Lo.length;s++)_e(Lo[s],r);break;case"source":_e("error",r);break;case"img":case"image":case"link":_e("error",r),_e("load",r);break;case"details":_e("toggle",r);break;case"input":Vf(r,o),_e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_e("invalid",r);break;case"textarea":Gf(r,o),_e("invalid",r)}Hu(n,o),s=null;for(var l in o)if(o.hasOwnProperty(l)){var u=o[l];l==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&ei(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&ei(r.textContent,u,e),s=["children",""+u]):qo.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&_e("scroll",r)}switch(n){case"input":Kl(r),Kf(r,o,!0);break;case"textarea":Kl(r),Yf(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Oi)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=th(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Sn]=t,e[il]=r,jg(e,t,!1,!1),t.stateNode=e;e:{switch(l=Vu(n,r),n){case"dialog":_e("cancel",e),_e("close",e),s=r;break;case"iframe":case"object":case"embed":_e("load",e),s=r;break;case"video":case"audio":for(s=0;s<Lo.length;s++)_e(Lo[s],e);s=r;break;case"source":_e("error",e),s=r;break;case"img":case"image":case"link":_e("error",e),_e("load",e),s=r;break;case"details":_e("toggle",e),s=r;break;case"input":Vf(e,r),s=Fu(e,r),_e("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),_e("invalid",e);break;case"textarea":Gf(e,r),s=Bu(e,r),_e("invalid",e);break;default:s=r}Hu(n,s),u=s;for(o in u)if(u.hasOwnProperty(o)){var c=u[o];o==="style"?sh(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&nh(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Xo(e,c):typeof c=="number"&&Xo(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(qo.hasOwnProperty(o)?c!=null&&o==="onScroll"&&_e("scroll",e):c!=null&&$c(e,o,c,l))}switch(n){case"input":Kl(e),Kf(e,r,!1);break;case"textarea":Kl(e),Yf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Sr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Ls(e,!!r.multiple,o,!1):r.defaultValue!=null&&Ls(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Oi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return yt(t),null;case 6:if(e&&t.stateNode!=null)Eg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(I(166));if(n=Hr(ul.current),Hr(Nn.current),ti(t)){if(r=t.stateNode,n=t.memoizedProps,r[Sn]=t,(o=r.nodeValue!==n)&&(e=$t,e!==null))switch(e.tag){case 3:ei(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ei(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sn]=t,t.stateNode=r}return yt(t),null;case 13:if(Re(Ie),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ae&&zt!==null&&t.mode&1&&!(t.flags&128))Vh(),Hs(),t.flags|=98560,o=!1;else if(o=ti(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(I(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(I(317));o[Sn]=t}else Hs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yt(t),o=!1}else ln!==null&&(jc(ln),ln=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ie.current&1?Qe===0&&(Qe=3):Nd())),t.updateQueue!==null&&(t.flags|=4),yt(t),null);case 4:return Ks(),yc(e,t),e===null&&ol(t.stateNode.containerInfo),yt(t),null;case 10:return ld(t.type._context),yt(t),null;case 17:return It(t.type)&&Mi(),yt(t),null;case 19:if(Re(Ie),o=t.memoizedState,o===null)return yt(t),null;if(r=(t.flags&128)!==0,l=o.rendering,l===null)if(r)Co(o,!1);else{if(Qe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Hi(e),l!==null){for(t.flags|=128,Co(o,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ce(Ie,Ie.current&1|2),t.child}e=e.sibling}o.tail!==null&&Be()>Ys&&(t.flags|=128,r=!0,Co(o,!1),t.lanes=4194304)}else{if(!r)if(e=Hi(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Co(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Ae)return yt(t),null}else 2*Be()-o.renderingStartTime>Ys&&n!==1073741824&&(t.flags|=128,r=!0,Co(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(n=o.last,n!==null?n.sibling=l:t.child=l,o.last=l)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Be(),t.sibling=null,n=Ie.current,Ce(Ie,r?n&1|2:n&1),t):(yt(t),null);case 22:case 23:return bd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ft&1073741824&&(yt(t),t.subtreeFlags&6&&(t.flags|=8192)):yt(t),null;case 24:return null;case 25:return null}throw Error(I(156,t.tag))}function bv(e,t){switch(nd(t),t.tag){case 1:return It(t.type)&&Mi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ks(),Re(Pt),Re(vt),dd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cd(t),null;case 13:if(Re(Ie),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(I(340));Hs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Re(Ie),null;case 4:return Ks(),null;case 10:return ld(t.type._context),null;case 22:case 23:return bd(),null;case 24:return null;default:return null}}var si=!1,xt=!1,Nv=typeof WeakSet=="function"?WeakSet:Set,G=null;function Ts(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function xc(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var Mp=!1;function kv(e,t){if(tc=Ii,e=Ph(),ed(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var l=0,u=-1,c=-1,f=0,g=0,S=e,b=null;t:for(;;){for(var E;S!==n||s!==0&&S.nodeType!==3||(u=l+s),S!==o||r!==0&&S.nodeType!==3||(c=l+r),S.nodeType===3&&(l+=S.nodeValue.length),(E=S.firstChild)!==null;)b=S,S=E;for(;;){if(S===e)break t;if(b===n&&++f===s&&(u=l),b===o&&++g===r&&(c=l),(E=S.nextSibling)!==null)break;S=b,b=S.parentNode}S=E}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nc={focusedElem:e,selectionRange:n},Ii=!1,G=t;G!==null;)if(t=G,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,G=e;else for(;G!==null;){t=G;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var k=j.memoizedProps,J=j.memoizedState,y=t.stateNode,m=y.getSnapshotBeforeUpdate(t.elementType===t.type?k:sn(t.type,k),J);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(I(163))}}catch(T){Ue(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,G=e;break}G=t.return}return j=Mp,Mp=!1,j}function Ko(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&xc(t,n,o)}s=s.next}while(s!==r)}}function fa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function vc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function _g(e){var t=e.alternate;t!==null&&(e.alternate=null,_g(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sn],delete t[il],delete t[oc],delete t[lv],delete t[iv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rg(e){return e.tag===5||e.tag===3||e.tag===4}function Up(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Oi));else if(r!==4&&(e=e.child,e!==null))for(wc(e,t,n),e=e.sibling;e!==null;)wc(e,t,n),e=e.sibling}function Sc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Sc(e,t,n),e=e.sibling;e!==null;)Sc(e,t,n),e=e.sibling}var ct=null,on=!1;function tr(e,t,n){for(n=n.child;n!==null;)Tg(e,t,n),n=n.sibling}function Tg(e,t,n){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(sa,n)}catch{}switch(n.tag){case 5:xt||Ts(n,t);case 6:var r=ct,s=on;ct=null,tr(e,t,n),ct=r,on=s,ct!==null&&(on?(e=ct,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ct.removeChild(n.stateNode));break;case 18:ct!==null&&(on?(e=ct,n=n.stateNode,e.nodeType===8?cu(e.parentNode,n):e.nodeType===1&&cu(e,n),nl(e)):cu(ct,n.stateNode));break;case 4:r=ct,s=on,ct=n.stateNode.containerInfo,on=!0,tr(e,t,n),ct=r,on=s;break;case 0:case 11:case 14:case 15:if(!xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&xc(n,t,l),s=s.next}while(s!==r)}tr(e,t,n);break;case 1:if(!xt&&(Ts(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ue(n,t,u)}tr(e,t,n);break;case 21:tr(e,t,n);break;case 22:n.mode&1?(xt=(r=xt)||n.memoizedState!==null,tr(e,t,n),xt=r):tr(e,t,n);break;default:tr(e,t,n)}}function Fp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Nv),t.forEach(function(r){var s=Iv.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,l=t,u=l;e:for(;u!==null;){switch(u.tag){case 5:ct=u.stateNode,on=!1;break e;case 3:ct=u.stateNode.containerInfo,on=!0;break e;case 4:ct=u.stateNode.containerInfo,on=!0;break e}u=u.return}if(ct===null)throw Error(I(160));Tg(o,l,s),ct=null,on=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(f){Ue(s,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ag(t,e),t=t.sibling}function Ag(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),xn(e),r&4){try{Ko(3,e,e.return),fa(3,e)}catch(k){Ue(e,e.return,k)}try{Ko(5,e,e.return)}catch(k){Ue(e,e.return,k)}}break;case 1:rn(t,e),xn(e),r&512&&n!==null&&Ts(n,n.return);break;case 5:if(rn(t,e),xn(e),r&512&&n!==null&&Ts(n,n.return),e.flags&32){var s=e.stateNode;try{Xo(s,"")}catch(k){Ue(e,e.return,k)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,l=n!==null?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&Zm(s,o),Vu(u,l);var f=Vu(u,o);for(l=0;l<c.length;l+=2){var g=c[l],S=c[l+1];g==="style"?sh(s,S):g==="dangerouslySetInnerHTML"?nh(s,S):g==="children"?Xo(s,S):$c(s,g,S,f)}switch(u){case"input":zu(s,o);break;case"textarea":eh(s,o);break;case"select":var b=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var E=o.value;E!=null?Ls(s,!!o.multiple,E,!1):b!==!!o.multiple&&(o.defaultValue!=null?Ls(s,!!o.multiple,o.defaultValue,!0):Ls(s,!!o.multiple,o.multiple?[]:"",!1))}s[il]=o}catch(k){Ue(e,e.return,k)}}break;case 6:if(rn(t,e),xn(e),r&4){if(e.stateNode===null)throw Error(I(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(k){Ue(e,e.return,k)}}break;case 3:if(rn(t,e),xn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{nl(t.containerInfo)}catch(k){Ue(e,e.return,k)}break;case 4:rn(t,e),xn(e);break;case 13:rn(t,e),xn(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(wd=Be())),r&4&&Fp(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(xt=(f=xt)||g,rn(t,e),xt=f):rn(t,e),xn(e),r&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!g&&e.mode&1)for(G=e,g=e.child;g!==null;){for(S=G=g;G!==null;){switch(b=G,E=b.child,b.tag){case 0:case 11:case 14:case 15:Ko(4,b,b.return);break;case 1:Ts(b,b.return);var j=b.stateNode;if(typeof j.componentWillUnmount=="function"){r=b,n=b.return;try{t=r,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(k){Ue(r,n,k)}}break;case 5:Ts(b,b.return);break;case 22:if(b.memoizedState!==null){$p(S);continue}}E!==null?(E.return=b,G=E):$p(S)}g=g.sibling}e:for(g=null,S=e;;){if(S.tag===5){if(g===null){g=S;try{s=S.stateNode,f?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=S.stateNode,c=S.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=rh("display",l))}catch(k){Ue(e,e.return,k)}}}else if(S.tag===6){if(g===null)try{S.stateNode.nodeValue=f?"":S.memoizedProps}catch(k){Ue(e,e.return,k)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;g===S&&(g=null),S=S.return}g===S&&(g=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:rn(t,e),xn(e),r&4&&Fp(e);break;case 21:break;default:rn(t,e),xn(e)}}function xn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Rg(n)){var r=n;break e}n=n.return}throw Error(I(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xo(s,""),r.flags&=-33);var o=Up(e);Sc(e,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,u=Up(e);wc(e,u,l);break;default:throw Error(I(161))}}catch(c){Ue(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jv(e,t,n){G=e,Pg(e)}function Pg(e,t,n){for(var r=(e.mode&1)!==0;G!==null;){var s=G,o=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||si;if(!l){var u=s.alternate,c=u!==null&&u.memoizedState!==null||xt;u=si;var f=xt;if(si=l,(xt=c)&&!f)for(G=s;G!==null;)l=G,c=l.child,l.tag===22&&l.memoizedState!==null?Bp(s):c!==null?(c.return=l,G=c):Bp(s);for(;o!==null;)G=o,Pg(o),o=o.sibling;G=s,si=u,xt=f}zp(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,G=o):zp(e)}}function zp(e){for(;G!==null;){var t=G;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:xt||fa(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!xt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:sn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&kp(t,o,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}kp(t,l,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var g=f.memoizedState;if(g!==null){var S=g.dehydrated;S!==null&&nl(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(I(163))}xt||t.flags&512&&vc(t)}catch(b){Ue(t,t.return,b)}}if(t===e){G=null;break}if(n=t.sibling,n!==null){n.return=t.return,G=n;break}G=t.return}}function $p(e){for(;G!==null;){var t=G;if(t===e){G=null;break}var n=t.sibling;if(n!==null){n.return=t.return,G=n;break}G=t.return}}function Bp(e){for(;G!==null;){var t=G;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{fa(4,t)}catch(c){Ue(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ue(t,s,c)}}var o=t.return;try{vc(t)}catch(c){Ue(t,o,c)}break;case 5:var l=t.return;try{vc(t)}catch(c){Ue(t,l,c)}}}catch(c){Ue(t,t.return,c)}if(t===e){G=null;break}var u=t.sibling;if(u!==null){u.return=t.return,G=u;break}G=t.return}}var Cv=Math.ceil,Gi=Bn.ReactCurrentDispatcher,xd=Bn.ReactCurrentOwner,Xt=Bn.ReactCurrentBatchConfig,fe=0,st=null,Ge=null,dt=0,Ft=0,As=Cr(0),Qe=0,pl=null,Zr=0,pa=0,vd=0,Go=null,Tt=null,wd=0,Ys=1/0,Pn=null,Yi=!1,bc=null,hr=null,oi=!1,ur=null,Qi=0,Yo=0,Nc=null,wi=-1,Si=0;function Ct(){return fe&6?Be():wi!==-1?wi:wi=Be()}function gr(e){return e.mode&1?fe&2&&dt!==0?dt&-dt:uv.transition!==null?(Si===0&&(Si=gh()),Si):(e=we,e!==0||(e=window.event,e=e===void 0?16:Nh(e.type)),e):1}function cn(e,t,n,r){if(50<Yo)throw Yo=0,Nc=null,Error(I(185));yl(e,n,r),(!(fe&2)||e!==st)&&(e===st&&(!(fe&2)&&(pa|=n),Qe===4&&ir(e,dt)),Dt(e,r),n===1&&fe===0&&!(t.mode&1)&&(Ys=Be()+500,ua&&Er()))}function Dt(e,t){var n=e.callbackNode;ux(e,t);var r=Pi(e,e===st?dt:0);if(r===0)n!==null&&qf(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&qf(n),t===1)e.tag===0?av(Wp.bind(null,e)):Bh(Wp.bind(null,e)),sv(function(){!(fe&6)&&Er()}),n=null;else{switch(yh(r)){case 1:n=Kc;break;case 4:n=mh;break;case 16:n=Ai;break;case 536870912:n=hh;break;default:n=Ai}n=zg(n,Ig.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ig(e,t){if(wi=-1,Si=0,fe&6)throw Error(I(327));var n=e.callbackNode;if(zs()&&e.callbackNode!==n)return null;var r=Pi(e,e===st?dt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ji(e,r);else{t=r;var s=fe;fe|=2;var o=Lg();(st!==e||dt!==t)&&(Pn=null,Ys=Be()+500,Yr(e,t));do try{Rv();break}catch(u){Dg(e,u)}while(!0);od(),Gi.current=o,fe=s,Ge!==null?t=0:(st=null,dt=0,t=Qe)}if(t!==0){if(t===2&&(s=Ju(e),s!==0&&(r=s,t=kc(e,s))),t===1)throw n=pl,Yr(e,0),ir(e,r),Dt(e,Be()),n;if(t===6)ir(e,r);else{if(s=e.current.alternate,!(r&30)&&!Ev(s)&&(t=Ji(e,r),t===2&&(o=Ju(e),o!==0&&(r=o,t=kc(e,o))),t===1))throw n=pl,Yr(e,0),ir(e,r),Dt(e,Be()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(I(345));case 2:zr(e,Tt,Pn);break;case 3:if(ir(e,r),(r&130023424)===r&&(t=wd+500-Be(),10<t)){if(Pi(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ct(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=sc(zr.bind(null,e,Tt,Pn),t);break}zr(e,Tt,Pn);break;case 4:if(ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var l=31-un(r);o=1<<l,l=t[l],l>s&&(s=l),r&=~o}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cv(r/1960))-r,10<r){e.timeoutHandle=sc(zr.bind(null,e,Tt,Pn),r);break}zr(e,Tt,Pn);break;case 5:zr(e,Tt,Pn);break;default:throw Error(I(329))}}}return Dt(e,Be()),e.callbackNode===n?Ig.bind(null,e):null}function kc(e,t){var n=Go;return e.current.memoizedState.isDehydrated&&(Yr(e,t).flags|=256),e=Ji(e,t),e!==2&&(t=Tt,Tt=n,t!==null&&jc(t)),e}function jc(e){Tt===null?Tt=e:Tt.push.apply(Tt,e)}function Ev(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!dn(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ir(e,t){for(t&=~vd,t&=~pa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-un(t),r=1<<n;e[n]=-1,t&=~r}}function Wp(e){if(fe&6)throw Error(I(327));zs();var t=Pi(e,0);if(!(t&1))return Dt(e,Be()),null;var n=Ji(e,t);if(e.tag!==0&&n===2){var r=Ju(e);r!==0&&(t=r,n=kc(e,r))}if(n===1)throw n=pl,Yr(e,0),ir(e,t),Dt(e,Be()),n;if(n===6)throw Error(I(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zr(e,Tt,Pn),Dt(e,Be()),null}function Sd(e,t){var n=fe;fe|=1;try{return e(t)}finally{fe=n,fe===0&&(Ys=Be()+500,ua&&Er())}}function es(e){ur!==null&&ur.tag===0&&!(fe&6)&&zs();var t=fe;fe|=1;var n=Xt.transition,r=we;try{if(Xt.transition=null,we=1,e)return e()}finally{we=r,Xt.transition=n,fe=t,!(fe&6)&&Er()}}function bd(){Ft=As.current,Re(As)}function Yr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,rv(n)),Ge!==null)for(n=Ge.return;n!==null;){var r=n;switch(nd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Mi();break;case 3:Ks(),Re(Pt),Re(vt),dd();break;case 5:cd(r);break;case 4:Ks();break;case 13:Re(Ie);break;case 19:Re(Ie);break;case 10:ld(r.type._context);break;case 22:case 23:bd()}n=n.return}if(st=e,Ge=e=yr(e.current,null),dt=Ft=t,Qe=0,pl=null,vd=pa=Zr=0,Tt=Go=null,Wr!==null){for(t=0;t<Wr.length;t++)if(n=Wr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var l=o.next;o.next=s,r.next=l}n.pending=r}Wr=null}return e}function Dg(e,t){do{var n=Ge;try{if(od(),yi.current=Ki,Vi){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vi=!1}if(Xr=0,rt=Ye=De=null,Vo=!1,cl=0,xd.current=null,n===null||n.return===null){Qe=1,pl=t,Ge=null;break}e:{var o=e,l=n.return,u=n,c=t;if(t=dt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,g=u,S=g.tag;if(!(g.mode&1)&&(S===0||S===11||S===15)){var b=g.alternate;b?(g.updateQueue=b.updateQueue,g.memoizedState=b.memoizedState,g.lanes=b.lanes):(g.updateQueue=null,g.memoizedState=null)}var E=Tp(l);if(E!==null){E.flags&=-257,Ap(E,l,u,o,t),E.mode&1&&Rp(o,f,t),t=E,c=f;var j=t.updateQueue;if(j===null){var k=new Set;k.add(c),t.updateQueue=k}else j.add(c);break e}else{if(!(t&1)){Rp(o,f,t),Nd();break e}c=Error(I(426))}}else if(Ae&&u.mode&1){var J=Tp(l);if(J!==null){!(J.flags&65536)&&(J.flags|=256),Ap(J,l,u,o,t),rd(Gs(c,u));break e}}o=c=Gs(c,u),Qe!==4&&(Qe=2),Go===null?Go=[o]:Go.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=yg(o,c,t);Np(o,y);break e;case 1:u=c;var m=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(hr===null||!hr.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t;var T=xg(o,u,t);Np(o,T);break e}}o=o.return}while(o!==null)}Mg(n)}catch(O){t=O,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function Lg(){var e=Gi.current;return Gi.current=Ki,e===null?Ki:e}function Nd(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),st===null||!(Zr&268435455)&&!(pa&268435455)||ir(st,dt)}function Ji(e,t){var n=fe;fe|=2;var r=Lg();(st!==e||dt!==t)&&(Pn=null,Yr(e,t));do try{_v();break}catch(s){Dg(e,s)}while(!0);if(od(),fe=n,Gi.current=r,Ge!==null)throw Error(I(261));return st=null,dt=0,Qe}function _v(){for(;Ge!==null;)Og(Ge)}function Rv(){for(;Ge!==null&&!ex();)Og(Ge)}function Og(e){var t=Fg(e.alternate,e,Ft);e.memoizedProps=e.pendingProps,t===null?Mg(e):Ge=t,xd.current=null}function Mg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=bv(n,t),n!==null){n.flags&=32767,Ge=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qe=6,Ge=null;return}}else if(n=Sv(n,t,Ft),n!==null){Ge=n;return}if(t=t.sibling,t!==null){Ge=t;return}Ge=t=e}while(t!==null);Qe===0&&(Qe=5)}function zr(e,t,n){var r=we,s=Xt.transition;try{Xt.transition=null,we=1,Tv(e,t,n,r)}finally{Xt.transition=s,we=r}return null}function Tv(e,t,n,r){do zs();while(ur!==null);if(fe&6)throw Error(I(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(I(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(cx(e,o),e===st&&(Ge=st=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||oi||(oi=!0,zg(Ai,function(){return zs(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Xt.transition,Xt.transition=null;var l=we;we=1;var u=fe;fe|=4,xd.current=null,kv(e,n),Ag(n,e),Jx(nc),Ii=!!tc,nc=tc=null,e.current=n,jv(n),tx(),fe=u,we=l,Xt.transition=o}else e.current=n;if(oi&&(oi=!1,ur=e,Qi=s),o=e.pendingLanes,o===0&&(hr=null),sx(n.stateNode),Dt(e,Be()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Yi)throw Yi=!1,e=bc,bc=null,e;return Qi&1&&e.tag!==0&&zs(),o=e.pendingLanes,o&1?e===Nc?Yo++:(Yo=0,Nc=e):Yo=0,Er(),null}function zs(){if(ur!==null){var e=yh(Qi),t=Xt.transition,n=we;try{if(Xt.transition=null,we=16>e?16:e,ur===null)var r=!1;else{if(e=ur,ur=null,Qi=0,fe&6)throw Error(I(331));var s=fe;for(fe|=4,G=e.current;G!==null;){var o=G,l=o.child;if(G.flags&16){var u=o.deletions;if(u!==null){for(var c=0;c<u.length;c++){var f=u[c];for(G=f;G!==null;){var g=G;switch(g.tag){case 0:case 11:case 15:Ko(8,g,o)}var S=g.child;if(S!==null)S.return=g,G=S;else for(;G!==null;){g=G;var b=g.sibling,E=g.return;if(_g(g),g===f){G=null;break}if(b!==null){b.return=E,G=b;break}G=E}}}var j=o.alternate;if(j!==null){var k=j.child;if(k!==null){j.child=null;do{var J=k.sibling;k.sibling=null,k=J}while(k!==null)}}G=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,G=l;else e:for(;G!==null;){if(o=G,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ko(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,G=y;break e}G=o.return}}var m=e.current;for(G=m;G!==null;){l=G;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,G=v;else e:for(l=m;G!==null;){if(u=G,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:fa(9,u)}}catch(O){Ue(u,u.return,O)}if(u===l){G=null;break e}var T=u.sibling;if(T!==null){T.return=u.return,G=T;break e}G=u.return}}if(fe=s,Er(),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(sa,e)}catch{}r=!0}return r}finally{we=n,Xt.transition=t}}return!1}function Hp(e,t,n){t=Gs(n,t),t=yg(e,t,1),e=mr(e,t,1),t=Ct(),e!==null&&(yl(e,1,t),Dt(e,t))}function Ue(e,t,n){if(e.tag===3)Hp(e,e,n);else for(;t!==null;){if(t.tag===3){Hp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hr===null||!hr.has(r))){e=Gs(n,e),e=xg(t,e,1),t=mr(t,e,1),e=Ct(),t!==null&&(yl(t,1,e),Dt(t,e));break}}t=t.return}}function Av(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ct(),e.pingedLanes|=e.suspendedLanes&n,st===e&&(dt&n)===n&&(Qe===4||Qe===3&&(dt&130023424)===dt&&500>Be()-wd?Yr(e,0):vd|=n),Dt(e,t)}function Ug(e,t){t===0&&(e.mode&1?(t=Ql,Ql<<=1,!(Ql&130023424)&&(Ql=4194304)):t=1);var n=Ct();e=zn(e,t),e!==null&&(yl(e,t,n),Dt(e,n))}function Pv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ug(e,n)}function Iv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(I(314))}r!==null&&r.delete(t),Ug(e,n)}var Fg;Fg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Pt.current)At=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return At=!1,wv(e,t,n);At=!!(e.flags&131072)}else At=!1,Ae&&t.flags&1048576&&Wh(t,zi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;vi(e,t),e=t.pendingProps;var s=Ws(t,vt.current);Fs(t,n),s=pd(null,t,r,e,s,n);var o=md();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,It(r)?(o=!0,Ui(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ad(t),s.updater=da,t.stateNode=s,s._reactInternals=t,dc(t,r,e,n),t=mc(null,t,r,!0,o,n)):(t.tag=0,Ae&&o&&td(t),jt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(vi(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Lv(r),e=sn(r,e),s){case 0:t=pc(null,t,r,e,n);break e;case 1:t=Dp(null,t,r,e,n);break e;case 11:t=Pp(null,t,r,e,n);break e;case 14:t=Ip(null,t,r,sn(r.type,e),n);break e}throw Error(I(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),pc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Dp(e,t,r,s,n);case 3:e:{if(bg(t),e===null)throw Error(I(387));r=t.pendingProps,o=t.memoizedState,s=o.element,Qh(e,t),Wi(t,r,null,n);var l=t.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Gs(Error(I(423)),t),t=Lp(e,t,r,n,s);break e}else if(r!==s){s=Gs(Error(I(424)),t),t=Lp(e,t,r,n,s);break e}else for(zt=pr(t.stateNode.containerInfo.firstChild),$t=t,Ae=!0,ln=null,n=Gh(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hs(),r===s){t=$n(e,t,n);break e}jt(e,t,r,n)}t=t.child}return t;case 5:return Jh(t),e===null&&ac(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,l=s.children,rc(r,s)?l=null:o!==null&&rc(r,o)&&(t.flags|=32),Sg(e,t),jt(e,t,l,n),t.child;case 6:return e===null&&ac(t),null;case 13:return Ng(e,t,n);case 4:return ud(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Vs(t,null,r,n):jt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Pp(e,t,r,s,n);case 7:return jt(e,t,t.pendingProps,n),t.child;case 8:return jt(e,t,t.pendingProps.children,n),t.child;case 12:return jt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,l=s.value,Ce($i,r._currentValue),r._currentValue=l,o!==null)if(dn(o.value,l)){if(o.children===s.children&&!Pt.current){t=$n(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var u=o.dependencies;if(u!==null){l=o.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=On(-1,n&-n),c.tag=2;var f=o.updateQueue;if(f!==null){f=f.shared;var g=f.pending;g===null?c.next=c:(c.next=g.next,g.next=c),f.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),uc(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(o.tag===10)l=o.type===t.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(I(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),uc(l,n,t),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===t){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}jt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Fs(t,n),s=Zt(s),r=r(s),t.flags|=1,jt(e,t,r,n),t.child;case 14:return r=t.type,s=sn(r,t.pendingProps),s=sn(r.type,s),Ip(e,t,r,s,n);case 15:return vg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),vi(e,t),t.tag=1,It(r)?(e=!0,Ui(t)):e=!1,Fs(t,n),gg(t,r,s),dc(t,r,s,n),mc(null,t,r,!0,e,n);case 19:return kg(e,t,n);case 22:return wg(e,t,n)}throw Error(I(156,t.tag))};function zg(e,t){return ph(e,t)}function Dv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(e,t,n,r){return new Dv(e,t,n,r)}function kd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Lv(e){if(typeof e=="function")return kd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wc)return 11;if(e===Hc)return 14}return 2}function yr(e,t){var n=e.alternate;return n===null?(n=qt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function bi(e,t,n,r,s,o){var l=2;if(r=e,typeof e=="function")kd(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ss:return Qr(n.children,s,o,t);case Bc:l=8,s|=8;break;case Lu:return e=qt(12,n,t,s|2),e.elementType=Lu,e.lanes=o,e;case Ou:return e=qt(13,n,t,s),e.elementType=Ou,e.lanes=o,e;case Mu:return e=qt(19,n,t,s),e.elementType=Mu,e.lanes=o,e;case Jm:return ma(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ym:l=10;break e;case Qm:l=9;break e;case Wc:l=11;break e;case Hc:l=14;break e;case rr:l=16,r=null;break e}throw Error(I(130,e==null?e:typeof e,""))}return t=qt(l,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function Qr(e,t,n,r){return e=qt(7,e,r,t),e.lanes=n,e}function ma(e,t,n,r){return e=qt(22,e,r,t),e.elementType=Jm,e.lanes=n,e.stateNode={isHidden:!1},e}function xu(e,t,n){return e=qt(6,e,null,t),e.lanes=n,e}function vu(e,t,n){return t=qt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ov(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Za(0),this.expirationTimes=Za(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Za(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jd(e,t,n,r,s,o,l,u,c){return e=new Ov(e,t,n,u,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=qt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ad(o),e}function Mv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function $g(e){if(!e)return br;e=e._reactInternals;e:{if(os(e)!==e||e.tag!==1)throw Error(I(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(It(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(I(171))}if(e.tag===1){var n=e.type;if(It(n))return $h(e,n,t)}return t}function Bg(e,t,n,r,s,o,l,u,c){return e=jd(n,r,!0,e,s,o,l,u,c),e.context=$g(null),n=e.current,r=Ct(),s=gr(n),o=On(r,s),o.callback=t??null,mr(n,o,s),e.current.lanes=s,yl(e,s,r),Dt(e,r),e}function ha(e,t,n,r){var s=t.current,o=Ct(),l=gr(s);return n=$g(n),t.context===null?t.context=n:t.pendingContext=n,t=On(o,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=mr(s,t,l),e!==null&&(cn(e,s,l,o),gi(e,s,l)),l}function qi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Cd(e,t){Vp(e,t),(e=e.alternate)&&Vp(e,t)}function Uv(){return null}var Wg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ed(e){this._internalRoot=e}ga.prototype.render=Ed.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(I(409));ha(e,t,null,null)};ga.prototype.unmount=Ed.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;es(function(){ha(null,e,null,null)}),t[Fn]=null}};function ga(e){this._internalRoot=e}ga.prototype.unstable_scheduleHydration=function(e){if(e){var t=wh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<lr.length&&t!==0&&t<lr[n].priority;n++);lr.splice(n,0,e),n===0&&bh(e)}};function _d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ya(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kp(){}function Fv(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var f=qi(l);o.call(f)}}var l=Bg(t,r,e,0,null,!1,!1,"",Kp);return e._reactRootContainer=l,e[Fn]=l.current,ol(e.nodeType===8?e.parentNode:e),es(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var f=qi(c);u.call(f)}}var c=jd(e,0,!1,null,null,!1,!1,"",Kp);return e._reactRootContainer=c,e[Fn]=c.current,ol(e.nodeType===8?e.parentNode:e),es(function(){ha(t,c,n,r)}),c}function xa(e,t,n,r,s){var o=n._reactRootContainer;if(o){var l=o;if(typeof s=="function"){var u=s;s=function(){var c=qi(l);u.call(c)}}ha(t,l,e,s)}else l=Fv(n,t,e,s,r);return qi(l)}xh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Do(t.pendingLanes);n!==0&&(Gc(t,n|1),Dt(t,Be()),!(fe&6)&&(Ys=Be()+500,Er()))}break;case 13:es(function(){var r=zn(e,1);if(r!==null){var s=Ct();cn(r,e,1,s)}}),Cd(e,1)}};Yc=function(e){if(e.tag===13){var t=zn(e,134217728);if(t!==null){var n=Ct();cn(t,e,134217728,n)}Cd(e,134217728)}};vh=function(e){if(e.tag===13){var t=gr(e),n=zn(e,t);if(n!==null){var r=Ct();cn(n,e,t,r)}Cd(e,t)}};wh=function(){return we};Sh=function(e,t){var n=we;try{return we=e,t()}finally{we=n}};Gu=function(e,t,n){switch(t){case"input":if(zu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=aa(r);if(!s)throw Error(I(90));Xm(r),zu(r,s)}}}break;case"textarea":eh(e,n);break;case"select":t=n.value,t!=null&&Ls(e,!!n.multiple,t,!1)}};ih=Sd;ah=es;var zv={usingClientEntryPoint:!1,Events:[vl,js,aa,oh,lh,Sd]},Eo={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$v={bundleType:Eo.bundleType,version:Eo.version,rendererPackageName:Eo.rendererPackageName,rendererConfig:Eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dh(e),e===null?null:e.stateNode},findFiberByHostInstance:Eo.findFiberByHostInstance||Uv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var li=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!li.isDisabled&&li.supportsFiber)try{sa=li.inject($v),bn=li}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zv;Wt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_d(t))throw Error(I(200));return Mv(e,t,null,n)};Wt.createRoot=function(e,t){if(!_d(e))throw Error(I(299));var n=!1,r="",s=Wg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=jd(e,1,!1,null,null,n,!1,r,s),e[Fn]=t.current,ol(e.nodeType===8?e.parentNode:e),new Ed(t)};Wt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(I(188)):(e=Object.keys(e).join(","),Error(I(268,e)));return e=dh(t),e=e===null?null:e.stateNode,e};Wt.flushSync=function(e){return es(e)};Wt.hydrate=function(e,t,n){if(!ya(t))throw Error(I(200));return xa(null,e,t,!0,n)};Wt.hydrateRoot=function(e,t,n){if(!_d(e))throw Error(I(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",l=Wg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Bg(t,null,e,1,n??null,s,!1,o,l),e[Fn]=t.current,ol(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new ga(t)};Wt.render=function(e,t,n){if(!ya(t))throw Error(I(200));return xa(null,e,t,!1,n)};Wt.unmountComponentAtNode=function(e){if(!ya(e))throw Error(I(40));return e._reactRootContainer?(es(function(){xa(null,null,e,!1,function(){e._reactRootContainer=null,e[Fn]=null})}),!0):!1};Wt.unstable_batchedUpdates=Sd;Wt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ya(n))throw Error(I(200));if(e==null||e._reactInternals===void 0)throw Error(I(38));return xa(e,t,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function Hg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hg)}catch(e){console.error(e)}}Hg(),Hm.exports=Wt;var Bv=Hm.exports,Gp=Bv;Iu.createRoot=Gp.createRoot,Iu.hydrateRoot=Gp.hydrateRoot;const Wv={1:[{rows:1,cols:1}],2:[{rows:1,cols:2},{rows:2,cols:1}],3:[{rows:2,cols:2},{rows:1,cols:3},{rows:3,cols:1}],4:[{rows:2,cols:2},{rows:1,cols:4},{rows:4,cols:1}],5:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:5},{rows:5,cols:1}],6:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:6},{rows:6,cols:1}],7:[{rows:2,cols:4},{rows:4,cols:2}],8:[{rows:2,cols:4},{rows:4,cols:2},{rows:3,cols:3}],9:[{rows:3,cols:3},{rows:2,cols:5},{rows:5,cols:2}],10:[{rows:2,cols:5},{rows:5,cols:2}]},$s=(e,t)=>{if(!Number.isFinite(e))return t;const n=Math.floor(e);return n>0?n:t};function Hv(e){const t=$s(e,1);return(Wv[t]||[]).map(r=>({...r}))}function Cc(e,t){if(!e)return null;const n=$s(t,1),r=$s(e.rows,1),s=$s(e.cols,1),o=r*s;if(o<n)return null;let l=e.emptySeatIndex??null;return o>n?(l==null||l<0||l>=o)&&(l=o-1):l=null,{rows:r,cols:s,emptySeatIndex:l}}const Yp=(e,t)=>{const n=$s(e,1),r=(t||0)===90,s=Math.ceil(Math.sqrt(n)),o=r?s:Math.ceil(n/s),l=Math.ceil(n/o);return Cc({rows:o,cols:l},n)||{rows:1,cols:n}};function Vg(e,t,n){const r=$s(e,1),s=Cc(n,r);if(s)return s;const o=Hv(r);if(!o.length)return Yp(r,t);const l=(t||0)===90,c=o.filter(f=>l?f.rows>=f.cols:f.cols>=f.rows)[0]||o[0];return Cc(c,r)||Yp(r,t)}const Vv="newui_app_state",Ec=1,Kv=e=>!!e&&typeof e=="object";function Gv(e){const t=Math.max(0,e.capacity||0),n=Array.isArray(e.preferredSeatIndexes)?e.preferredSeatIndexes:[],r=[];for(const s of n){const o=typeof s=="number"?s:parseInt(String(s),10);!Number.isFinite(o)||!Number.isInteger(o)||o<0||o>=t||r.push(o)}return Array.from(new Set(r)).sort((s,o)=>s-o)}function Yv(e){const t=(e.seatIds??[]).slice(),n=Math.max(0,e.capacity||0);if(t.length<n)for(let l=t.length;l<n;l++)t[l]=String(e.id)+"_s"+l;else t.length>n&&(t.length=n);const r=Gv(e),s=Vg(n,e.rotation||0,e.seatLayout),o=Kv(e.meta)?e.meta:void 0;return{...e,seatIds:t,preferredSeatIndexes:r,seatLayout:s,meta:o}}function Qv(e){return{...e,tables:e.tables.map(Yv)}}function Jv(e){const n=((e||{layouts:[]}).layouts||[]).map(Qv);return{version:Ec,layouts:n}}function qv(){try{const e=localStorage.getItem(Vv);if(!e)return{version:Ec,layouts:[]};const t=JSON.parse(e);return Jv(t)}catch{return{version:Ec,layouts:[]}}}function Xv(){return qv().layouts}const Zv="newui_periods_state";function ew(){try{const e=localStorage.getItem(Zv);if(!e)return{periods:[],currentId:null};const t=JSON.parse(e);return{periods:t.periods??[],currentId:t.currentId??null}}catch{return{periods:[],currentId:null}}}function _c(){return ew()}const tw="newui_tags_state_v1";function nw(){try{const e=localStorage.getItem(tw);return e?{version:1,tags:JSON.parse(e).tags??[]}:{version:1,tags:[]}}catch{return{version:1,tags:[]}}}function rw(){return nw().tags}const sw=d.createContext(null),ow="newui_students_state_v1";function lw(){try{const e=localStorage.getItem(ow);return e?{version:1,students:JSON.parse(e).students??[]}:{version:1,students:[]}}catch{return{version:1,students:[]}}}function iw(){return lw().students}const aw={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","6xl":"max-w-6xl","7xl":"max-w-7xl"};function Rd({isOpen:e,onRequestClose:t,title:n,subtitle:r,headerRight:s,footer:o,children:l,maxWidth:u="6xl",bodyClassName:c,bodyPadding:f=!0,showCloseX:g=!1}){if(d.useEffect(()=>{if(!e)return;const b=E=>{E.key==="Escape"&&t()};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[e,t]),!e)return null;const S=f?"px-5 py-4":"";return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40",style:{width:"100dvw",height:"100dvh"},onMouseDown:t}),i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{width:"100dvw",height:"100dvh"},children:i.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative w-full rounded-xl bg-white shadow-xl border border-slate-200 max-h-[90vh] overflow-hidden flex flex-col ${aw[u]}`,onMouseDown:b=>b.stopPropagation(),children:[i.jsx("div",{className:"border-b border-slate-200 px-5 py-4 bg-white",children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"min-w-0",children:[n&&i.jsx("div",{className:"text-lg font-semibold text-slate-900",children:n}),r&&i.jsx("div",{className:"text-sm text-slate-500",children:r})]}),(s||g)&&i.jsxs("div",{className:"flex items-center gap-2",children:[s,g&&i.jsx("button",{type:"button","aria-label":"Close",onClick:t,className:"rounded-md p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:i.jsx("span",{"aria-hidden":"true",className:"text-lg leading-none",children:""})})]})]})}),i.jsx("div",{className:`flex-1 min-h-0 overflow-y-auto overscroll-contain ${S} ${c??""}`,children:l}),o&&i.jsx("div",{className:"border-t border-slate-200 px-5 py-4 bg-slate-50",children:o})]})})]})}function uw(){return"pro"}function cw(e=uw()){return{tier:e,canUseDriveSync:e!=="free",canUseLocalSave:!0,canExportPDF:e!=="free",canUseAdvancedReports:e==="school"||e==="pro",canUseImports:!0,canUseMobile:!0}}function dw({studentId:e,hasPhoto:t=!1,src:n=null,onClick:r,widthPx:s,heightPx:o,sizePx:l=44}){const f={width:s??l,height:o??l};return i.jsx("button",{type:"button","aria-label":t?"Update student photo":"Add student photo",className:"flex-shrink-0 rounded-xl border border-slate-200 bg-white/60 overflow-hidden active:scale-[0.98]",style:f,onClick:g=>{g.stopPropagation(),r==null||r(e)},children:t&&n?i.jsx("img",{src:n,alt:"Student photo",className:"w-full h-full object-cover",draggable:!1}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18","aria-hidden":"true",className:"text-slate-500",children:i.jsx("path",{fill:"currentColor",d:"M9.5 4.5h5l1.2 1.8H19a2.5 2.5 0 0 1 2.5 2.5v8.7A2.5 2.5 0 0 1 19 20H5a2.5 2.5 0 0 1-2.5-2.5V8.8A2.5 2.5 0 0 1 5 6.3h3.3l1.2-1.8ZM12 9a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 1.7a2.3 2.3 0 1 1 0 4.6 2.3 2.3 0 0 1 0-4.6Z"})})})})}function Kg(e){const t=(e||"").trim();if(!t)return{first:"Unknown",last:"Unknown"};if(t.includes(",")){const[o,l]=t.split(",",2),u=(o||"").trim()||"Unknown";return{first:(l||"").trim().split(/\s+/).filter(Boolean)[0]||"Unknown",last:u}}const n=t.split(/\s+/).filter(Boolean);if(n.length===1)return{first:n[0],last:"Unknown"};const r=n[0]||"Unknown",s=n[n.length-1]||"Unknown";return{first:r,last:s}}function Xi(e){return(e||"").trim().replace(/\s+/g,"_").replace(/[^A-Za-z0-9_-]/g,"").replace(/_+/g,"_")||"Unknown"}function Td(e,t){const n=Kg(t),r=Xi(n.first);return`${Xi(n.last)}_${r}__id_${e}.jpg`}var Am,Pm;const Rc=((Pm=(Am=import.meta)==null?void 0:Am.env)==null?void 0:Pm.VITE_GOOGLE_CLIENT_ID)??"403722152172-rm3rvd6kba8s10a8svv60jbj2s93kv1e.apps.googleusercontent.com",fw="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email",Zi="ClassSeats";function pw(e){return e?e.startsWith(".")?e:`.${e}`:""}function mw(e,t,n){const r=Kg(t),s=Xi(r.first),o=Xi(r.last),l=pw(n);return`${o}_${s}__audio__id_${e}${l}`}const Gg="classseats_mobile_drive_session_v2",Ad="classseats_mobile_drive_folder_v1",Pd="classseats_student_docs_folder_v1",Yg={classseats:"data_v1"},Qp="Student Docs",Jp="studentPhotos",qp="audio",Qg="https://us-east1-classseats-sync.cloudfunctions.net/exchangecode",Ni="classseats_mobile_drive_pkce_verifier",Qo="classseats_mobile_drive_return_to",ki="classseats_mobile_drive_redirect_uri",Jg="https://app.classseats.app/ClassSeatsMobile";function hw(){if(typeof window>"u")return Jg;const e=window.location.origin;return e==="https://app.classseats.app"?"https://app.classseats.app/ClassSeatsMobile":e==="https://mifish3474.github.io"?"https://mifish3474.github.io/ClassSeats-Mobile-Testing/ClassSeatsMobile":`${e}/ClassSeatsMobile`}const gw=45*60*1e3,yw="classseats_auth",xw=1,Nr="driveSession",ea="singleton";let $r=null,wn=null,Oo=!1,ji="none";function vw(e){const{sessionLoaded:t}=e,n=(e.lastWriteReason||"").trim();return t?"ok":n?n==="explicit-disconnect"?"user-logged-out":n==="fatal-oauth-error"?"oauth-failure":n==="login-success"?"device-storage-wipe":"unknown":"no-session-yet"}function Id(){return new Promise((e,t)=>{const n=indexedDB.open(yw,xw);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(Nr)||r.createObjectStore(Nr,{keyPath:"id"})},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error||new Error("IndexedDB open failed"))})}async function ww(){const e=await Id();return new Promise((t,n)=>{const o=e.transaction(Nr,"readonly").objectStore(Nr).get(ea);o.onsuccess=()=>{const l=o.result;if(l){wn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason};const{id:u,lastWriteAt:c,lastWriteReason:f,...g}=l;t(g)}else t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}async function qg(e,t){const n=await Id();return new Promise((r,s)=>{const o=n.transaction(Nr,"readwrite"),l=o.objectStore(Nr);if(!e)console.info("[Drive][IDB] CLEAR session",{reason:t}),l.delete(ea),wn={lastWriteAt:Date.now(),lastWriteReason:t};else{const u={id:ea,...e,lastWriteAt:Date.now(),lastWriteReason:t};console.info("[Drive][IDB] WRITE session",{reason:t,hasRefresh:!!e.refreshToken,expiresAt:e.expiresAt}),l.put(u),wn={lastWriteAt:u.lastWriteAt,lastWriteReason:u.lastWriteReason}}o.oncomplete=()=>r(),o.onerror=()=>s(o.error||new Error("IDB put/delete failed"))})}async function Sw(){try{const e=await Id();return await new Promise((t,n)=>{const o=e.transaction(Nr,"readonly").objectStore(Nr).get(ea);o.onsuccess=()=>{const l=o.result;l?(wn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason},t(l)):t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}catch(e){return console.warn("[Drive][IDB] getDriveSessionRecord failed",e),null}}async function bw(){const e=await Sw(),t=!!e,n=!!(e!=null&&e.refreshToken),r=(e==null?void 0:e.expiresAt)??null,s=(e==null?void 0:e.lastWriteAt)??(wn==null?void 0:wn.lastWriteAt)??null,o=(e==null?void 0:e.lastWriteReason)??(wn==null?void 0:wn.lastWriteReason)??null,l=e?"idb":"none",u=e==null?void 0:e.profile,c=vw({sessionLoaded:t,lastWriteReason:o}),f={sessionLoaded:t,hasRefresh:n,expiresAt:r,source:l,lastWriteAt:s,lastWriteReason:o,state:c,profile:u};return console.info("startup:",f),console.info("[Drive] startupSessionState",{state:c,lastWriteReason:o}),f}function Nw(){if(typeof window>"u")return null;try{const e=window.localStorage.getItem(Gg);return e?JSON.parse(e):null}catch{return null}}function kw(){typeof window>"u"||window.localStorage.removeItem(Gg)}async function va(){if(Oo)return $r;try{const t=await ww();if(t)return $r=t,ji="idb",Oo=!0,$r}catch{}const e=Nw();if(e){$r=e,ji="legacy",Oo=!0;try{await qg(e,"startup-migration")}catch{}return $r}return $r=null,ji="none",Oo=!0,null}async function Dd(e,t){$r=e,Oo=!0,ji=e?"idb":"none";try{await qg(e,t)}catch(n){console.warn("[Drive][IDB] persistSession failed",n)}}async function Xg(e){await Dd(null,e),kw()}async function jw(){return va()}function Cw(e,t=5*60*1e3){return!e||e.expiresAt<=Date.now()+t}function Ew(e){return e.replace(/^#/,"").split("&").map(t=>t.split("=")).reduce((t,[n,r])=>(n&&(t[decodeURIComponent(n)]=decodeURIComponent(r||"")),t),{})}function Zg(e,t,n,r){const s=t?t*1e3:gw;return{accessToken:e,expiresAt:Date.now()+s-60*1e3,refreshToken:n,profile:r}}async function e0(e){try{const t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return;const n=await t.json();return{email:n.email,name:n.name,picture:n.picture}}catch{return}}async function _w(){const e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rw(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=Array.from(new Uint8Array(r));return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Tw(e,t){const n=await _w(),r=await Rw(n),s=btoa(JSON.stringify({v:n,r:t||null}));return window.localStorage.setItem(Ni,n),t?window.localStorage.setItem(Qo,t):window.localStorage.removeItem(Qo),window.localStorage.setItem(ki,e),`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:Rc,redirect_uri:e,response_type:"code",scope:fw,include_granted_scopes:"true",state:s,prompt:"consent",access_type:"offline",code_challenge:r,code_challenge_method:"S256"}).toString()}`}async function Aw(e,t,n){const r={grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:n,client_id:Rc};console.info("[Drive] Exchanging code",{redirect_uri:n,client_id:Rc,code_preview:e?`${e.slice(0,4)}...${e.slice(-4)}`:"none"});const s=await fetch(Qg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const o=await s.text().catch(()=>"");throw new Error(o||"Failed to exchange code for tokens.")}return s.json()}async function Pw(){if(typeof window>"u")return null;const e=window.location.search||"",t=new URLSearchParams(e);let n=t.get("code"),r=t.get("state");if(!n&&window.location.hash){const u=Ew(window.location.hash);n=u.code||n,r=u.state||r}if(!n)return null;let s=null,o=null,l=null;if(r)try{const u=JSON.parse(atob(r));u!=null&&u.v&&typeof u.v=="string"&&(s=u.v),u!=null&&u.r&&typeof u.r=="string"&&(o=u.r),u!=null&&u.d&&typeof u.d=="string"&&(l=u.d)}catch{}if(s||(s=window.localStorage.getItem(Ni)),o||(o=window.localStorage.getItem(Qo)),l||(l=window.localStorage.getItem(ki)||Jg),!s)return null;try{const u=await Aw(n,s,l),c=await e0(u.access_token),f=Zg(u.access_token,u.expires_in,u.refresh_token,c||void 0);return await Dd(f,"login-success"),window.localStorage.removeItem(Ni),window.localStorage.removeItem(Qo),window.localStorage.removeItem(ki),o&&o!==l?window.location.replace(o):window.history.replaceState(null,document.title,l),f}catch{return window.localStorage.removeItem(Ni),window.localStorage.removeItem(Qo),window.localStorage.removeItem(ki),null}}async function Iw(e,t){if(typeof window>"u")throw new Error("Browser required.");const n=hw(),r=await Tw(n,window.location.href);return window.location.href=r,new Promise(()=>{})}async function t0(){const e=await va();if(!e)return console.warn("[Drive] refreshDriveSession: no stored session"),null;if(e.expiresAt>Date.now()+60*1e3)return console.debug("[Drive] refreshDriveSession: not expiring soon; skipping refresh",{expiresAt:e.expiresAt}),e;if(!e.refreshToken)return console.warn("[Drive] refreshDriveSession: missing refresh token; cannot refresh; keeping existing session",{expiresAt:e.expiresAt}),e;try{const t=await fetch(Qg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"refresh_token",refresh_token:e.refreshToken})});if(!t.ok){const o=await t.text().catch(()=>"");throw console.warn("[Drive] refreshDriveSession: HTTP error from token endpoint",{status:t.status,statusText:t.statusText,bodySnippet:o.slice(0,200)}),new Error("Refresh failed: "+t.status)}const n=await t.json(),r=await e0(n.access_token),s=Zg(n.access_token,n.expires_in,e.refreshToken,r||e.profile);return await Dd(s,"refresh-success"),s}catch(t){const n=String((t==null?void 0:t.message)||"");return console.warn("[Drive] refreshDriveSession: caught error",{message:n}),/invalid_grant|invalid_client/i.test(n)?(console.warn("[Drive] refreshDriveSession: treating as fatal OAuth error; clearing session"),await Xg("fatal-oauth-error")):console.warn("[Drive] refreshDriveSession: non-fatal error; keeping stored session in IDB"),null}}async function kn(e){let t=e??await va();return t?Cw(t)?await t0():t:null}async function Dw(){const e=await Pw();if(e)return e;const t=await va();return t&&t.expiresAt>Date.now()+60*1e3?t:t0()}async function Lw(){await Xg("explicit-disconnect")}async function Ee(e,t,n){const r=await fetch(t,{...n,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",...(n==null?void 0:n.headers)||{}}});if(!r.ok){const s=await r.text().catch(()=>"");throw new Error(s||"Google Drive request failed.")}return r}function kr(e){return e.replace(/'/g,"\\'")}async function to(e){const t=Ow();if(t){if(await n0(e,t))return t;Mw()}const n=new URLSearchParams({q:`name='${Zi}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return Xp(s.files[0].id),s.files[0].id;const l=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:Zi,mimeType:"application/vnd.google-apps.folder"})})).json();return Xp(l.id),l.id}function Xp(e){typeof window>"u"||window.localStorage.setItem(Ad,e)}function Ow(){return typeof window>"u"?null:window.localStorage.getItem(Ad)}function Mw(){typeof window>"u"||window.localStorage.removeItem(Ad)}function Zp(e){typeof window>"u"||window.localStorage.setItem(Pd,e)}function Uw(){return typeof window>"u"?null:window.localStorage.getItem(Pd)}function Fw(){typeof window>"u"||window.localStorage.removeItem(Pd)}async function n0(e,t){try{return(await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id`)).ok}catch{return!1}}async function zw(e){const t=Uw();if(t){if(await n0(e,t))return t;Fw()}const n=await to(e),r=new URLSearchParams({q:`'${n}' in parents and name='${kr(Qp)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json();if(Array.isArray(o.files)&&o.files.length>0)return Zp(o.files[0].id),o.files[0].id;const u=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:Qp,mimeType:"application/vnd.google-apps.folder",parents:[n]})})).json();if(!(u!=null&&u.id))throw new Error("Unable to create Student Docs folder.");return Zp(u.id),u.id}async function $w(e){const t=await to(e),n=new URLSearchParams({q:`'${t}' in parents and name='${kr(Jp)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:Jp,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student photos folder.");return l.id}async function Bw(e){const t=await to(e),n=new URLSearchParams({q:`'${t}' in parents and name='${kr(qp)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:qp,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student audio folder.");return l.id}async function Ww(e,t,n){const r=(n||"").trim();if(!r)throw new Error("Document title is required.");const o=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.document",parents:[t]})})).json();if(!(o!=null&&o.id))throw new Error("Unable to create Google Doc.");return{fileId:o.id,title:o.name||r}}async function Hw(e){const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await $w(n),s=Td(e.studentId,e.studentFullName);let o=e.fileId?String(e.fileId):null;if(!o){const S=`name='${kr(s)}' and '${r}' in parents and trashed=false`,b=new URLSearchParams({q:S,fields:"files(id)",spaces:"drive"}),j=await(await Ee(n,`https://www.googleapis.com/drive/v3/files?${b.toString()}`)).json();o=Array.isArray(j.files)&&j.files.length>0?j.files[0].id:null}if(!o){const S=`student_${e.studentId}.jpg`,b=`name='${kr(S)}' and '${r}' in parents and trashed=false`,E=new URLSearchParams({q:b,fields:"files(id)",spaces:"drive"}),k=await(await Ee(n,`https://www.googleapis.com/drive/v3/files?${E.toString()}`)).json();o=Array.isArray(k.files)&&k.files.length>0?k.files[0].id:null}const l=o?{name:s,mimeType:"image/jpeg"}:{name:s,parents:[r],mimeType:"image/jpeg"},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.jpegBlob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const S=await f.text().catch(()=>"");throw new Error(S||"Failed to upload student photo.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student photo.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function Vw(e){const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await Bw(n),s=mw(e.studentId,e.studentFullName,e.extension),o=e.fileId?String(e.fileId):null,l=o?{name:s,mimeType:e.mimeType}:{name:s,parents:[r],mimeType:e.mimeType},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.blob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const S=await f.text().catch(()=>"");throw new Error(S||"Failed to upload student audio.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student audio.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function Kw(e){if(!e)throw new Error("File ID is required.");const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");await Ee(t.accessToken,`https://www.googleapis.com/drive/v3/files/${e}`,{method:"DELETE"})}async function wu(e){const t=await to(e),n=new URLSearchParams({q:`'${t}' in parents and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json()).files||[]).map(ts)}async function Su(e,t){const r=await(await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId,appProperties`,{method:"GET"})).json();return ts(r)}async function Gw(e,t,n){const r=t.trim();if(!r)throw new Error("Folder name is required.");const s=["mimeType='application/vnd.google-apps.folder'",`name='${kr(r)}'`,"trashed=false"];n&&s.push(`'${n}' in parents`);const o=new URLSearchParams({q:s.join(" and "),fields:"files(id)",spaces:"drive"}),u=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return u.files[0].id;const f=await(await Ee(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.folder",parents:n?[n]:void 0})})).json();if(!(f!=null&&f.id))throw new Error("Unable to create folder.");return f.id}async function Yw(e,t){const n=(t||[]).map(s=>s.trim()).filter(Boolean);if(n.length===0)throw new Error("Folder path is required.");let r=null;for(const s of n){if(!r&&s===Zi){r=await to(e);continue}r=await Gw(e,s,r)}if(!r)throw new Error("Unable to resolve folder path.");return r}async function Qw(e,t){const n=t.trim();if(!n)return!1;const r=new URLSearchParams({q:`'root' in parents and mimeType='application/vnd.google-apps.folder' and name='${kr(n)}' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json(),l=Array.isArray(o.files)&&o.files.length>0?o.files[0].id:null;if(!l)return!1;const u=new URLSearchParams({q:`'${l}' in parents and trashed=false`,fields:"files(id)",spaces:"drive",pageSize:"1"}),f=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${u.toString()}`)).json();return Array.isArray(f.files)&&f.files.length>0?!1:(await Ee(e,`https://www.googleapis.com/drive/v3/files/${l}`,{method:"PATCH",body:JSON.stringify({trashed:!0})}),!0)}async function Jw(e,t,n){if(!t)throw new Error("File ID is required.");if(!n)throw new Error("Folder ID is required.");let r=null;try{const l=await(await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=parents`,{method:"GET"})).json();Array.isArray(l.parents)&&l.parents.length>0&&(r=l.parents.join(","))}catch{r=null}const s=new URLSearchParams({addParents:n,fields:"id,parents"});r&&s.set("removeParents",r),await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?${s.toString()}`,{method:"PATCH",body:JSON.stringify({})})}async function qw(e,t,n){const r=await to(e),s="classseats_drive_boundary",o={name:t,mimeType:"application/json",parents:[r],appProperties:Yg},l=[`--${s}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(o),`--${s}`,"Content-Type: application/json","",n,`--${s}--`,""].join(`\r
`),u=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${s}`},body:l});if(!u.ok){const f=await u.text().catch(()=>"");throw new Error(f||"Failed to create Google Drive file.")}const c=await u.json();return ts(c)}async function Xw(e,t,n,r="{}"){const s=n.trim();if(!s)throw new Error("File name is required.");const o=new URLSearchParams({q:`'${t}' in parents and name='${kr(s)}' and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",spaces:"drive"}),u=await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return ts(u.files[0]);const c="classseats_drive_boundary",f={name:s,mimeType:"application/json",parents:[t],appProperties:Yg},g=[`--${c}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(f),`--${c}`,"Content-Type: application/json","",r,`--${c}--`,""].join(`\r
`),S=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${c}`},body:g});if(!S.ok){const E=await S.text().catch(()=>"");throw new Error(E||"Failed to create Google Drive file.")}const b=await S.json();return ts(b)}async function vs(e,t){return(await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?alt=media`,{method:"GET"})).text()}async function em(e,t,n){const r=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${t}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:n});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(l||"Failed to upload file to Google Drive.")}const o=await(await Ee(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId`,{method:"GET"})).json();return ts(o)}function ts(e){var t;return e?{id:e.id,name:e.name,modifiedTime:e.modifiedTime,size:e.size,revisionId:e.headRevisionId||e.revisionId||((t=e==null?void 0:e.appProperties)==null?void 0:t.revisionId)}:{id:"",name:""}}async function bu(e){const t=new URLSearchParams({q:"mimeType='application/json' and trashed=false",fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Ee(e,`https://www.googleapis.com/drive/v3/files?${t.toString()}`)).json()).files||[]).map(ts)}const Vr=new Map;function r0(e,t){const n=Vr.get(e);if((n==null?void 0:n.value)!==void 0)return Promise.resolve(n.value);if(n!=null&&n.promise)return n.promise;const r=t().then(s=>(Vr.set(e,{value:s}),s)).catch(s=>{throw Vr.delete(e),s});return Vr.set(e,{promise:r}),r}function Qs(e){if(!e){Vr.clear();return}for(const t of Vr.keys())t.startsWith(e)&&Vr.delete(t)}const Zw="classseats-cache",eS=1,Mn="driveFolders",xr="studentPhotoMap",vr="photoBlobs";function wa(){return typeof indexedDB>"u"?Promise.resolve(null):new Promise(e=>{const t=indexedDB.open(Zw,eS);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Mn)||n.createObjectStore(Mn,{keyPath:"key"}),n.objectStoreNames.contains(xr)||n.createObjectStore(xr,{keyPath:"studentId"}),n.objectStoreNames.contains(vr)||n.createObjectStore(vr,{keyPath:"fileId"})},t.onsuccess=()=>e(t.result),t.onerror=()=>e(null)})}function Ld(e,t){return t?Date.now()-e>t:!1}async function no(e,t){const n=await wa();return n?new Promise(r=>{const s=n.transaction(e,"readonly"),l=s.objectStore(e).get(t);l.onsuccess=()=>r(l.result||null),l.onerror=()=>r(null),s.onabort=()=>r(null)}):null}async function Sa(e,t){const n=await wa();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).put(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function Js(e,t){const n=await wa();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).delete(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function Nu(e){const t=await wa();if(t)return new Promise(n=>{const r=t.transaction(e,"readwrite");r.objectStore(e).clear(),r.oncomplete=()=>n(),r.onerror=()=>n(),r.onabort=()=>n()})}async function s0(e,t,n){const r=await no(Mn,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(Mn,e),null):Ld(r.updatedAt,t)?(await Js(Mn,e),null):r:null}async function o0(e){await Sa(Mn,e)}async function tS(e,t,n){const r=await no(xr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(xr,e),null):Ld(r.fetchedAt,t)?(await Js(xr,e),null):r:null}async function nS(e,t){const n=await no(xr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function rS(e){await Sa(xr,e)}async function sS(e,t,n){const r=await no(vr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Js(vr,e),null):Ld(r.fetchedAt,t)?(await Js(vr,e),null):r:null}async function oS(e,t){const n=await no(vr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function l0(e){await Sa(vr,e)}async function lS(){await Promise.all([Nu(Mn),Nu(xr),Nu(vr)])}const i0="driveAccountKey";async function iS(){const e=await no(Mn,i0);return(e==null?void 0:e.value)||null}async function aS(e){const t={key:i0,value:e,updatedAt:Date.now(),accountKey:e};await Sa(Mn,t)}const tm="ClassSeats",nm="studentPhotos",a0=30*24*60*60*1e3,uS=7*24*60*60*1e3,cS=7*24*60*60*1e3,dS=5*60*1e3,fS="classseats_studentPhotoRefs_v1",pS=()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},Kr=(e,t)=>{pS()&&console.debug(`[PhotoService] ${e}`,t)},ku={folderLookups:0,photoMetaLookups:0,mediaDownloads:0};function qs(e){ku[e]+=1,Kr(`${e}=${ku[e]}`,{count:ku[e]})}const ta=new Map,na=new Map,ns=new Map;let Ci=null;const u0=(e,t)=>`${e}:${t||0}`;function c0(e){return e.replace(/'/g,"\\'")}function mS(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(fS);if(!t)return null;const n=JSON.parse(t);if(!n||typeof n!="object")return null;const r=n[e];return!r||typeof r.fileId!="string"?null:r.fileId}catch{return null}}function d0(e){let t=0;const n=[],r=()=>{if(t>=e)return;const s=n.shift();s&&s()};return async function(o){t>=e&&await new Promise(l=>n.push(l)),t+=1;try{return await o()}finally{t-=1,r()}}}const Od=d0(4),rm=d0(3);async function rs(e,t,n){const r={Authorization:`Bearer ${e}`},s=(n==null?void 0:n.body)instanceof FormData;n!=null&&n.body&&!s&&(r["Content-Type"]="application/json");const o=await fetch(t,{...n,headers:{...r,...(n==null?void 0:n.headers)||{}}});if(!o.ok){const l=await o.text().catch(()=>"");throw new Error(l||"Google Drive request failed.")}return o}async function hS(e){var n,r,s,o,l;if((r=(n=e.driveSession)==null?void 0:n.profile)!=null&&r.email)return e.driveSession.profile.email;if((s=e.driveClient)!=null&&s.getStatus)try{const u=await e.driveClient.getStatus();if(u.connected)return((o=u.profile)==null?void 0:o.email)||null}catch{}const t=await kn(e.driveSession);return((l=t==null?void 0:t.profile)==null?void 0:l.email)||null}async function Sl(e){const t=await hS(e);if(!t)return null;Ci&&Ci!==t&&await Ps("account-change");const n=await iS();return n&&n!==t&&await Ps("account-change"),Ci=t,n!==t&&await aS(t),t}async function ba(e){var n,r;if(((n=e.driveClient)==null?void 0:n.kind)==="desktop")return null;const t=await kn(e.driveSession);return t!=null&&t.accessToken?t.accessToken:(r=e.driveSession)!=null&&r.accessToken?(Kr("falling back to existing drive session token"),e.driveSession.accessToken):null}async function Md(e,t){const n=await r0(e,t);return n==null&&Qs(e),n}function Mo(e,t){const n=ns.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return ns.set(e,{url:r}),r}function gS(e){const t=ns.get(e);return(t==null?void 0:t.url)||null}function f0(e,t){const n=`${e}:`;for(const[r,s]of ns.entries())r!==e&&!r.startsWith(n)||t&&r===t||(s!=null&&s.url&&URL.revokeObjectURL(s.url),ns.delete(r))}function yS(e){const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),t}function xS(e){const t=e.replace(/\s+/g,"");return t.length<32||t.length%4!==0?!1:/^[A-Za-z0-9+/=]+$/.test(t)}function sm(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"image/jpeg"})}catch{return null}}function vS(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e))return new Blob([yS(e)]);if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=sm(t[1],n==null?void 0:n[1]);if(r)return r}}if(xS(e)){const t=sm(e);if(t)return t}return new Blob([e])}return null}async function om(e,t,n,r){const s=`name='${c0(n)}' and '${t}' in parents and trashed=false`,o=new URLSearchParams({q:s,fields:"files(id,name,modifiedTime)",spaces:"drive"});return qs("photoMetaLookups"),Od(async()=>{const u=await(await rs(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET",signal:r})).json();return!Array.isArray(u.files)||u.files.length===0?null:u.files[0]})}async function wS(e,t,n){return qs("photoMetaLookups"),Od(async()=>{const s=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"GET",signal:n})).json();return s!=null&&s.id?{id:s.id,name:s.name,modifiedTime:s.modifiedTime}:null})}async function SS(e,t,n,r){return Od(async()=>{const o=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"PATCH",body:JSON.stringify({name:n}),signal:r})).json();return o!=null&&o.id?{id:o.id,name:o.name,modifiedTime:o.modifiedTime}:null})}async function bS(e){return Md("driveFolder:classSeats",async()=>{const t=await Sl(e),n=await s0("classSeatsFolderId",a0,t||void 0);if(n!=null&&n.value)return n.value;const r=await ba(e);if(!r)return null;qs("folderLookups");const s=new URLSearchParams({q:`name='${tm}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),l=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${s.toString()}`,{method:"GET"})).json();let u=null;if(Array.isArray(l.files)&&l.files.length>0&&(u=l.files[0].id),!u){const f=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:tm,mimeType:"application/vnd.google-apps.folder"})})).json();u=(f==null?void 0:f.id)||null}return u?(await o0({key:"classSeatsFolderId",value:u,updatedAt:Date.now(),accountKey:t||void 0}),u):null})}async function NS(e){return Md("driveFolder:studentPhotos",async()=>{const t=await Sl(e),n=await s0("studentPhotosFolderId",a0,t||void 0);if(n!=null&&n.value)return n.value;const r=await ba(e);if(!r)return null;const s=await bS(e);if(!s)return null;qs("folderLookups");const o=new URLSearchParams({q:`'${s}' in parents and name='${c0(nm)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),u=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET"})).json();let c=null;if(Array.isArray(u.files)&&u.files.length>0&&(c=u.files[0].id),!c){const g=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:nm,mimeType:"application/vnd.google-apps.folder",parents:[s]})})).json();c=(g==null?void 0:g.id)||null}return c?(await o0({key:"studentPhotosFolderId",value:c,updatedAt:Date.now(),accountKey:t||void 0}),c):null})}async function Uo(e){ta.set(e.studentId,e),na.delete(e.studentId),Qs(`studentPhoto:${e.studentId}`),await rS(e)}async function kS(e,t,n,r){const s=String(e),o=await Sl(n),l=ta.get(s);if(l&&(!o||l.accountKey===o))return l;const u=await tS(s,uS,o||void 0);if(u)return ta.set(s,u),u;const c=await nS(s,o||void 0),f=na.get(s);if(f&&Date.now()-f<dS)return c||null;const g=await ba(n);if(!g)return c||null;if(c!=null&&c.fileId)try{const j=await wS(g,c.fileId,r);if(j){const k={studentId:s,fileId:j.id,fileName:j.name,updatedTime:j.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(k),k}}catch{}const S=await NS(n);if(!S)return c||null;const b=t?Td(e,t):c==null?void 0:c.fileName;if(b)try{const j=await om(g,S,b,r);if(j){const k={studentId:s,fileId:j.id,fileName:j.name,updatedTime:j.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(k),k}}catch{return c||null}try{const j=`student_${e}.jpg`,k=await om(g,S,j,r);if(k){let J=k.name,y=k.modifiedTime;if(b&&k.name!==b){const v=await SS(g,k.id,b,r);v!=null&&v.name&&(J=v.name,y=v.modifiedTime)}const m={studentId:s,fileId:k.id,fileName:J,updatedTime:y,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(m),m}}catch{return c||null}const E=mS(s);if(E){const j={studentId:s,fileId:E,fileName:b||void 0,fetchedAt:Date.now(),accountKey:o||void 0};return await Uo(j),j}return na.set(s,Date.now()),c||null}async function jS(e,t,n){var s;if(((s=t.driveClient)==null?void 0:s.kind)==="desktop"&&t.driveClient.downloadFile)return qs("mediaDownloads"),rm(async()=>{var l,u;const o=await((u=(l=t.driveClient)==null?void 0:l.downloadFile)==null?void 0:u.call(l,e));return vS(o==null?void 0:o.data)});const r=await ba(t);return r?(qs("mediaDownloads"),rm(async()=>{const o=`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,l=async b=>await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${b}`},signal:n}),u=await l(r);if(u.ok)return u.blob();if(Kr("photo download failed",{fileId:e,status:u.status}),!(u.status===401||u.status===403))return null;const f=await kn(t.driveSession),g=f==null?void 0:f.accessToken;if(!g)return Kr("photo download retry skipped: no refreshed token",{fileId:e}),null;const S=await l(g);return S.ok?(Kr("photo download recovered after token refresh",{fileId:e}),S.blob()):(Kr("photo download retry failed",{fileId:e,status:S.status}),null)})):null}async function CS(e,t,n,r){const s=u0(e,t);f0(e,s);const o=gS(s);if(o)return o;const l=await Sl(n),u=await sS(s,cS,l||void 0);if(u)return Mo(s,u.blob);const c=await oS(s,l||void 0);try{const f=await r0(`photoBlob:${s}`,async()=>jS(e,n,r));if(!f)return Qs(`photoBlob:${s}`),c?Mo(s,c.blob):null;const g={fileId:s,blob:f,fetchedAt:Date.now(),accountKey:l||void 0};return await l0(g),Mo(s,f)}catch{return Qs(`photoBlob:${s}`),c?Mo(s,c.blob):null}}async function ES(e){const t=e.photoFileId?String(e.photoFileId):"";if(!t)return{fileId:null,url:null};const n=await CS(t,e.photoUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}async function _S(e){const t=`studentPhoto:${String(e.studentId)}`;return Md(t,async()=>kS(e.studentId,e.fullName,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal))}async function RS(e){const t=u0(e.fileId,e.photoUpdatedAt);Qs(`photoBlob:${t}`);const n=String(e.studentId),r=await Sl({driveClient:e.driveClient,driveSession:e.driveSession}),s=Td(e.studentId,e.fullName),o={studentId:n,fileId:e.fileId,fileName:s,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await Uo(o);const l={fileId:t,blob:e.blob,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await l0(l),f0(e.fileId,t),Mo(t,e.blob)}async function Ps(e){e&&Kr("cache clear",{reason:e});for(const t of ns.values())URL.revokeObjectURL(t.url);ns.clear(),ta.clear(),na.clear(),Ci=null,Qs(),await lS()}function p0({studentId:e,fullName:t,photoFileId:n,photoUpdatedAt:r,driveClient:s,driveSession:o,driveAccountKey:l}){const[u,c]=d.useState(null),[f,g]=d.useState(null),[S,b]=d.useState(!1),E=d.useMemo(()=>String(e),[e]),j=d.useMemo(()=>n?String(n):"",[n]),k=(o==null?void 0:o.accessToken)||"",J=l||"";return d.useEffect(()=>{let y=!0;const m=new AbortController;return j?(b(!0),c(null),ES({photoFileId:j,photoUpdatedAt:r,driveClient:s,driveSession:o,signal:m.signal}).then(v=>{y&&(c(v.url),g(v.fileId))}).catch(()=>{y&&(c(null),g(null))}).finally(()=>{y&&b(!1)}),()=>{y=!1,m.abort()}):(c(null),g(null),b(!1),()=>{y=!1,m.abort()})},[E,j,r,s,o,k,J,t]),{photoUrl:u,fileId:f,loading:S}}const ml=new Map,TS=(e,t)=>`${e}:${t||0}`;function AS(e){return/^[A-Za-z0-9+/=\s]+$/.test(e)&&e.length%4===0}function lm(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"audio/webm"})}catch{return null}}function PS(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e)){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=new Uint8Array(t.length);return n.set(t),new Blob([n.buffer])}if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=lm(t[1],n==null?void 0:n[1]);if(r)return r}}if(AS(e)){const t=lm(e);if(t)return t}return new Blob([e])}return null}async function IS(e){var n,r;if((n=e.driveSession)!=null&&n.accessToken)return e.driveSession.accessToken;if(((r=e.driveClient)==null?void 0:r.kind)==="desktop")return null;const t=await kn(e.driveSession);return(t==null?void 0:t.accessToken)||null}function DS(e,t){const n=ml.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return ml.set(e,{url:r}),r}function LS(e){const t=ml.get(e);return(t==null?void 0:t.url)||null}function OS(e,t){for(const[n,r]of ml.entries())n.startsWith(`${e}:`)&&(t&&n===t||(r.url&&URL.revokeObjectURL(r.url),ml.delete(n)))}async function MS(e,t,n){var o;if(((o=t.driveClient)==null?void 0:o.kind)==="desktop"&&t.driveClient.downloadFile){const l=await t.driveClient.downloadFile(e);return PS(l==null?void 0:l.data)}const r=await IS(t);if(!r)return null;const s=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{method:"GET",headers:{Authorization:`Bearer ${r}`},signal:n});return s.ok?s.blob():null}async function US(e,t,n,r){const s=TS(e,t);OS(e,s);const o=LS(s);if(o)return o;const l=await MS(e,n,r);return l?DS(s,l):null}async function FS(e){const t=e.audioFileId?String(e.audioFileId):"";if(!t)return{fileId:null,url:null};const n=await US(t,e.audioUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}function Ud({studentId:e,audioFileId:t,audioUpdatedAt:n,driveClient:r,driveSession:s}){const[o,l]=d.useState(null),[u,c]=d.useState(null),[f,g]=d.useState(!1),S=d.useMemo(()=>String(e),[e]),b=d.useMemo(()=>t?String(t):"",[t]),E=(s==null?void 0:s.accessToken)||"";return d.useEffect(()=>{let j=!0;const k=new AbortController;return b?(g(!0),l(null),FS({audioFileId:b,audioUpdatedAt:n,driveClient:r,driveSession:s,signal:k.signal}).then(J=>{j&&(l(J.url),c(J.fileId))}).catch(()=>{j&&(l(null),c(null))}).finally(()=>{j&&g(!1)}),()=>{j=!1,k.abort()}):(l(null),c(null),g(!1),()=>{j=!1,k.abort()})},[S,b,n,r,s,E]),{audioUrl:o,fileId:u,loading:f}}const zS="newui_constraints_v1";function $S(){try{const e=localStorage.getItem(zS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function BS(){return $S()}const m0=d.createContext(null);function WS({children:e}){const[t,n]=d.useState([]),r=d.useCallback(l=>{n(u=>u.filter(c=>c.id!==l))},[]),s=d.useCallback(l=>{const u=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`,c=l.tone||"info",f=l.duration??4e3;n(g=>[...g,{...l,id:u,tone:c}]),f>0&&typeof window<"u"&&window.setTimeout(()=>r(u),f)},[r]),o=d.useMemo(()=>s,[s]);return i.jsxs(m0.Provider,{value:o,children:[e,i.jsx("div",{className:"pointer-events-none fixed top-6 left-1/2 -translate-x-1/2 z-[1000] flex flex-col gap-4 w-full max-w-lg items-center",children:t.map(l=>{const u=l.tone==="success"?"bg-emerald-600 text-white shadow-emerald-500/40":l.tone==="error"?"bg-rose-600 text-white shadow-rose-500/40":l.tone==="warning"?"bg-amber-500 text-slate-900 shadow-amber-400/40":"bg-slate-800 text-white shadow-slate-900/40";return i.jsxs("div",{className:`pointer-events-auto rounded-3xl px-5 py-4 shadow-2xl flex items-start gap-4 text-base font-semibold w-full ${u}`,children:[i.jsx("div",{className:"flex-1 text-sm font-semibold",children:l.message}),i.jsx("button",{className:"text-base font-bold opacity-80 hover:opacity-100",onClick:()=>r(l.id),"aria-label":"Dismiss notification",children:""})]},l.id)})})]})}function Fd(){const e=d.useContext(m0);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}const HS="newui_history_v1";function VS(){try{const e=localStorage.getItem(HS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function KS(){return VS()}const GS="newui_groupings_v1";function YS(){try{const e=localStorage.getItem(GS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function QS(){return YS()}console.log(" GroupingAlgorithm.js (FIXED v2) file loaded!");console.log(" GroupingAlgorithm v2 loaded successfully!");const JS="newui_print_settings_v1",qS={seatingChartEditor:{lastUpdated:new Date(0).toISOString()}};function XS(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function nr(e,t,n,r){const s=typeof e=="number"?e:parseFloat(String(e));return Number.isFinite(s)?Math.min(r,Math.max(n,s)):t}function ZS(e){return e==="a4"||e==="legal"||e==="tabloid"?e:"letter"}function e1(e){return Array.isArray(e)?e.filter(t=>typeof t=="string"||typeof t=="number"):null}function t1(e){return e==="posterTiled"?e:"single"}function n1(){var n,r,s,o,l;const e=XS(localStorage.getItem(JS)),t=(e==null?void 0:e.seatingChartEditor)??{};return{seatingChartEditor:{paper:ZS(t.paper),orientation:t.orientation==="portrait"?"portrait":"landscape",marginMode:t.marginMode==="max"?"max":"safe",showPhotos:t.showPhotos!==!1,showTags:t.showTags!==!1,showSeatNumbers:t.showSeatNumbers===!0,showTableHeader:t.showTableHeader!==!1,selectedTagIds:e1(t.selectedTagIds),textScale:nr(t.textScale,1,.5,2.5),photoScale:nr(t.photoScale,1,.5,2),zoom:nr(t.zoom,1,.1,4),offsetX:nr(t.offsetX,0,-5e3,5e3),offsetY:nr(t.offsetY,0,-5e3,5e3),seatingChartLayoutMode:t1(t.seatingChartLayoutMode),poster:{mode:((n=t.poster)==null?void 0:n.mode)==="manual"?"manual":"auto",rows:Math.round(nr((r=t.poster)==null?void 0:r.rows,2,1,10)),cols:Math.round(nr((s=t.poster)==null?void 0:s.cols,2,1,10)),overlapIn:nr((o=t.poster)==null?void 0:o.overlapIn,.25,0,.5),showPageLabels:((l=t.poster)==null?void 0:l.showPageLabels)!==!1},lastUpdated:typeof t.lastUpdated=="string"?t.lastUpdated:qS.seatingChartEditor.lastUpdated}}}function h0(e,t=50){const n=t>0?t:50,r=Math.ceil(n*.9),s=Math.ceil(n*.7),o=Math.ceil(n*.5);return e>=r?{label:"Good Standing",color:"green",emoji:"",min:r}:e>=s?{label:"Caution",color:"yellow",emoji:"",min:s,max:r-1}:e>=o?{label:"Warning",color:"orange",emoji:"",min:o,max:s-1}:{label:"Alert",color:"red",emoji:"",min:0,max:o-1}}function r1(){return{periods:_c().periods.map(t=>({id:t.id,behaviorNotes:t.behaviorNotes||{},pointsByStudent:t.pointsByStudent||{},pointsHistory:t.pointsHistory||[],pointsEnabled:t.pointsEnabled,startingPoints:t.startingPoints}))}}const s1=e=>{const[t,n,r]=e.split("-").map(s=>Number(s));return!Number.isFinite(t)||!Number.isFinite(n)||!Number.isFinite(r)?null:new Date(Date.UTC(t,n-1,r))},o1=e=>{const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return`${t}-${n}-${r}`},l1=e=>{const t=s1(e);return t?(t.setUTCDate(t.getUTCDate()-1),o1(t)):e},g0=(e,t,n)=>{if(!e)return null;const r=e[String(t)];return r&&r[n]||null},i1=e=>{if(!e)return null;const t=Object.keys(e);return t.length===0?null:t.reduce((n,r)=>r<n?r:n,t[0])};function ju(e){var g;const{attendance:t,studentId:n,date:r,status:s,resets:o}=e;if(!t)return 0;const l=String(n),c=g0(o,n,s==="left_early"?"leftEarly":s==="tardy"?"tardy":"absent");let f=0;for(const S of Object.keys(t))S>r||c&&S<c||((g=t[S])==null?void 0:g[l])===s&&(f+=1);return f}function a1(e){var b,E;const{attendance:t,studentId:n,date:r,resets:s}=e;if(!t)return 0;const o=String(n),l=g0(s,n,"absent");if(l&&r<l)return 0;const u=Object.keys(t).filter(j=>j<=r&&(!l||j>=l)).sort((j,k)=>k.localeCompare(j));if(u.length===0)return 0;let c=null;for(const j of u){const k=((b=t[j])==null?void 0:b[o])||"unmarked";if(k!=="unmarked"){if(k!=="absent")return 0;c=j;break}}if(!c)return 0;const f=i1(t);let g=c,S=0;for(;!(l&&g<l);){const j=((E=t[g])==null?void 0:E[o])||"unmarked";if(j==="absent")S+=1;else if(j!=="unmarked")break;if(!f||g<=f)break;g=l1(g)}return S}const y0="https://www.classseats.com/updates",zd="https://classseats.com",u1=`${zd}/privacy.html`,c1=`${zd}/terms.html`;function d1({variant:e="floating",className:t}){const n=new Date().getFullYear(),r=i.jsxs("div",{className:"w-full max-w-[460px] rounded-xl border border-indigo-100 bg-white/95 px-3 py-3 text-left text-slate-800 shadow-lg backdrop-blur",children:[i.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-700 flex flex-wrap items-center gap-1",children:[i.jsx("span",{children:"Early Access"}),i.jsx("span",{children:""}),i.jsx("a",{href:y0,target:"_blank",rel:"noreferrer",className:"text-indigo-700 underline decoration-indigo-300 decoration-2 underline-offset-4 hover:text-indigo-800",children:"Updates"}),i.jsx("span",{children:""}),i.jsxs("span",{children:["(c) ",n," ClassWare Solutions, LLC"]})]}),i.jsx("p",{className:"mt-1 text-[11px] leading-snug text-slate-700",children:"ClassSeats is in development. Features and pricing may change."})]});return e==="floating"?i.jsx("div",{className:`pointer-events-none fixed bottom-3 left-3 right-3 z-40 flex justify-end md:left-auto md:right-4 md:max-w-[420px] ${t??""}`,children:i.jsx("div",{className:"pointer-events-auto w-full md:w-auto",children:r})}):i.jsx("div",{className:t,children:r})}const f1="0.1.0",p1=new Date().toLocaleDateString();function m1({open:e,onClose:t,buildRevision:n}){const r=new Date().getFullYear();return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),i.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-700",children:["ClassSeats",i.jsx("sup",{className:"text-[6px] font-normal align-super",children:"TM"})," (Early Access)"]}),i.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"About"})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:t,"aria-label":"Close about",children:""})]}),i.jsx("p",{className:"mt-2 text-sm leading-relaxed text-slate-700",children:"ClassSeats is in active development. Features and pricing may change. Data is stored in your Google Drive or locally on your device  ClassWare Solutions, LLC does not store student data on its servers."}),i.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm text-slate-800 space-y-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"App version"}),i.jsx("span",{children:f1})]}),n&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build revision"}),i.jsxs("span",{children:["Rev ",n]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build date"}),i.jsx("span",{children:p1})]})]}),i.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[i.jsx(ii,{href:zd,label:"Home"}),i.jsx(ii,{href:u1,label:"Privacy"}),i.jsx(ii,{href:c1,label:"Terms"}),i.jsx(ii,{href:y0,label:"Get updates"})]}),i.jsxs("p",{className:"mt-4 text-[11px] text-slate-500",children:[" ",r," ClassWare Solutions, LLC. All rights reserved."]}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Google Drive is a trademark of Google LLC"}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"ClassSeats is a product of ClassWare Solutions, LLC"})]})]}):null}function ii({href:e,label:t}){return i.jsxs("a",{href:e,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-800 shadow-sm hover:border-indigo-200 hover:text-indigo-700",children:[t,i.jsx("span",{"aria-hidden":"true",children:""})]})}function h1(e){const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function g1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function y1({isOpen:e,onRequestClose:t,unreadMessages:n,allMessages:r,dismissedIds:s,onDismiss:o}){const[l,u]=Ds.useState("unread"),c=Ds.useRef(!1);Ds.useEffect(()=>{if(!e){c.current=!1;return}c.current||(c.current=!0,u("unread"))},[e]);const f=l==="all"?r:n;return i.jsxs(Rd,{isOpen:e,onRequestClose:t,title:"Messages",subtitle:"Updates and notes from ClassSeats",maxWidth:"md",footer:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsxs("p",{className:"text-xs text-slate-600",children:["Need Help? Email"," ",i.jsx("a",{className:"font-semibold text-slate-700 hover:text-slate-900",href:"mailto:support@classseats.com",children:"support@classseats.com"})]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 text-sm font-semibold",onClick:t,children:"Close"})]}),children:[i.jsxs("div",{className:"mb-3 inline-flex items-center rounded-full border border-slate-200 bg-slate-100 p-1",children:[i.jsxs("button",{type:"button",onClick:()=>u("unread"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="unread"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["Unread (",n.length,")"]}),i.jsxs("button",{type:"button",onClick:()=>u("all"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["All (",r.length,")"]})]}),f.length===0?i.jsx("div",{className:"py-6",children:l==="unread"?i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No new messages right now."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"You're all caught up."})]}):i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No messages available yet."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Published messages will appear here."})]})}):i.jsx("div",{className:"flex flex-col gap-3 py-1",children:f.map(g=>{var S,b;return i.jsxs("article",{className:"rounded-xl border border-slate-200 bg-white",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("h3",{className:"text-sm font-extrabold text-slate-900 truncate",children:g.title}),g.priority==="high"&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-100 text-rose-800 px-2 py-0.5 text-[11px] font-semibold",children:"Important"}),l==="all"&&s.has(g.id)&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2 py-0.5 text-[11px] font-semibold",children:"Dismissed"})]}),i.jsx("div",{className:"mt-1 text-xs text-slate-500",children:h1(g.publishedAt)})]}),l==="all"&&s.has(g.id)?i.jsx("span",{className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-600 px-2.5 py-1 text-[11px] font-semibold",children:"Dismissed"}):i.jsx("button",{type:"button",className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2.5 py-1 text-[11px] font-semibold hover:bg-slate-200",onClick:()=>o(g.id),title:"Dismiss this message",children:"Dismiss"})]}),i.jsxs("div",{className:"px-4 py-3",children:[i.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:g.body}),((S=g.cta)==null?void 0:S.label)&&((b=g.cta)==null?void 0:b.href)&&g1(g.cta.href)&&i.jsx("div",{className:"mt-3",children:i.jsxs("a",{className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 text-white px-3 py-2 text-sm font-semibold hover:bg-indigo-700",href:g.cta.href,target:"_blank",rel:"noopener noreferrer",children:[g.cta.label,i.jsx("span",{"aria-hidden":!0,children:""})]})})]})]},g.id)})})]})}function x1({current:e,onGoDesktop:t,onGoMobile:n}){const r="px-3 py-1.5 text-xs font-semibold rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500",s="bg-slate-900 text-white",o="bg-white text-slate-700 border border-slate-200 hover:bg-slate-50";return i.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white/80 p-1 shadow-sm",children:[i.jsx("button",{type:"button","aria-pressed":e==="desktop",className:`${r} ${e==="desktop"?s:o}`,onClick:t,children:"Desktop"}),i.jsx("button",{type:"button","aria-pressed":e==="mobile",className:`${r} ${e==="mobile"?s:o}`,onClick:n,children:"Mobile"})]})}function v1(){var n;if(typeof navigator>"u")return!1;const e=(n=navigator.userAgentData)==null?void 0:n.mobile;if(typeof e=="boolean")return e;const t=navigator.userAgent||"";return/iPhone|Android.+Mobile|Windows Phone|iPod/i.test(t)}function w1(e,t,n){const r=_c().currentId,s=r!=null?String(r):null,o=new Date().toISOString();return{schemaVersion:1,version:1,exportedAt:o,updatedAt:o,lastWriter:"unknown",layouts:Xv(),periodsState:_c(),lastEditedPeriodId:s,lastEditedDate:null,students:n||iw(),tags:rw(),behaviorState:r1(),constraintsState:BS(),historyState:KS(),groupingsState:QS(),printSettings:n1()}}const or=e=>!!e&&typeof e=="object",S1=e=>e===!0||e==="true"||e===1||e==="1",Gr=e=>{const t=typeof e=="number"?e:parseInt(String(e),10);return Number.isFinite(t)&&Number.isInteger(t)?t:null};function b1(e){if(!or(e))return;const t=e.singleSeat;if(!or(t))return;const n=t.template;if(n!=="grid"&&n!=="arc")return;const r=Gr(t.row)??void 0,s=Gr(t.col)??void 0,o=Gr(t.arcIndex)??void 0,l=Gr(t.seatIndex)??void 0,u=t.angle,c=Number.isFinite(u)?Number(u):void 0;return{singleSeat:{template:n,row:r,col:s,arcIndex:o,seatIndex:l,angle:c}}}function N1(e,t){if(!Array.isArray(e))return[];const n=[];for(const r of e){const s=Gr(r);s!=null&&(s<0||s>=t||n.push(s))}return Array.from(new Set(n)).sort((r,s)=>r-s)}function k1(e){var u;if(!e||typeof e!="object"||(e.schemaVersion??(e.version===1?1:void 0))!==1)return null;const n=typeof e.exportedAt=="string"?e.exportedAt:new Date().toISOString(),r=typeof e.updatedAt=="string"?e.updatedAt:n,s=e.lastWriter==="desktop"||e.lastWriter==="mobile"||e.lastWriter==="unknown"?e.lastWriter:"unknown",o={...e,schemaVersion:1,version:e.version??1,exportedAt:n,updatedAt:r,lastWriter:s};if(o.behaviorState=or(e.behaviorState)?e.behaviorState:{},!or(o.periodsState)||!Array.isArray((u=o.periodsState)==null?void 0:u.periods)||!Array.isArray(o.students)||!Array.isArray(o.layouts)||!or(o.behaviorState)||!or(o.constraintsState)||!or(o.historyState)||!or(o.groupingsState))return null;switch((e.schemaVersion!==o.schemaVersion||e.updatedAt!==o.updatedAt||e.exportedAt!==o.exportedAt||e.lastWriter!==o.lastWriter)&&console.log("[Payload] migrated to schema v1",{hadSchemaVersion:e.schemaVersion,hadVersion:e.version,addedUpdatedAt:e.updatedAt!==o.updatedAt,addedLastWriter:e.lastWriter!==o.lastWriter}),o.schemaVersion){case 1:return o.students=(o.students||[]).map(c=>({...c,needsPreferredSeating:S1(c.needsPreferredSeating),quickNote:(typeof c.quickNote=="string",c.quickNote),quickNoteUpdatedAt:(typeof c.quickNoteUpdatedAt=="string",c.quickNoteUpdatedAt),photoFileId:typeof c.photoFileId=="string"?c.photoFileId:c.photoFileId==null?null:String(c.photoFileId),photoUpdatedAt:Gr(c.photoUpdatedAt),audioFileId:typeof c.audioFileId=="string"?c.audioFileId:c.audioFileId==null?null:String(c.audioFileId),audioUpdatedAt:Gr(c.audioUpdatedAt)})),o.layouts=(o.layouts||[]).map(c=>({...c,tables:(c.tables||[]).map(f=>{const g=Math.max(0,f.capacity||0),S=b1(f.meta);return{...f,meta:S,preferredSeatIndexes:N1(f.preferredSeatIndexes,g),seatLayout:Vg(g||1,f.rotation||0,f.seatLayout||null)}})})),o;default:return null}}function j1(e){return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.hasFile?e.dirty?{action:"upload",reason:"ready"}:{action:"skip",reason:"clean"}:{action:"skip",reason:"no-file"}}function C1(e){const t=e.graceMs;return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.dirty?{action:"skip",reason:"dirty"}:e.lastLocalEditAt&&e.now-e.lastLocalEditAt<t?{action:"skip",reason:"grace-window"}:{action:"pull",reason:"ready"}}function E1(e){if(e.incomingRevisionId&&e.lastRevisionId)return e.incomingRevisionId===e.lastRevisionId?{action:"skip",reason:"same-revision"}:{action:"apply",reason:"fresh-revision"};const t=e.incomingUpdatedAt?Date.parse(e.incomingUpdatedAt):NaN,n=e.lastAppliedUpdatedAt?Date.parse(e.lastAppliedUpdatedAt):NaN;return Number.isFinite(t)&&Number.isFinite(n)&&t<=n?{action:"skip",reason:"stale-updatedAt"}:{action:"apply",reason:"fresh"}}const _1=new Set(["students","periodsState","layouts","tags","constraintsState","historyState","groupingsState","behaviorNotes","attendance","notes","alerts","payload"]),Tc=(e,t,n)=>{if(_1.has(t))return"[omitted]";if(typeof e=="string")return e.length>200?`[string ${e.length}]`:e;if(Array.isArray(e)){const r=e.slice(0,5).map(s=>Tc(s,"",n+1));return e.length>5&&r.push(`[+${e.length-5} more]`),n>1?`[array len=${e.length}]`:r}if(e&&typeof e=="object"){if(n>1)return"[object]";const r=Object.entries(e).slice(0,10).map(([s,o])=>[s,Tc(o,s,n+1)]);return r.length===0?e:Object.fromEntries(r)}return e};function _o(e,t){if(!(typeof console>"u"))try{const n=t?Tc(t,"",0):void 0;n!==void 0?console.log(e,n):console.log(e)}catch{console.log(e)}}const im="classseats_first_seen_at_v1",x0="classseats_announcements_dismissed_v1",R1="classseats_announcements_last_read_published_at_v1",v0="classseats_announcements_cache_v1",$d="classseats_announcements_cache_at_v1",am="appPrefs",Ac="announcements_state_v1.json";function hl(){return new Date().toISOString()}function Fo(e){const t=Date.parse(e);return Number.isFinite(t)?t:0}function an(e){return typeof e=="string"?e.trim():""}function Bd(e){const t=an(e);return t&&Number.isFinite(Date.parse(t))?t:null}function T1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function A1(e){return!!e&&typeof e=="object"&&e.schema===1&&Array.isArray(e.messages)}function P1(e){if(!e||typeof e!="object")return null;const t=e,n=an(t.id),r=t.audience==="onboarding"?"onboarding":t.audience==="all"?"all":null,s=t.priority==="high"?"high":t.priority==="normal"?"normal":null,o=an(t.publishedAt),l=an(t.title),u=an(t.body);if(!n||!r||!s||!o||!l||!u)return null;let c;const f=t.cta;if(f&&typeof f=="object"){const g=f,S=an(g.label),b=an(g.href);S&&b&&T1(b)&&(c={label:S,href:b})}return{id:n,audience:r,publishedAt:o,title:l,body:u,priority:s,...c?{cta:c}:{}}}function I1(e){if(!e||typeof e!="object")return null;const t=e;if(t.schema!==1&&t.schema!==2)return null;const n=an(t.updatedAt),r=Array.isArray(t.dismissed)?t.dismissed:[],s=Array.from(new Set(r.map(l=>an(l)).filter(Boolean))),o=Bd(t.lastReadPublishedAt);return{schema:2,updatedAt:n||hl(),dismissed:s,lastReadPublishedAt:o}}function w0(e){if(!A1(e))return null;const t=new Set,n=[];for(const r of e.messages){const s=P1(r);s&&(t.has(s.id)||(t.add(s.id),n.push(s)))}return{schema:1,messages:n}}function D1(){try{const e=localStorage.getItem(im);if(e)return e;const t=hl();return localStorage.setItem(im,t),t}catch{return hl()}}function Jo(){try{const e=localStorage.getItem(x0);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.map(n=>String(n))):new Set}catch{return new Set}}function Pc(e){try{localStorage.setItem(x0,JSON.stringify(Array.from(e)))}catch{}}function L1(){try{const e=localStorage.getItem(R1);return Bd(e)}catch{return null}}function O1(e){const t=Jo();t.add(String(e)),Pc(t)}function um(e,t){return{schema:2,updatedAt:hl(),dismissed:Array.from(new Set(Array.from(e).map(n=>an(n)).filter(Boolean))),lastReadPublishedAt:Bd(t)}}function cm(e){try{const t=JSON.parse(e);return I1(t)}catch{return null}}function dm(e,t){const n=new Set(Array.from(e).map(String));for(const r of t){const s=an(r);s&&n.add(s)}return n}function M1(e,t){const n=Fo(t),r=e.messages.filter(s=>s.audience==="onboarding"?!0:Fo(s.publishedAt)>n);return r.sort((s,o)=>{const l=s.priority==="high"?1:0,u=o.priority==="high"?1:0;return l!==u?u-l:Fo(o.publishedAt)-Fo(s.publishedAt)}),r}function S0(){try{const e=localStorage.getItem(v0),t=localStorage.getItem($d);if(!e)return{wrapper:null,cacheAt:t||null};const n=JSON.parse(e);return{wrapper:w0(n),cacheAt:t||null}}catch{return{wrapper:null,cacheAt:null}}}function U1(e){try{localStorage.setItem(v0,JSON.stringify(e)),localStorage.setItem($d,hl())}catch{}}function F1(e,t){return e?Date.now()-Fo(e)>t*60*60*1e3:!0}async function z1(e,t){const n=new AbortController,r=window.setTimeout(()=>n.abort(),t);try{const s=await fetch(e,{cache:"no-store",signal:n.signal});return s.ok?await s.json():null}catch{return null}finally{window.clearTimeout(r)}}function Ei(e,t){const n=D1(),r=Jo(),s=L1(),o=e?M1(e,n):[],l=o.filter(u=>!r.has(u.id));return{fetchedAt:t,messages:l,allMessages:o,dismissedIds:new Set(r),lastReadPublishedAt:s,unreadCount:l.length}}function ai(){const{wrapper:e,cacheAt:t}=S0();return Ei(e,t)}async function fm(e=12,t=!1){const{wrapper:n,cacheAt:r}=S0();if(!t&&!F1(r,e))return Ei(n,r);const s=await z1("/announcements.json",3e3),o=w0(s);if(!o)return Ei(n,r);U1(o);const l=(()=>{try{return localStorage.getItem($d)}catch{return r}})();return Ei(o,l)}const pm="https://app.classseats.app";function $1({open:e,onBypass:t}){const[n,r]=d.useState(!1);if(d.useEffect(()=>{if(!e)return;const o=document.documentElement.style.overflow,l=document.body.style.overflow;return document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",()=>{document.documentElement.style.overflow=o,document.body.style.overflow=l}},[e]),!e)return null;const s=async()=>{try{await navigator.clipboard.writeText(pm),r(!0),window.setTimeout(()=>r(!1),1200)}catch{r(!1)}};return i.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Mobile setup required",style:{position:"fixed",inset:0,zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:16,background:"rgba(0,0,0,0.55)"},children:i.jsxs("div",{style:{width:"min(520px, 100%)",borderRadius:16,background:"white",color:"#0f172a",padding:18,boxShadow:"0 12px 40px rgba(0,0,0,0.25)"},children:[i.jsx("div",{style:{fontSize:22,fontWeight:700,marginBottom:10},children:"Hi! "}),i.jsxs("div",{style:{fontSize:15,lineHeight:1.45,marginBottom:14},children:[i.jsx("div",{style:{marginBottom:10},children:"Thanks for your interest in ClassSeats. It looks like youre on a mobile device."}),i.jsxs("div",{style:{marginBottom:10},children:["ClassSeats setup must be done on a desktop or laptop.",i.jsx("br",{}),"Mobile becomes available after youve set up your first class."]}),i.jsx("div",{children:"See you on desktop! "})]}),i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsx("button",{onClick:s,style:{borderRadius:12,padding:"10px 14px",border:"1px solid rgba(0,0,0,0.12)",fontWeight:600,cursor:"pointer",background:"white"},children:"Copy desktop link"}),n&&i.jsx("span",{style:{fontSize:13,fontWeight:600},children:"Copied!"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:t,style:{border:"none",background:"transparent",padding:0,fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"Ive already set up my class"})}),i.jsx("div",{style:{marginTop:10,fontSize:12,opacity:.75,userSelect:"text"},children:pm})]})})}const mm=e=>e?{...e}:{},hm=(e,t)=>{if(t.size===0)return e;const n={...e};return t.forEach(r=>{delete n[r]}),n},B1=e=>{if(!e||typeof e!="object"||typeof e.note!="string")return null;const t=typeof e.timestamp=="string"?e.timestamp:"";return{note:e.note,timestamp:t}},W1=e=>{const t=e!=null&&e.note&&typeof e.note=="object"?e.note:e,n={};return Object.entries(t||{}).forEach(([r,s])=>{const o=B1(s);o&&(n[String(r)]=o)}),n};function gm(e,t,n){const r={};return Object.entries(e||{}).forEach(([o,l])=>{const u=hm(mm(l),n);Object.keys(u).length>0&&(r[o]=u)}),t&&Object.entries(t).forEach(([o,l])=>{const u=hm(mm(l),n);Object.keys(u).length===0?delete r[o]:r[o]=u}),r}function ym(e,t,n,r){const s={};return Object.entries(e||{}).forEach(([l,u])=>{const c={};Object.entries(W1(u)).forEach(([f,g])=>{n.has(f)||(c[f]=g)}),Object.keys(c).length>0&&(s[l]=c)}),t&&Object.entries(t).forEach(([l,u])=>{const c=s[l]||{},f={};Object.entries(u||{}).forEach(([g,S])=>{if(n.has(g))return;const b=c[g];b&&b.note===S?f[g]=b:f[g]={note:S,timestamp:r}}),Object.keys(f).length===0?delete s[l]:s[l]=f}),s}function H1({children:e}){return i.jsx(i.Fragment,{children:e})}const Ro=10,V1=250,K1=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a.40.2","audio/mp4"];function G1(){if(typeof MediaRecorder>"u")return"";for(const e of K1)if(MediaRecorder.isTypeSupported(e))return e;return""}function Y1(e){const t=e.toLowerCase();return t.includes("webm")?".webm":t.includes("mp4")?".m4a":".webm"}function b0({open:e,studentId:t,studentFullName:n,existingAudioFileId:r,existingAudioUpdatedAt:s,driveSession:o,onClose:l,onUploadComplete:u,onDeleteComplete:c}){const f=Fd(),[g,S]=d.useState("idle"),[b,E]=d.useState(Ro),[j,k]=d.useState(!1),[J,y]=d.useState(!1),[m,v]=d.useState(null),[T,O]=d.useState(0),[F,$]=d.useState(!1),z=d.useRef(null),ue=d.useRef(null),X=d.useRef([]),pe=d.useRef(null),Je=d.useRef(null),ot=d.useRef(null),qe=d.useRef(null),Fe=d.useRef(null),{audioUrl:ne}=Ud({studentId:t,audioFileId:r||null,audioUpdatedAt:s??null,driveSession:o}),Oe=!!r&&!j&&!J&&g!=="recording",N=()=>{v(me=>(me!=null&&me.url&&URL.revokeObjectURL(me.url),null))},H=()=>{pe.current&&(window.clearInterval(pe.current),pe.current=null)},q=()=>{Fe.current&&(cancelAnimationFrame(Fe.current),Fe.current=null),ot.current=null,qe.current=null,Je.current&&(Je.current.close().catch(()=>{}),Je.current=null),$(!1),O(0)},re=()=>{ue.current&&(ue.current.getTracks().forEach(me=>me.stop()),ue.current=null)},V=()=>{const me=z.current;me&&me.state!=="inactive"&&me.stop()},Ne=()=>{V(),q(),re(),z.current=null,X.current=[],H()};d.useEffect(()=>(e||(Ne(),N(),S("idle"),E(Ro)),()=>{e&&Ne()}),[e]);const ze=async()=>{if(g!=="recording"){if(typeof MediaRecorder>"u"){f({message:"Audio recording is not supported on this device.",tone:"error"});return}try{const me=await navigator.mediaDevices.getUserMedia({audio:!0}),St=G1(),We=new MediaRecorder(me,St?{mimeType:St}:void 0);ue.current=me,z.current=We,X.current=[];try{const Me=window.AudioContext||window.webkitAudioContext;if(Me){const Lt=new Me,Vt=Lt.createMediaStreamSource(me),B=Lt.createAnalyser();B.fftSize=512,Vt.connect(B);const R=new Uint8Array(new ArrayBuffer(B.frequencyBinCount));Je.current=Lt,ot.current=B,qe.current=R,$(!0);const Z=()=>{const He=ot.current,Ze=qe.current;if(!He||!Ze)return;He.getByteTimeDomainData(Ze);let Kt=0;for(let U=0;U<Ze.length;U+=1){const Y=(Ze[U]-128)/128;Kt+=Y*Y}const mt=Math.sqrt(Kt/Ze.length),M=Math.min(1,Math.sqrt(mt)*2.2);O(M),Fe.current=requestAnimationFrame(Z)};Fe.current=requestAnimationFrame(Z)}}catch{$(!1)}We.ondataavailable=Me=>{Me.data&&Me.data.size>0&&X.current.push(Me.data)},We.onstop=()=>{H(),q(),re();const Me=We.mimeType||St,Lt=new Blob(X.current,{type:Me});if(X.current=[],!Lt.size){S("idle"),E(Ro),f({message:"We could not save that recording. Please try again.",tone:"error"});return}const Vt=URL.createObjectURL(Lt);v({blob:Lt,url:Vt,mimeType:Me}),S("draft"),E(Ro)},S("recording"),E(Ro),We.start(V1),pe.current=window.setInterval(()=>{E(Me=>Me<=1?(V(),0):Me-1)},1e3)}catch{Ne(),S("idle"),f({message:"We could not access your microphone. Please allow access and try again.",tone:"error"})}}},wt=()=>{V()},pt=async()=>{if(!(!m||j)){k(!0);try{const me=m.mimeType||m.blob.type||"audio/webm",St=Y1(me),We=await Vw({studentId:t,studentFullName:n,blob:m.blob,mimeType:me,extension:St,fileId:r||null}),Me=Date.now();u({fileId:We.fileId,audioUpdatedAt:Me}),N(),l()}catch(me){const We=(me instanceof Error?me.message:"").toLowerCase();We.includes("sign in")&&We.includes("drive")?f({message:"Please reconnect Google Drive to upload audio.",tone:"error"}):f({message:"Couldn't upload the audio. Please try again.",tone:"error"})}finally{k(!1)}}},Xe=async()=>{if(!(!r||J||!window.confirm("Delete this audio clip?"))){y(!0);try{await Kw(r)}catch{f({message:"Audio was removed from the student, but we couldn't delete it from Drive.",tone:"warning"})}finally{y(!1),c(),l()}}},fn=!!r,_r=!m&&fn,Wn=g==="idle"&&!m;return e?i.jsx(Rd,{isOpen:e,onRequestClose:l,title:"Record Audio",subtitle:"Name & Audio Intro (=10s)",maxWidth:"md",showCloseX:!0,footer:g==="draft"?i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:()=>{N(),S("idle")},disabled:j,children:"Re-record"}),i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:j,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:pt,disabled:j,children:j?"Uploading":"Accept"})]}):i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[i.jsx("div",{children:Oe&&i.jsx("button",{className:"rounded border border-rose-200 px-3 py-2 text-sm text-rose-700 hover:bg-rose-50",onClick:Xe,children:"Delete audio"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:j||J,children:"Close"}),Wn&&i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:ze,disabled:j||J,children:fn?"Record new":"Record"})]})]}),children:i.jsxs("div",{className:"space-y-4",children:[g==="recording"&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm font-semibold text-slate-700",children:[i.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-rose-600 animate-pulse"}),"Recording"]}),F&&i.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-200",children:i.jsx("div",{className:"h-full rounded-full bg-rose-500 transition-[width]",style:{width:`${Math.min(100,Math.max(8,Math.round(T*100)))}%`}})}),i.jsxs("div",{className:"mt-2 text-3xl font-bold text-slate-900",children:[b,"s"]}),i.jsx("button",{className:"mt-3 rounded bg-rose-600 px-4 py-2 text-sm font-semibold text-white",onClick:wt,children:"Stop"})]}),g==="draft"&&m&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Preview"}),i.jsx("audio",{controls:!0,src:m.url,className:"w-full"})]}),_r&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Current audio"}),ne?i.jsx("audio",{controls:!0,src:ne,className:"w-full"}):i.jsx("div",{className:"text-sm text-slate-500",children:"Loading audio"})]}),Wn&&!fn&&i.jsx("div",{className:"text-sm text-slate-500",children:"Tap record to capture a short name pronunciation."})]})}):null}function Q1(e){const t=e.slice();for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function Yt(e){return String(e)}function xm(e){try{const t=localStorage.getItem(e);if(!t)return new Set;const n=JSON.parse(t);return Array.isArray(n)?new Set(n.map(String)):new Set}catch{return new Set}}function Cu(e,t){try{localStorage.setItem(e,JSON.stringify(Array.from(t)))}catch{}}function vm({open:e,title:t,body:n,confirmText:r,cancelText:s,onConfirm:o,onCancel:l,danger:u}){return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center p-4 sm:items-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:l}),i.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[i.jsxs("div",{className:"space-y-2 p-5",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:t}),i.jsx("div",{className:"text-sm text-slate-600",children:n})]}),i.jsxs("div",{className:"flex gap-2 p-4 pt-0",children:[i.jsx("button",{className:"flex-1 rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:l,children:s}),i.jsx("button",{className:`flex-1 rounded-xl px-4 py-2.5 text-sm font-semibold text-white ${u?"bg-rose-600 hover:bg-rose-700":"bg-violet-600 hover:bg-violet-700"}`,onClick:o,children:r})]})]})]}):null}function J1({students:e,periodId:t,driveFileId:n,driveClient:r,driveSession:s,onAudioSaved:o,onAudioDeleted:l}){const u=n??"local",c=`cs_mobile_flashcards_learned_v1:${u}:${t}`,[f,g]=d.useState(!1),[S,b]=d.useState(()=>xm(c)),E=d.useRef(S);d.useEffect(()=>{E.current=S},[S]),d.useEffect(()=>{const B=xm(c);E.current=B,b(B),g(!1)},[c]);const j=e.length,[k,J]=d.useState([]),[y,m]=d.useState(0),[v,T]=d.useState(!1),[O,F]=d.useState(null),[$,z]=d.useState(null),[ue,X]=d.useState(!1),pe=d.useMemo(()=>{if(f)return e;const B=S;return e.filter(R=>!B.has(Yt(R.id))||Yt(R.id)===O)},[e,f,S,O]),Je=d.useMemo(()=>e.map(B=>Yt(B.id)).join("|"),[e]),ot=d.useMemo(()=>pe.map(B=>Yt(B.id)).join("|"),[pe]),qe=d.useMemo(()=>{const B=new Set(e.map(Z=>Yt(Z.id)));let R=0;return S.forEach(Z=>{B.has(Z)&&R++}),R},[e,S]),Fe=Math.max(0,j-qe),[ne,Oe]=d.useState(!1),[N,H]=d.useState(!1);d.useEffect(()=>{const B=E.current,R=(f?e:e.filter(Z=>!B.has(Yt(Z.id)))).map(Z=>Yt(Z.id));J(R),m(0),T(!1),F(null),z(null)},[f,t,u,Je]),d.useEffect(()=>{const B=new Set(pe.map(R=>Yt(R.id)));J(R=>{const Z=R.filter(He=>B.has(He));return Z.length===R.length?R:(m(He=>Math.min(He,Math.max(0,Z.length-1))),Z)})},[ot]);const q=d.useMemo(()=>new Map(pe.map(B=>[Yt(B.id),B])),[pe]),re=k[y]??null,V=re?q.get(re)??null:null,{photoUrl:Ne}=p0({studentId:(V==null?void 0:V.id)??"unknown",fullName:(V==null?void 0:V.fullName)??null,photoFileId:(V==null?void 0:V.photoFileId)??null,photoUpdatedAt:(V==null?void 0:V.photoUpdatedAt)??null,driveClient:r,driveSession:s}),{audioUrl:ze}=Ud({studentId:(V==null?void 0:V.id)??"unknown",audioFileId:(V==null?void 0:V.audioFileId)??null,audioUpdatedAt:(V==null?void 0:V.audioUpdatedAt)??null,driveSession:s}),wt=d.useRef(null),[pt,Xe]=d.useState(!1);d.useEffect(()=>{Xe(!1)},[ze]);const fn=B=>!re||O!==re||f?!1:(J(R=>{const Z=R.filter(He=>He!==re);return m(He=>Z.length===0?0:B==="prev"?Math.max(0,He-1):Math.min(He,Z.length-1)),Z}),F(null),!0),_r=()=>{T(!1),z(null),!fn("next")&&m(B=>k.length===0?0:Math.min(B+1,k.length-1))},Wn=()=>{T(!1),z(null),!fn("prev")&&m(B=>Math.max(0,B-1))},me=async()=>{if(!ze)return;const B=wt.current;if(B){if(pt){B.pause(),Xe(!1);return}try{await B.play(),Xe(!0)}catch{}}},St=()=>{if(!V)return;const B=Yt(V.id);z(null),b(R=>{const Z=new Set(R);return Z.add(B),Cu(c,Z),Z}),F(B)},We=()=>{if(!V)return;const B=Yt(V.id);F(null),z(R=>R===B?null:B),b(R=>{if(!R.has(B))return R;const Z=new Set(R);return Z.delete(B),Cu(c,Z),Z})},Me=()=>{Oe(!1),T(!1),F(null),z(null),J(B=>Q1(B)),m(0)},Lt=()=>{H(!1),T(!1),F(null),z(null);const B=new Set;b(B),Cu(c,B);const R=e.map(Z=>Yt(Z.id));J(R),m(0)},Vt=!f&&Fe===0&&j>0;return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsxs("div",{className:"space-y-0.5",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Flashcards"}),i.jsxs("div",{className:"text-xs text-slate-600",children:["Learned ",qe," / ",j,"  Remaining ",Fe]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:k.length<2,onClick:()=>Oe(!0),children:"Shuffle"}),i.jsx("button",{className:`rounded-xl border px-3 py-2 text-xs font-semibold ${f?"border-violet-200 bg-violet-50 text-violet-900":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"}`,onClick:()=>{g(B=>!B),T(!1),F(null),z(null)},children:f?"Including learned":"Include learned"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>H(!0),children:"Clear learned"})]})]}),Vt?i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"All learned!"}),i.jsx("div",{className:"text-sm text-slate-600",children:"Youve marked everyone in this period as learned."}),i.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[i.jsx("button",{className:"rounded-xl bg-violet-600 px-4 py-3 text-sm font-semibold text-white hover:bg-violet-700",onClick:()=>g(!0),children:"Review learned students"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>H(!0),children:"Clear learned for this period"})]})]}):i.jsx("div",{className:"space-y-3",children:V?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"relative w-full",style:{perspective:1200},children:i.jsx("button",{type:"button",onClick:()=>T(B=>!B),className:"w-full text-left","aria-label":"Flip flashcard",children:i.jsxs("div",{className:"relative h-[380px] w-full",style:{transformStyle:"preserve-3d",transition:"transform 420ms cubic-bezier(0.2, 0.8, 0.2, 1)",transform:v?"rotateY(180deg)":"rotateY(0deg)"},children:[i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden"},children:i.jsxs("div",{className:"h-full w-full bg-slate-50 flex items-center justify-center",children:[Ne?i.jsx("img",{src:Ne,alt:"",className:"h-full w-full object-cover"}):i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-200 text-2xl font-bold text-slate-700",children:V.fullName.split(" ").slice(0,2).map(B=>{var R;return((R=B[0])==null?void 0:R.toUpperCase())??""}).join("")}),i.jsx("div",{className:"mt-3 text-sm text-slate-500",children:"No photo"})]}),i.jsx("div",{className:"absolute bottom-3 left-0 right-0 text-center text-xs font-semibold text-slate-500",children:"Tap to flip"})]})}),i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:i.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold leading-tight text-slate-900",children:V.fullName}),i.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"Tap again to see photo"}),i.jsxs("div",{className:"mt-4 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${ze?"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50":"border border-slate-200 bg-white text-slate-400 cursor-not-allowed"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),me()},disabled:!ze,children:pt?"Pause audio":"Play audio"}),i.jsx("button",{className:"w-full rounded-2xl px-4 py-3 text-sm font-semibold transition border border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100",onClick:B=>{B.preventDefault(),B.stopPropagation(),X(!0)},children:V.audioFileId?"Re-record audio":"Record audio"})]}),i.jsx("audio",{ref:wt,src:ze||void 0,onEnded:()=>Xe(!1),onPause:()=>Xe(!1)}),i.jsxs("div",{className:"mt-6 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${O===re?"bg-emerald-600 text-white hover:bg-emerald-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),St()},children:" Ive learned this"}),i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${$===re?"bg-violet-600 text-white hover:bg-violet-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),We()},children:" Still learning"})]})]})})]})})}),i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:y===0,onClick:Wn,children:"Prev"}),i.jsx("div",{className:"px-2 text-xs font-semibold text-slate-500",children:k.length===0?"0 / 0":`${y+1} / ${k.length}`}),i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:k.length===0||y>=k.length-1,onClick:_r,children:"Next"})]}),ue&&V&&i.jsx(b0,{open:!0,studentId:V.id,studentFullName:V.fullName,existingAudioFileId:V.audioFileId??null,existingAudioUpdatedAt:V.audioUpdatedAt??null,driveSession:s,onClose:()=>X(!1),onUploadComplete:({fileId:B,audioUpdatedAt:R})=>{o(V.id,B,R),X(!1)},onDeleteComplete:()=>{l(V.id),X(!1)}})]}):i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"No students found."}),i.jsx("div",{className:"text-sm text-slate-600",children:"This period doesnt have any students yet."})]})}),i.jsx(vm,{open:ne,title:"Shuffle deck?",body:"This will randomize the order of the current deck once.",confirmText:"Shuffle",cancelText:"Cancel",onConfirm:Me,onCancel:()=>Oe(!1)}),i.jsx(vm,{open:N,title:"Clear learned students?",body:"This resets learned progress for this period on this device.",confirmText:"Clear",cancelText:"Cancel",danger:!0,onConfirm:Lt,onCancel:()=>H(!1)})]})}const q1=.85,X1=900,Z1=1200,eb=4,tb=60,nb=160;function rb({studentId:e,studentFullName:t,existingPhotoFileId:n,open:r,onClose:s,onAccept:o,onUploadComplete:l,title:u="Take Photo"}){const c=Fd(),f=d.useRef(null),g=d.useRef(null),S=d.useRef(null),b=d.useRef(null),E=d.useRef(null),j=d.useRef(!1),k=d.useRef(new Map),J=d.useRef(null),y=d.useRef(null),m=d.useRef(1),v=d.useRef(null),T=d.useRef(null),[O,F]=d.useState(null),[$,z]=d.useState(!1),[ue,X]=d.useState(!1),[pe,Je]=d.useState(!1),[ot,qe]=d.useState(1),[Fe,ne]=d.useState(!1),[Oe,N]=d.useState(!1),H=d.useRef(null),q=d.useMemo(()=>{if(typeof navigator>"u")return{isIOS:!1,isAndroid:!1};const M=navigator.userAgent||"",U=/iPad|iPhone|iPod/i.test(M)||M.includes("Mac")&&typeof document<"u"&&"ontouchend"in document,Y=/Android/i.test(M);return{isIOS:U,isAndroid:Y}},[]),re=()=>{k.current.clear(),J.current=null,v.current&&(cancelAnimationFrame(v.current),v.current=null),T.current=null},V=()=>{b.current=null,y.current=null,m.current=1,qe(1),Je(!1),re()},Ne=()=>(H.current||(H.current=document.createElement("canvas")),H.current),ze=M=>{const U=Ne(),Y=U.getContext("2d");if(!Y)return 0;const Q=nb,ce=Math.max(M.width,M.height)/Q,de=Math.max(1,Math.round(M.width/(ce||1))),ye=Math.max(1,Math.round(M.height/(ce||1)));U.width=de,U.height=ye,Y.drawImage(M,0,0,de,ye);const Se=Y.getImageData(0,0,de,ye).data;let he=0;for(let ht=0;ht<ye;ht++){const Hn=ht*de*4;for(let lt=0;lt<de;lt++){const Vn=Hn+lt*4,ro=(Se[Vn]+Se[Vn+1]+Se[Vn+2])/3;if(lt<de-1){const pn=Vn+4,Kn=(Se[pn]+Se[pn+1]+Se[pn+2])/3;he+=Math.abs(ro-Kn)}if(ht<ye-1){const pn=Vn+de*4,Kn=(Se[pn]+Se[pn+1]+Se[pn+2])/3;he+=Math.abs(ro-Kn)}}}return he},wt=M=>{const{width:U,height:Y}=M;if(!U||!Y)return M;const Q=X1/U,ce=Z1/Y,de=Math.min(1,Q,ce);if(de>=.999)return M;const ye=Math.max(1,Math.round(U*de)),Se=Math.max(1,Math.round(Y*de)),he=document.createElement("canvas");he.width=ye,he.height=Se;const ht=he.getContext("2d");return ht?(ht.drawImage(M,0,0,ye,Se),he):M},pt=async M=>new Promise(U=>{M.toBlob(Y=>{if(Y){U(Y);return}M.toBlob(Q=>U(Q),"image/png")},"image/jpeg",q1)}),Xe=async M=>{const U=wt(M);return pt(U)},fn=async M=>{try{const U=await createImageBitmap(M),Y=document.createElement("canvas");Y.width=U.width,Y.height=U.height;const Q=Y.getContext("2d");if(!Q)return null;if(Q.drawImage(U,0,0),"close"in U)try{U.close()}catch{}return Y}catch{return new Promise(U=>{const Y=URL.createObjectURL(M),Q=new Image;Q.onload=()=>{const ce=document.createElement("canvas");ce.width=Q.naturalWidth||Q.width,ce.height=Q.naturalHeight||Q.height;const de=ce.getContext("2d");if(URL.revokeObjectURL(Y),!de){U(null);return}de.drawImage(Q,0,0),U(ce)},Q.onerror=()=>{URL.revokeObjectURL(Y),U(null)},Q.src=Y})}},_r=async(M,U)=>{const Y=f.current,Q=g.current;if(!Y||!Q)return null;const ce=Y.videoWidth,de=Y.videoHeight;if(!ce||!de)return null;Q.width=ce,Q.height=de;const ye=Q.getContext("2d");if(!ye)return null;let Se=-1/0,he=null;for(let ht=0;ht<M;ht++){if(!j.current)return null;ht===0?await new Promise(lt=>requestAnimationFrame(()=>lt())):U>0&&await new Promise(lt=>setTimeout(lt,U)),ye.drawImage(Y,0,0,ce,de);const Hn=ze(Q);if(Hn>=Se){Se=Hn,he||(he=document.createElement("canvas")),he.width=ce,he.height=de;const lt=he.getContext("2d");lt&&lt.drawImage(Q,0,0,ce,de)}}return he||Q},Wn=async()=>{if(typeof window>"u")return null;const M=b.current,U=window.ImageCapture;if(!M||!U)return null;try{const Y=new U(M);return typeof Y.takePhoto!="function"?null:await Y.takePhoto()}catch{return null}},me=()=>{S.current&&(S.current.getTracks().forEach(M=>M.stop()),S.current=null),f.current&&(f.current.srcObject=null),V()},St=()=>{O&&URL.revokeObjectURL(O),E.current=null,F(null)},We=()=>{me(),St(),z(!1),ne(!1),N(!1),s()},Me=M=>{const U=y.current;if(!U)return M;let Y=Math.min(U.max,Math.max(U.min,M));if(typeof U.step=="number"&&U.step>0){const Q=Math.round((Y-U.min)/U.step);Y=U.min+Q*U.step,Y=Math.min(U.max,Math.max(U.min,Y))}return Y},Lt=M=>{const U=b.current;if(!U)return;const Y=Me(M);T.current=Y,!v.current&&(v.current=requestAnimationFrame(()=>{v.current=null;const Q=T.current;T.current=null,typeof Q=="number"&&U.applyConstraints({advanced:[{zoom:Q}]}).then(()=>{m.current=Q,qe(Q)}).catch(()=>{})}))},Vt=async M=>{var U,Y;X(!0),z(!1),V();try{let Q;try{Q=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"},width:{ideal:1280},height:{ideal:960},frameRate:{ideal:30}},audio:!1})}catch{Q=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}if(!M()){Q.getTracks().forEach(de=>de.stop());return}S.current=Q;const ce=Q.getVideoTracks()[0]||null;if(b.current=ce,ce){const de=(U=ce.getCapabilities)==null?void 0:U.call(ce),ye=de==null?void 0:de.zoom;if(ye&&typeof ye.min=="number"&&typeof ye.max=="number"){y.current={min:ye.min,max:ye.max,step:typeof ye.step=="number"?ye.step:void 0};const Se=(Y=ce.getSettings)==null?void 0:Y.call(ce),he=typeof(Se==null?void 0:Se.zoom)=="number"?Se.zoom:ye.min,ht=Me(he);m.current=ht,qe(ht),Je(!0)}}if(f.current){f.current.srcObject=Q;try{await f.current.play()}catch{}}}catch{M()&&z(!0),me()}finally{M()&&X(!1)}};d.useEffect(()=>{let M=!0;return j.current=r,r?Vt(()=>M):(me(),St(),z(!1),N(!1)),()=>{M=!1,j.current=!1,me(),St(),z(!1),N(!1)}},[r]);const B=async()=>{if(!Oe){N(!0);try{let M=null;if(q.isAndroid){const Y=await Wn();if(Y){const Q=await fn(Y);Q&&(M=await Xe(Q))}}if(!M){const Y=q.isIOS?eb:1,Q=q.isIOS?tb:0,ce=await _r(Y,Q);ce&&(M=await Xe(ce))}if(!M)return;E.current=M;const U=URL.createObjectURL(M);F(U),me()}finally{N(!1)}}},R=async()=>{if(Fe)return;const M=E.current;if(M){o(M),ne(!0);try{const U=n?null:await _S({studentId:e,fullName:t}),Y=await Hw({studentId:e,studentFullName:t,jpegBlob:M,fileId:n||(U==null?void 0:U.fileId)}),Q=Date.now();await RS({studentId:e,fullName:t,fileId:Y.fileId,updatedTime:Y.modifiedTime,photoUpdatedAt:Q,blob:M}),l==null||l({fileId:Y.fileId,photoUpdatedAt:Q}),We()}catch(U){ne(!1);const Q=(U instanceof Error?U.message:"").toLowerCase();Q.includes("sign in")&&Q.includes("drive")?c({message:"Please reconnect Google Drive to upload photos.",tone:"error"}):c({message:"Couldn't upload the photo. Your preview is still saved here - try again.",tone:"error"})}}},Z=()=>{St(),N(!1),Vt(()=>j.current)},He=M=>{if(!(!pe||O)&&(M.preventDefault(),M.currentTarget.setPointerCapture(M.pointerId),k.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),k.current.size===2)){const U=Array.from(k.current.values()),Y=Math.hypot(U[0].x-U[1].x,U[0].y-U[1].y);J.current={initialDistance:Y,initialZoom:m.current}}},Ze=M=>{if(!pe||O||!k.current.has(M.pointerId)||(M.preventDefault(),k.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),k.current.size<2||!J.current))return;const U=Array.from(k.current.values()),Y=Math.hypot(U[0].x-U[1].x,U[0].y-U[1].y);if(J.current.initialDistance<=0)return;const Q=Y/J.current.initialDistance,ce=J.current.initialZoom*Q;Lt(ce)},Kt=M=>{pe&&(k.current.delete(M.pointerId),k.current.size<2&&(J.current=null))};if(!r)return null;const mt=pe&&!O;return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:We}),i.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white p-4 shadow-2xl space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:u}),i.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-700",onClick:We,"aria-label":"Close",children:""})]}),$?i.jsxs("div",{className:"space-y-3",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Camera unavailable. Check permissions and try again."}),i.jsx("button",{type:"button",className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:We,children:"Close"})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"w-full aspect-[3/4] rounded-xl bg-slate-100 overflow-hidden flex items-center justify-center",onPointerDown:mt?He:void 0,onPointerMove:mt?Ze:void 0,onPointerUp:mt?Kt:void 0,onPointerCancel:mt?Kt:void 0,style:mt?{touchAction:"none"}:void 0,children:O?i.jsx("img",{src:O,alt:"",className:"w-full h-full object-cover"}):i.jsx("video",{ref:f,className:"w-full h-full object-cover",playsInline:!0,muted:!0})}),O?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm disabled:opacity-50",onClick:Z,disabled:Fe,children:"Retake"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:R,disabled:Fe,children:Fe?"Uploading...":"Accept"})]}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:B,disabled:ue||Oe,children:Oe?"Capturing...":"Take Photo"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm",onClick:We,children:"Cancel"})]})]})]}),i.jsx("canvas",{ref:g,className:"hidden"})]})}const wm=!1,Sm="770",sb="https://app.classseats.app",To="cs_mobile_last_drive_file",ob="cs_mobile_local_draft_v2",Eu="cs_mobile_students_mode_v1",_u="cs_mobile_notes_sort_v1",Ru="cs_mobile_table_sort_v1",Tu="cs_mobile_seat_number_sort_v1",lb=14*24*60*60*1e3,bm=2e5,Nm=14,ib=2e4,km="classseats_mobile_setup_gate_bypass_v1";function Ao(e){return e?`${ob}:${e}`:null}function ui(e){return e!=null&&e.id?[e.id,e.revisionId||"",e.modifiedTime||"",e.size||""].join("|"):null}function Is(e){if(!(e!=null&&e.modifiedTime))return 0;const t=Date.parse(e.modifiedTime);return Number.isFinite(t)?t:0}function jm(e){return e.filter(n=>!!(n!=null&&n.id)&&n.name===Ac).sort((n,r)=>Is(r)-Is(n))[0]||null}function ab(e,t){var n,r;return!e||!t?!1:(e.accessToken||"")===(t.accessToken||"")&&(e.refreshToken||"")===(t.refreshToken||"")&&(e.expiresAt||"")===(t.expiresAt||"")&&(((n=e.profile)==null?void 0:n.email)||"")===(((r=t.profile)==null?void 0:r.email)||"")}function N0(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function Cm(e,t){const n={};return Object.entries(e||{}).forEach(([r,s])=>{const o=Object.keys(s||{}).filter(u=>N0(u));o.sort((u,c)=>c.localeCompare(u)),o.slice(0,t).forEach(u=>{const c=(s==null?void 0:s[u])||{};Object.keys(c).length!==0&&(n[r]||(n[r]={}),n[r][u]={...c})})}),n}function ci(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s={};Object.entries(r||{}).forEach(([o,l])=>{s[o]={...l||{}}}),Object.keys(s).length>0&&(t[n]=s)}),t}function ub({student:e,attendance:t,points:n,pointsEnabled:r,maxPoints:s,hasNote:o,absenceTotal:l,absenceStreak:u,tardyCount:c,leftEarlyCount:f,customCounter:g,onShowAbsenceHelp:S,onShowTardyHelp:b,onShowLeftEarlyHelp:E,onShowCustomHelp:j,seatNumber:k,showSeatNumber:J=!1,statusBg:y,statusLabel:m,tempPhotoUrl:v,onOpenPhoto:T,onOpenMenu:O,driveClient:F,driveSession:$}){const z=h0(n,s),{photoUrl:ue}=p0({studentId:e.id,fullName:e.fullName,photoFileId:e.photoFileId,photoUpdatedAt:e.photoUpdatedAt,driveClient:F,driveSession:$}),[X,...pe]=(e.fullName||"").split(" "),Je=pe.join(" "),ot=(()=>{switch(t){case"present":return"";case"absent":return"";case"tardy":return"";case"left_early":return"";default:return""}})(),qe=m(t),Fe=v||ue,ne=l??0,Oe=u??0,N=c??0,H=f??0,q=g??0,re=ne===0&&Oe===0,V=N===0,Ne=H===0,ze=q===0;return i.jsx("div",{className:`w-full rounded-2xl border px-4 py-3 shadow-sm ${y(t)}`,children:i.jsxs("div",{className:"flex items-start gap-2",children:[J&&i.jsx("div",{className:"flex h-[80px] w-8 shrink-0 items-center justify-center text-sm font-semibold text-slate-500",children:k||""}),i.jsx(dw,{studentId:e.id,hasPhoto:!!Fe,src:Fe,onClick:T,widthPx:60,heightPx:80}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"text-left min-w-0 flex-1",children:[i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:X}),i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:Je||""})]}),i.jsx("button",{className:"text-xl text-slate-600 px-3 py-2 rounded-full hover:bg-slate-200 flex-shrink-0",onClick:wt=>{wt.stopPropagation(),O()},children:""})]}),i.jsxs("div",{className:"mt-1 flex items-center justify-between text-sm px-1",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:ot}),i.jsx("span",{className:"text-slate-700",children:qe})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${re?"text-slate-600 bg-slate-100 border-slate-300":"text-rose-700 bg-rose-100 border-rose-200"}`,onClick:S,children:["A",ne,"/S",Oe]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${V?"text-slate-600 bg-slate-100 border-slate-300":"text-amber-700 bg-amber-100 border-amber-200"}`,onClick:b,children:["T",N]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${Ne?"text-slate-600 bg-slate-100 border-slate-300":"text-orange-700 bg-orange-100 border-orange-200"}`,onClick:E,children:["LE",H]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${ze?"text-slate-600 bg-slate-100 border-slate-300":"text-slate-800 bg-slate-100 border-slate-400"}`,onClick:j,children:["",q]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[r&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-lg",children:z.emoji}),i.jsx("span",{className:"text-emerald-700 font-semibold",children:n})]}),o&&i.jsx("span",{className:"text-indigo-600 text-lg",children:""})]})]})]})]})})}function cb(e,t,n){var S,b,E;if(!(e!=null&&e.activeGrouping)||!(e!=null&&e.tableAssignments))return null;let r=-1,s=-1;if(e.activeGrouping.forEach((j,k)=>{const J=j==null?void 0:j.findIndex(y=>String(y)===String(n));J!==-1&&(r=k,s=J)}),r===-1||s===-1)return null;const o=e.tableAssignments[String(r)];if(!o)return null;const l=String(o),u=((S=e.tableNumbering)==null?void 0:S.perTableSeatNumbers)&&e.tableNumbering.perTableSeatNumbers[l],c=(E=(b=t==null?void 0:t.tables)==null?void 0:b.find(j=>String(j.id)===l))==null?void 0:E.seatNumbers,f=u||c;if(!f)return null;const g=f[s];return g!=null?String(g):null}function Au(e,t){const n=e==null?void 0:e[t];if(!n||typeof n!="object")return{};const r=n.note&&typeof n.note=="object"?n.note:n,s={};return Object.entries(r||{}).forEach(([o,l])=>{l&&typeof l=="object"&&typeof l.note=="string"&&(s[String(o)]=l.note)}),s}function db(){var If,Df,Lf,Of;const e=Fd(),t=v1(),n=d.useMemo(()=>cw(),[]),r=d.useMemo(()=>({kind:"web",openExternal:a=>typeof window<"u"?window.open(a,"_blank","noopener,noreferrer"):null}),[]),s=!n.canUseDriveSync,o="Drive sync is disabled.",[l,u]=d.useState(null),[c,f]=d.useState([]),[g,S]=d.useState(!1),[b,E]=d.useState(null),[j,k]=d.useState(()=>s?o:null),[J,y]=d.useState(!1),[m,v]=d.useState(!1),[T,O]=d.useState(null),[F,$]=d.useState(!1),[z,ue]=d.useState([]),[X,pe]=d.useState(""),[Je,ot]=d.useState(!1),[qe,Fe]=d.useState(!1),[ne,Oe]=d.useState(null),[N,H]=d.useState(null),[q,re]=d.useState(!1),[V,Ne]=d.useState(!1),[ze,wt]=d.useState(!1),[pt,Xe]=d.useState(!1),[fn,_r]=d.useState([]),[Wn,me]=d.useState([]),[St,We]=d.useState(new Set),[Me,Lt]=d.useState(0),[Vt,B]=d.useState(null),[R,Z]=d.useState(null),[He,Ze]=d.useState({}),[Kt,mt]=d.useState({}),[M,U]=d.useState({}),[Y,Q]=d.useState({}),[ce,de]=d.useState(null),[ye,Se]=d.useState({note:"",delta:0,reason:""}),[he,ht]=d.useState({pointsEnabled:!1,startingPoints:50,currentPoints:0,predictedPoints:0}),[Hn,lt]=d.useState(null),[Vn,ro]=d.useState(""),[pn,Kn]=d.useState(null),[ls,Wd]=d.useState(null),[Rr,Hd]=d.useState(null),[Na,E0]=d.useState({}),Vd=d.useRef({}),[_0,Db]=d.useState({}),[Gn,so]=d.useState(null),[Kd,bl]=d.useState(0),[Gd,Nl]=d.useState(null),[Yd,ka]=d.useState(""),[it,is]=d.useState(null),[Lb,R0]=d.useState([]),[Ob,Qd]=d.useState(!1),[Mb,ja]=d.useState(null),[Ub,Fb]=d.useState(!1),[xe,bt]=d.useState(null),[et,Jd]=d.useState(null),[qd,Xd]=d.useState(null),[Yn,oo]=d.useState(null),[kl,Tr]=d.useState(null),[Ar,Zd]=d.useState(!1),[jl,as]=d.useState(null),[Qn,Ve]=d.useState(!1),[zb,Ot]=d.useState(null),us=d.useRef(null),ef=d.useRef(null),[tf,cs]=d.useState(!1),Ca=typeof navigator<"u"?navigator.onLine:!0,[nf,lo]=d.useState(Ca),[rf,Ea]=d.useState(Ca),[ge,io]=d.useState(!Ca),T0=d.useRef(null),A0=d.useRef(!1),Jn=d.useRef(!1),P0=d.useRef(15e3),I0=d.useRef(0),sf=d.useRef(!1),jn=d.useRef(!1),Pr=d.useRef(!1),_a=d.useRef(new Set),Mt=d.useRef(null),Ra=d.useRef(async()=>{}),Ta=d.useRef(0),of=d.useRef(null),lf=d.useRef(void 0),af=d.useRef(null),Aa=()=>{const a=new Date,p=a.getFullYear(),h=String(a.getMonth()+1).padStart(2,"0"),x=String(a.getDate()).padStart(2,"0");return`${p}-${h}-${x}`},[le,ao]=d.useState(Aa()),[Ir,D0]=d.useState("table"),[Rt,Pa]=d.useState(()=>{try{const a=localStorage.getItem(Eu);return a==="notes"||a==="flashcards"?a:"attendance"}catch{return"attendance"}});d.useEffect(()=>{try{localStorage.setItem(Eu,Rt)}catch{}},[Rt]);const[Cl,L0]=d.useState(()=>{try{return localStorage.getItem(_u)==="last-first"?"last-first":"first-last"}catch{return"first-last"}});d.useEffect(()=>{try{localStorage.setItem(_u,Cl)}catch{}},[Cl]);const[uo,O0]=d.useState(()=>{try{return localStorage.getItem(Ru)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Ru,uo)}catch{}},[uo]);const[El,M0]=d.useState(()=>{try{return localStorage.getItem(Tu)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Tu,El)}catch{}},[El]);const U0=d.useMemo(()=>new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),[]);d.useEffect(()=>{Vd.current=Na},[Na]),d.useEffect(()=>()=>{Object.values(Vd.current).forEach(a=>URL.revokeObjectURL(a))},[]);const[$e,Cn]=d.useState(!1),[Ia,F0]=d.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem(km)==="1"}catch{return!1}}),qn=d.useRef(0),Ut=d.useRef(null),uf=d.useRef({}),cf=d.useRef({}),_l=d.useRef(null),ds=d.useRef({}),fs=d.useRef({}),Xn=d.useRef(null),Rl=d.useRef(!1),Da=d.useRef(!1),La=d.useRef(!1),ps=d.useRef(null),co=d.useRef(0),fo=d.useRef(!1),df=d.useRef(0),tn=d.useCallback(a=>{_r(a.messages),me(a.allMessages),Lt(a.unreadCount),We(new Set(a.dismissedIds))},[]),Dr=d.useRef(null),ff=d.useRef(null),Tl=d.useRef(!1),Oa=d.useRef(!1),[pf,ms]=d.useState(!1),Al=d.useRef(0),En=d.useRef(null),Ma=d.useRef(!1),mf=1500,hf=3e4,Lr=d.useRef(null),Pl=d.useCallback(a=>a?uf.current[a]??null:null,[]),Nt=d.useCallback((a,p)=>{a&&(uf.current[a]=p||null)},[]),Il=d.useCallback(a=>a||"__local__",[]),gf=d.useCallback(a=>cf.current[Il(a)]??null,[Il]),Or=d.useCallback((a,p)=>{p&&(cf.current[Il(a)]=p)},[Il]),mn=d.useCallback(a=>{ds.current={},fs.current={};const p=Ao(a??(N==null?void 0:N.id));if(p)try{window.localStorage.removeItem(p)}catch{}Dr.current&&(window.clearTimeout(Dr.current),Dr.current=null)},[N==null?void 0:N.id]),hs=d.useCallback((a,p,h)=>{const x=ds.current;x[a]||(x[a]={}),x[a][p]={...h}},[]),yf=d.useCallback((a,p,h)=>{const x=fs.current;x[a]||(x[a]={}),x[a][p]={...h}},[]),xf=d.useCallback(()=>{const a=N==null?void 0:N.id,p=Ao(a);if(!p)return;const h=Cm(ci(ds.current),Nm),x=Cm(ci(fs.current),Nm),w={savedAt:Date.now(),lastEditAt:Lr.current??Date.now(),selectedDate:le,selectedPeriodId:it,pendingAttendanceByDate:h,pendingNotesByDate:x,pointsLocal:M,pointsHistoryLocal:Y};let C=JSON.stringify(w);if(C.length>bm){const A={...w,pointsHistoryLocal:{}};C=JSON.stringify(A)}if(!(C.length>bm))try{window.localStorage.setItem(p,C)}catch{}},[N==null?void 0:N.id,Y,M,le,it]),vf=d.useCallback(()=>{$e&&(Dr.current&&window.clearTimeout(Dr.current),Dr.current=window.setTimeout(()=>{xf(),Dr.current=null},250))},[$e,xf]),Ua=a=>{var p;return JSON.stringify({periodsState:((p=a.periodsState)==null?void 0:p.periods)||[],students:a.students||[]})},_n=d.useRef(0),[$b,po]=d.useState("unknown"),[Bb,Fa]=d.useState(0),mo=d.useRef(null),za=d.useRef(!1);d.useEffect(()=>{mo.current=l},[l]);const Dl=d.useCallback(a=>{if(!a)return!1;const p=mo.current;return ab(p,a)?!1:(mo.current=a,u(a),!0)},[]);d.useCallback(async()=>{const a=await kn(mo.current);return a&&Dl(a),a},[Dl]);const wf=d.useCallback(()=>{if(F)return!0;if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[F]),hn=d.useCallback(a=>{if(!wf())return;const p=`${new Date().toISOString()} ${a}`;ue(h=>[p,...h].slice(0,200))},[wf]);d.useEffect(()=>{s&&k(o)},[o,s]);const z0=d.useCallback(async()=>{var p;const a=await bw();if(O(a),hn(`startup info: state=${a.state} sessionLoaded=${a.sessionLoaded} hasRefresh=${a.hasRefresh} expiresAt=${a.expiresAt} source=${a.source} lastWriteAt=${a.lastWriteAt} lastWriteReason=${a.lastWriteReason}`),a.state==="ok"){const h=await jw();h&&(u(h),(p=h.profile)!=null&&p.email&&k(null))}return a},[hn]),gs=d.useCallback(async a=>{const p=mo.current,h=(p==null?void 0:p.expiresAt)||null,x=await kn(p);return hn(`${a}: ensureFreshDriveSession ok=${!!x} before=${h} new=${x==null?void 0:x.expiresAt} hasRefresh=${!!(x!=null&&x.refreshToken)}`),x&&(Dl(x),y(!1)),x},[hn,Dl]),$0=d.useCallback(()=>{Al.current+=1,En.current&&window.clearTimeout(En.current),En.current=window.setTimeout(()=>{Al.current=0,En.current=null},2e3),Al.current>=5&&($(a=>!a),Al.current=0,En.current&&(window.clearTimeout(En.current),En.current=null))},[]),B0=()=>{const a=new URL(sb);new URL(window.location.href).searchParams.forEach((h,x)=>a.searchParams.set(x,h)),a.searchParams.set("from","mobile"),window.location.assign(a.toString())},W0=a=>{var x,w;if(!R)return;const p=R.students.find(C=>String(C.id)===String(a));if(!p)return;const h=((x=p.periodIds)==null?void 0:x[0])||it||((w=R.periods[0])!=null&&w.id?String(R.periods[0].id):"");oo({name:p.fullName,gender:p.gender||"F",periodId:h?String(h):""}),Xd({id:String(a)})},Ll=()=>{Xd(null),oo(null)},H0=a=>{if(!R)return;const p=R.students.find(x=>String(x.id)===String(a));!p||!window.confirm(`Delete ${p.fullName}? This removes them from this class list.`)||(_a.current.add(String(a)),Z(x=>{if(!x)return x;const w=x.students.filter(A=>String(A.id)!==String(a)),C=x.periods.map(A=>{const D={...A.attendance||{}};Object.keys(D).forEach(P=>{const L={...D[P]||{}};delete L[String(a)],Object.keys(L).length===0?delete D[P]:D[P]=L});const _={...A.behaviorNotes||{}};Object.keys(_).forEach(P=>{const L={..._[P]||{}};delete L[String(a)],Object.keys(L).length===0?delete _[P]:_[P]=L});const W={...A.pointsByStudent||{}};delete W[String(a)];const K={...A.customCounterByStudent||{}};delete K[String(a)];const ee={...A.attendanceResets||{}};delete ee[String(a)];const ie=A.activeGrouping?A.activeGrouping.map(P=>P.filter(L=>String(L)!==String(a))):A.activeGrouping;return{...A,attendance:D,behaviorNotes:_,pointsByStudent:W,customCounterByStudent:K,attendanceResets:ee,activeGrouping:ie}});return{...x,students:w,periods:C}}),Ze(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const A={...w[C]||{}};delete A[String(a)],w[C]=A}}),w}),mt(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const A={...w[C]||{}};delete A[String(a)],w[C]=A}}),w}),U(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const A={...w[C]||{}};delete A[String(a)],w[C]=A}}),w}),Q(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{w[C]=(w[C]||[]).filter(A=>String(A.studentId)!==String(a))}),w}),Pe(),tt({silent:!0}),bt(null),Jd(null),Ll())};d.useEffect(()=>()=>{En.current&&window.clearTimeout(En.current)},[]),d.useEffect(()=>{io(!nf||!rf)},[nf,rf]);const Sf=d.useCallback(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[]),ho=d.useCallback(a=>{Sf()&&console.debug(a.startsWith("[Ping]")?a:`[Ping] ${a}`)},[Sf]);d.useEffect(()=>{Jn.current=!1;const a=T0,p=A0,h=P0,x=I0,w=()=>{a.current&&(window.clearTimeout(a.current),a.current=null)},C=K=>{if(Jn.current)return;w();const ee=typeof K=="number"?K:h.current;ho(`[Ping] next ${ee}`),a.current=window.setTimeout(()=>{a.current=null,A()},ee)},A=async()=>{if(Jn.current)return;if(x.current=Date.now(),ho("[Ping] tick"),typeof document<"u"&&document.visibilityState!=="visible"){C(5e3);return}if(p.current){C(2e3);return}p.current=!0;const K=new AbortController,ee=window.setTimeout(()=>K.abort(),5e3),ie=(()=>{try{return new URL(`/ping.txt?t=${Date.now()}`,window.location.origin).toString()}catch{return`/ping.txt?t=${Date.now()}`}})();let P=!1;try{const L=await fetch(ie,{cache:"no-store",signal:K.signal});P=!!(L!=null&&L.ok),P?(lo(!0),Ea(!0),io(!1),h.current=15e3,ho("[Ping] ok")):(lo(!1),Ea(!1),io(!0),h.current=Math.min(6e4,h.current*2),ho(`[Ping] fail status=${L==null?void 0:L.status}`))}catch(L){lo(!1),Ea(!1),io(!0),h.current=Math.min(6e4,h.current*2),ho(`[Ping] fail ${(L==null?void 0:L.message)||L}`)}finally{window.clearTimeout(ee),p.current=!1,Jn.current||C()}},D=()=>{Jn.current||(lo(!0),A())},_=()=>{Jn.current||(lo(!1),io(!0),C(2e3))},W=()=>{Jn.current||typeof document<"u"&&document.visibilityState==="visible"&&A()};return A(),window.addEventListener("online",D),window.addEventListener("offline",_),document.addEventListener("visibilitychange",W),()=>{Jn.current=!0,w(),window.removeEventListener("online",D),window.removeEventListener("offline",_),document.removeEventListener("visibilitychange",W)}},[]);const Ol=d.useCallback((a,p)=>{Ze(p.periods.reduce((h,x)=>{var C,A;const w=(C=ds.current[String(x.id)])==null?void 0:C[a];return h[x.id]=w?{...w}:(A=x.attendance)!=null&&A[a]?{...x.attendance[a]}:{},h},{})),mt(p.periods.reduce((h,x)=>{var C;const w=(C=fs.current[String(x.id)])==null?void 0:C[a];return h[x.id]=w?{...w}:Au(x.behaviorNotes,a),h},{}))},[]);d.useEffect(()=>{if(!R)return;const a=lf.current!==R.periods,p=af.current!==le;!a&&!p||(lf.current=R.periods,af.current=le,Ol(le,R))},[Ol,R,le]),d.useEffect(()=>{const a=N==null?void 0:N.id;if(!a||ff.current===a)return;ff.current=a;const p=Ao(a);if(!p)return;let h=null;try{const C=window.localStorage.getItem(p);if(!C)return;h=JSON.parse(C)}catch{return}if(!h||typeof h.savedAt!="number")return;if(Date.now()-h.savedAt>lb){mn(a);return}ds.current=h.pendingAttendanceByDate||{},fs.current=h.pendingNotesByDate||{},h.pointsLocal&&U(h.pointsLocal),h.pointsHistoryLocal&&Q(h.pointsHistoryLocal),h.selectedPeriodId&&is(h.selectedPeriodId),h.lastEditAt&&(Lr.current=h.lastEditAt);const x=h.selectedDate&&N0(h.selectedDate)?h.selectedDate:le;h.selectedDate&&x!==le&&ao(x),R&&Ol(x,R),(Object.keys(h.pendingAttendanceByDate||{}).length>0||Object.keys(h.pendingNotesByDate||{}).length>0||Object.keys(h.pointsHistoryLocal||{}).length>0)&&(qn.current+=1,Cn(!0),Ve(!0))},[N==null?void 0:N.id,mn,Ol,R,le]),d.useEffect(()=>{vf()},[He,Kt,M,Y,$e,vf]);const bf=d.useCallback(a=>{const p={};return!a||typeof a!="object"||Object.entries(a).forEach(([h,x])=>{if(!x||typeof x!="object")return;const w={},C=x.note&&typeof x.note=="object"?x.note:x;Object.entries(C).forEach(([A,D])=>{D&&typeof D=="object"&&typeof D.note=="string"&&(w[String(A)]={note:D.note,timestamp:D.timestamp||new Date().toISOString()})}),Object.keys(w).length>0&&(p[h]=w)}),p},[]),Mr=a=>e({tone:"success",message:a}),at=a=>e({tone:"error",message:a}),gn=a=>e({tone:"info",message:a}),Ml=["unmarked","absent","tardy","left_early","present"],V0=["present","absent","tardy","left_early","unmarked"],Ul=d.useCallback(a=>{if(!a)return!1;const p=a.toLowerCase();return p.includes("401")||p.includes("unauthorized")||p.includes("403")||p.includes("sign in with google drive first")},[]),K0=a=>{switch(a){case"present":return"bg-emerald-50 border-emerald-100";case"absent":return"bg-rose-50 border-rose-100";case"tardy":return"bg-amber-50 border-amber-100";case"left_early":return"bg-blue-50 border-blue-100";default:return"bg-slate-50 border-slate-200"}},Nf=a=>{switch(a){case"present":return"Present";case"absent":return"Absent";case"tardy":return"Tardy";case"left_early":return"Left Early";default:return"Unmarked"}},$a=(a,p)=>h0(a,p).emoji,G0=()=>`${Date.now()}-${Math.random().toString(36).slice(2)}`,Y0=a=>{const p=String(a.getMonth()+1).padStart(2,"0"),h=String(a.getDate()).padStart(2,"0");return`${p}-${h}-${a.getFullYear()}`},Ba=a=>`https://docs.google.com/document/d/${a}/edit`,Wa=d.useCallback(a=>{if(!a)return;const p=Date.now(),h=of.current;if(h&&h.url===a&&p-h.at<600)return;of.current={url:a,at:p};try{if(r!=null&&r.openExternal){r.openExternal(a);return}}catch{}window.open(a,"_blank","noopener,noreferrer")||k==null||k("Pop-up blocked  please allow pop-ups to open Google Docs.")},[r]),Rn=d.useCallback(a=>k1(a),[]),Te=d.useCallback(async(a,p="preflight")=>{if(s)return k(o),null;if(ge)return k("Offline  will sync when back online."),y(!0),hn(`${p}: offline; skipping refresh`),null;try{const h=await gs(p);if(h)return h}catch(h){console.warn("[Drive] refresh failed",h),hn(`${p}: refresh failed ${(h==null?void 0:h.message)||h}`)}if(!a)return y(!0),k("Reconnect to Google Drive to continue syncing."),hn(`${p}: interactive=false; would trigger OAuth if allowed`),null;hn(`triggerOAuth: reason=${p} hadSession=${!!l} hasRefresh=${!!(l!=null&&l.refreshToken)}`);try{await Iw()}catch(h){at((h==null?void 0:h.message)||"Google sign-in was cancelled.")}return null},[o,l,s,at,ge,hn,gs]),kf=d.useCallback(async()=>{if(s||ge||Rl.current)return!1;Rl.current=!0;try{const a=await Te(!1,"announcements-sync");if(!(a!=null&&a.accessToken))return!1;const p=a.accessToken,h=await Yw(p,[Zi,am]);let x=Xn.current;if(x)try{const P=await Su(p,x);P!=null&&P.id||(x=null,Xn.current=null)}catch{x=null,Xn.current=null}const w=await bu(p),C=jm(w);if(C!=null&&C.id){const P=x?await Su(p,x).catch(()=>null):null,L=Is(P||null),oe=Is(C);(!x||C.id!==x||oe>=L)&&(x=C.id,Xn.current=C.id,ps.current=ui(C)),co.current=0,await Jw(p,C.id,h)}if(!x){const P=JSON.stringify(um(Jo(),null),null,2),L=await Xw(p,h,Ac,P);if(!(L!=null&&L.id))return!1;x=L.id,Xn.current=L.id,ps.current=ui(L),co.current=0}const A=await vs(p,x),D=cm(A),_=Jo(),W=dm(_,(D==null?void 0:D.dismissed)||[]),K=W.size!==_.size;K&&Pc(W);const ee=new Set(((D==null?void 0:D.dismissed)||[]).map(String));let ie=W.size!==ee.size;if(!ie){for(const P of W)if(!ee.has(P)){ie=!0;break}}if(ie){const P=JSON.stringify(um(W,null),null,2),L=await em(p,x,P);ps.current=ui(L)}else ps.current=null;if(K||ie){const P=ai();tn(P)}return await Qw(p,am),!0}catch{return!1}finally{Rl.current=!1}},[tn,s,Te,ge]),Fl=d.useCallback(async()=>{if(!(!l||s||ge)&&!(Da.current||Rl.current)){Da.current=!0;try{const a=await Te(!1,"announcements-poll");if(!(a!=null&&a.accessToken))return;const p=a.accessToken;let h=null,x=Xn.current;if(x)try{h=await Su(p,x)}catch{h=null,x=null,Xn.current=null}const w=await bu(p),C=jm(w);if(C!=null&&C.id){const oe=Is(h||null),se=Is(C);(!x||C.id!==x||se>=oe)&&(x=C.id,h=C,Xn.current=C.id),co.current=0}else if(!x){if(Date.now()<co.current)return;co.current=Date.now()+12e4;return}if(!x)return;const A=ui(h||{id:x,name:Ac}),D=Date.now(),_=D-df.current>=ib;if(A&&A===ps.current&&!_)return;const W=await vs(p,x),K=cm(W);if(df.current=D,ps.current=A,!K)return;const ee=Jo(),ie=dm(ee,K.dismissed||[]);if(!(ie.size!==ee.size))return;Pc(ie);const L=ai();tn(L)}catch{}finally{Da.current=!1}}},[tn,l,s,Te,ge]),Tn=d.useCallback(async a=>{if(La.current){a==="manual"&&fo.current&&window.setTimeout(()=>{Tn("manual")},350);return}La.current=!0;try{l&&!s&&!ge&&(a==="manual"&&fo.current?await kf()&&(fo.current=!1):await Fl());const x=await fm(a==="heartbeat"?24:12,a==="manual");tn(x)}catch{}finally{La.current=!1}},[tn,l,s,ge,Fl,kf]),Q0=d.useCallback(()=>{Xe(!0),Tn("manual")},[Tn]),J0=d.useCallback(()=>{Xe(!1),fo.current&&Tn("manual")},[Tn]),q0=d.useCallback(a=>{O1(a),fo.current=!0;const p=ai();tn(p)},[tn]);d.useEffect(()=>{let a=!0;const p=ai();return a&&tn(p),(async()=>{const h=await fm(12,!0);a&&tn(h)})(),()=>{a=!1}},[tn]),d.useEffect(()=>{let a=!0;const p=60*60*1e3,h=window.setInterval(()=>{(async()=>a&&await Tn("heartbeat"))()},p);return()=>{a=!1,window.clearInterval(h)}},[Tn]),d.useEffect(()=>{if(!(l!=null&&l.accessToken)){za.current=!1;return}za.current||(za.current=!0,Tn("drive-connect"))},[l==null?void 0:l.accessToken,Tn]),d.useEffect(()=>{if(!l||s||ge)return;let a=!0;const p=()=>{a&&(typeof document<"u"&&document.visibilityState!=="visible"||Fl())};p();const h=window.setInterval(p,2e4),x=()=>{document.visibilityState==="visible"&&p()},w=()=>p();return document.addEventListener("visibilitychange",x),window.addEventListener("online",w),()=>{a=!1,window.clearInterval(h),document.removeEventListener("visibilitychange",x),window.removeEventListener("online",w)}},[l,s,ge,Fl]);const zl=d.useCallback(async(a,p,h)=>{let x=!1;const w=async()=>{let C=h;if(C||(C=await Te(!0,`${p}-download`)),!C)throw new Error("Reconnect to Google Drive to continue.");try{return{data:await vs(C.accessToken,a)}}catch(A){const D=(A==null?void 0:A.message)||"";if(!x&&Ul(D))return x=!0,_o("[Drive][Mobile] auth error on download, retrying once",{context:p,error:D}),h=null,w();throw A}};return w()},[Te,Ul]),jf=d.useCallback(async(a,p,h,x)=>{let w=!1;const C=async()=>{let A=x;if(A||(A=await Te(!0,`${h}-upload`)),!A)throw new Error("Reconnect to Google Drive to continue.");try{return await em(A.accessToken,a,p)}catch(D){const _=(D==null?void 0:D.message)||"";if(!w&&Ul(_))return w=!0,_o("[Drive][Mobile] auth error on upload, retrying once",{context:h,error:_}),x=null,C();throw D}};return C()},[Te,Ul]),Zn=d.useCallback((a,p)=>{var D;if(!((D=a==null?void 0:a.periodsState)!=null&&D.periods)||!(a!=null&&a.students))return"failed";const h=Ua(a),x=(p==null?void 0:p.id)||Ut.current;if(x){const _=E1({incomingUpdatedAt:a.updatedAt,lastAppliedUpdatedAt:gf(x),incomingRevisionId:(p==null?void 0:p.revisionId)||null,lastRevisionId:Pl(x)??null});if(_o("[Sync][Mobile] apply decision",{fileKey:x,decision:_}),_.action==="skip")return p&&(Ut.current=p.id,H(p),Nt(p.id,p.revisionId||null)),_n.current=Date.now(),"skipped"}qn.current=0,jn.current=!1,Pr.current=!1,Cn(!1),Ve(!1),Ot(null),ms(!1),mn(),Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null);const w=(a.layouts||[]).reduce((_,W)=>(_[String(W.id)]={id:String(W.id),name:W.name,tables:(W.tables||[]).map(K=>({id:String(K.id),name:K.name||"Table",seatNumbers:Array.isArray(K.seatNumbers)?K.seatNumbers:void 0}))},_),{}),C=a.periodsState.periods.map(_=>({id:String(_.id),name:_.name,layoutId:_.layoutId||null,tableAssignments:_.tableAssignments||{},activeGrouping:_.activeGrouping||[],tableNumbering:_.tableNumbering||void 0,attendance:_.attendance||{},attendanceResets:_.attendanceResets||{},customCounterByStudent:_.customCounterByStudent||{},behaviorNotes:bf(_.behaviorNotes),pointsByStudent:_.pointsByStudent||{},pointsEnabled:_.pointsEnabled??!1,startingPoints:_.startingPoints??50,pointsHistory:_.pointsHistory||[]})),A=(a.students||[]).map(_=>{var W;return{id:String(_.id),fullName:_.fullName||_.name||"Student",gender:typeof _.gender=="string"?_.gender:void 0,periodIds:((W=_.periodIds)==null?void 0:W.map(K=>String(K)))||[],profileUpdatedAt:typeof _.profileUpdatedAt=="string"?_.profileUpdatedAt:void 0,quickNote:typeof _.quickNote=="string"?_.quickNote:void 0,quickNoteUpdatedAt:typeof _.quickNoteUpdatedAt=="string"?_.quickNoteUpdatedAt:void 0,photoFileId:typeof _.photoFileId=="string"?_.photoFileId:_.photoFileId==null?null:String(_.photoFileId),photoUpdatedAt:(()=>{if(typeof _.photoUpdatedAt=="number")return _.photoUpdatedAt;if(typeof _.photoUpdatedAt=="string"){const K=Number.parseInt(_.photoUpdatedAt,10);return Number.isFinite(K)?K:null}return null})(),audioFileId:typeof _.audioFileId=="string"?_.audioFileId:_.audioFileId==null?null:String(_.audioFileId),audioUpdatedAt:(()=>{if(typeof _.audioUpdatedAt=="number")return _.audioUpdatedAt;if(typeof _.audioUpdatedAt=="string"){const K=Number.parseInt(_.audioUpdatedAt,10);return Number.isFinite(K)?K:null}return null})(),docs:Array.isArray(_.docs)?_.docs.map(K=>({...K,id:String(K.id),driveFileId:String(K.driveFileId)})):[]}});return Z({periods:C,students:A,layouts:w}),is(_=>{var P;const W=_?String(_):null,K=a.periodsState.currentId?String(a.periodsState.currentId):null;return[W,K,((P=C[0])==null?void 0:P.id)||null].filter(Boolean).find(L=>C.some(oe=>String(oe.id)===L))||null}),Ze(C.reduce((_,W)=>{var K;return _[W.id]=(K=W.attendance)!=null&&K[le]?{...W.attendance[le]}:{},_},{})),mt(C.reduce((_,W)=>(_[W.id]=Au(W.behaviorNotes,le),_),{})),U(C.reduce((_,W)=>{var ee;const K=W.pointsByStudent?{...W.pointsByStudent}:{};return W.pointsEnabled&&((ee=W.studentsIds)==null||ee.forEach(ie=>{K[ie]===void 0&&(K[ie]=W.startingPoints??50)})),_[W.id]=K,_},{})),_l.current=h,po(a.lastWriter||"unknown"),p?(Ut.current=p.id,H(p),Nt(p.id,p.revisionId||null)):Nt(Ut.current,null),as(null),Fa(_=>_+1),Or(x,a.updatedAt),_n.current=Date.now(),"applied"},[le,gf,bf,Au,Ze,mt,U,is,Z,Cn,Ve,H,Nt,Ot,ms,po,as,Fa,Or,mn]),Pe=d.useCallback(()=>{qn.current+=1,Lr.current=Date.now(),Cn(!0),Ve(!0)},[]),Ha=d.useCallback((a,p,h)=>{Z(x=>x&&{...x,periods:x.periods.map(w=>{if(String(w.id)!==String(a))return w;const C={...w.attendanceResets||{}},A={...C[String(p)]||{}};return A[h]=le,C[String(p)]=A,{...w,attendanceResets:C}})}),Pe()},[Pe,le]),Cf=d.useCallback((a,p,h)=>{const x=Math.trunc(h);!Number.isFinite(x)||x===0||(Z(w=>w&&{...w,periods:w.periods.map(C=>{if(String(C.id)!==String(a))return C;const A={...C.customCounterByStudent||{}},D=Number(A[String(p)]||0),_=Math.max(0,D+x);return _<=0?delete A[String(p)]:A[String(p)]=_,{...C,customCounterByStudent:A}})}),Pe())},[Pe]),X0=d.useCallback((a,p)=>{Z(h=>h&&{...h,periods:h.periods.map(x=>{if(String(x.id)!==String(a))return x;const w={...x.customCounterByStudent||{}};return delete w[String(p)],{...x,customCounterByStudent:w}})}),Pe()},[Pe]),Va=d.useCallback((a,p,h)=>{Ze(x=>{const w={...x||{}};return w[a]={...w[a]||{}},h==="unmarked"?delete w[a][p]:w[a][p]=h,hs(String(a),le,w[a]),w}),Pe()},[Pe,le,hs]);d.useCallback((a,p)=>{var C;const h=((C=He[a])==null?void 0:C[p])||"unmarked",x=Ml.indexOf(h),w=Ml[(x+1)%Ml.length];Va(a,p,w)},[He,Va,Ml]);const $l=d.useCallback((a,p)=>{Ze(h=>{const x={...h||{}};return x[a]={...x[a]||{}},p.forEach(w=>{x[a][w]||(x[a][w]="present")}),hs(String(a),le,x[a]),x}),Pe()},[Pe,le,hs]),Z0=d.useCallback((a,p,h,x)=>{if(h===0||p.length===0)return;const w=(x==null?void 0:x.trim())||"Bulk points update",C=R==null?void 0:R.periods.find(D=>D.id===a),A=(C==null?void 0:C.startingPoints)??50;U(D=>{const _={...D||{}};return _[a]={..._[a]||{}},p.forEach(W=>{const K=_[a][W]??A;_[a][W]=Math.max(0,K+h)}),_}),Q(D=>{const _={...D||{}},W=_[a]?[..._[a]]:[];return p.forEach(K=>W.push({studentId:K,delta:h,reason:w,date:le})),_[a]=W,_}),Pe()},[R==null?void 0:R.periods,le,Pe]),Ef=d.useCallback(a=>{Ze(p=>{const h={...p||{}};return h[a]={},hs(String(a),le,h[a]),h}),gn("Reset attendance to unmarked for this date."),Pe()},[gn,Pe,le,hs]),ey=d.useCallback(()=>{if(!ce)return;const{periodId:a,studentId:p}=ce,{note:h,delta:x,reason:w}=ye,C=he;if(C.pointsEnabled&&x!==0&&!w.trim()){at("Please provide a reason when changing points.");return}mt(A=>{const D={...A||{}};return D[a]={...D[a]||{}},h.trim()?D[a][p]=h.trim():delete D[a][p],yf(String(a),le,D[a]),D}),C.pointsEnabled&&x!==0&&(U(A=>{const D={...A||{}};D[a]={...D[a]||{}};const _=D[a][p]??C.startingPoints??0,W=Math.max(0,_+x);return D[a][p]=W,D}),Q(A=>{const D={...A||{}},_=D[a]?[...D[a]]:[];return _.push({studentId:p,delta:x,reason:w||"Behavior note",date:le}),D[a]=_,D})),Pe(),de(null),Se({note:"",delta:0,reason:""})},[ce,ye,he,Pe,le,yf,mt,U,at]),_f=d.useCallback((a,p,h)=>{var D,_;const x=((D=Kt[a])==null?void 0:D[p])||"",w=R==null?void 0:R.periods.find(W=>W.id===a),C=(w==null?void 0:w.startingPoints)??50,A=((_=M[a])==null?void 0:_[p])??C;Se({note:x,delta:0,reason:""}),ht({pointsEnabled:!!(w!=null&&w.pointsEnabled),startingPoints:C,currentPoints:A,predictedPoints:A}),de({periodId:a,studentId:p,studentName:h})},[Kt,M,R]),ty=d.useCallback((a,p,h)=>{_f(a,p,h)},[_f]);d.useEffect(()=>{if(s){k(o),v(!0);return}let a=!0;return(async()=>{await z0();const h=await Dw().catch(()=>null);if(!h||!a){a&&v(!0);return}const x=await kn(h),w=x||h;if(hn(`startup refresh result: ok=${!!x} expiresAt=${x==null?void 0:x.expiresAt}`),!!a){if(u(w),sf.current){v(!0);return}sf.current=!0;try{const C=localStorage.getItem(To);if(!C){Tl.current=!0,v(!0);return}const A=JSON.parse(C);if(A!=null&&A.id&&(A!=null&&A.name)){Oa.current=!0;const D={id:A.id,name:A.name,modifiedTime:A.modifiedTime,size:A.size,revisionId:A.revisionId};Oe(D),k(`Restoring ${D.name}`);const _=await vs(h.accessToken,D.id),W=typeof _=="string"?JSON.parse(_):_,K=Rn(W);if(!K)throw new Error("Drive file could not be parsed.");const ee=Zn(K,D);ee==="applied"?(H(D),k(`Loaded ${D.name} from Drive.`),as(new Date().toISOString())):ee==="skipped"&&(H(D),k("Drive file is older than current data  keeping existing state."))}Tl.current=!0,v(!0)}catch(C){console.error("[Drive] Restore failed",C),k("Google sign-in failed. Please try again."),Oa.current=!1,Tl.current=!0,v(!0)}}})(),()=>{a=!1}},[]),d.useEffect(()=>{var w;if(s||!m||q)return;const a=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,p=t||a,h=(((w=R==null?void 0:R.periods)==null?void 0:w.length)??0)>0;if(!(p&&!h&&!Ia&&!ge)){if(!l){re(!0);return}R||N!=null&&N.id||Tl.current&&(Oa.current||re(!0))}},[N,l,s,ge,t,R,Ia,m,q]),d.useEffect(()=>{q||Ne(!1)},[q]),d.useEffect(()=>{if(!V)return;const a=p=>{var x;const h=p.target;h&&((x=ef.current)!=null&&x.contains(h)||Ne(!1))};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[V]),d.useEffect(()=>{const a=window.setInterval(async()=>{l&&await gs("timer")},3e5);return()=>window.clearInterval(a)},[l,gs]),d.useEffect(()=>{const a=async()=>{l&&await gs("visibility")};return document.addEventListener("visibilitychange",a),()=>document.removeEventListener("visibilitychange",a)},[l,gs]),d.useEffect(()=>{if(g){const a=window.setTimeout(()=>{S(!1),E("Still loading Drive files. Try Sign in with Google then tap Refresh Cloud Files.")},12e3);return B(a),()=>window.clearTimeout(a)}Vt&&(window.clearTimeout(Vt),B(null)),Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null)},[g,Vt]);const ny=d.useCallback(()=>{Lw(),u(null),f([]),Oe(null),H(null),k(null),gn("Signed out of Google Drive."),Ps("drive-disconnect")},[gn,Ps]),ry=d.useCallback(()=>{if(!window.confirm("Clear local ClassSeats data on this device? This removes local class data and drafts on this device only. Google Drive files will not be changed."))return;const p=Ao(N==null?void 0:N.id),h=Ao(ne==null?void 0:ne.id);try{window.localStorage.removeItem(To),window.localStorage.removeItem(Eu),window.localStorage.removeItem(_u),window.localStorage.removeItem(Ru),window.localStorage.removeItem(Tu),p&&window.localStorage.removeItem(p),h&&h!==p&&window.localStorage.removeItem(h)}catch{}Z(null),Ze({}),mt({}),U({}),Q({}),is(null),Oe(null),H(null),Cn(!1),Ve(!1),Ot(null),mn(),Ps("local-clear"),Ne(!1),k("Local data cleared on this device."),gn("Local ClassSeats data cleared from this device.")},[N==null?void 0:N.id,Ps,mn,ne==null?void 0:ne.id,gn]),sy=d.useCallback(async()=>{var a;!N||!((a=window.desktopBridge)!=null&&a.uploadDriveFile)||confirm(`Delete ${N.name} from Drive? This cannot be undone.`)&&(await window.desktopBridge.uploadDriveFile({fileId:N.id,content:JSON.stringify({deleted:!0,message:"File deleted by user."})}),Z(null),Ze({}),mt({}),U({}),Q({}),mn(),H(null),is(null),k("Deleted active file from Drive."))},[N,mn]);d.useCallback(async()=>{},[Zn,Rn,H,Nt]);const Ka=d.useCallback(async(a=!0,p=!1)=>{if(!(g&&!p)){S(!0),E(null);try{const h=await Te(a,"refreshFiles");if(!h){E("Sign in with Google to view cloud files.");return}const x=await wu(h.accessToken);f(x),k(null)}catch(h){const x=(h==null?void 0:h.message)||"Unable to load Drive files.";E(x),at(x)}finally{S(!1)}}},[Te,at,g]);d.useEffect(()=>{if(!q){Ma.current=!1;return}s||l&&(Ma.current||(Ma.current=!0,Ka(!0)))},[l,s,Ka,q]),d.useCallback(async()=>{Qd(!0),ja(null);try{const a=await Te(!0,"importList");if(!a){ja("Sign in first to import.");return}const p=await bu(a.accessToken);R0(p)}catch(a){const p=(a==null?void 0:a.message)||"Unable to list Drive files.";ja(p),at(p)}finally{Qd(!1)}},[Te,at]);const oy=d.useCallback(async()=>{if(!ne){E("Select a cloud file first.");return}if(jn.current){E("Sync in progress. Please wait.");return}if($e||Qn)if(window.confirm("You have unsynced changes. Sync them to Drive before switching files? Click OK to sync, Cancel to discard changes.")){if(await tt({silent:!0}),$e||Qn){E("Sync did not complete. Try again before switching files.");return}}else{if(!window.confirm("Discard unsynced changes and load the selected file?"))return;qn.current=0,Cn(!1),Ve(!1),Ot(null)}if(await Te(!0,"loadSelected")){Fe(!0);try{const p=await zl(ne.id,"loadSelected"),h=typeof p.data=="string"?JSON.parse(p.data):p.data,x=Rn(h);if(!x)throw new Error("File could not be parsed.");const w=Zn(x,ne);if(w==="applied")k(`Loaded ${ne.name}. Data available locally.`),re(!1),Ne(!1);else if(w==="skipped")k("Drive file is older than current data. Keeping existing data."),re(!1),Ne(!1);else throw new Error("File could not be parsed.");localStorage.setItem(To,JSON.stringify({id:ne.id,name:ne.name,modifiedTime:ne.modifiedTime,size:ne.size,revisionId:ne.revisionId})),Mr(`Loaded ${ne.name} from Drive.`)}catch(p){const h=(p==null?void 0:p.message)||"Unable to load Drive file.";E(h),at(h)}finally{Fe(!1)}}},[Te,ne,at,Mr,Zn,Rn,$e,Qn,zl]);d.useCallback(async()=>{const a=X.trim();if(!a){E("Enter a file name first.");return}const p=await Te(!0,"createFile");if(p){ot(!0),E(null);try{const x={...w1(void 0,void 0,R==null?void 0:R.students),lastWriter:"mobile",updatedAt:new Date().toISOString()},w=await qw(p.accessToken,a,JSON.stringify(x,null,2));f(C=>[w,...C]),H(w),Ut.current=w.id,Nt(w.id,w.revisionId||null),Or(w.id,x.updatedAt),Oe(w),pe(""),localStorage.setItem(To,JSON.stringify({id:w.id,name:w.name,modifiedTime:w.modifiedTime,size:w.size,revisionId:w.revisionId})),Mr(`Created ${w.name} in Drive.`)}catch(h){const x=(h==null?void 0:h.message)||"Unable to create Drive file.";E(x),at(x)}finally{ot(!1)}}},[X,Te,R,Or,at,Mr]);const Rf=d.useCallback((a,p)=>{const h={...a||{}};return Object.entries(p||{}).forEach(([x,w])=>{if(!w||typeof w!="object")return;const C=h[x]||{},A={...C};["absent","tardy","leftEarly"].forEach(D=>{const _=w[D],W=C[D];_&&(!W||_>W)?A[D]=_:W&&(A[D]=W)}),h[x]=A}),h},[]),tt=d.useCallback(async a=>{var h,x,w;if(s){k(o);return}if(jn.current)return;if(a!=null&&a.silent&&!$e){Ve(!1),Ot(null);return}if(!((h=R==null?void 0:R.periods)!=null&&h.length)||!((x=R==null?void 0:R.students)!=null&&x.length)){k("Cannot sync until data is loaded. Open a file first.");return}if(ge){Ve(!0),Ot("Offline - changes will sync when back online."),ms(!0);return}if(Pr.current){k("Sync already running.");return}const p=qn.current;try{const C=await Te(!(a!=null&&a.silent),"syncUpload");if(!C){Ot("Reconnect to Google Drive to continue syncing."),Ve(!0);return}if(!N){k("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ve(!0);return}const A=j1({isOffline:ge,isLocked:Pr.current,inFlight:jn.current,hasSession:!0,hasFile:!!N,dirty:$e,now:Date.now(),lastLocalEditAt:Lr.current,graceMs:mf});if(_o("[Sync][Mobile] upload decision",A),A.action==="skip"){if(A.reason==="clean"&&!(a!=null&&a.silent)){const te=N.id,be=(await wu(C.accessToken)).find(ys=>ys.id===te),nt=be||N,kt=await vs(C.accessToken,te),ut=typeof kt=="string"?JSON.parse(kt):kt,yn=Rn(ut);if(!yn)throw new Error("Drive file could not be parsed.");const er=Zn(yn,nt);if(er==="failed")throw new Error("Drive file could not be parsed.");er==="applied"&&gn("Updated from Drive."),be!=null&&be.revisionId&&Nt(te,be.revisionId||null),_n.current=Date.now(),as(new Date().toISOString()),Ve(!1),Ot(null),k("Synced with Google Drive."),Mr("Synced with Google Drive.");return}A.reason==="no-file"&&(k("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ve(!0));return}Pr.current=!0,jn.current=!0,Zd(!0);const D=ci(ds.current),_=ci(fs.current),W=await zl(N.id,"syncUpload",C),K=typeof W.data=="string"?JSON.parse(W.data):W.data,ee=Rn(K);if(!((w=ee==null?void 0:ee.periodsState)!=null&&w.periods))throw new Error("Drive file missing periods.");const ie=_a.current,P=new Date().toISOString(),L=(ee.periodsState.periods||[]).map(te=>{const ve=String(te.id),be=M[ve]||{},nt=Array.isArray(te.pointsHistory)?[...te.pointsHistory]:[],kt=Y[ve]||[],ut=R==null?void 0:R.periods.find(nn=>String(nn.id)===ve),yn=Rf(te.attendanceResets||{},(ut==null?void 0:ut.attendanceResets)||{}),er=gm(te.attendance,D[ve],ie),ys=ym(te.behaviorNotes,_[ve],ie,P),xo=[...nt,...kt].filter(nn=>!ie.has(String(nn.studentId))),vo={...be};ie.forEach(nn=>{delete vo[nn]});const Mf={...yn||{}};ie.forEach(nn=>{delete Mf[nn]});const Uf={...te.customCounterByStudent||{},...(ut==null?void 0:ut.customCounterByStudent)||{}};ie.forEach(nn=>{delete Uf[nn]});const my=te.activeGrouping?te.activeGrouping.map(nn=>nn.filter(hy=>!ie.has(String(hy)))):te.activeGrouping;return{...te,attendance:er,attendanceResets:Mf,customCounterByStudent:Uf,behaviorNotes:ys,pointsByStudent:vo,pointsHistory:xo,activeGrouping:my}}),oe=ee.students||[],se=(R==null?void 0:R.students)||[],ke=new Map(se.map(te=>[String(te.id),te])),Ke=oe.filter(te=>!ie.has(String(te.id))).map(te=>{const ve=ke.get(String(te.id));if(!ve)return te;let be={...te};const nt=ve.profileUpdatedAt||"",kt=te.profileUpdatedAt||"";nt&&(!kt||nt>kt)&&(be={...be,fullName:ve.fullName,gender:ve.gender,periodIds:ve.periodIds,profileUpdatedAt:nt});const ut=ve.quickNoteUpdatedAt||"",yn=te.quickNoteUpdatedAt||"";ut&&(!yn||ut>yn)&&(be={...be,quickNote:ve.quickNote,quickNoteUpdatedAt:ve.quickNoteUpdatedAt});const er=typeof ve.photoUpdatedAt=="number"?ve.photoUpdatedAt:0,ys=typeof te.photoUpdatedAt=="number"?te.photoUpdatedAt:0;er&&(!ys||er>ys)&&(be={...be,photoFileId:ve.photoFileId??null,photoUpdatedAt:er});const xo=typeof ve.audioUpdatedAt=="number"?ve.audioUpdatedAt:0,vo=typeof te.audioUpdatedAt=="number"?te.audioUpdatedAt:0;return xo&&(!vo||xo>vo)&&(be={...be,audioFileId:ve.audioFileId??null,audioUpdatedAt:xo}),be}),Ur=new Set(oe.map(te=>String(te.id)));se.forEach(te=>{ie.has(String(te.id))||Ur.has(String(te.id))||Ke.push(te)});const An={...ee,schemaVersion:1,version:1,lastWriter:"mobile",lastEditedPeriodId:it?String(it):null,lastEditedDate:le,updatedAt:P,students:Ke,periodsState:{...ee.periodsState,periods:L}},yo=JSON.stringify(An,null,2),je=await jf(N.id,yo,"syncUpload",C);Q(te=>{const ve={...te||{}};return delete ve[it||""],ve}),je?(_l.current=Ua(An),Nt(je.id,je.revisionId||null),Ut.current=je.id,H(je),Or(je.id,An.updatedAt),_n.current=Date.now()):Or(N.id,An.updatedAt),_a.current.clear(),po("mobile"),a!=null&&a.silent||(k("Synced with Google Drive."),Mr("Synced with Google Drive.")),as(new Date().toISOString()),Ve(!1),localStorage.setItem(To,JSON.stringify({id:(je==null?void 0:je.id)||N.id,name:(je==null?void 0:je.name)||N.name,modifiedTime:(je==null?void 0:je.modifiedTime)||N.modifiedTime,size:(je==null?void 0:je.size)||N.size,revisionId:(je==null?void 0:je.revisionId)||N.revisionId})),qn.current===p&&(Z(te=>{if(!te)return te;const ve=te.periods.map(be=>{const nt=String(be.id),kt=gm(be.attendance,D[nt],new Set),ut=ym(be.behaviorNotes,_[nt],new Set,P);return{...be,attendance:kt,behaviorNotes:ut}});return{...te,periods:ve}}),Cn(!1),Ve(!1),mn())}catch(C){const A=(C==null?void 0:C.message)||"Failed to sync with Drive.";k(A),a!=null&&a.silent||at(A),Ve(!0)}finally{Zd(!1),jn.current=!1,Pr.current=!1}},[N,Te,Zn,at,gn,Mr,M,Y,R,le,it,$e,o,s,ge,Rn,mn,Z,Pl,Or,Nt,zl,jf,Rf]),Bl=d.useCallback(()=>{s||ge||$e&&N&&l&&(Ve(!0),tt({silent:!0}))},[$e,N,l,s,tt,ge]);d.useEffect(()=>{const a=()=>{document.visibilityState==="visible"&&(Bl(),!$e&&!Ar&&!ge&&N&&Ra.current())};return window.addEventListener("online",Bl),document.addEventListener("visibilitychange",a),()=>{window.removeEventListener("online",Bl),document.removeEventListener("visibilitychange",a)}},[Bl,$e,Ar,ge,N]),d.useEffect(()=>{if(ge){ms(!0);return}if(!pf||!N||!l)return;(async()=>{if(!$e){Ve(!1),Ot(null),ms(!1);return}Ve(!0),Ot("Reconnected  refreshing data"),await tt({silent:!0}),ms(!1),Ot(null)})()},[ge,pf,N,l,$e,tt]),d.useEffect(()=>{if(!N||!$e&&!Qn||jn.current)return;const a=window.setTimeout(()=>{tt({silent:!0})},500);return()=>window.clearTimeout(a)},[$e,Qn,N,tt,He,Kt,M,Y]),d.useEffect(()=>{if(!Qn||s||ge||!N)return;const a=window.setInterval(()=>{jn.current||Pr.current||tt({silent:!0})},2500);return()=>window.clearInterval(a)},[Qn,s,ge,N,tt]),d.useEffect(()=>{N&&Nt(N.id,N.revisionId||null)},[N,Nt]),d.useEffect(()=>{Ut.current=(N==null?void 0:N.id)||null,Ta.current=0},[N]);const Wl=d.useCallback(async()=>{if(s)return;const a=Ut.current;if(!a)return;const p=C1({isOffline:ge,isLocked:Pr.current||Ar,inFlight:jn.current,dirty:$e,now:Date.now(),lastLocalEditAt:Lr.current,lastPullAt:_n.current,graceMs:mf});if(_o("[Sync][Mobile] pull decision",p),p.action==="skip")return;const h=await Te(!1,"pull");if(h&&Ut.current===a)try{const x=await wu(h.accessToken);if(Ut.current!==a)return;const w=x.find(_=>_.id===a),C=Pl(a),A=!(w!=null&&w.revisionId)||w.revisionId!==C,D=Date.now()-Ta.current>=hf;if(A||D){Ta.current=Date.now();const _=await vs(h.accessToken,a);if(Ut.current!==a)return;const W=typeof _=="string"?JSON.parse(_):_,K=Rn(W);if(!K)return;const ee=Ua(K);if(_l.current&&ee===_l.current){w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now(),po(K.lastWriter||"unknown");return}const ie=Zn(K,w);ie==="applied"&&Ut.current===a?(as(new Date().toISOString()),w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now(),po(K.lastWriter||"unknown"),Fa(P=>P+1),gn("Updated from Drive.")):ie==="skipped"&&(w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now())}else _n.current=Date.now()}catch{}},[Zn,Te,Rn,gn,$e,Ar,ge,s,Pl,Nt,hf]);d.useEffect(()=>{Ra.current=Wl},[Wl]),d.useEffect(()=>{if(s)return;const a=()=>{Ra.current()},p=window.setTimeout(a,2e3),h=window.setInterval(a,1e4);return()=>{window.clearTimeout(p),window.clearInterval(h)}},[s]),d.useEffect(()=>{if(Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null),!s&&!($e||Ar||ge||!N))return Mt.current=window.setTimeout(()=>{Wl()},5e3),()=>{Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null)}},[$e,Ar,ge,N,s,Wl]);const Tf=xe&&et&&(R!=null&&R.periods)&&R.periods.find(a=>String(a.id)===String(et))||null,Gt=d.useMemo(()=>!xe||!R?null:R.students.find(a=>String(a.id)===String(xe.id))||null,[xe,R]),{audioUrl:go}=Ud({studentId:(Gt==null?void 0:Gt.id)??"menu",audioFileId:(Gt==null?void 0:Gt.audioFileId)??null,audioUpdatedAt:(Gt==null?void 0:Gt.audioUpdatedAt)??null,driveSession:l}),Ga=!!(Gt!=null&&Gt.audioFileId),Af=Tf&&xe?Math.max(0,Number(((If=Tf.customCounterByStudent)==null?void 0:If[String(xe.id)])||0)):null;d.useEffect(()=>{xe||(cs(!1),us.current&&us.current.pause())},[xe]),d.useEffect(()=>{cs(!1),us.current&&us.current.pause()},[go]);const ly=async()=>{if(!go)return;const a=us.current;if(a){if(tf){a.pause(),cs(!1);return}try{await a.play(),cs(!0)}catch{e({message:"Could not play audio. Please try again.",tone:"error"})}}},iy=Rt==="attendance"&&!!R&&!!it,ay=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,uy=t||ay,cy=(((Df=R==null?void 0:R.periods)==null?void 0:Df.length)??0)>0,dy=uy&&m&&!cy&&!Ia&&!ge,Pf=!(!s&&!l),fy=ne?`Open "${ne.name}"`:"Open File",py=d.useCallback(()=>{try{window.localStorage.setItem(km,"1")}catch{}F0(!0)},[]);return i.jsx(H1,{children:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"min-h-[100dvh] h-[100dvh] bg-gradient-to-b from-violet-900 to-indigo-800 text-white flex flex-col relative",children:[i.jsxs("div",{className:"bg-emerald-50 text-emerald-900 text-xs px-4 py-1 text-center",children:[i.jsx("span",{role:"img","aria-label":"lock",className:"mr-1",children:""}),"Privacy: Data stays on this device and in your Google Drive. Use your school Google account. No data is sent to our servers."]}),ge&&i.jsx("div",{className:"bg-slate-900 text-white text-xs px-4 py-1 text-center",children:"Offline  edits are saved locally and will sync when youre back online."}),i.jsxs("div",{className:"px-4 pt-2 flex items-center justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow",onClick:$0,title:"Version",type:"button",children:["Rev ",Sm]}),i.jsx("button",{className:"text-[11px] px-2 py-1 rounded border border-white/60 bg-white/20 text-white shadow hover:bg-white/30",onClick:()=>wt(!0),type:"button",children:"About"}),i.jsx("a",{href:"https://help.classseats.app/",target:"_blank",rel:"noopener noreferrer",className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow hover:bg-white",title:"Open ClassSeats Help Center",children:" Help"})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[i.jsx("span",{className:"text-[16px] font-bold tracking-wide text-white/90 whitespace-nowrap",children:"ClassSeats Mobile"}),!t&&i.jsx(x1,{current:"mobile",onGoDesktop:B0,onGoMobile:()=>{}})]})]}),iy&&i.jsx("div",{className:"mt-[76px]"}),wm,Rt==="attendance"&&R&&it&&(()=>{const a=R.periods.find(ee=>ee.id===it);if(!a)return null;const p=R.students.filter(ee=>{var ie;return(ie=ee.periodIds)==null?void 0:ie.includes(String(a.id))}),h=He[a.id]||{},x=p.length||1,w=p.filter(ee=>h[ee.id]==="present").length,C=p.filter(ee=>h[ee.id]==="absent").length,A=p.filter(ee=>h[ee.id]==="tardy").length,D=p.filter(ee=>h[ee.id]==="left_early").length,_=w+C+A+D,W=Math.round(_/x*100),K=Math.round(w/x*100);return i.jsx("div",{className:"fixed left-0 right-0 z-40 px-4 pt-2",style:{top:"76px"},children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow px-3 py-2 flex flex-wrap items-center gap-2 text-xs text-slate-800",children:[i.jsxs("span",{className:"font-semibold",children:["Progress: ",W,"%  Present: ",K,"%"]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 font-semibold",children:[" Present: ",w]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-rose-100 text-rose-800 font-semibold",children:[" Absent: ",C]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-amber-100 text-amber-800 font-semibold",children:[" Tardy: ",A]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-800 font-semibold",children:[" Left Early: ",D]})]})})})(),i.jsxs("main",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-28 pt-20 space-y-6 relative",children:[i.jsx(d1,{variant:"inline"}),s&&i.jsx("p",{className:"max-w-2xl mx-auto text-sm text-rose-100 text-left",children:"Drive sync is disabled."}),F&&i.jsxs("section",{className:"max-w-2xl mx-auto bg-slate-900 text-slate-100 rounded-2xl shadow-inner p-3 space-y-2 text-xs",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"font-semibold",children:"Drive Debug"}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>$(!1),children:"Close"})]}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>ue([]),children:"Clear"})]}),i.jsxs("div",{className:"border border-slate-700 rounded p-2 h-48 overflow-y-auto space-y-1 bg-slate-800/70",children:[z.length===0&&i.jsx("div",{className:"text-slate-400",children:"No debug entries yet."}),z.map((a,p)=>i.jsx("div",{className:"font-mono text-[11px] whitespace-pre-wrap break-all",children:a},p))]})]}),i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsx("div",{className:"mt-3",children:i.jsx("div",{className:"inline-flex w-full rounded-xl border border-slate-200 bg-slate-50 p-1",children:i.jsxs("div",{className:"grid w-full grid-cols-3 gap-1",children:[i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Rt==="attendance"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Pa("attendance"),children:"Attendance"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Rt==="notes"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Pa("notes"),children:"Notes"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${Rt==="flashcards"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Pa("flashcards"),children:"Flashcards"})]})})})}),i.jsxs("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-6 space-y-6",children:[R&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsx("div",{children:i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:Rt==="attendance"?"Attendance & Behavior":Rt==="notes"?"Student Notes":"Flashcards"})}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[Rt==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Date:"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(le);a.setDate(a.getDate()-1),ao(a.toISOString().slice(0,10))},children:""}),i.jsx("input",{type:"date",className:"rounded border border-slate-300 px-2 py-1 text-sm",value:le,onChange:a=>ao(a.target.value||Aa())}),i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(le);a.setDate(a.getDate()+1),ao(a.toISOString().slice(0,10))},children:""}),i.jsx("button",{className:"px-2 py-1 rounded border border-emerald-200 bg-emerald-50 text-emerald-700 text-sm font-semibold",onClick:()=>ao(Aa()),children:"Today"})]})]}),Rt==="notes"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Sort:"}),i.jsxs("select",{className:"rounded border border-slate-300 bg-white text-slate-900 px-3 py-2 text-sm shadow-sm",value:Cl,onChange:a=>L0(a.target.value),children:[i.jsx("option",{value:"first-last",children:"First Last"}),i.jsx("option",{value:"last-first",children:"Last, First"})]})]}),Rt==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"View:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:Ir,onChange:a=>D0(a.target.value),children:[i.jsx("option",{value:"table",children:"Table View"}),i.jsx("option",{value:"list-last-first",children:"List (Last, First)"}),i.jsx("option",{value:"list-first-last",children:"List (First Last)"}),i.jsx("option",{value:"list-seat-number",children:"List (Seat Number)"})]}),Ir==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Table Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:uo,onChange:a=>O0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3 / A, B, C)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1 / C, B, A)"})]})]}),Ir==="list-seat-number"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Seat Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:El,onChange:a=>M0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1)"})]})]})]}),R.periods.length>0&&i.jsx("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:it||"",onChange:a=>is(a.target.value||null),children:R.periods.map(a=>i.jsx("option",{value:a.id,children:a.name},a.id))})]})]}),it?(()=>{const a=R.periods.find(P=>P.id===it);if(!a)return i.jsx("p",{className:"text-sm text-slate-500",children:"Period not found."});if(Rt==="notes"){const P=R.students.filter(L=>{var oe;return(oe=L.periodIds)==null?void 0:oe.includes(String(it))}).slice().sort((L,oe)=>{const[se,...ke]=L.fullName.split(" "),[Ke,...Ur]=oe.fullName.split(" ");return Cl==="last-first"?ke.join(" ").localeCompare(Ur.join(" ")):se.localeCompare(Ke)});return i.jsx("div",{className:"space-y-3",children:P.length===0?i.jsx("p",{className:"text-sm text-slate-500",children:"No students found."}):P.map(L=>{var se;const oe=(se=L.docs)==null?void 0:se.find(ke=>ke.pinned);return i.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm",children:i.jsx("div",{className:"flex flex-col gap-3",children:i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800 truncate",children:[L.fullName,"  QuickNote"]}),L.quickNote&&i.jsxs("div",{className:"relative mt-1",children:[i.jsx("div",{className:"text-xs text-slate-600 whitespace-pre-wrap break-words max-h-28 overflow-hidden pr-2",children:L.quickNote}),L.quickNote.length>180&&i.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t from-white to-transparent"}),i.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Open Quick Note to view/edit more."})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{ro(L.quickNote||""),lt({studentId:L.id,studentName:L.fullName})},children:"Quick Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:!oe,onClick:ke=>{ke.preventDefault(),ke.stopPropagation(),oe&&Wa(Ba(oe.driveFileId))},children:"Pinned Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>Kn({studentId:L.id,studentName:L.fullName}),children:"Docs"})]})]})})},L.id)})})}if(Rt==="flashcards"){const P=R.students.filter(L=>{var oe;return(oe=L.periodIds)==null?void 0:oe.includes(String(it))});return i.jsx(J1,{students:P,periodId:String(it),driveFileId:Ut.current,driveClient:r,driveSession:l,onAudioSaved:(L,oe,se)=>{Z(ke=>ke&&{...ke,students:ke.students.map(Ke=>String(Ke.id)===String(L)?{...Ke,audioFileId:oe,audioUpdatedAt:se}:Ke)}),Pe(),tt({silent:!0})},onAudioDeleted:L=>{Z(oe=>oe&&{...oe,students:oe.students.map(se=>String(se.id)===String(L)?{...se,audioFileId:null,audioUpdatedAt:null}:se)}),Pe(),tt({silent:!0})}})}const p=a.layoutId?R.layouts[a.layoutId]:null,h=R.students.filter(P=>{var L;return(L=P.periodIds)==null?void 0:L.includes(String(a.id))}),x=h.reduce((P,L)=>(P[String(L.id)]=L,P),{}),w={};p==null||p.tables.forEach(P=>w[P.id]={id:P.id,name:P.name,students:[]});const C=[],A=a.tableAssignments||{};Array.isArray(a.activeGrouping)&&Object.keys(A||{}).length>0?(a.activeGrouping.forEach((P,L)=>{const oe=A[String(L)]||A[L],se=oe?w[oe]:null;P==null||P.forEach(ke=>{const Ke=x[String(ke)];Ke&&(se?se.students.push(Ke):C.push(Ke))})}),h.forEach(P=>{(a.activeGrouping||[]).some(oe=>oe==null?void 0:oe.some(se=>String(se)===String(P.id)))||C.push(P)})):h.forEach(P=>{const L=A[String(P.id)]||A[P.id];L&&w[L]?w[L].students.push(P):C.push(P)});const D=Object.values(w).sort((P,L)=>{const oe=P.name||"",se=L.name||"",ke=U0.compare(oe,se);if(ke!==0)return uo==="asc"?ke:-ke;const Ke=String(P.id).localeCompare(String(L.id));return uo==="asc"?Ke:-Ke}),_=He[a.id]||{},W={...a.attendance||{},[le]:_},K=a.attendanceResets||{};Kt[a.id];const ee=M[a.id]||{};_0[a.id];const ie=(P,L,oe)=>{var be,nt;const se=_[P.id],ke=ju({attendance:W,studentId:P.id,date:le,status:"absent",resets:K}),Ke=a1({attendance:W,studentId:P.id,date:le,resets:K}),Ur=ju({attendance:W,studentId:P.id,date:le,status:"tardy",resets:K}),An=ju({attendance:W,studentId:P.id,date:le,status:"left_early",resets:K}),yo=Math.max(0,Number(((be=a.customCounterByStudent)==null?void 0:be[String(P.id)])||0)),je=typeof ee[P.id]=="number"?ee[P.id]:a.startingPoints??50,te=!!((nt=Kt[a.id])!=null&&nt[P.id]),ve=Na[String(P.id)]||null;return i.jsx(ub,{student:P,attendance:se,points:je,pointsEnabled:!!a.pointsEnabled,maxPoints:a.startingPoints??50,hasNote:te,absenceTotal:ke,absenceStreak:Ke,tardyCount:Ur,leftEarlyCount:An,customCounter:yo,onShowAbsenceHelp:()=>Tr("absent"),onShowTardyHelp:()=>Tr("tardy"),onShowLeftEarlyHelp:()=>Tr("leftEarly"),onShowCustomHelp:()=>Tr("custom"),seatNumber:L,showSeatNumber:oe,statusBg:K0,statusLabel:Nf,tempPhotoUrl:ve,onOpenPhoto:()=>{Wd({id:String(P.id),fullName:P.fullName,photoFileId:P.photoFileId??null})},onOpenMenu:()=>{bt({id:P.id,name:P.fullName}),Jd(a.id)},driveClient:r,driveSession:l},P.id)};if(Ir!=="table"){const P=new Map;h.forEach(se=>{P.set(String(se.id),cb(a,p,se.id))});const L=Ir==="list-seat-number",oe=[...h].sort((se,ke)=>{const[Ke,...Ur]=se.fullName.split(" "),[An,...yo]=ke.fullName.split(" "),je=Ur.join(" "),te=yo.join(" ");if(Ir==="list-seat-number"){const ve=P.get(String(se.id)),be=P.get(String(ke.id)),nt=parseInt(String(ve??""),10),kt=parseInt(String(be??""),10),ut=Number.isFinite(nt),yn=Number.isFinite(kt);return ut!==yn?ut?-1:1:ut&&yn&&nt!==kt?El==="asc"?nt-kt:kt-nt:`${se.fullName||""}`.localeCompare(`${ke.fullName||""}`)}return Ir==="list-last-first"?`${je} ${Ke}`.localeCompare(`${te} ${An}`):`${Ke} ${je}`.localeCompare(`${An} ${te}`)});return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>$l(a.id,h.map(se=>se.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>Ef(a.id),children:"Reset Today"})]}),i.jsx("div",{className:"space-y-2",children:oe.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students found."}):oe.map(se=>ie(se,L?P.get(String(se.id)):null,L))})]})}return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>$l(a.id,h.map(P=>P.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>Ef(a.id),children:"Reset Today"})]}),D.map(P=>{const L=P.students.filter(se=>_[se.id]!=="absent").map(se=>se.id),oe=P.name.replace("Table","").trim()||P.name;return i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200 gap-3",children:[i.jsxs("div",{className:"flex flex-col leading-tight text-center min-w-[54px]",children:[i.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Table"}),i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:oe})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>$l(a.id,P.students.map(se=>se.id)),children:"Mark Rest Present"}),a.pointsEnabled&&i.jsx("button",{className:"text-[11px] rounded bg-amber-600 text-white px-3 py-2 font-semibold",onClick:()=>{Nl(null),bl(0),ka(""),so({periodId:a.id,tableName:P.name,studentIds:L})},children:"Table Points"})]})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:P.students.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students assigned."}):P.students.map(se=>ie(se))})]},P.id)}),i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Unassigned"}),i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>$l(a.id,C.map(P=>P.id)),children:"Mark Rest Present"})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:C.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No unassigned students."}):C.map(P=>ie(P))})]})]})})():i.jsx("p",{className:"text-sm text-slate-500",children:"Load and select a period to begin."})]}),ls&&i.jsx(rb,{open:!0,studentId:ls.id,studentFullName:ls.fullName,existingPhotoFileId:ls.photoFileId,onClose:()=>Wd(null),onAccept:a=>{const p=ls.id;if(!p)return;const h=URL.createObjectURL(a);E0(x=>{const w=x[p];return w&&URL.revokeObjectURL(w),{...x,[p]:h}})},onUploadComplete:({fileId:a,photoUpdatedAt:p})=>{const h=ls.id;Z(x=>x&&{...x,students:x.students.map(w=>w.id===h?{...w,photoFileId:a,photoUpdatedAt:p}:w)}),Pe(),tt({silent:!0})}}),Rr&&i.jsx(b0,{open:!0,studentId:Rr.id,studentFullName:Rr.fullName,existingAudioFileId:Rr.audioFileId,existingAudioUpdatedAt:Rr.audioUpdatedAt,driveSession:l,onClose:()=>Hd(null),onUploadComplete:({fileId:a,audioUpdatedAt:p})=>{const h=Rr.id;Z(x=>x&&{...x,students:x.students.map(w=>w.id===h?{...w,audioFileId:a,audioUpdatedAt:p}:w)}),Pe(),tt({silent:!0})},onDeleteComplete:()=>{const a=Rr.id;Z(p=>p&&{...p,students:p.students.map(h=>h.id===a?{...h,audioFileId:null,audioUpdatedAt:null}:h)}),Pe(),tt({silent:!0})}}),qd&&Yn&&i.jsx(Rd,{isOpen:!0,onRequestClose:Ll,title:"Edit Student",maxWidth:"md",showCloseX:!0,footer:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:Ll,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:()=>{const a=Yn.name.trim();if(!a||!Yn.periodId){alert("Name and period are required.");return}const p=qd.id;Z(h=>h&&{...h,students:h.students.map(x=>String(x.id)===String(p)?{...x,fullName:a,gender:Yn.gender,periodIds:[String(Yn.periodId)],profileUpdatedAt:new Date().toISOString()}:x)}),Pe(),tt({silent:!0}),Ll()},children:"Save"})]}),children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Full Name"}),i.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:Yn.name,onChange:a=>oo(p=>p&&{...p,name:a.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Gender"}),i.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Yn.gender,onChange:a=>oo(p=>p&&{...p,gender:a.target.value}),children:[i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"O",children:"Other/Prefer not"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Class Period"}),i.jsx("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Yn.periodId,onChange:a=>oo(p=>p&&{...p,periodId:a.target.value}),children:((R==null?void 0:R.periods)||[]).map(a=>i.jsx("option",{value:String(a.id),children:a.name},String(a.id)))})]})]})}),xe&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center px-4",onClick:()=>bt(null),children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-4 w-full max-w-sm space-y-3",onClick:a=>a.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:xe.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Actions"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{type:"button",className:"rounded-md p-1 text-slate-600 hover:text-slate-800",onClick:()=>{bt(null),W0(xe.id)},"aria-label":"Edit student",children:""}),i.jsx("button",{type:"button",className:"rounded-md p-1 text-rose-600 hover:text-rose-700",onClick:()=>H0(xe.id),"aria-label":"Delete student",children:""}),i.jsx("button",{className:"rounded-md p-1 text-slate-500 hover:text-slate-700",onClick:()=>bt(null),children:""})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:V0.map(a=>i.jsx("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{et&&Va(et,xe.id,a),bt(null)},children:Nf(a)},a))}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{className:"w-full rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{et&&ty(et,xe.id,xe.name),bt(null)},children:" Notes and Points"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:`rounded-lg border px-2 py-2 text-xs text-left ${Ga&&go?"border-slate-200 text-slate-700 hover:bg-slate-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:()=>{ly()},disabled:!Ga||!go,children:tf?" Pause audio":" Play audio"}),i.jsxs("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{const a=R==null?void 0:R.students.find(p=>String(p.id)===String(xe.id));Hd({id:xe.id,fullName:xe.name,audioFileId:(a==null?void 0:a.audioFileId)??null,audioUpdatedAt:(a==null?void 0:a.audioUpdatedAt)??null}),bt(null)},children:[" ",Ga?"Re-record audio":"Record audio"]})]})]}),i.jsx("audio",{ref:us,src:go||void 0,onEnded:()=>cs(!1),onPause:()=>cs(!1)}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{et&&xe&&Cf(et,xe.id,1),bt(null)},children:[""," +1 counter ",typeof Af=="number"?`(${Af})`:""]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{et&&xe&&Cf(et,xe.id,-1),bt(null)},children:[""," -1 counter"]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{et&&xe&&X0(et,xe.id),bt(null)},children:[""," Reset counter"]}),i.jsx("button",{className:"w-full rounded-lg border border-rose-200 px-2 py-2 text-xs text-left hover:bg-rose-50 text-rose-700",onClick:()=>{et&&xe&&Ha(et,xe.id,"absent"),bt(null)},children:" Reset absence streak"}),i.jsx("button",{className:"w-full rounded-lg border border-amber-200 px-2 py-2 text-xs text-left hover:bg-amber-50 text-amber-700",onClick:()=>{et&&xe&&Ha(et,xe.id,"tardy"),bt(null)},children:" Reset tardy counter"}),i.jsx("button",{className:"w-full rounded-lg border border-orange-200 px-2 py-2 text-xs text-left hover:bg-orange-50 text-orange-700",onClick:()=>{et&&xe&&Ha(et,xe.id,"leftEarly"),bt(null)},children:" Reset left early counter"})]}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>bt(null),children:"Close"})]})}),kl&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Tr(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"About this badge"}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Tr(null),children:""})]}),kl==="absent"?i.jsx("p",{className:"text-sm text-slate-700",children:"A# is total absences since reset. S# is the latest absence streak ending on the most recent marked day (unmarked days are skipped)."}):kl==="leftEarly"?i.jsx("p",{className:"text-sm text-slate-700",children:"LE# shows the left early count since the last reset."}):kl==="custom"?i.jsxs("p",{className:"text-sm text-slate-700",children:["","# is your custom teacher counter since the last reset."]}):i.jsx("p",{className:"text-sm text-slate-700",children:"T# shows the tardy count since the last reset."}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>Tr(null),children:"Got it"})]})]}),ce&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>de(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:["Behavior for ",ce.studentName]}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Today  Points ",he.pointsEnabled?`${$a(he.currentPoints,he.startingPoints)} ${he.currentPoints}`:"disabled"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>de(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:ye.note,onChange:a=>Se(p=>({...p,note:a.target.value})),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:4,placeholder:"Enter behavior note...",autoFocus:!0,onMouseDown:a=>a.stopPropagation(),onClick:a=>a.stopPropagation()}),i.jsx("div",{className:"flex flex-wrap gap-2",children:[" Excellent participation"," Needs redirection"," Academic progress"," Positive peer interactions"].map(a=>i.jsx("button",{onClick:()=>Se(p=>({...p,note:p.note?p.note+" "+a:a})),className:"text-[11px] px-2.5 py-1 rounded-lg bg-slate-100 hover:bg-slate-200 border border-slate-200 text-slate-700",children:a},a))})]}),he.pointsEnabled&&i.jsxs("div",{className:"space-y-3 border border-slate-200 rounded-xl p-3 bg-slate-50",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Points"}),i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsxs("span",{children:[$a(he.currentPoints,he.startingPoints)," ",he.currentPoints]}),i.jsx("span",{className:"text-slate-400",children:""}),i.jsxs("span",{children:[$a(Math.max(0,he.currentPoints+ye.delta),he.startingPoints)," ",Math.max(0,he.currentPoints+ye.delta)]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,0,-1,-2].map(a=>i.jsx("button",{onClick:()=>Se(p=>({...p,delta:a,reason:p.reason})),className:`px-3 py-1.5 rounded border text-sm font-semibold ${ye.delta===a?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-700 border-slate-300 hover:bg-indigo-50"}`,children:a>0?`+${a}`:a},a)),i.jsx("button",{onClick:()=>{const a=prompt("Enter custom point change:",String(ye.delta));if(a===null)return;const p=parseInt(a,10);Number.isNaN(p)||Se(h=>({...h,delta:p,reason:h.reason}))},className:"px-3 py-1.5 rounded border text-sm font-semibold bg-white text-slate-700 border-slate-300 hover:bg-indigo-50",children:"Custom"})]}),ye.delta!==0&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Reason (required)"}),i.jsx("input",{value:ye.reason,onChange:a=>Se(p=>({...p,reason:a.target.value})),className:"w-full border border-slate-300 rounded px-2 py-1 text-sm",placeholder:"Enter reason for point change"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:ey,children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>de(null),children:"Cancel"})]})]})]}),Hn&&R&&(()=>{const a=R.students.find(p=>p.id===Hn.studentId);return a?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>lt(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Quick Note"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>lt(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:Vn,onChange:p=>ro(p.target.value),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:5,placeholder:"Add a quick note...",autoFocus:!0,onMouseDown:p=>p.stopPropagation(),onClick:p=>p.stopPropagation()})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:()=>{const p=Hn.studentId,h=Vn;Z(x=>x&&{...x,students:x.students.map(w=>w.id===p?{...w,quickNote:h,quickNoteUpdatedAt:new Date().toISOString()}:w)}),qn.current+=1,Cn(!0),Ve(!0),Lr.current=Date.now(),tt({silent:!0}),lt(null)},children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>lt(null),children:"Cancel"})]})]})]}):null})(),pn&&R&&(()=>{const a=R.students.find(w=>w.id===pn.studentId);if(!a)return null;const p=R.periods.find(w=>w.id===it),x=(a.docs||[]).slice().sort((w,C)=>{if(w.pinned&&!C.pinned)return-1;if(!w.pinned&&C.pinned)return 1;const A=w.createdAt?new Date(w.createdAt).getTime():0;return(C.createdAt?new Date(C.createdAt).getTime():0)-A});return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Kn(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Student Docs"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Kn(null),children:""})]}),i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-xs text-slate-500",children:"Tap a doc to open it in Google Docs."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"To protect privacy, ClassSeats can only see the documents it helps create."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"All documents are created in the ClassSeats/Student Docs folder in your Google Drive."})]}),i.jsx("button",{className:"rounded-lg bg-emerald-600 text-white text-xs font-semibold px-3 py-2 disabled:opacity-50",disabled:!n.canUseDriveSync,onClick:async()=>{if(n.canUseDriveSync)try{const w=await Te(!0,"studentDocCreate");if(!w)return;const C=(p==null?void 0:p.name)||"Period",A=`Notes - ${a.fullName} - ${C} ${Y0(new Date)}`,D=window.prompt("Name this Doc:",A);if(!D||!D.trim())return;const _=D.trim(),W=await zw(w.accessToken),K=await Ww(w.accessToken,W,_),ee=new Date().toISOString(),ie={id:G0(),driveFileId:K.fileId,title:K.title||_,createdAt:ee,lastOpenedAt:ee};Z(P=>P&&{...P,students:P.students.map(L=>L.id===a.id?{...L,docs:[...L.docs||[],ie]}:L)}),qn.current+=1,Cn(!0),Ve(!0),Lr.current=Date.now(),Wa(Ba(K.fileId))}catch(w){at((w==null?void 0:w.message)||"Unable to create Google Doc.")}},children:"+ New Doc"})]}),i.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2",children:x.length===0?i.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3 text-sm text-slate-600",children:"No Docs yet."}):x.map(w=>i.jsx("button",{className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",onClick:C=>{C.preventDefault(),C.stopPropagation(),Wa(Ba(w.driveFileId))},children:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{className:"font-semibold text-slate-900",children:w.title}),w.pinned&&i.jsx("span",{className:"text-[10px] font-semibold text-emerald-700 bg-emerald-100 px-2 py-0.5 rounded-full",children:"PINNED"})]})},w.id))}),i.jsx("button",{className:"w-full rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>Kn(null),children:"Close"})]})]})})(),!R&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"No class file loaded yet."}),i.jsx("p",{className:"text-sm text-slate-600",children:"To take attendance or track points, open a class file from your Google Drive."}),i.jsx("button",{className:"w-full rounded-lg bg-emerald-600 text-white font-semibold py-2",onClick:()=>{if(s){k(o);return}return l?re(!0):void Te(!0,"empty-state")},disabled:s,title:s?o:void 0,children:"Manage Files"})]}),Gn&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>so(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:Gn.tableName}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Apply points to ",Gn.studentIds.length," present student",Gn.studentIds.length===1?"":"s"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>so(null),children:""})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note (required)"}),i.jsx("textarea",{className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Describe why youre adjusting points",value:Yd,onChange:a=>ka(a.target.value),rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Choose points"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,-1,-2].map(a=>{const p=Gd===a;return i.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm font-semibold border ${p?"bg-amber-600 text-white border-amber-600":"bg-white text-amber-800 border-amber-300"}`,onClick:()=>{Nl(a),bl(0)},children:[a>0?`+${a}`:a," pts"]},a)}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"number",className:"w-24 rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Custom",value:Kd,onFocus:()=>Nl(null),onChange:a=>bl(Number(a.target.value)||0)})})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-amber-600 text-white font-semibold py-2",onClick:()=>{const a=Yd.trim(),p=Gd??Kd;if(!a){at("Enter a note for the point change.");return}if(!p){at("Select a point value.");return}Z0(Gn.periodId,Gn.studentIds,p,a),Nl(null),bl(0),ka(""),so(null)},children:"Apply"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>so(null),children:"Cancel"})]}),i.jsx("p",{className:"text-[11px] text-slate-500",children:"Only present students at this table receive the adjustment. Absent students are skipped."}),(()=>{const a=(Y[Gn.periodId]||[]).filter(h=>{var x;return((x=h.date)==null?void 0:x.startsWith(le))&&Gn.studentIds.includes(String(h.studentId))});if(a.length===0)return null;const p=h=>{var x;return((x=R==null?void 0:R.students.find(w=>String(w.id)===String(h)))==null?void 0:x.fullName)||`Student ${h}`};return i.jsxs("div",{className:"border-t border-slate-200 pt-2 space-y-1",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Todays table adjustments"}),i.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:a.map((h,x)=>i.jsxs("div",{className:"text-xs text-slate-700 flex justify-between",children:[i.jsx("span",{className:"font-semibold",children:p(h.studentId)}),i.jsxs("span",{children:[h.delta>0?"+":"",h.delta,"  ",h.reason||"No note"]})]},`${h.studentId}-${x}`))})]})})()]})]})]}),q&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Pf?()=>{re(!1),Ne(!1)}:void 0}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Select Your ClassSeats File"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Choose the file you use on desktop to continue."})]}),i.jsxs("div",{ref:ef,className:"relative flex items-center gap-3",children:[l&&i.jsx("button",{type:"button",className:"text-slate-600 hover:text-slate-800 text-sm font-semibold px-2 py-1 rounded-lg border border-slate-200","aria-label":"More actions",onClick:()=>Ne(a=>!a),children:"More"}),Pf&&i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>{re(!1),Ne(!1)},children:""}),V&&l&&i.jsxs("div",{className:"absolute right-0 top-8 min-w-[220px] rounded-xl border border-slate-200 bg-white shadow-lg p-1 z-10 text-sm",children:[i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-slate-800",onClick:()=>{Ne(!1),ny()},children:"Sign out of Google Drive"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 disabled:text-slate-400 disabled:hover:bg-transparent text-rose-700",disabled:!N,onClick:()=>{Ne(!1),sy()},children:"Delete active class file"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-rose-700",onClick:ry,children:"Clear local ClassSeats data (this device)"})]})]})]}),s?i.jsx("div",{className:"space-y-2 text-sm text-rose-700",children:i.jsx("p",{children:o})}):l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-600",children:i.jsxs("div",{children:[i.jsxs("p",{children:["Signed in as: ",i.jsx("span",{className:"font-semibold text-slate-900",children:((Lf=l.profile)==null?void 0:Lf.email)||"your account"})]}),i.jsxs("p",{children:["Current file: ",i.jsx("span",{className:"font-semibold text-slate-900",children:(N==null?void 0:N.name)||(ne==null?void 0:ne.name)||"None selected"})]})]})}),wm,i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Your files"}),i.jsx("button",{type:"button","aria-label":"Refresh file list",className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>void Ka(!0),children:""})]}),i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-3 max-h-64 overflow-auto space-y-2",children:[g&&i.jsx("p",{className:"text-sm text-slate-500",children:"Loading Drive files"}),b&&i.jsx("p",{className:"text-sm text-rose-600",children:b}),!g&&!b&&c.length===0&&i.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[i.jsx("p",{className:"font-semibold",children:"No ClassSeats files found yet."}),i.jsx("p",{className:"text-slate-500",children:"Create your class file on desktop first, then tap refresh."})]}),!g&&!b&&c.length>0&&c.map(a=>{const p=(ne==null?void 0:ne.id)===a.id,h=(N==null?void 0:N.id)===a.id;return i.jsxs("button",{className:`w-full text-left rounded-xl border px-3 py-2 transition ${p?"border-indigo-400 bg-indigo-50 text-indigo-900":h?"border-emerald-400 bg-emerald-50 text-emerald-900":"border-slate-200 bg-white hover:bg-slate-100"}`,onClick:()=>Oe(a),children:[i.jsx("p",{className:"text-sm font-semibold",children:a.name}),i.jsxs("p",{className:"text-[11px] text-slate-500",children:["Updated ",a.modifiedTime?new Date(a.modifiedTime).toLocaleString():"",a.size?`  ${(Number(a.size)/1024).toFixed(1)} KB`:""]}),h&&i.jsx("p",{className:"text-[11px] text-emerald-700 font-semibold",children:"Active"})]},a.id)})]}),i.jsx("button",{className:"w-full rounded-2xl bg-emerald-600 text-white font-semibold py-2 disabled:opacity-50",onClick:oy,disabled:!ne||qe,children:qe?"Loading":fy})]})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm text-slate-700",children:"Hi! you need a Class File already set up in your Google Drive to access mobile. Let's get you connected."}),i.jsx("button",{className:"w-full rounded-2xl bg-indigo-600 text-white font-semibold py-2",onClick:()=>{Te(!0)},children:"Connect to Google Drive"})]})]})]})]})]}),i.jsx("div",{className:"fixed inset-x-0 bottom-0 px-4 pb-[env(safe-area-inset-bottom)]",children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow-lg px-4 py-3 flex flex-wrap items-center gap-2 text-xs text-slate-700",children:[i.jsxs("div",{className:"flex-1 min-w-[180px]",children:[i.jsx("p",{className:"font-semibold text-slate-900",children:Ar?"Saving":jl?`Synced ${new Date(jl).toLocaleTimeString()}`:"Ready"}),i.jsxs("p",{className:"text-[11px] text-slate-500 truncate",children:[l?((Of=l.profile)==null?void 0:Of.email)||"Signed in":"Not signed in"," "," ",(N==null?void 0:N.name)||(ne==null?void 0:ne.name)||"No file selected",ge&&"  Offline"]}),Qn&&i.jsx("p",{className:"text-[11px] text-amber-700",children:"Pending sync"})]}),i.jsxs("div",{className:"flex w-full items-center gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded-full bg-violet-600 text-white px-3 py-2 text-xs font-semibold disabled:opacity-50 flex-none hover:bg-violet-700",disabled:!l||!N,onClick:()=>void tt(),children:"Sync Now"}),i.jsx("button",{className:"rounded-full border border-slate-900 bg-white text-slate-900 px-3 py-2 text-xs font-semibold flex-none hover:bg-slate-100",onClick:()=>l?re(!0):void Te(!0,"cta"),children:"Open Files"})]}),i.jsxs("button",{type:"button",onClick:Q0,className:"relative ml-auto inline-flex h-9 w-9 items-center justify-center rounded-full bg-slate-100 text-slate-700 hover:bg-slate-200 flex-none",title:"Messages","aria-label":"Messages",children:[i.jsx("span",{"aria-hidden":!0,className:"text-2xl leading-none",children:""}),Me>0&&i.jsx("span",{className:"absolute -top-1 -right-1 inline-flex min-w-[16px] items-center justify-center rounded-full bg-violet-600 text-white px-1 py-0.5 text-[10px] font-semibold",children:Me})]})]})]})}),i.jsx(y1,{isOpen:pt,onRequestClose:J0,unreadMessages:fn,allMessages:Wn,dismissedIds:St,onDismiss:q0}),i.jsx(m1,{open:ze,onClose:()=>wt(!1),buildRevision:Sm}),i.jsx($1,{open:dy,onBypass:py})]}),ge&&i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-4 text-center space-y-2 text-slate-900",children:[i.jsx("p",{className:"text-base font-semibold",children:"Mobile paused while offline"}),i.jsx("p",{className:"text-sm text-slate-600",children:"Edits are disabled while offline. Reconnect to resume."}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Last sync: ",jl?new Date(jl).toLocaleTimeString():"No sync yet"]})]})})]})})}function fb({toasts:e}){return i.jsx("div",{className:"fixed right-4 top-4 z-[1000] flex w-[320px] max-w-[calc(100vw-2rem)] flex-col gap-2",children:e.map(t=>{const n=t.kind==="success"?"border-emerald-200 bg-emerald-50 text-emerald-900":t.kind==="error"?"border-rose-200 bg-rose-50 text-rose-900":t.kind==="warning"?"border-amber-200 bg-amber-50 text-amber-900":"border-slate-200 bg-slate-50 text-slate-800",r=t.kind==="success"?"":t.kind==="error"?"":t.kind==="warning"?"":"";return i.jsx("div",{className:`rounded-xl border px-3 py-2 shadow-sm ${n}`,children:i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx("span",{"aria-hidden":"true",children:r}),i.jsx("div",{className:"leading-snug",children:t.message})]})},t.id)})})}function pb({open:e,opts:t,onCancel:n,onConfirm:r}){if(!e||!t)return null;const s=t.tone??"default",o=t.confirmText??"Confirm",l=t.cancelText===null,u=t.cancelText??"Cancel",c=s==="danger"?"bg-rose-600 hover:bg-rose-700 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 flex items-center justify-end gap-2",children:[!l&&i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:`rounded-xl px-4 py-2 text-sm font-semibold ${c}`,onClick:r,children:o})]})]})})}function mb({open:e,opts:t,onCancel:n,onConfirm:r}){const[s,o]=d.useState("");if(d.useEffect(()=>{e&&t&&o(t.defaultValue??"")},[e,t]),!e||!t)return null;const l=t.confirmText??"OK",u=t.cancelText??"Cancel",c=t.inputType??"text";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),t.message&&i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 space-y-3",children:[i.jsx("input",{autoFocus:!0,type:c,value:s,onChange:f=>o(f.target.value),placeholder:t.placeholder??"",className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"}),i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700",onClick:()=>r(s),children:l})]})]})]})})}function hb(){return Math.random().toString(16).slice(2)+Date.now().toString(16)}function gb({children:e}){const[t,n]=d.useState([]),r=d.useRef(null),[s,o]=d.useState(!1),[l,u]=d.useState(null),c=d.useRef(null),[f,g]=d.useState(!1),[S,b]=d.useState(null),E=d.useCallback((y,m,v=2500)=>{const T=hb(),O={id:T,kind:y,message:m,durationMs:v};n(F=>[...F,O]),window.setTimeout(()=>{n(F=>F.filter($=>$.id!==T))},v)},[]),j=d.useCallback(y=>(u(y),o(!0),new Promise(m=>{r.current=m})),[]),k=d.useCallback(y=>(b(y),g(!0),new Promise(m=>{c.current=m})),[]),J=d.useMemo(()=>({toast:E,confirm:j,prompt:k}),[E,j,k]);return i.jsxs(sw.Provider,{value:J,children:[e,i.jsx(fb,{toasts:t}),i.jsx(pb,{open:s,opts:l,onCancel:()=>{o(!1);const y=r.current;r.current=null,y==null||y(!1)},onConfirm:()=>{o(!1);const y=r.current;r.current=null,y==null||y(!0)}}),i.jsx(mb,{open:f,opts:S,onCancel:()=>{g(!1);const y=c.current;c.current=null,y==null||y(null)},onConfirm:y=>{g(!1);const m=c.current;c.current=null,m==null||m(y)}})]})}const wr={waiting:!1,registration:null},Ic=new Set;let Em=null;const Dc="cs_sw_update_requested_v1",yb=2*60*1e3;function k0(){for(const e of Ic)e({...wr})}function _m(e){e&&Em===e||(e&&(Em=e),!wr.waiting&&(wr.waiting=!0,k0()))}function xb(e){return Ic.add(e),e({...wr}),()=>{Ic.delete(e)}}async function vb(){var e,t,n;if("serviceWorker"in navigator&&!window.__cs_sw_registered){window.__cs_sw_registered=!0;try{const o=await navigator.serviceWorker.register("/service-worker.js?rev=a9cf6093cd153fcfbb95cd6f8cc97793f0cfb193",{updateViaCache:"none"});wr.registration=o;const l=()=>{try{const f=window.sessionStorage.getItem(Dc);if(!f)return!1;const g=Number(f);if(!Number.isFinite(g))return!1;const S=Date.now()-g<yb;return S||window.sessionStorage.removeItem(Dc),S}catch{return!1}};if(o.waiting&&navigator.serviceWorker.controller){const f=l();console.info("[PWA] waiting SW detected",{active:(e=o.active)==null?void 0:e.scriptURL,waiting:(t=o.waiting)==null?void 0:t.scriptURL,controller:(n=navigator.serviceWorker.controller)==null?void 0:n.scriptURL,updateRequested:f}),f?o.waiting.postMessage({type:"SKIP_WAITING"}):_m(o.waiting.scriptURL)}o.addEventListener("updatefound",()=>{const f=o.installing;f&&f.addEventListener("statechange",()=>{var g,S,b,E;if(f.state==="installed"&&navigator.serviceWorker.controller){const j=l();console.info("[PWA] SW installed update",{active:(g=o.active)==null?void 0:g.scriptURL,waiting:(S=o.waiting)==null?void 0:S.scriptURL,installing:f.scriptURL,controller:(b=navigator.serviceWorker.controller)==null?void 0:b.scriptURL,updateRequested:j}),j?(E=o.waiting)==null||E.postMessage({type:"SKIP_WAITING"}):_m(f.scriptURL)}})});const u=()=>{wr.waiting||o.update().catch(()=>{})};window.addEventListener("focus",u),window.setInterval(u,6e4),k0();let c=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{c||(c=!0,wr.waiting=!1,window.location.reload())})}catch(r){console.warn("[PWA] SW registration failed",r)}}}async function wb(){var t,n,r;const e=wr.registration;if(e!=null&&e.waiting){console.info("[PWA] activate update",{active:(t=e.active)==null?void 0:t.scriptURL,waiting:(n=e.waiting)==null?void 0:n.scriptURL,controller:(r=navigator.serviceWorker.controller)==null?void 0:r.scriptURL});try{window.sessionStorage.setItem(Dc,String(Date.now()))}catch{}e.waiting.postMessage({type:"SKIP_WAITING"})}}function Sb(){const[e,t]=d.useState({waiting:!1,registration:null});return d.useEffect(()=>xb(t),[]),e.waiting?i.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-[9999]",children:i.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-slate-900 text-white px-4 py-3 shadow-xl",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Update available"}),i.jsx("button",{className:"rounded-xl bg-white/15 hover:bg-white/25 px-3 py-1 text-sm font-semibold",onClick:async()=>{await wb()},children:"Refresh"})]})}):null}const bb=["classseats_","classseats.","newui_"],Nb=new Set(["attendance:lastDate"]),kb=["classseats_auth","classseats-cache"],Pu={border:"1px solid #cbd5e1",borderRadius:"10px",padding:"10px 14px",background:"#ffffff",color:"#0f172a",fontWeight:600,cursor:"pointer"};function jb(){try{const e=[];for(let t=0;t<window.localStorage.length;t+=1){const n=window.localStorage.key(t);if(!n)continue;(bb.some(s=>n.startsWith(s))||Nb.has(n))&&e.push(n)}for(const t of e)window.localStorage.removeItem(t)}catch{}}function Cb(){try{window.sessionStorage.clear()}catch{}}function Eb(){return"indexedDB"in window?Promise.all(kb.map(e=>new Promise(t=>{try{const n=window.indexedDB.deleteDatabase(e);n.onsuccess=()=>t(),n.onerror=()=>t(),n.onblocked=()=>t()}catch{t()}}))).then(()=>{}):Promise.resolve()}async function _b(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(t=>t.unregister()))}catch{}}async function Rb(){if("caches"in window)try{const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t)))}catch{}}function Rm(){window.location.reload()}class Tb extends Ds.Component{constructor(){super(...arguments),this.state={hasError:!1,details:""},this.onReload=()=>{Rm()},this.onRefresh=async()=>{await _b(),await Rb(),Rm()},this.onRestart=async()=>{window.confirm("Restart will clear local ClassSeats data on this device, then reload the app. Continue?")&&(jb(),Cb(),await Eb(),await this.onRefresh())}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t){const n=t instanceof Error?t.message:String(t||"Unknown error");this.setState({details:n})}render(){return this.state.hasError?i.jsx("div",{role:"alert",style:{minHeight:"100dvh",display:"grid",placeItems:"center",background:"#f8fafc",color:"#0f172a",padding:"24px"},children:i.jsxs("div",{style:{width:"100%",maxWidth:"560px",background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"14px",padding:"20px",boxShadow:"0 10px 30px rgba(15, 23, 42, 0.08)"},children:[i.jsx("h1",{style:{margin:"0 0 8px",fontSize:"1.1rem"},children:"Oops - the most recent update did not install properly. This happens sometimes. Sorry! "}),i.jsx("p",{style:{margin:"0 0 12px",lineHeight:1.45},children:"Try the buttons below, in order, to try to get things running again."}),i.jsx("p",{style:{margin:"0 0 16px",lineHeight:1.45,color:"#334155"},children:"If that does not work, delete the shortcut on your home screen, go to mobile.classseats.app, and add a new shortcut to your home screen."}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsx("button",{type:"button",onClick:this.onReload,style:Pu,children:"Reload"}),i.jsx("button",{type:"button",onClick:this.onRefresh,style:Pu,children:"Refresh"}),i.jsx("button",{type:"button",onClick:this.onRestart,style:Pu,children:"Restart"})]}),this.state.details?i.jsxs("p",{style:{margin:"12px 0 0",fontSize:"0.86rem",color:"#475569"},children:["Error details: ",this.state.details]}):null]})}):this.props.children}}const Ab=document.getElementById("root"),Tm="cs_chunk_recovery";function Pb(){window.__cs_boot_mounted=!0,window.dispatchEvent(new Event("classseats:boot-mounted"))}function Ib(){return Ds.useEffect(()=>{Pb()},[]),null}function j0(e){if(!e)return!1;const t=typeof e=="string"?e:typeof e.message=="string"?e.message:"";return t.includes("Loading chunk")||t.includes("ChunkLoadError")||t.includes("Failed to fetch dynamically imported module")||t.includes("Importing a module script failed")}function C0(){sessionStorage.getItem(Tm)||(sessionStorage.setItem(Tm,"1"),"serviceWorker"in navigator?navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(t=>t.unregister()))).finally(()=>window.location.reload()):window.location.reload())}window.addEventListener("error",e=>{j0(e.error||e.message)&&C0()});window.addEventListener("unhandledrejection",e=>{j0(e.reason)&&C0()});Iu.createRoot(Ab).render(i.jsx(Ds.StrictMode,{children:i.jsx(Tb,{children:i.jsx(WS,{children:i.jsxs(gb,{children:[i.jsx(Ib,{}),i.jsx(db,{}),i.jsx(Sb,{})]})})})})),vb();
