(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Sy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Um={exports:{}},oa={},Fm={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xl=Symbol.for("react.element"),by=Symbol.for("react.portal"),Ny=Symbol.for("react.fragment"),ky=Symbol.for("react.strict_mode"),jy=Symbol.for("react.profiler"),Cy=Symbol.for("react.provider"),Ey=Symbol.for("react.context"),Ry=Symbol.for("react.forward_ref"),_y=Symbol.for("react.suspense"),Ty=Symbol.for("react.memo"),Py=Symbol.for("react.lazy"),Hf=Symbol.iterator;function Ay(e){return e===null||typeof e!="object"?null:(e=Hf&&e[Hf]||e["@@iterator"],typeof e=="function"?e:null)}var zm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$m=Object.assign,Bm={};function eo(e,t,n){this.props=e,this.context=t,this.refs=Bm,this.updater=n||zm}eo.prototype.isReactComponent={};eo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};eo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wm(){}Wm.prototype=eo.prototype;function Mc(e,t,n){this.props=e,this.context=t,this.refs=Bm,this.updater=n||zm}var Uc=Mc.prototype=new Wm;Uc.constructor=Mc;$m(Uc,eo.prototype);Uc.isPureReactComponent=!0;var Vf=Array.isArray,Hm=Object.prototype.hasOwnProperty,Fc={current:null},Vm={key:!0,ref:!0,__self:!0,__source:!0};function Km(e,t,n){var r,s={},o=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(o=""+t.key),t)Hm.call(t,r)&&!Vm.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var c=Array(u),f=0;f<u;f++)c[f]=arguments[f+2];s.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:xl,type:e,key:o,ref:l,props:s,_owner:Fc.current}}function Iy(e,t){return{$$typeof:xl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function zc(e){return typeof e=="object"&&e!==null&&e.$$typeof===xl}function Dy(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Kf=/\/+/g;function Ja(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Dy(""+e.key):t.toString(36)}function pi(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case xl:case by:l=!0}}if(l)return l=e,s=s(l),e=r===""?"."+Ja(l,0):r,Vf(s)?(n="",e!=null&&(n=e.replace(Kf,"$&/")+"/"),pi(s,t,n,"",function(f){return f})):s!=null&&(zc(s)&&(s=Iy(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Kf,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=r===""?".":r+":",Vf(e))for(var u=0;u<e.length;u++){o=e[u];var c=r+Ja(o,u);l+=pi(o,t,n,c,s)}else if(c=Ay(e),typeof c=="function")for(e=c.call(e),u=0;!(o=e.next()).done;)o=o.value,c=r+Ja(o,u++),l+=pi(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Kl(e,t,n){if(e==null)return e;var r=[],s=0;return pi(e,r,"","",function(o){return t.call(n,o,s++)}),r}function Ly(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Et={current:null},mi={transition:null},Oy={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:mi,ReactCurrentOwner:Fc};function Gm(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Kl,forEach:function(e,t,n){Kl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Kl(e,function(){t++}),t},toArray:function(e){return Kl(e,function(t){return t})||[]},only:function(e){if(!zc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ae.Component=eo;ae.Fragment=Ny;ae.Profiler=jy;ae.PureComponent=Mc;ae.StrictMode=ky;ae.Suspense=_y;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Oy;ae.act=Gm;ae.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=$m({},e.props),s=e.key,o=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,l=Fc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)Hm.call(t,c)&&!Vm.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&u!==void 0?u[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];r.children=u}return{$$typeof:xl,type:e.type,key:s,ref:o,props:r,_owner:l}};ae.createContext=function(e){return e={$$typeof:Ey,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Cy,_context:e},e.Consumer=e};ae.createElement=Km;ae.createFactory=function(e){var t=Km.bind(null,e);return t.type=e,t};ae.createRef=function(){return{current:null}};ae.forwardRef=function(e){return{$$typeof:Ry,render:e}};ae.isValidElement=zc;ae.lazy=function(e){return{$$typeof:Py,_payload:{_status:-1,_result:e},_init:Ly}};ae.memo=function(e,t){return{$$typeof:Ty,type:e,compare:t===void 0?null:t}};ae.startTransition=function(e){var t=mi.transition;mi.transition={};try{e()}finally{mi.transition=t}};ae.unstable_act=Gm;ae.useCallback=function(e,t){return Et.current.useCallback(e,t)};ae.useContext=function(e){return Et.current.useContext(e)};ae.useDebugValue=function(){};ae.useDeferredValue=function(e){return Et.current.useDeferredValue(e)};ae.useEffect=function(e,t){return Et.current.useEffect(e,t)};ae.useId=function(){return Et.current.useId()};ae.useImperativeHandle=function(e,t,n){return Et.current.useImperativeHandle(e,t,n)};ae.useInsertionEffect=function(e,t){return Et.current.useInsertionEffect(e,t)};ae.useLayoutEffect=function(e,t){return Et.current.useLayoutEffect(e,t)};ae.useMemo=function(e,t){return Et.current.useMemo(e,t)};ae.useReducer=function(e,t,n){return Et.current.useReducer(e,t,n)};ae.useRef=function(e){return Et.current.useRef(e)};ae.useState=function(e){return Et.current.useState(e)};ae.useSyncExternalStore=function(e,t,n){return Et.current.useSyncExternalStore(e,t,n)};ae.useTransition=function(){return Et.current.useTransition()};ae.version="18.3.1";Fm.exports=ae;var d=Fm.exports;const Os=Sy(d);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var My=d,Uy=Symbol.for("react.element"),Fy=Symbol.for("react.fragment"),zy=Object.prototype.hasOwnProperty,$y=My.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,By={key:!0,ref:!0,__self:!0,__source:!0};function Ym(e,t,n){var r,s={},o=null,l=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)zy.call(t,r)&&!By.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Uy,type:e,key:o,ref:l,props:s,_owner:$y.current}}oa.Fragment=Fy;oa.jsx=Ym;oa.jsxs=Ym;Um.exports=oa;var i=Um.exports,Lu={},Qm={exports:{}},Wt={},Jm={exports:{}},qm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,H){var Q=N.length;N.push(H);e:for(;0<Q;){var re=Q-1>>>1,V=N[re];if(0<s(V,H))N[re]=H,N[Q]=V,Q=re;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var H=N[0],Q=N.pop();if(Q!==H){N[0]=Q;e:for(var re=0,V=N.length,Ee=V>>>1;re<Ee;){var ze=2*(re+1)-1,wt=N[ze],pt=ze+1,Ze=N[pt];if(0>s(wt,Q))pt<V&&0>s(Ze,wt)?(N[re]=Ze,N[pt]=Q,re=pt):(N[re]=wt,N[ze]=Q,re=ze);else if(pt<V&&0>s(Ze,Q))N[re]=Ze,N[pt]=Q,re=pt;else break e}}return H}function s(N,H){var Q=N.sortIndex-H.sortIndex;return Q!==0?Q:N.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var c=[],f=[],g=1,S=null,b=3,E=!1,j=!1,k=!1,q=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(N){for(var H=n(f);H!==null;){if(H.callback===null)r(f);else if(H.startTime<=N)r(f),H.sortIndex=H.expirationTime,t(c,H);else break;H=n(f)}}function T(N){if(k=!1,v(N),!j)if(n(c)!==null)j=!0,ee(O);else{var H=n(f);H!==null&&Oe(T,H.startTime-N)}}function O(N,H){j=!1,k&&(k=!1,y(z),z=-1),E=!0;var Q=b;try{for(v(H),S=n(c);S!==null&&(!(S.expirationTime>H)||N&&!me());){var re=S.callback;if(typeof re=="function"){S.callback=null,b=S.priorityLevel;var V=re(S.expirationTime<=H);H=e.unstable_now(),typeof V=="function"?S.callback=V:S===n(c)&&r(c),v(H)}else r(c);S=n(c)}if(S!==null)var Ee=!0;else{var ze=n(f);ze!==null&&Oe(T,ze.startTime-H),Ee=!1}return Ee}finally{S=null,b=Q,E=!1}}var F=!1,$=null,z=-1,ue=5,X=-1;function me(){return!(e.unstable_now()-X<ue)}function qe(){if($!==null){var N=e.unstable_now();X=N;var H=!0;try{H=$(!0,N)}finally{H?ot():(F=!1,$=null)}}else F=!1}var ot;if(typeof m=="function")ot=function(){m(qe)};else if(typeof MessageChannel<"u"){var Xe=new MessageChannel,Fe=Xe.port2;Xe.port1.onmessage=qe,ot=function(){Fe.postMessage(null)}}else ot=function(){q(qe,0)};function ee(N){$=N,F||(F=!0,ot())}function Oe(N,H){z=q(function(){N(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){j||E||(j=!0,ee(O))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(N){switch(b){case 1:case 2:case 3:var H=3;break;default:H=b}var Q=b;b=H;try{return N()}finally{b=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,H){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var Q=b;b=N;try{return H()}finally{b=Q}},e.unstable_scheduleCallback=function(N,H,Q){var re=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?re+Q:re):Q=re,N){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Q+V,N={id:g++,callback:H,priorityLevel:N,startTime:Q,expirationTime:V,sortIndex:-1},Q>re?(N.sortIndex=Q,t(f,N),n(c)===null&&N===n(f)&&(k?(y(z),z=-1):k=!0,Oe(T,Q-re))):(N.sortIndex=V,t(c,N),j||E||(j=!0,ee(O))),N},e.unstable_shouldYield=me,e.unstable_wrapCallback=function(N){var H=b;return function(){var Q=b;b=H;try{return N.apply(this,arguments)}finally{b=Q}}}})(qm);Jm.exports=qm;var Wy=Jm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy=d,Bt=Wy;function I(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xm=new Set,Zo={};function ss(e,t){Hs(e,t),Hs(e+"Capture",t)}function Hs(e,t){for(Zo[e]=t,e=0;e<t.length;e++)Xm.add(t[e])}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ou=Object.prototype.hasOwnProperty,Vy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gf={},Yf={};function Ky(e){return Ou.call(Yf,e)?!0:Ou.call(Gf,e)?!1:Vy.test(e)?Yf[e]=!0:(Gf[e]=!0,!1)}function Gy(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Yy(e,t,n,r){if(t===null||typeof t>"u"||Gy(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Rt(e,t,n,r,s,o,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ft[e]=new Rt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ft[t]=new Rt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ft[e]=new Rt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ft[e]=new Rt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ft[e]=new Rt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ft[e]=new Rt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ft[e]=new Rt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ft[e]=new Rt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ft[e]=new Rt(e,5,!1,e.toLowerCase(),null,!1,!1)});var $c=/[\-:]([a-z])/g;function Bc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($c,Bc);ft[t]=new Rt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($c,Bc);ft[t]=new Rt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($c,Bc);ft[t]=new Rt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ft[e]=new Rt(e,1,!1,e.toLowerCase(),null,!1,!1)});ft.xlinkHref=new Rt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ft[e]=new Rt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wc(e,t,n,r){var s=ft.hasOwnProperty(t)?ft[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Yy(t,n,s,r)&&(n=null),r||s===null?Ky(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Wn=Hy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gl=Symbol.for("react.element"),bs=Symbol.for("react.portal"),Ns=Symbol.for("react.fragment"),Hc=Symbol.for("react.strict_mode"),Mu=Symbol.for("react.profiler"),Zm=Symbol.for("react.provider"),eh=Symbol.for("react.context"),Vc=Symbol.for("react.forward_ref"),Uu=Symbol.for("react.suspense"),Fu=Symbol.for("react.suspense_list"),Kc=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),th=Symbol.for("react.offscreen"),Qf=Symbol.iterator;function bo(e){return e===null||typeof e!="object"?null:(e=Qf&&e[Qf]||e["@@iterator"],typeof e=="function"?e:null)}var Le=Object.assign,qa;function Do(e){if(qa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);qa=t&&t[1]||""}return`
`+qa+e}var Xa=!1;function Za(e,t){if(!e||Xa)return"";Xa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var r=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){r=f}e.call(t.prototype)}else{try{throw Error()}catch(f){r=f}e()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var s=f.stack.split(`
`),o=r.stack.split(`
`),l=s.length-1,u=o.length-1;1<=l&&0<=u&&s[l]!==o[u];)u--;for(;1<=l&&0<=u;l--,u--)if(s[l]!==o[u]){if(l!==1||u!==1)do if(l--,u--,0>u||s[l]!==o[u]){var c=`
`+s[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=u);break}}}finally{Xa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Do(e):""}function Qy(e){switch(e.tag){case 5:return Do(e.type);case 16:return Do("Lazy");case 13:return Do("Suspense");case 19:return Do("SuspenseList");case 0:case 2:case 15:return e=Za(e.type,!1),e;case 11:return e=Za(e.type.render,!1),e;case 1:return e=Za(e.type,!0),e;default:return""}}function zu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ns:return"Fragment";case bs:return"Portal";case Mu:return"Profiler";case Hc:return"StrictMode";case Uu:return"Suspense";case Fu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eh:return(e.displayName||"Context")+".Consumer";case Zm:return(e._context.displayName||"Context")+".Provider";case Vc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Kc:return t=e.displayName||null,t!==null?t:zu(e.type)||"Memo";case rr:t=e._payload,e=e._init;try{return zu(e(t))}catch{}}return null}function Jy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zu(t);case 8:return t===Hc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function nh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qy(e){var t=nh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yl(e){e._valueTracker||(e._valueTracker=qy(e))}function rh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=nh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ti(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $u(e,t){var n=t.checked;return Le({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Jf(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Sr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sh(e,t){t=t.checked,t!=null&&Wc(e,"checked",t,!1)}function Bu(e,t){sh(e,t);var n=Sr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wu(e,t.type,n):t.hasOwnProperty("defaultValue")&&Wu(e,t.type,Sr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Wu(e,t,n){(t!=="number"||Ti(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Lo=Array.isArray;function Ms(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Sr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Hu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(I(91));return Le({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(I(92));if(Lo(n)){if(1<n.length)throw Error(I(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Sr(n)}}function oh(e,t){var n=Sr(t.value),r=Sr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Zf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ql,ih=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ql=Ql||document.createElement("div"),Ql.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ql.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function el(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xy=["Webkit","ms","Moz","O"];Object.keys(Bo).forEach(function(e){Xy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Bo[t]=Bo[e]})});function ah(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Bo.hasOwnProperty(e)&&Bo[e]?(""+t).trim():t+"px"}function uh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ah(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Zy=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ku(e,t){if(t){if(Zy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(I(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(I(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(I(61))}if(t.style!=null&&typeof t.style!="object")throw Error(I(62))}}function Gu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yu=null;function Gc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qu=null,Us=null,Fs=null;function ep(e){if(e=Sl(e)){if(typeof Qu!="function")throw Error(I(280));var t=e.stateNode;t&&(t=ca(t),Qu(e.stateNode,e.type,t))}}function ch(e){Us?Fs?Fs.push(e):Fs=[e]:Us=e}function dh(){if(Us){var e=Us,t=Fs;if(Fs=Us=null,ep(e),t)for(e=0;e<t.length;e++)ep(t[e])}}function fh(e,t){return e(t)}function ph(){}var eu=!1;function mh(e,t,n){if(eu)return e(t,n);eu=!0;try{return fh(e,t,n)}finally{eu=!1,(Us!==null||Fs!==null)&&(ph(),dh())}}function tl(e,t){var n=e.stateNode;if(n===null)return null;var r=ca(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(I(231,t,typeof n));return n}var Ju=!1;if(Fn)try{var No={};Object.defineProperty(No,"passive",{get:function(){Ju=!0}}),window.addEventListener("test",No,No),window.removeEventListener("test",No,No)}catch{Ju=!1}function ex(e,t,n,r,s,o,l,u,c){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(g){this.onError(g)}}var Wo=!1,Pi=null,Ai=!1,qu=null,tx={onError:function(e){Wo=!0,Pi=e}};function nx(e,t,n,r,s,o,l,u,c){Wo=!1,Pi=null,ex.apply(tx,arguments)}function rx(e,t,n,r,s,o,l,u,c){if(nx.apply(this,arguments),Wo){if(Wo){var f=Pi;Wo=!1,Pi=null}else throw Error(I(198));Ai||(Ai=!0,qu=f)}}function os(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tp(e){if(os(e)!==e)throw Error(I(188))}function sx(e){var t=e.alternate;if(!t){if(t=os(e),t===null)throw Error(I(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return tp(s),e;if(o===r)return tp(s),t;o=o.sibling}throw Error(I(188))}if(n.return!==r.return)n=s,r=o;else{for(var l=!1,u=s.child;u;){if(u===n){l=!0,n=s,r=o;break}if(u===r){l=!0,r=s,n=o;break}u=u.sibling}if(!l){for(u=o.child;u;){if(u===n){l=!0,n=o,r=s;break}if(u===r){l=!0,r=o,n=s;break}u=u.sibling}if(!l)throw Error(I(189))}}if(n.alternate!==r)throw Error(I(190))}if(n.tag!==3)throw Error(I(188));return n.stateNode.current===n?e:t}function gh(e){return e=sx(e),e!==null?yh(e):null}function yh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yh(e);if(t!==null)return t;e=e.sibling}return null}var xh=Bt.unstable_scheduleCallback,np=Bt.unstable_cancelCallback,ox=Bt.unstable_shouldYield,lx=Bt.unstable_requestPaint,Be=Bt.unstable_now,ix=Bt.unstable_getCurrentPriorityLevel,Yc=Bt.unstable_ImmediatePriority,vh=Bt.unstable_UserBlockingPriority,Ii=Bt.unstable_NormalPriority,ax=Bt.unstable_LowPriority,wh=Bt.unstable_IdlePriority,la=null,bn=null;function ux(e){if(bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(la,e,void 0,(e.current.flags&128)===128)}catch{}}var un=Math.clz32?Math.clz32:fx,cx=Math.log,dx=Math.LN2;function fx(e){return e>>>=0,e===0?32:31-(cx(e)/dx|0)|0}var Jl=64,ql=4194304;function Oo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Di(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,l=n&268435455;if(l!==0){var u=l&~s;u!==0?r=Oo(u):(o&=l,o!==0&&(r=Oo(o)))}else l=n&~s,l!==0?r=Oo(l):o!==0&&(r=Oo(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-un(t),s=1<<n,r|=e[n],t&=~s;return r}function px(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mx(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-un(o),u=1<<l,c=s[l];c===-1?(!(u&n)||u&r)&&(s[l]=px(u,t)):c<=t&&(e.expiredLanes|=u),o&=~u}}function Xu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sh(){var e=Jl;return Jl<<=1,!(Jl&4194240)&&(Jl=64),e}function tu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-un(t),e[t]=n}function hx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-un(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Qc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-un(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var we=0;function bh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Nh,Jc,kh,jh,Ch,Zu=!1,Xl=[],cr=null,dr=null,fr=null,nl=new Map,rl=new Map,lr=[],gx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rp(e,t){switch(e){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":nl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(t.pointerId)}}function ko(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Sl(t),t!==null&&Jc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function yx(e,t,n,r,s){switch(t){case"focusin":return cr=ko(cr,e,t,n,r,s),!0;case"dragenter":return dr=ko(dr,e,t,n,r,s),!0;case"mouseover":return fr=ko(fr,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return nl.set(o,ko(nl.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,rl.set(o,ko(rl.get(o)||null,e,t,n,r,s)),!0}return!1}function Eh(e){var t=Br(e.target);if(t!==null){var n=os(t);if(n!==null){if(t=n.tag,t===13){if(t=hh(n),t!==null){e.blockedOn=t,Ch(e.priority,function(){kh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ec(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Yu=r,n.target.dispatchEvent(r),Yu=null}else return t=Sl(n),t!==null&&Jc(t),e.blockedOn=n,!1;t.shift()}return!0}function sp(e,t,n){hi(e)&&n.delete(t)}function xx(){Zu=!1,cr!==null&&hi(cr)&&(cr=null),dr!==null&&hi(dr)&&(dr=null),fr!==null&&hi(fr)&&(fr=null),nl.forEach(sp),rl.forEach(sp)}function jo(e,t){e.blockedOn===t&&(e.blockedOn=null,Zu||(Zu=!0,Bt.unstable_scheduleCallback(Bt.unstable_NormalPriority,xx)))}function sl(e){function t(s){return jo(s,e)}if(0<Xl.length){jo(Xl[0],e);for(var n=1;n<Xl.length;n++){var r=Xl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(cr!==null&&jo(cr,e),dr!==null&&jo(dr,e),fr!==null&&jo(fr,e),nl.forEach(t),rl.forEach(t),n=0;n<lr.length;n++)r=lr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<lr.length&&(n=lr[0],n.blockedOn===null);)Eh(n),n.blockedOn===null&&lr.shift()}var zs=Wn.ReactCurrentBatchConfig,Li=!0;function vx(e,t,n,r){var s=we,o=zs.transition;zs.transition=null;try{we=1,qc(e,t,n,r)}finally{we=s,zs.transition=o}}function wx(e,t,n,r){var s=we,o=zs.transition;zs.transition=null;try{we=4,qc(e,t,n,r)}finally{we=s,zs.transition=o}}function qc(e,t,n,r){if(Li){var s=ec(e,t,n,r);if(s===null)du(e,t,r,Oi,n),rp(e,r);else if(yx(s,e,t,n,r))r.stopPropagation();else if(rp(e,r),t&4&&-1<gx.indexOf(e)){for(;s!==null;){var o=Sl(s);if(o!==null&&Nh(o),o=ec(e,t,n,r),o===null&&du(e,t,r,Oi,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else du(e,t,r,null,n)}}var Oi=null;function ec(e,t,n,r){if(Oi=null,e=Gc(r),e=Br(e),e!==null)if(t=os(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Oi=e,null}function Rh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ix()){case Yc:return 1;case vh:return 4;case Ii:case ax:return 16;case wh:return 536870912;default:return 16}default:return 16}}var ar=null,Xc=null,gi=null;function _h(){if(gi)return gi;var e,t=Xc,n=t.length,r,s="value"in ar?ar.value:ar.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===s[o-r];r++);return gi=s.slice(e,1<r?1-r:void 0)}function yi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zl(){return!0}function op(){return!1}function Ht(e){function t(n,r,s,o,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Zl:op,this.isPropagationStopped=op,this}return Le(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zl)},persist:function(){},isPersistent:Zl}),t}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zc=Ht(to),wl=Le({},to,{view:0,detail:0}),Sx=Ht(wl),nu,ru,Co,ia=Le({},wl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ed,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Co&&(Co&&e.type==="mousemove"?(nu=e.screenX-Co.screenX,ru=e.screenY-Co.screenY):ru=nu=0,Co=e),nu)},movementY:function(e){return"movementY"in e?e.movementY:ru}}),lp=Ht(ia),bx=Le({},ia,{dataTransfer:0}),Nx=Ht(bx),kx=Le({},wl,{relatedTarget:0}),su=Ht(kx),jx=Le({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),Cx=Ht(jx),Ex=Le({},to,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rx=Ht(Ex),_x=Le({},to,{data:0}),ip=Ht(_x),Tx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Px={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ax={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ix(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ax[e])?!!t[e]:!1}function ed(){return Ix}var Dx=Le({},wl,{key:function(e){if(e.key){var t=Tx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Px[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ed,charCode:function(e){return e.type==="keypress"?yi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lx=Ht(Dx),Ox=Le({},ia,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ap=Ht(Ox),Mx=Le({},wl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ed}),Ux=Ht(Mx),Fx=Le({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),zx=Ht(Fx),$x=Le({},ia,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bx=Ht($x),Wx=[9,13,27,32],td=Fn&&"CompositionEvent"in window,Ho=null;Fn&&"documentMode"in document&&(Ho=document.documentMode);var Hx=Fn&&"TextEvent"in window&&!Ho,Th=Fn&&(!td||Ho&&8<Ho&&11>=Ho),up=" ",cp=!1;function Ph(e,t){switch(e){case"keyup":return Wx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ah(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ks=!1;function Vx(e,t){switch(e){case"compositionend":return Ah(t);case"keypress":return t.which!==32?null:(cp=!0,up);case"textInput":return e=t.data,e===up&&cp?null:e;default:return null}}function Kx(e,t){if(ks)return e==="compositionend"||!td&&Ph(e,t)?(e=_h(),gi=Xc=ar=null,ks=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Th&&t.locale!=="ko"?null:t.data;default:return null}}var Gx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Gx[e.type]:t==="textarea"}function Ih(e,t,n,r){ch(r),t=Mi(t,"onChange"),0<t.length&&(n=new Zc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vo=null,ol=null;function Yx(e){Hh(e,0)}function aa(e){var t=Es(e);if(rh(t))return e}function Qx(e,t){if(e==="change")return t}var Dh=!1;if(Fn){var ou;if(Fn){var lu="oninput"in document;if(!lu){var fp=document.createElement("div");fp.setAttribute("oninput","return;"),lu=typeof fp.oninput=="function"}ou=lu}else ou=!1;Dh=ou&&(!document.documentMode||9<document.documentMode)}function pp(){Vo&&(Vo.detachEvent("onpropertychange",Lh),ol=Vo=null)}function Lh(e){if(e.propertyName==="value"&&aa(ol)){var t=[];Ih(t,ol,e,Gc(e)),mh(Yx,t)}}function Jx(e,t,n){e==="focusin"?(pp(),Vo=t,ol=n,Vo.attachEvent("onpropertychange",Lh)):e==="focusout"&&pp()}function qx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return aa(ol)}function Xx(e,t){if(e==="click")return aa(t)}function Zx(e,t){if(e==="input"||e==="change")return aa(t)}function ev(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dn=typeof Object.is=="function"?Object.is:ev;function ll(e,t){if(dn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ou.call(t,s)||!dn(e[s],t[s]))return!1}return!0}function mp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hp(e,t){var n=mp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mp(n)}}function Oh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Oh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mh(){for(var e=window,t=Ti();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ti(e.document)}return t}function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tv(e){var t=Mh(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Oh(n.ownerDocument.documentElement,n)){if(r!==null&&nd(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=hp(n,o);var l=hp(n,r);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nv=Fn&&"documentMode"in document&&11>=document.documentMode,js=null,tc=null,Ko=null,nc=!1;function gp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nc||js==null||js!==Ti(r)||(r=js,"selectionStart"in r&&nd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ko&&ll(Ko,r)||(Ko=r,r=Mi(tc,"onSelect"),0<r.length&&(t=new Zc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=js)))}function ei(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Cs={animationend:ei("Animation","AnimationEnd"),animationiteration:ei("Animation","AnimationIteration"),animationstart:ei("Animation","AnimationStart"),transitionend:ei("Transition","TransitionEnd")},iu={},Uh={};Fn&&(Uh=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function ua(e){if(iu[e])return iu[e];if(!Cs[e])return e;var t=Cs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Uh)return iu[e]=t[n];return e}var Fh=ua("animationend"),zh=ua("animationiteration"),$h=ua("animationstart"),Bh=ua("transitionend"),Wh=new Map,yp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(e,t){Wh.set(e,t),ss(t,[e])}for(var au=0;au<yp.length;au++){var uu=yp[au],rv=uu.toLowerCase(),sv=uu[0].toUpperCase()+uu.slice(1);jr(rv,"on"+sv)}jr(Fh,"onAnimationEnd");jr(zh,"onAnimationIteration");jr($h,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(Bh,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ov=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mo));function xp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,rx(r,t,void 0,e),e.currentTarget=null}function Hh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var u=r[l],c=u.instance,f=u.currentTarget;if(u=u.listener,c!==o&&s.isPropagationStopped())break e;xp(s,u,f),o=c}else for(l=0;l<r.length;l++){if(u=r[l],c=u.instance,f=u.currentTarget,u=u.listener,c!==o&&s.isPropagationStopped())break e;xp(s,u,f),o=c}}}if(Ai)throw e=qu,Ai=!1,qu=null,e}function _e(e,t){var n=t[ic];n===void 0&&(n=t[ic]=new Set);var r=e+"__bubble";n.has(r)||(Vh(t,e,2,!1),n.add(r))}function cu(e,t,n){var r=0;t&&(r|=4),Vh(n,e,r,t)}var ti="_reactListening"+Math.random().toString(36).slice(2);function il(e){if(!e[ti]){e[ti]=!0,Xm.forEach(function(n){n!=="selectionchange"&&(ov.has(n)||cu(n,!1,e),cu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ti]||(t[ti]=!0,cu("selectionchange",!1,t))}}function Vh(e,t,n,r){switch(Rh(t)){case 1:var s=vx;break;case 4:s=wx;break;default:s=qc}n=s.bind(null,t,n,e),s=void 0,!Ju||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function du(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;l=l.return}for(;u!==null;){if(l=Br(u),l===null)return;if(c=l.tag,c===5||c===6){r=o=l;continue e}u=u.parentNode}}r=r.return}mh(function(){var f=o,g=Gc(n),S=[];e:{var b=Wh.get(e);if(b!==void 0){var E=Zc,j=e;switch(e){case"keypress":if(yi(n)===0)break e;case"keydown":case"keyup":E=Lx;break;case"focusin":j="focus",E=su;break;case"focusout":j="blur",E=su;break;case"beforeblur":case"afterblur":E=su;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=Nx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Ux;break;case Fh:case zh:case $h:E=Cx;break;case Bh:E=zx;break;case"scroll":E=Sx;break;case"wheel":E=Bx;break;case"copy":case"cut":case"paste":E=Rx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=ap}var k=(t&4)!==0,q=!k&&e==="scroll",y=k?b!==null?b+"Capture":null:b;k=[];for(var m=f,v;m!==null;){v=m;var T=v.stateNode;if(v.tag===5&&T!==null&&(v=T,y!==null&&(T=tl(m,y),T!=null&&k.push(al(m,T,v)))),q)break;m=m.return}0<k.length&&(b=new E(b,j,null,n,g),S.push({event:b,listeners:k}))}}if(!(t&7)){e:{if(b=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",b&&n!==Yu&&(j=n.relatedTarget||n.fromElement)&&(Br(j)||j[zn]))break e;if((E||b)&&(b=g.window===g?g:(b=g.ownerDocument)?b.defaultView||b.parentWindow:window,E?(j=n.relatedTarget||n.toElement,E=f,j=j?Br(j):null,j!==null&&(q=os(j),j!==q||j.tag!==5&&j.tag!==6)&&(j=null)):(E=null,j=f),E!==j)){if(k=lp,T="onMouseLeave",y="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(k=ap,T="onPointerLeave",y="onPointerEnter",m="pointer"),q=E==null?b:Es(E),v=j==null?b:Es(j),b=new k(T,m+"leave",E,n,g),b.target=q,b.relatedTarget=v,T=null,Br(g)===f&&(k=new k(y,m+"enter",j,n,g),k.target=v,k.relatedTarget=q,T=k),q=T,E&&j)t:{for(k=E,y=j,m=0,v=k;v;v=ws(v))m++;for(v=0,T=y;T;T=ws(T))v++;for(;0<m-v;)k=ws(k),m--;for(;0<v-m;)y=ws(y),v--;for(;m--;){if(k===y||y!==null&&k===y.alternate)break t;k=ws(k),y=ws(y)}k=null}else k=null;E!==null&&vp(S,b,E,k,!1),j!==null&&q!==null&&vp(S,q,j,k,!0)}}e:{if(b=f?Es(f):window,E=b.nodeName&&b.nodeName.toLowerCase(),E==="select"||E==="input"&&b.type==="file")var O=Qx;else if(dp(b))if(Dh)O=Zx;else{O=qx;var F=Jx}else(E=b.nodeName)&&E.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(O=Xx);if(O&&(O=O(e,f))){Ih(S,O,n,g);break e}F&&F(e,b,f),e==="focusout"&&(F=b._wrapperState)&&F.controlled&&b.type==="number"&&Wu(b,"number",b.value)}switch(F=f?Es(f):window,e){case"focusin":(dp(F)||F.contentEditable==="true")&&(js=F,tc=f,Ko=null);break;case"focusout":Ko=tc=js=null;break;case"mousedown":nc=!0;break;case"contextmenu":case"mouseup":case"dragend":nc=!1,gp(S,n,g);break;case"selectionchange":if(nv)break;case"keydown":case"keyup":gp(S,n,g)}var $;if(td)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else ks?Ph(e,n)&&(z="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(Th&&n.locale!=="ko"&&(ks||z!=="onCompositionStart"?z==="onCompositionEnd"&&ks&&($=_h()):(ar=g,Xc="value"in ar?ar.value:ar.textContent,ks=!0)),F=Mi(f,z),0<F.length&&(z=new ip(z,e,null,n,g),S.push({event:z,listeners:F}),$?z.data=$:($=Ah(n),$!==null&&(z.data=$)))),($=Hx?Vx(e,n):Kx(e,n))&&(f=Mi(f,"onBeforeInput"),0<f.length&&(g=new ip("onBeforeInput","beforeinput",null,n,g),S.push({event:g,listeners:f}),g.data=$))}Hh(S,t)})}function al(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Mi(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=tl(e,n),o!=null&&r.unshift(al(e,o,s)),o=tl(e,t),o!=null&&r.push(al(e,o,s))),e=e.return}return r}function ws(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vp(e,t,n,r,s){for(var o=t._reactName,l=[];n!==null&&n!==r;){var u=n,c=u.alternate,f=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&f!==null&&(u=f,s?(c=tl(n,o),c!=null&&l.unshift(al(n,c,u))):s||(c=tl(n,o),c!=null&&l.push(al(n,c,u)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var lv=/\r\n?/g,iv=/\u0000|\uFFFD/g;function wp(e){return(typeof e=="string"?e:""+e).replace(lv,`
`).replace(iv,"")}function ni(e,t,n){if(t=wp(t),wp(e)!==t&&n)throw Error(I(425))}function Ui(){}var rc=null,sc=null;function oc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lc=typeof setTimeout=="function"?setTimeout:void 0,av=typeof clearTimeout=="function"?clearTimeout:void 0,Sp=typeof Promise=="function"?Promise:void 0,uv=typeof queueMicrotask=="function"?queueMicrotask:typeof Sp<"u"?function(e){return Sp.resolve(null).then(e).catch(cv)}:lc;function cv(e){setTimeout(function(){throw e})}function fu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),sl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sl(t)}function pr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function bp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var no=Math.random().toString(36).slice(2),Sn="__reactFiber$"+no,ul="__reactProps$"+no,zn="__reactContainer$"+no,ic="__reactEvents$"+no,dv="__reactListeners$"+no,fv="__reactHandles$"+no;function Br(e){var t=e[Sn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[zn]||n[Sn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=bp(e);e!==null;){if(n=e[Sn])return n;e=bp(e)}return t}e=n,n=e.parentNode}return null}function Sl(e){return e=e[Sn]||e[zn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Es(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(I(33))}function ca(e){return e[ul]||null}var ac=[],Rs=-1;function Cr(e){return{current:e}}function Te(e){0>Rs||(e.current=ac[Rs],ac[Rs]=null,Rs--)}function je(e,t){Rs++,ac[Rs]=e.current,e.current=t}var br={},vt=Cr(br),At=Cr(!1),Jr=br;function Vs(e,t){var n=e.type.contextTypes;if(!n)return br;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function It(e){return e=e.childContextTypes,e!=null}function Fi(){Te(At),Te(vt)}function Np(e,t,n){if(vt.current!==br)throw Error(I(168));je(vt,t),je(At,n)}function Kh(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(I(108,Jy(e)||"Unknown",s));return Le({},n,r)}function zi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||br,Jr=vt.current,je(vt,e),je(At,At.current),!0}function kp(e,t,n){var r=e.stateNode;if(!r)throw Error(I(169));n?(e=Kh(e,t,Jr),r.__reactInternalMemoizedMergedChildContext=e,Te(At),Te(vt),je(vt,e)):Te(At),je(At,n)}var Dn=null,da=!1,pu=!1;function Gh(e){Dn===null?Dn=[e]:Dn.push(e)}function pv(e){da=!0,Gh(e)}function Er(){if(!pu&&Dn!==null){pu=!0;var e=0,t=we;try{var n=Dn;for(we=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Dn=null,da=!1}catch(s){throw Dn!==null&&(Dn=Dn.slice(e+1)),xh(Yc,Er),s}finally{we=t,pu=!1}}return null}var _s=[],Ts=0,$i=null,Bi=0,Qt=[],Jt=0,qr=null,Ln=1,On="";function Fr(e,t){_s[Ts++]=Bi,_s[Ts++]=$i,$i=e,Bi=t}function Yh(e,t,n){Qt[Jt++]=Ln,Qt[Jt++]=On,Qt[Jt++]=qr,qr=e;var r=Ln;e=On;var s=32-un(r)-1;r&=~(1<<s),n+=1;var o=32-un(t)+s;if(30<o){var l=s-s%5;o=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Ln=1<<32-un(t)+s|n<<s|r,On=o+e}else Ln=1<<o|n<<s|r,On=e}function rd(e){e.return!==null&&(Fr(e,1),Yh(e,1,0))}function sd(e){for(;e===$i;)$i=_s[--Ts],_s[Ts]=null,Bi=_s[--Ts],_s[Ts]=null;for(;e===qr;)qr=Qt[--Jt],Qt[Jt]=null,On=Qt[--Jt],Qt[Jt]=null,Ln=Qt[--Jt],Qt[Jt]=null}var $t=null,zt=null,Pe=!1,ln=null;function Qh(e,t){var n=qt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function jp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$t=e,zt=pr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$t=e,zt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=qr!==null?{id:Ln,overflow:On}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=qt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,$t=e,zt=null,!0):!1;default:return!1}}function uc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cc(e){if(Pe){var t=zt;if(t){var n=t;if(!jp(e,t)){if(uc(e))throw Error(I(418));t=pr(n.nextSibling);var r=$t;t&&jp(e,t)?Qh(r,n):(e.flags=e.flags&-4097|2,Pe=!1,$t=e)}}else{if(uc(e))throw Error(I(418));e.flags=e.flags&-4097|2,Pe=!1,$t=e}}}function Cp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$t=e}function ri(e){if(e!==$t)return!1;if(!Pe)return Cp(e),Pe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!oc(e.type,e.memoizedProps)),t&&(t=zt)){if(uc(e))throw Jh(),Error(I(418));for(;t;)Qh(e,t),t=pr(t.nextSibling)}if(Cp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(I(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){zt=pr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}zt=null}}else zt=$t?pr(e.stateNode.nextSibling):null;return!0}function Jh(){for(var e=zt;e;)e=pr(e.nextSibling)}function Ks(){zt=$t=null,Pe=!1}function od(e){ln===null?ln=[e]:ln.push(e)}var mv=Wn.ReactCurrentBatchConfig;function Eo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(I(309));var r=n.stateNode}if(!r)throw Error(I(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(l){var u=s.refs;l===null?delete u[o]:u[o]=l},t._stringRef=o,t)}if(typeof e!="string")throw Error(I(284));if(!n._owner)throw Error(I(290,e))}return e}function si(e,t){throw e=Object.prototype.toString.call(t),Error(I(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ep(e){var t=e._init;return t(e._payload)}function qh(e){function t(y,m){if(e){var v=y.deletions;v===null?(y.deletions=[m],y.flags|=16):v.push(m)}}function n(y,m){if(!e)return null;for(;m!==null;)t(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(y,m){return y=yr(y,m),y.index=0,y.sibling=null,y}function o(y,m,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<m?(y.flags|=2,m):v):(y.flags|=2,m)):(y.flags|=1048576,m)}function l(y){return e&&y.alternate===null&&(y.flags|=2),y}function u(y,m,v,T){return m===null||m.tag!==6?(m=wu(v,y.mode,T),m.return=y,m):(m=s(m,v),m.return=y,m)}function c(y,m,v,T){var O=v.type;return O===Ns?g(y,m,v.props.children,T,v.key):m!==null&&(m.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&Ep(O)===m.type)?(T=s(m,v.props),T.ref=Eo(y,m,v),T.return=y,T):(T=ki(v.type,v.key,v.props,null,y.mode,T),T.ref=Eo(y,m,v),T.return=y,T)}function f(y,m,v,T){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=Su(v,y.mode,T),m.return=y,m):(m=s(m,v.children||[]),m.return=y,m)}function g(y,m,v,T,O){return m===null||m.tag!==7?(m=Qr(v,y.mode,T,O),m.return=y,m):(m=s(m,v),m.return=y,m)}function S(y,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=wu(""+m,y.mode,v),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Gl:return v=ki(m.type,m.key,m.props,null,y.mode,v),v.ref=Eo(y,null,m),v.return=y,v;case bs:return m=Su(m,y.mode,v),m.return=y,m;case rr:var T=m._init;return S(y,T(m._payload),v)}if(Lo(m)||bo(m))return m=Qr(m,y.mode,v,null),m.return=y,m;si(y,m)}return null}function b(y,m,v,T){var O=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return O!==null?null:u(y,m,""+v,T);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Gl:return v.key===O?c(y,m,v,T):null;case bs:return v.key===O?f(y,m,v,T):null;case rr:return O=v._init,b(y,m,O(v._payload),T)}if(Lo(v)||bo(v))return O!==null?null:g(y,m,v,T,null);si(y,v)}return null}function E(y,m,v,T,O){if(typeof T=="string"&&T!==""||typeof T=="number")return y=y.get(v)||null,u(m,y,""+T,O);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Gl:return y=y.get(T.key===null?v:T.key)||null,c(m,y,T,O);case bs:return y=y.get(T.key===null?v:T.key)||null,f(m,y,T,O);case rr:var F=T._init;return E(y,m,v,F(T._payload),O)}if(Lo(T)||bo(T))return y=y.get(v)||null,g(m,y,T,O,null);si(m,T)}return null}function j(y,m,v,T){for(var O=null,F=null,$=m,z=m=0,ue=null;$!==null&&z<v.length;z++){$.index>z?(ue=$,$=null):ue=$.sibling;var X=b(y,$,v[z],T);if(X===null){$===null&&($=ue);break}e&&$&&X.alternate===null&&t(y,$),m=o(X,m,z),F===null?O=X:F.sibling=X,F=X,$=ue}if(z===v.length)return n(y,$),Pe&&Fr(y,z),O;if($===null){for(;z<v.length;z++)$=S(y,v[z],T),$!==null&&(m=o($,m,z),F===null?O=$:F.sibling=$,F=$);return Pe&&Fr(y,z),O}for($=r(y,$);z<v.length;z++)ue=E($,y,z,v[z],T),ue!==null&&(e&&ue.alternate!==null&&$.delete(ue.key===null?z:ue.key),m=o(ue,m,z),F===null?O=ue:F.sibling=ue,F=ue);return e&&$.forEach(function(me){return t(y,me)}),Pe&&Fr(y,z),O}function k(y,m,v,T){var O=bo(v);if(typeof O!="function")throw Error(I(150));if(v=O.call(v),v==null)throw Error(I(151));for(var F=O=null,$=m,z=m=0,ue=null,X=v.next();$!==null&&!X.done;z++,X=v.next()){$.index>z?(ue=$,$=null):ue=$.sibling;var me=b(y,$,X.value,T);if(me===null){$===null&&($=ue);break}e&&$&&me.alternate===null&&t(y,$),m=o(me,m,z),F===null?O=me:F.sibling=me,F=me,$=ue}if(X.done)return n(y,$),Pe&&Fr(y,z),O;if($===null){for(;!X.done;z++,X=v.next())X=S(y,X.value,T),X!==null&&(m=o(X,m,z),F===null?O=X:F.sibling=X,F=X);return Pe&&Fr(y,z),O}for($=r(y,$);!X.done;z++,X=v.next())X=E($,y,z,X.value,T),X!==null&&(e&&X.alternate!==null&&$.delete(X.key===null?z:X.key),m=o(X,m,z),F===null?O=X:F.sibling=X,F=X);return e&&$.forEach(function(qe){return t(y,qe)}),Pe&&Fr(y,z),O}function q(y,m,v,T){if(typeof v=="object"&&v!==null&&v.type===Ns&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Gl:e:{for(var O=v.key,F=m;F!==null;){if(F.key===O){if(O=v.type,O===Ns){if(F.tag===7){n(y,F.sibling),m=s(F,v.props.children),m.return=y,y=m;break e}}else if(F.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&Ep(O)===F.type){n(y,F.sibling),m=s(F,v.props),m.ref=Eo(y,F,v),m.return=y,y=m;break e}n(y,F);break}else t(y,F);F=F.sibling}v.type===Ns?(m=Qr(v.props.children,y.mode,T,v.key),m.return=y,y=m):(T=ki(v.type,v.key,v.props,null,y.mode,T),T.ref=Eo(y,m,v),T.return=y,y=T)}return l(y);case bs:e:{for(F=v.key;m!==null;){if(m.key===F)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(y,m.sibling),m=s(m,v.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else t(y,m);m=m.sibling}m=Su(v,y.mode,T),m.return=y,y=m}return l(y);case rr:return F=v._init,q(y,m,F(v._payload),T)}if(Lo(v))return j(y,m,v,T);if(bo(v))return k(y,m,v,T);si(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(y,m.sibling),m=s(m,v),m.return=y,y=m):(n(y,m),m=wu(v,y.mode,T),m.return=y,y=m),l(y)):n(y,m)}return q}var Gs=qh(!0),Xh=qh(!1),Wi=Cr(null),Hi=null,Ps=null,ld=null;function id(){ld=Ps=Hi=null}function ad(e){var t=Wi.current;Te(Wi),e._currentValue=t}function dc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function $s(e,t){Hi=e,ld=Ps=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pt=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(ld!==e)if(e={context:e,memoizedValue:t,next:null},Ps===null){if(Hi===null)throw Error(I(308));Ps=e,Hi.dependencies={lanes:0,firstContext:e}}else Ps=Ps.next=e;return t}var Wr=null;function ud(e){Wr===null?Wr=[e]:Wr.push(e)}function Zh(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,ud(t)):(n.next=s.next,s.next=n),t.interleaved=n,$n(e,r)}function $n(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var sr=!1;function cd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,$n(e,n)}return s=r.interleaved,s===null?(t.next=t,ud(r)):(t.next=s.next,s.next=t),r.interleaved=t,$n(e,n)}function xi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Qc(e,n)}}function Rp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=l:o=o.next=l,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vi(e,t,n,r){var s=e.updateQueue;sr=!1;var o=s.firstBaseUpdate,l=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var c=u,f=c.next;c.next=null,l===null?o=f:l.next=f,l=c;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==l&&(u===null?g.firstBaseUpdate=f:u.next=f,g.lastBaseUpdate=c))}if(o!==null){var S=s.baseState;l=0,g=f=c=null,u=o;do{var b=u.lane,E=u.eventTime;if((r&b)===b){g!==null&&(g=g.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var j=e,k=u;switch(b=t,E=n,k.tag){case 1:if(j=k.payload,typeof j=="function"){S=j.call(E,S,b);break e}S=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=k.payload,b=typeof j=="function"?j.call(E,S,b):j,b==null)break e;S=Le({},S,b);break e;case 2:sr=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,b=s.effects,b===null?s.effects=[u]:b.push(u))}else E={eventTime:E,lane:b,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(f=g=E,c=S):g=g.next=E,l|=b;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;b=u,u=b.next,b.next=null,s.lastBaseUpdate=b,s.shared.pending=null}}while(!0);if(g===null&&(c=S),s.baseState=c,s.firstBaseUpdate=f,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Zr|=l,e.lanes=l,e.memoizedState=S}}function _p(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(I(191,s));s.call(r)}}}var bl={},Nn=Cr(bl),cl=Cr(bl),dl=Cr(bl);function Hr(e){if(e===bl)throw Error(I(174));return e}function dd(e,t){switch(je(dl,t),je(cl,e),je(Nn,bl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vu(t,e)}Te(Nn),je(Nn,t)}function Ys(){Te(Nn),Te(cl),Te(dl)}function tg(e){Hr(dl.current);var t=Hr(Nn.current),n=Vu(t,e.type);t!==n&&(je(cl,e),je(Nn,n))}function fd(e){cl.current===e&&(Te(Nn),Te(cl))}var Ie=Cr(0);function Ki(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var mu=[];function pd(){for(var e=0;e<mu.length;e++)mu[e]._workInProgressVersionPrimary=null;mu.length=0}var vi=Wn.ReactCurrentDispatcher,hu=Wn.ReactCurrentBatchConfig,Xr=0,De=null,Qe=null,rt=null,Gi=!1,Go=!1,fl=0,hv=0;function gt(){throw Error(I(321))}function md(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!dn(e[n],t[n]))return!1;return!0}function hd(e,t,n,r,s,o){if(Xr=o,De=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,vi.current=e===null||e.memoizedState===null?vv:wv,e=n(r,s),Go){o=0;do{if(Go=!1,fl=0,25<=o)throw Error(I(301));o+=1,rt=Qe=null,t.updateQueue=null,vi.current=Sv,e=n(r,s)}while(Go)}if(vi.current=Yi,t=Qe!==null&&Qe.next!==null,Xr=0,rt=Qe=De=null,Gi=!1,t)throw Error(I(300));return e}function gd(){var e=fl!==0;return fl=0,e}function vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?De.memoizedState=rt=e:rt=rt.next=e,rt}function en(){if(Qe===null){var e=De.alternate;e=e!==null?e.memoizedState:null}else e=Qe.next;var t=rt===null?De.memoizedState:rt.next;if(t!==null)rt=t,Qe=e;else{if(e===null)throw Error(I(310));Qe=e,e={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},rt===null?De.memoizedState=rt=e:rt=rt.next=e}return rt}function pl(e,t){return typeof t=="function"?t(e):t}function gu(e){var t=en(),n=t.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=e;var r=Qe,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var l=s.next;s.next=o.next,o.next=l}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var u=l=null,c=null,f=o;do{var g=f.lane;if((Xr&g)===g)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:e(r,f.action);else{var S={lane:g,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(u=c=S,l=r):c=c.next=S,De.lanes|=g,Zr|=g}f=f.next}while(f!==null&&f!==o);c===null?l=r:c.next=u,dn(r,t.memoizedState)||(Pt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,De.lanes|=o,Zr|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function yu(e){var t=en(),n=t.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do o=e(o,l.action),l=l.next;while(l!==s);dn(o,t.memoizedState)||(Pt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ng(){}function rg(e,t){var n=De,r=en(),s=t(),o=!dn(r.memoizedState,s);if(o&&(r.memoizedState=s,Pt=!0),r=r.queue,yd(lg.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||rt!==null&&rt.memoizedState.tag&1){if(n.flags|=2048,ml(9,og.bind(null,n,r,s,t),void 0,null),st===null)throw Error(I(349));Xr&30||sg(n,t,s)}return s}function sg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function og(e,t,n,r){t.value=n,t.getSnapshot=r,ig(t)&&ag(e)}function lg(e,t,n){return n(function(){ig(t)&&ag(e)})}function ig(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!dn(e,n)}catch{return!0}}function ag(e){var t=$n(e,1);t!==null&&cn(t,e,1,-1)}function Tp(e){var t=vn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:e},t.queue=e,e=e.dispatch=xv.bind(null,De,e),[t.memoizedState,e]}function ml(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ug(){return en().memoizedState}function wi(e,t,n,r){var s=vn();De.flags|=e,s.memoizedState=ml(1|t,n,void 0,r===void 0?null:r)}function fa(e,t,n,r){var s=en();r=r===void 0?null:r;var o=void 0;if(Qe!==null){var l=Qe.memoizedState;if(o=l.destroy,r!==null&&md(r,l.deps)){s.memoizedState=ml(t,n,o,r);return}}De.flags|=e,s.memoizedState=ml(1|t,n,o,r)}function Pp(e,t){return wi(8390656,8,e,t)}function yd(e,t){return fa(2048,8,e,t)}function cg(e,t){return fa(4,2,e,t)}function dg(e,t){return fa(4,4,e,t)}function fg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pg(e,t,n){return n=n!=null?n.concat([e]):null,fa(4,4,fg.bind(null,t,e),n)}function xd(){}function mg(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&md(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function hg(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&md(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function gg(e,t,n){return Xr&21?(dn(n,t)||(n=Sh(),De.lanes|=n,Zr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pt=!0),e.memoizedState=n)}function gv(e,t){var n=we;we=n!==0&&4>n?n:4,e(!0);var r=hu.transition;hu.transition={};try{e(!1),t()}finally{we=n,hu.transition=r}}function yg(){return en().memoizedState}function yv(e,t,n){var r=gr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xg(e))vg(t,n);else if(n=Zh(e,t,n,r),n!==null){var s=Ct();cn(n,e,r,s),wg(n,t,r)}}function xv(e,t,n){var r=gr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xg(e))vg(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var l=t.lastRenderedState,u=o(l,n);if(s.hasEagerState=!0,s.eagerState=u,dn(u,l)){var c=t.interleaved;c===null?(s.next=s,ud(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Zh(e,t,s,r),n!==null&&(s=Ct(),cn(n,e,r,s),wg(n,t,r))}}function xg(e){var t=e.alternate;return e===De||t!==null&&t===De}function vg(e,t){Go=Gi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function wg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Qc(e,n)}}var Yi={readContext:Zt,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},vv={readContext:Zt,useCallback:function(e,t){return vn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:Pp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,wi(4194308,4,fg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return wi(4194308,4,e,t)},useInsertionEffect:function(e,t){return wi(4,2,e,t)},useMemo:function(e,t){var n=vn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=yv.bind(null,De,e),[r.memoizedState,e]},useRef:function(e){var t=vn();return e={current:e},t.memoizedState=e},useState:Tp,useDebugValue:xd,useDeferredValue:function(e){return vn().memoizedState=e},useTransition:function(){var e=Tp(!1),t=e[0];return e=gv.bind(null,e[1]),vn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=De,s=vn();if(Pe){if(n===void 0)throw Error(I(407));n=n()}else{if(n=t(),st===null)throw Error(I(349));Xr&30||sg(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Pp(lg.bind(null,r,o,e),[e]),r.flags|=2048,ml(9,og.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vn(),t=st.identifierPrefix;if(Pe){var n=On,r=Ln;n=(r&~(1<<32-un(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=fl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=hv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wv={readContext:Zt,useCallback:mg,useContext:Zt,useEffect:yd,useImperativeHandle:pg,useInsertionEffect:cg,useLayoutEffect:dg,useMemo:hg,useReducer:gu,useRef:ug,useState:function(){return gu(pl)},useDebugValue:xd,useDeferredValue:function(e){var t=en();return gg(t,Qe.memoizedState,e)},useTransition:function(){var e=gu(pl)[0],t=en().memoizedState;return[e,t]},useMutableSource:ng,useSyncExternalStore:rg,useId:yg,unstable_isNewReconciler:!1},Sv={readContext:Zt,useCallback:mg,useContext:Zt,useEffect:yd,useImperativeHandle:pg,useInsertionEffect:cg,useLayoutEffect:dg,useMemo:hg,useReducer:yu,useRef:ug,useState:function(){return yu(pl)},useDebugValue:xd,useDeferredValue:function(e){var t=en();return Qe===null?t.memoizedState=e:gg(t,Qe.memoizedState,e)},useTransition:function(){var e=yu(pl)[0],t=en().memoizedState;return[e,t]},useMutableSource:ng,useSyncExternalStore:rg,useId:yg,unstable_isNewReconciler:!1};function sn(e,t){if(e&&e.defaultProps){t=Le({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function fc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Le({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pa={isMounted:function(e){return(e=e._reactInternals)?os(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ct(),s=gr(e),o=Mn(r,s);o.payload=t,n!=null&&(o.callback=n),t=mr(e,o,s),t!==null&&(cn(t,e,s,r),xi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ct(),s=gr(e),o=Mn(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=mr(e,o,s),t!==null&&(cn(t,e,s,r),xi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ct(),r=gr(e),s=Mn(n,r);s.tag=2,t!=null&&(s.callback=t),t=mr(e,s,r),t!==null&&(cn(t,e,r,n),xi(t,e,r))}};function Ap(e,t,n,r,s,o,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,l):t.prototype&&t.prototype.isPureReactComponent?!ll(n,r)||!ll(s,o):!0}function Sg(e,t,n){var r=!1,s=br,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=It(t)?Jr:vt.current,r=t.contextTypes,o=(r=r!=null)?Vs(e,s):br),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pa,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ip(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function pc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},cd(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=It(t)?Jr:vt.current,s.context=Vs(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(fc(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&pa.enqueueReplaceState(s,s.state,null),Vi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qs(e,t){try{var n="",r=t;do n+=Qy(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function xu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function mc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bv=typeof WeakMap=="function"?WeakMap:Map;function bg(e,t,n){n=Mn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ji||(Ji=!0,kc=r),mc(e,t)},n}function Ng(e,t,n){n=Mn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){mc(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){mc(e,t),typeof r!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Dp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bv;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Ov.bind(null,e,t,n),t.then(e,e))}function Lp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Op(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Mn(-1,1),t.tag=2,mr(n,t,1))),n.lanes|=1),e)}var Nv=Wn.ReactCurrentOwner,Pt=!1;function jt(e,t,n,r){t.child=e===null?Xh(t,null,n,r):Gs(t,e.child,n,r)}function Mp(e,t,n,r,s){n=n.render;var o=t.ref;return $s(t,s),r=hd(e,t,n,r,o,s),n=gd(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bn(e,t,s)):(Pe&&n&&rd(t),t.flags|=1,jt(e,t,r,s),t.child)}function Up(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!Cd(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,kg(e,t,o,r,s)):(e=ki(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var l=o.memoizedProps;if(n=n.compare,n=n!==null?n:ll,n(l,r)&&e.ref===t.ref)return Bn(e,t,s)}return t.flags|=1,e=yr(o,r),e.ref=t.ref,e.return=t,t.child=e}function kg(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(ll(o,r)&&e.ref===t.ref)if(Pt=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(Pt=!0);else return t.lanes=e.lanes,Bn(e,t,s)}return hc(e,t,n,r,s)}function jg(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Is,Ft),Ft|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,je(Is,Ft),Ft|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,je(Is,Ft),Ft|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,je(Is,Ft),Ft|=r;return jt(e,t,s,n),t.child}function Cg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hc(e,t,n,r,s){var o=It(n)?Jr:vt.current;return o=Vs(t,o),$s(t,s),n=hd(e,t,n,r,o,s),r=gd(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bn(e,t,s)):(Pe&&r&&rd(t),t.flags|=1,jt(e,t,n,s),t.child)}function Fp(e,t,n,r,s){if(It(n)){var o=!0;zi(t)}else o=!1;if($s(t,s),t.stateNode===null)Si(e,t),Sg(t,n,r),pc(t,n,r,s),r=!0;else if(e===null){var l=t.stateNode,u=t.memoizedProps;l.props=u;var c=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Zt(f):(f=It(n)?Jr:vt.current,f=Vs(t,f));var g=n.getDerivedStateFromProps,S=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function";S||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||c!==f)&&Ip(t,l,r,f),sr=!1;var b=t.memoizedState;l.state=b,Vi(t,r,l,s),c=t.memoizedState,u!==r||b!==c||At.current||sr?(typeof g=="function"&&(fc(t,n,g,r),c=t.memoizedState),(u=sr||Ap(t,n,u,r,b,c,f))?(S||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),l.props=r,l.state=c,l.context=f,r=u):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,eg(e,t),u=t.memoizedProps,f=t.type===t.elementType?u:sn(t.type,u),l.props=f,S=t.pendingProps,b=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=It(n)?Jr:vt.current,c=Vs(t,c));var E=n.getDerivedStateFromProps;(g=typeof E=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==S||b!==c)&&Ip(t,l,r,c),sr=!1,b=t.memoizedState,l.state=b,Vi(t,r,l,s);var j=t.memoizedState;u!==S||b!==j||At.current||sr?(typeof E=="function"&&(fc(t,n,E,r),j=t.memoizedState),(f=sr||Ap(t,n,f,r,b,j,c)||!1)?(g||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,j,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,j,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=j),l.props=r,l.state=j,l.context=c,r=f):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),r=!1)}return gc(e,t,n,r,o,s)}function gc(e,t,n,r,s,o){Cg(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return s&&kp(t,n,!1),Bn(e,t,o);r=t.stateNode,Nv.current=t;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Gs(t,e.child,null,o),t.child=Gs(t,null,u,o)):jt(e,t,u,o),t.memoizedState=r.state,s&&kp(t,n,!0),t.child}function Eg(e){var t=e.stateNode;t.pendingContext?Np(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Np(e,t.context,!1),dd(e,t.containerInfo)}function zp(e,t,n,r,s){return Ks(),od(s),t.flags|=256,jt(e,t,n,r),t.child}var yc={dehydrated:null,treeContext:null,retryLane:0};function xc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Rg(e,t,n){var r=t.pendingProps,s=Ie.current,o=!1,l=(t.flags&128)!==0,u;if((u=l)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),je(Ie,s&1),e===null)return cc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=ga(l,r,0,null),e=Qr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=xc(n),t.memoizedState=yc,e):vd(t,l));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return kv(e,t,l,r,u,s,n);if(o){o=r.fallback,l=t.mode,s=e.child,u=s.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=yr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?o=yr(u,o):(o=Qr(o,l,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=e.child.memoizedState,l=l===null?xc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=yc,r}return o=e.child,e=o.sibling,r=yr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function vd(e,t){return t=ga({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function oi(e,t,n,r){return r!==null&&od(r),Gs(t,e.child,null,n),e=vd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kv(e,t,n,r,s,o,l){if(n)return t.flags&256?(t.flags&=-257,r=xu(Error(I(422))),oi(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=ga({mode:"visible",children:r.children},s,0,null),o=Qr(o,s,l,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Gs(t,e.child,null,l),t.child.memoizedState=xc(l),t.memoizedState=yc,o);if(!(t.mode&1))return oi(e,t,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(I(419)),r=xu(o,r,void 0),oi(e,t,l,r)}if(u=(l&e.childLanes)!==0,Pt||u){if(r=st,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,$n(e,s),cn(r,e,s,-1))}return jd(),r=xu(Error(I(421))),oi(e,t,l,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Mv.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,zt=pr(s.nextSibling),$t=t,Pe=!0,ln=null,e!==null&&(Qt[Jt++]=Ln,Qt[Jt++]=On,Qt[Jt++]=qr,Ln=e.id,On=e.overflow,qr=t),t=vd(t,r.children),t.flags|=4096,t)}function $p(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),dc(e.return,t,n)}function vu(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function _g(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(jt(e,t,r.children,n),r=Ie.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$p(e,n,t);else if(e.tag===19)$p(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(je(Ie,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ki(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),vu(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ki(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}vu(t,!0,n,null,o);break;case"together":vu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Si(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Zr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(I(153));if(t.child!==null){for(e=t.child,n=yr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=yr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function jv(e,t,n){switch(t.tag){case 3:Eg(t),Ks();break;case 5:tg(t);break;case 1:It(t.type)&&zi(t);break;case 4:dd(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;je(Wi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(je(Ie,Ie.current&1),t.flags|=128,null):n&t.child.childLanes?Rg(e,t,n):(je(Ie,Ie.current&1),e=Bn(e,t,n),e!==null?e.sibling:null);je(Ie,Ie.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _g(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),je(Ie,Ie.current),r)break;return null;case 22:case 23:return t.lanes=0,jg(e,t,n)}return Bn(e,t,n)}var Tg,vc,Pg,Ag;Tg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vc=function(){};Pg=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Hr(Nn.current);var o=null;switch(n){case"input":s=$u(e,s),r=$u(e,r),o=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),o=[];break;case"textarea":s=Hu(e,s),r=Hu(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ui)}Ku(n,r);var l;n=null;for(f in s)if(!r.hasOwnProperty(f)&&s.hasOwnProperty(f)&&s[f]!=null)if(f==="style"){var u=s[f];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Zo.hasOwnProperty(f)?o||(o=[]):(o=o||[]).push(f,null));for(f in r){var c=r[f];if(u=s!=null?s[f]:void 0,r.hasOwnProperty(f)&&c!==u&&(c!=null||u!=null))if(f==="style")if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(o||(o=[]),o.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(o=o||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Zo.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&_e("scroll",e),o||u===c||(o=[])):(o=o||[]).push(f,c))}n&&(o=o||[]).push("style",n);var f=o;(t.updateQueue=f)&&(t.flags|=4)}};Ag=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ro(e,t){if(!Pe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function yt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Cv(e,t,n){var r=t.pendingProps;switch(sd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(t),null;case 1:return It(t.type)&&Fi(),yt(t),null;case 3:return r=t.stateNode,Ys(),Te(At),Te(vt),pd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ri(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ln!==null&&(Ec(ln),ln=null))),vc(e,t),yt(t),null;case 5:fd(t);var s=Hr(dl.current);if(n=t.type,e!==null&&t.stateNode!=null)Pg(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(I(166));return yt(t),null}if(e=Hr(Nn.current),ri(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Sn]=t,r[ul]=o,e=(t.mode&1)!==0,n){case"dialog":_e("cancel",r),_e("close",r);break;case"iframe":case"object":case"embed":_e("load",r);break;case"video":case"audio":for(s=0;s<Mo.length;s++)_e(Mo[s],r);break;case"source":_e("error",r);break;case"img":case"image":case"link":_e("error",r),_e("load",r);break;case"details":_e("toggle",r);break;case"input":Jf(r,o),_e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_e("invalid",r);break;case"textarea":Xf(r,o),_e("invalid",r)}Ku(n,o),s=null;for(var l in o)if(o.hasOwnProperty(l)){var u=o[l];l==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&ni(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&ni(r.textContent,u,e),s=["children",""+u]):Zo.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&_e("scroll",r)}switch(n){case"input":Yl(r),qf(r,o,!0);break;case"textarea":Yl(r),Zf(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ui)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Sn]=t,e[ul]=r,Tg(e,t,!1,!1),t.stateNode=e;e:{switch(l=Gu(n,r),n){case"dialog":_e("cancel",e),_e("close",e),s=r;break;case"iframe":case"object":case"embed":_e("load",e),s=r;break;case"video":case"audio":for(s=0;s<Mo.length;s++)_e(Mo[s],e);s=r;break;case"source":_e("error",e),s=r;break;case"img":case"image":case"link":_e("error",e),_e("load",e),s=r;break;case"details":_e("toggle",e),s=r;break;case"input":Jf(e,r),s=$u(e,r),_e("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),_e("invalid",e);break;case"textarea":Xf(e,r),s=Hu(e,r),_e("invalid",e);break;default:s=r}Ku(n,s),u=s;for(o in u)if(u.hasOwnProperty(o)){var c=u[o];o==="style"?uh(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ih(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&el(e,c):typeof c=="number"&&el(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Zo.hasOwnProperty(o)?c!=null&&o==="onScroll"&&_e("scroll",e):c!=null&&Wc(e,o,c,l))}switch(n){case"input":Yl(e),qf(e,r,!1);break;case"textarea":Yl(e),Zf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Sr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Ms(e,!!r.multiple,o,!1):r.defaultValue!=null&&Ms(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ui)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return yt(t),null;case 6:if(e&&t.stateNode!=null)Ag(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(I(166));if(n=Hr(dl.current),Hr(Nn.current),ri(t)){if(r=t.stateNode,n=t.memoizedProps,r[Sn]=t,(o=r.nodeValue!==n)&&(e=$t,e!==null))switch(e.tag){case 3:ni(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ni(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sn]=t,t.stateNode=r}return yt(t),null;case 13:if(Te(Ie),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pe&&zt!==null&&t.mode&1&&!(t.flags&128))Jh(),Ks(),t.flags|=98560,o=!1;else if(o=ri(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(I(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(I(317));o[Sn]=t}else Ks(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yt(t),o=!1}else ln!==null&&(Ec(ln),ln=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ie.current&1?Je===0&&(Je=3):jd())),t.updateQueue!==null&&(t.flags|=4),yt(t),null);case 4:return Ys(),vc(e,t),e===null&&il(t.stateNode.containerInfo),yt(t),null;case 10:return ad(t.type._context),yt(t),null;case 17:return It(t.type)&&Fi(),yt(t),null;case 19:if(Te(Ie),o=t.memoizedState,o===null)return yt(t),null;if(r=(t.flags&128)!==0,l=o.rendering,l===null)if(r)Ro(o,!1);else{if(Je!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ki(e),l!==null){for(t.flags|=128,Ro(o,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return je(Ie,Ie.current&1|2),t.child}e=e.sibling}o.tail!==null&&Be()>Js&&(t.flags|=128,r=!0,Ro(o,!1),t.lanes=4194304)}else{if(!r)if(e=Ki(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ro(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Pe)return yt(t),null}else 2*Be()-o.renderingStartTime>Js&&n!==1073741824&&(t.flags|=128,r=!0,Ro(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(n=o.last,n!==null?n.sibling=l:t.child=l,o.last=l)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Be(),t.sibling=null,n=Ie.current,je(Ie,r?n&1|2:n&1),t):(yt(t),null);case 22:case 23:return kd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ft&1073741824&&(yt(t),t.subtreeFlags&6&&(t.flags|=8192)):yt(t),null;case 24:return null;case 25:return null}throw Error(I(156,t.tag))}function Ev(e,t){switch(sd(t),t.tag){case 1:return It(t.type)&&Fi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ys(),Te(At),Te(vt),pd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return fd(t),null;case 13:if(Te(Ie),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(I(340));Ks()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Te(Ie),null;case 4:return Ys(),null;case 10:return ad(t.type._context),null;case 22:case 23:return kd(),null;case 24:return null;default:return null}}var li=!1,xt=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,G=null;function As(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function wc(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var Bp=!1;function _v(e,t){if(rc=Li,e=Mh(),nd(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var l=0,u=-1,c=-1,f=0,g=0,S=e,b=null;t:for(;;){for(var E;S!==n||s!==0&&S.nodeType!==3||(u=l+s),S!==o||r!==0&&S.nodeType!==3||(c=l+r),S.nodeType===3&&(l+=S.nodeValue.length),(E=S.firstChild)!==null;)b=S,S=E;for(;;){if(S===e)break t;if(b===n&&++f===s&&(u=l),b===o&&++g===r&&(c=l),(E=S.nextSibling)!==null)break;S=b,b=S.parentNode}S=E}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(sc={focusedElem:e,selectionRange:n},Li=!1,G=t;G!==null;)if(t=G,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,G=e;else for(;G!==null;){t=G;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var k=j.memoizedProps,q=j.memoizedState,y=t.stateNode,m=y.getSnapshotBeforeUpdate(t.elementType===t.type?k:sn(t.type,k),q);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(I(163))}}catch(T){Ue(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,G=e;break}G=t.return}return j=Bp,Bp=!1,j}function Yo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&wc(t,n,o)}s=s.next}while(s!==r)}}function ma(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Sc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ig(e){var t=e.alternate;t!==null&&(e.alternate=null,Ig(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sn],delete t[ul],delete t[ic],delete t[dv],delete t[fv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Dg(e){return e.tag===5||e.tag===3||e.tag===4}function Wp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Dg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ui));else if(r!==4&&(e=e.child,e!==null))for(bc(e,t,n),e=e.sibling;e!==null;)bc(e,t,n),e=e.sibling}function Nc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Nc(e,t,n),e=e.sibling;e!==null;)Nc(e,t,n),e=e.sibling}var ct=null,on=!1;function tr(e,t,n){for(n=n.child;n!==null;)Lg(e,t,n),n=n.sibling}function Lg(e,t,n){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(la,n)}catch{}switch(n.tag){case 5:xt||As(n,t);case 6:var r=ct,s=on;ct=null,tr(e,t,n),ct=r,on=s,ct!==null&&(on?(e=ct,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ct.removeChild(n.stateNode));break;case 18:ct!==null&&(on?(e=ct,n=n.stateNode,e.nodeType===8?fu(e.parentNode,n):e.nodeType===1&&fu(e,n),sl(e)):fu(ct,n.stateNode));break;case 4:r=ct,s=on,ct=n.stateNode.containerInfo,on=!0,tr(e,t,n),ct=r,on=s;break;case 0:case 11:case 14:case 15:if(!xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&wc(n,t,l),s=s.next}while(s!==r)}tr(e,t,n);break;case 1:if(!xt&&(As(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ue(n,t,u)}tr(e,t,n);break;case 21:tr(e,t,n);break;case 22:n.mode&1?(xt=(r=xt)||n.memoizedState!==null,tr(e,t,n),xt=r):tr(e,t,n);break;default:tr(e,t,n)}}function Hp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rv),t.forEach(function(r){var s=Uv.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,l=t,u=l;e:for(;u!==null;){switch(u.tag){case 5:ct=u.stateNode,on=!1;break e;case 3:ct=u.stateNode.containerInfo,on=!0;break e;case 4:ct=u.stateNode.containerInfo,on=!0;break e}u=u.return}if(ct===null)throw Error(I(160));Lg(o,l,s),ct=null,on=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(f){Ue(s,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Og(t,e),t=t.sibling}function Og(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),xn(e),r&4){try{Yo(3,e,e.return),ma(3,e)}catch(k){Ue(e,e.return,k)}try{Yo(5,e,e.return)}catch(k){Ue(e,e.return,k)}}break;case 1:rn(t,e),xn(e),r&512&&n!==null&&As(n,n.return);break;case 5:if(rn(t,e),xn(e),r&512&&n!==null&&As(n,n.return),e.flags&32){var s=e.stateNode;try{el(s,"")}catch(k){Ue(e,e.return,k)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,l=n!==null?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&sh(s,o),Gu(u,l);var f=Gu(u,o);for(l=0;l<c.length;l+=2){var g=c[l],S=c[l+1];g==="style"?uh(s,S):g==="dangerouslySetInnerHTML"?ih(s,S):g==="children"?el(s,S):Wc(s,g,S,f)}switch(u){case"input":Bu(s,o);break;case"textarea":oh(s,o);break;case"select":var b=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var E=o.value;E!=null?Ms(s,!!o.multiple,E,!1):b!==!!o.multiple&&(o.defaultValue!=null?Ms(s,!!o.multiple,o.defaultValue,!0):Ms(s,!!o.multiple,o.multiple?[]:"",!1))}s[ul]=o}catch(k){Ue(e,e.return,k)}}break;case 6:if(rn(t,e),xn(e),r&4){if(e.stateNode===null)throw Error(I(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(k){Ue(e,e.return,k)}}break;case 3:if(rn(t,e),xn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sl(t.containerInfo)}catch(k){Ue(e,e.return,k)}break;case 4:rn(t,e),xn(e);break;case 13:rn(t,e),xn(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(bd=Be())),r&4&&Hp(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(xt=(f=xt)||g,rn(t,e),xt=f):rn(t,e),xn(e),r&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!g&&e.mode&1)for(G=e,g=e.child;g!==null;){for(S=G=g;G!==null;){switch(b=G,E=b.child,b.tag){case 0:case 11:case 14:case 15:Yo(4,b,b.return);break;case 1:As(b,b.return);var j=b.stateNode;if(typeof j.componentWillUnmount=="function"){r=b,n=b.return;try{t=r,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(k){Ue(r,n,k)}}break;case 5:As(b,b.return);break;case 22:if(b.memoizedState!==null){Kp(S);continue}}E!==null?(E.return=b,G=E):Kp(S)}g=g.sibling}e:for(g=null,S=e;;){if(S.tag===5){if(g===null){g=S;try{s=S.stateNode,f?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=S.stateNode,c=S.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=ah("display",l))}catch(k){Ue(e,e.return,k)}}}else if(S.tag===6){if(g===null)try{S.stateNode.nodeValue=f?"":S.memoizedProps}catch(k){Ue(e,e.return,k)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;g===S&&(g=null),S=S.return}g===S&&(g=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:rn(t,e),xn(e),r&4&&Hp(e);break;case 21:break;default:rn(t,e),xn(e)}}function xn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Dg(n)){var r=n;break e}n=n.return}throw Error(I(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(el(s,""),r.flags&=-33);var o=Wp(e);Nc(e,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,u=Wp(e);bc(e,u,l);break;default:throw Error(I(161))}}catch(c){Ue(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Tv(e,t,n){G=e,Mg(e)}function Mg(e,t,n){for(var r=(e.mode&1)!==0;G!==null;){var s=G,o=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||li;if(!l){var u=s.alternate,c=u!==null&&u.memoizedState!==null||xt;u=li;var f=xt;if(li=l,(xt=c)&&!f)for(G=s;G!==null;)l=G,c=l.child,l.tag===22&&l.memoizedState!==null?Gp(s):c!==null?(c.return=l,G=c):Gp(s);for(;o!==null;)G=o,Mg(o),o=o.sibling;G=s,li=u,xt=f}Vp(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,G=o):Vp(e)}}function Vp(e){for(;G!==null;){var t=G;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:xt||ma(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!xt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:sn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&_p(t,o,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}_p(t,l,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var g=f.memoizedState;if(g!==null){var S=g.dehydrated;S!==null&&sl(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(I(163))}xt||t.flags&512&&Sc(t)}catch(b){Ue(t,t.return,b)}}if(t===e){G=null;break}if(n=t.sibling,n!==null){n.return=t.return,G=n;break}G=t.return}}function Kp(e){for(;G!==null;){var t=G;if(t===e){G=null;break}var n=t.sibling;if(n!==null){n.return=t.return,G=n;break}G=t.return}}function Gp(e){for(;G!==null;){var t=G;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ma(4,t)}catch(c){Ue(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ue(t,s,c)}}var o=t.return;try{Sc(t)}catch(c){Ue(t,o,c)}break;case 5:var l=t.return;try{Sc(t)}catch(c){Ue(t,l,c)}}}catch(c){Ue(t,t.return,c)}if(t===e){G=null;break}var u=t.sibling;if(u!==null){u.return=t.return,G=u;break}G=t.return}}var Pv=Math.ceil,Qi=Wn.ReactCurrentDispatcher,wd=Wn.ReactCurrentOwner,Xt=Wn.ReactCurrentBatchConfig,pe=0,st=null,Ge=null,dt=0,Ft=0,Is=Cr(0),Je=0,hl=null,Zr=0,ha=0,Sd=0,Qo=null,Tt=null,bd=0,Js=1/0,In=null,Ji=!1,kc=null,hr=null,ii=!1,ur=null,qi=0,Jo=0,jc=null,bi=-1,Ni=0;function Ct(){return pe&6?Be():bi!==-1?bi:bi=Be()}function gr(e){return e.mode&1?pe&2&&dt!==0?dt&-dt:mv.transition!==null?(Ni===0&&(Ni=Sh()),Ni):(e=we,e!==0||(e=window.event,e=e===void 0?16:Rh(e.type)),e):1}function cn(e,t,n,r){if(50<Jo)throw Jo=0,jc=null,Error(I(185));vl(e,n,r),(!(pe&2)||e!==st)&&(e===st&&(!(pe&2)&&(ha|=n),Je===4&&ir(e,dt)),Dt(e,r),n===1&&pe===0&&!(t.mode&1)&&(Js=Be()+500,da&&Er()))}function Dt(e,t){var n=e.callbackNode;mx(e,t);var r=Di(e,e===st?dt:0);if(r===0)n!==null&&np(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&np(n),t===1)e.tag===0?pv(Yp.bind(null,e)):Gh(Yp.bind(null,e)),uv(function(){!(pe&6)&&Er()}),n=null;else{switch(bh(r)){case 1:n=Yc;break;case 4:n=vh;break;case 16:n=Ii;break;case 536870912:n=wh;break;default:n=Ii}n=Vg(n,Ug.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ug(e,t){if(bi=-1,Ni=0,pe&6)throw Error(I(327));var n=e.callbackNode;if(Bs()&&e.callbackNode!==n)return null;var r=Di(e,e===st?dt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Xi(e,r);else{t=r;var s=pe;pe|=2;var o=zg();(st!==e||dt!==t)&&(In=null,Js=Be()+500,Yr(e,t));do try{Dv();break}catch(u){Fg(e,u)}while(!0);id(),Qi.current=o,pe=s,Ge!==null?t=0:(st=null,dt=0,t=Je)}if(t!==0){if(t===2&&(s=Xu(e),s!==0&&(r=s,t=Cc(e,s))),t===1)throw n=hl,Yr(e,0),ir(e,r),Dt(e,Be()),n;if(t===6)ir(e,r);else{if(s=e.current.alternate,!(r&30)&&!Av(s)&&(t=Xi(e,r),t===2&&(o=Xu(e),o!==0&&(r=o,t=Cc(e,o))),t===1))throw n=hl,Yr(e,0),ir(e,r),Dt(e,Be()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(I(345));case 2:zr(e,Tt,In);break;case 3:if(ir(e,r),(r&130023424)===r&&(t=bd+500-Be(),10<t)){if(Di(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ct(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=lc(zr.bind(null,e,Tt,In),t);break}zr(e,Tt,In);break;case 4:if(ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var l=31-un(r);o=1<<l,l=t[l],l>s&&(s=l),r&=~o}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pv(r/1960))-r,10<r){e.timeoutHandle=lc(zr.bind(null,e,Tt,In),r);break}zr(e,Tt,In);break;case 5:zr(e,Tt,In);break;default:throw Error(I(329))}}}return Dt(e,Be()),e.callbackNode===n?Ug.bind(null,e):null}function Cc(e,t){var n=Qo;return e.current.memoizedState.isDehydrated&&(Yr(e,t).flags|=256),e=Xi(e,t),e!==2&&(t=Tt,Tt=n,t!==null&&Ec(t)),e}function Ec(e){Tt===null?Tt=e:Tt.push.apply(Tt,e)}function Av(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!dn(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ir(e,t){for(t&=~Sd,t&=~ha,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-un(t),r=1<<n;e[n]=-1,t&=~r}}function Yp(e){if(pe&6)throw Error(I(327));Bs();var t=Di(e,0);if(!(t&1))return Dt(e,Be()),null;var n=Xi(e,t);if(e.tag!==0&&n===2){var r=Xu(e);r!==0&&(t=r,n=Cc(e,r))}if(n===1)throw n=hl,Yr(e,0),ir(e,t),Dt(e,Be()),n;if(n===6)throw Error(I(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zr(e,Tt,In),Dt(e,Be()),null}function Nd(e,t){var n=pe;pe|=1;try{return e(t)}finally{pe=n,pe===0&&(Js=Be()+500,da&&Er())}}function es(e){ur!==null&&ur.tag===0&&!(pe&6)&&Bs();var t=pe;pe|=1;var n=Xt.transition,r=we;try{if(Xt.transition=null,we=1,e)return e()}finally{we=r,Xt.transition=n,pe=t,!(pe&6)&&Er()}}function kd(){Ft=Is.current,Te(Is)}function Yr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,av(n)),Ge!==null)for(n=Ge.return;n!==null;){var r=n;switch(sd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fi();break;case 3:Ys(),Te(At),Te(vt),pd();break;case 5:fd(r);break;case 4:Ys();break;case 13:Te(Ie);break;case 19:Te(Ie);break;case 10:ad(r.type._context);break;case 22:case 23:kd()}n=n.return}if(st=e,Ge=e=yr(e.current,null),dt=Ft=t,Je=0,hl=null,Sd=ha=Zr=0,Tt=Qo=null,Wr!==null){for(t=0;t<Wr.length;t++)if(n=Wr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var l=o.next;o.next=s,r.next=l}n.pending=r}Wr=null}return e}function Fg(e,t){do{var n=Ge;try{if(id(),vi.current=Yi,Gi){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Gi=!1}if(Xr=0,rt=Qe=De=null,Go=!1,fl=0,wd.current=null,n===null||n.return===null){Je=1,hl=t,Ge=null;break}e:{var o=e,l=n.return,u=n,c=t;if(t=dt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,g=u,S=g.tag;if(!(g.mode&1)&&(S===0||S===11||S===15)){var b=g.alternate;b?(g.updateQueue=b.updateQueue,g.memoizedState=b.memoizedState,g.lanes=b.lanes):(g.updateQueue=null,g.memoizedState=null)}var E=Lp(l);if(E!==null){E.flags&=-257,Op(E,l,u,o,t),E.mode&1&&Dp(o,f,t),t=E,c=f;var j=t.updateQueue;if(j===null){var k=new Set;k.add(c),t.updateQueue=k}else j.add(c);break e}else{if(!(t&1)){Dp(o,f,t),jd();break e}c=Error(I(426))}}else if(Pe&&u.mode&1){var q=Lp(l);if(q!==null){!(q.flags&65536)&&(q.flags|=256),Op(q,l,u,o,t),od(Qs(c,u));break e}}o=c=Qs(c,u),Je!==4&&(Je=2),Qo===null?Qo=[o]:Qo.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=bg(o,c,t);Rp(o,y);break e;case 1:u=c;var m=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(hr===null||!hr.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t;var T=Ng(o,u,t);Rp(o,T);break e}}o=o.return}while(o!==null)}Bg(n)}catch(O){t=O,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function zg(){var e=Qi.current;return Qi.current=Yi,e===null?Yi:e}function jd(){(Je===0||Je===3||Je===2)&&(Je=4),st===null||!(Zr&268435455)&&!(ha&268435455)||ir(st,dt)}function Xi(e,t){var n=pe;pe|=2;var r=zg();(st!==e||dt!==t)&&(In=null,Yr(e,t));do try{Iv();break}catch(s){Fg(e,s)}while(!0);if(id(),pe=n,Qi.current=r,Ge!==null)throw Error(I(261));return st=null,dt=0,Je}function Iv(){for(;Ge!==null;)$g(Ge)}function Dv(){for(;Ge!==null&&!ox();)$g(Ge)}function $g(e){var t=Hg(e.alternate,e,Ft);e.memoizedProps=e.pendingProps,t===null?Bg(e):Ge=t,wd.current=null}function Bg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ev(n,t),n!==null){n.flags&=32767,Ge=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,Ge=null;return}}else if(n=Cv(n,t,Ft),n!==null){Ge=n;return}if(t=t.sibling,t!==null){Ge=t;return}Ge=t=e}while(t!==null);Je===0&&(Je=5)}function zr(e,t,n){var r=we,s=Xt.transition;try{Xt.transition=null,we=1,Lv(e,t,n,r)}finally{Xt.transition=s,we=r}return null}function Lv(e,t,n,r){do Bs();while(ur!==null);if(pe&6)throw Error(I(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(I(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(hx(e,o),e===st&&(Ge=st=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ii||(ii=!0,Vg(Ii,function(){return Bs(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Xt.transition,Xt.transition=null;var l=we;we=1;var u=pe;pe|=4,wd.current=null,_v(e,n),Og(n,e),tv(sc),Li=!!rc,sc=rc=null,e.current=n,Tv(n),lx(),pe=u,we=l,Xt.transition=o}else e.current=n;if(ii&&(ii=!1,ur=e,qi=s),o=e.pendingLanes,o===0&&(hr=null),ux(n.stateNode),Dt(e,Be()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ji)throw Ji=!1,e=kc,kc=null,e;return qi&1&&e.tag!==0&&Bs(),o=e.pendingLanes,o&1?e===jc?Jo++:(Jo=0,jc=e):Jo=0,Er(),null}function Bs(){if(ur!==null){var e=bh(qi),t=Xt.transition,n=we;try{if(Xt.transition=null,we=16>e?16:e,ur===null)var r=!1;else{if(e=ur,ur=null,qi=0,pe&6)throw Error(I(331));var s=pe;for(pe|=4,G=e.current;G!==null;){var o=G,l=o.child;if(G.flags&16){var u=o.deletions;if(u!==null){for(var c=0;c<u.length;c++){var f=u[c];for(G=f;G!==null;){var g=G;switch(g.tag){case 0:case 11:case 15:Yo(8,g,o)}var S=g.child;if(S!==null)S.return=g,G=S;else for(;G!==null;){g=G;var b=g.sibling,E=g.return;if(Ig(g),g===f){G=null;break}if(b!==null){b.return=E,G=b;break}G=E}}}var j=o.alternate;if(j!==null){var k=j.child;if(k!==null){j.child=null;do{var q=k.sibling;k.sibling=null,k=q}while(k!==null)}}G=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,G=l;else e:for(;G!==null;){if(o=G,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Yo(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,G=y;break e}G=o.return}}var m=e.current;for(G=m;G!==null;){l=G;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,G=v;else e:for(l=m;G!==null;){if(u=G,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:ma(9,u)}}catch(O){Ue(u,u.return,O)}if(u===l){G=null;break e}var T=u.sibling;if(T!==null){T.return=u.return,G=T;break e}G=u.return}}if(pe=s,Er(),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(la,e)}catch{}r=!0}return r}finally{we=n,Xt.transition=t}}return!1}function Qp(e,t,n){t=Qs(n,t),t=bg(e,t,1),e=mr(e,t,1),t=Ct(),e!==null&&(vl(e,1,t),Dt(e,t))}function Ue(e,t,n){if(e.tag===3)Qp(e,e,n);else for(;t!==null;){if(t.tag===3){Qp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hr===null||!hr.has(r))){e=Qs(n,e),e=Ng(t,e,1),t=mr(t,e,1),e=Ct(),t!==null&&(vl(t,1,e),Dt(t,e));break}}t=t.return}}function Ov(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ct(),e.pingedLanes|=e.suspendedLanes&n,st===e&&(dt&n)===n&&(Je===4||Je===3&&(dt&130023424)===dt&&500>Be()-bd?Yr(e,0):Sd|=n),Dt(e,t)}function Wg(e,t){t===0&&(e.mode&1?(t=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):t=1);var n=Ct();e=$n(e,t),e!==null&&(vl(e,t,n),Dt(e,n))}function Mv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Wg(e,n)}function Uv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(I(314))}r!==null&&r.delete(t),Wg(e,n)}var Hg;Hg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||At.current)Pt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pt=!1,jv(e,t,n);Pt=!!(e.flags&131072)}else Pt=!1,Pe&&t.flags&1048576&&Yh(t,Bi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Si(e,t),e=t.pendingProps;var s=Vs(t,vt.current);$s(t,n),s=hd(null,t,r,e,s,n);var o=gd();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,It(r)?(o=!0,zi(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,cd(t),s.updater=pa,t.stateNode=s,s._reactInternals=t,pc(t,r,e,n),t=gc(null,t,r,!0,o,n)):(t.tag=0,Pe&&o&&rd(t),jt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Si(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=zv(r),e=sn(r,e),s){case 0:t=hc(null,t,r,e,n);break e;case 1:t=Fp(null,t,r,e,n);break e;case 11:t=Mp(null,t,r,e,n);break e;case 14:t=Up(null,t,r,sn(r.type,e),n);break e}throw Error(I(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),hc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Fp(e,t,r,s,n);case 3:e:{if(Eg(t),e===null)throw Error(I(387));r=t.pendingProps,o=t.memoizedState,s=o.element,eg(e,t),Vi(t,r,null,n);var l=t.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Qs(Error(I(423)),t),t=zp(e,t,r,n,s);break e}else if(r!==s){s=Qs(Error(I(424)),t),t=zp(e,t,r,n,s);break e}else for(zt=pr(t.stateNode.containerInfo.firstChild),$t=t,Pe=!0,ln=null,n=Xh(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ks(),r===s){t=Bn(e,t,n);break e}jt(e,t,r,n)}t=t.child}return t;case 5:return tg(t),e===null&&cc(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,l=s.children,oc(r,s)?l=null:o!==null&&oc(r,o)&&(t.flags|=32),Cg(e,t),jt(e,t,l,n),t.child;case 6:return e===null&&cc(t),null;case 13:return Rg(e,t,n);case 4:return dd(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gs(t,null,r,n):jt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Mp(e,t,r,s,n);case 7:return jt(e,t,t.pendingProps,n),t.child;case 8:return jt(e,t,t.pendingProps.children,n),t.child;case 12:return jt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,l=s.value,je(Wi,r._currentValue),r._currentValue=l,o!==null)if(dn(o.value,l)){if(o.children===s.children&&!At.current){t=Bn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var u=o.dependencies;if(u!==null){l=o.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Mn(-1,n&-n),c.tag=2;var f=o.updateQueue;if(f!==null){f=f.shared;var g=f.pending;g===null?c.next=c:(c.next=g.next,g.next=c),f.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),dc(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(o.tag===10)l=o.type===t.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(I(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),dc(l,n,t),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===t){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}jt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,$s(t,n),s=Zt(s),r=r(s),t.flags|=1,jt(e,t,r,n),t.child;case 14:return r=t.type,s=sn(r,t.pendingProps),s=sn(r.type,s),Up(e,t,r,s,n);case 15:return kg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Si(e,t),t.tag=1,It(r)?(e=!0,zi(t)):e=!1,$s(t,n),Sg(t,r,s),pc(t,r,s,n),gc(null,t,r,!0,e,n);case 19:return _g(e,t,n);case 22:return jg(e,t,n)}throw Error(I(156,t.tag))};function Vg(e,t){return xh(e,t)}function Fv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(e,t,n,r){return new Fv(e,t,n,r)}function Cd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zv(e){if(typeof e=="function")return Cd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Vc)return 11;if(e===Kc)return 14}return 2}function yr(e,t){var n=e.alternate;return n===null?(n=qt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ki(e,t,n,r,s,o){var l=2;if(r=e,typeof e=="function")Cd(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ns:return Qr(n.children,s,o,t);case Hc:l=8,s|=8;break;case Mu:return e=qt(12,n,t,s|2),e.elementType=Mu,e.lanes=o,e;case Uu:return e=qt(13,n,t,s),e.elementType=Uu,e.lanes=o,e;case Fu:return e=qt(19,n,t,s),e.elementType=Fu,e.lanes=o,e;case th:return ga(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zm:l=10;break e;case eh:l=9;break e;case Vc:l=11;break e;case Kc:l=14;break e;case rr:l=16,r=null;break e}throw Error(I(130,e==null?e:typeof e,""))}return t=qt(l,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function Qr(e,t,n,r){return e=qt(7,e,r,t),e.lanes=n,e}function ga(e,t,n,r){return e=qt(22,e,r,t),e.elementType=th,e.lanes=n,e.stateNode={isHidden:!1},e}function wu(e,t,n){return e=qt(6,e,null,t),e.lanes=n,e}function Su(e,t,n){return t=qt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $v(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tu(0),this.expirationTimes=tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ed(e,t,n,r,s,o,l,u,c){return e=new $v(e,t,n,u,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=qt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cd(o),e}function Bv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Kg(e){if(!e)return br;e=e._reactInternals;e:{if(os(e)!==e||e.tag!==1)throw Error(I(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(It(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(I(171))}if(e.tag===1){var n=e.type;if(It(n))return Kh(e,n,t)}return t}function Gg(e,t,n,r,s,o,l,u,c){return e=Ed(n,r,!0,e,s,o,l,u,c),e.context=Kg(null),n=e.current,r=Ct(),s=gr(n),o=Mn(r,s),o.callback=t??null,mr(n,o,s),e.current.lanes=s,vl(e,s,r),Dt(e,r),e}function ya(e,t,n,r){var s=t.current,o=Ct(),l=gr(s);return n=Kg(n),t.context===null?t.context=n:t.pendingContext=n,t=Mn(o,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=mr(s,t,l),e!==null&&(cn(e,s,l,o),xi(e,s,l)),l}function Zi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Jp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Rd(e,t){Jp(e,t),(e=e.alternate)&&Jp(e,t)}function Wv(){return null}var Yg=typeof reportError=="function"?reportError:function(e){console.error(e)};function _d(e){this._internalRoot=e}xa.prototype.render=_d.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(I(409));ya(e,t,null,null)};xa.prototype.unmount=_d.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;es(function(){ya(null,e,null,null)}),t[zn]=null}};function xa(e){this._internalRoot=e}xa.prototype.unstable_scheduleHydration=function(e){if(e){var t=jh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<lr.length&&t!==0&&t<lr[n].priority;n++);lr.splice(n,0,e),n===0&&Eh(e)}};function Td(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function va(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function qp(){}function Hv(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var f=Zi(l);o.call(f)}}var l=Gg(t,r,e,0,null,!1,!1,"",qp);return e._reactRootContainer=l,e[zn]=l.current,il(e.nodeType===8?e.parentNode:e),es(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var f=Zi(c);u.call(f)}}var c=Ed(e,0,!1,null,null,!1,!1,"",qp);return e._reactRootContainer=c,e[zn]=c.current,il(e.nodeType===8?e.parentNode:e),es(function(){ya(t,c,n,r)}),c}function wa(e,t,n,r,s){var o=n._reactRootContainer;if(o){var l=o;if(typeof s=="function"){var u=s;s=function(){var c=Zi(l);u.call(c)}}ya(t,l,e,s)}else l=Hv(n,t,e,s,r);return Zi(l)}Nh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Oo(t.pendingLanes);n!==0&&(Qc(t,n|1),Dt(t,Be()),!(pe&6)&&(Js=Be()+500,Er()))}break;case 13:es(function(){var r=$n(e,1);if(r!==null){var s=Ct();cn(r,e,1,s)}}),Rd(e,1)}};Jc=function(e){if(e.tag===13){var t=$n(e,134217728);if(t!==null){var n=Ct();cn(t,e,134217728,n)}Rd(e,134217728)}};kh=function(e){if(e.tag===13){var t=gr(e),n=$n(e,t);if(n!==null){var r=Ct();cn(n,e,t,r)}Rd(e,t)}};jh=function(){return we};Ch=function(e,t){var n=we;try{return we=e,t()}finally{we=n}};Qu=function(e,t,n){switch(t){case"input":if(Bu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ca(r);if(!s)throw Error(I(90));rh(r),Bu(r,s)}}}break;case"textarea":oh(e,n);break;case"select":t=n.value,t!=null&&Ms(e,!!n.multiple,t,!1)}};fh=Nd;ph=es;var Vv={usingClientEntryPoint:!1,Events:[Sl,Es,ca,ch,dh,Nd]},_o={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Kv={bundleType:_o.bundleType,version:_o.version,rendererPackageName:_o.rendererPackageName,rendererConfig:_o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gh(e),e===null?null:e.stateNode},findFiberByHostInstance:_o.findFiberByHostInstance||Wv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ai=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ai.isDisabled&&ai.supportsFiber)try{la=ai.inject(Kv),bn=ai}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vv;Wt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Td(t))throw Error(I(200));return Bv(e,t,null,n)};Wt.createRoot=function(e,t){if(!Td(e))throw Error(I(299));var n=!1,r="",s=Yg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ed(e,1,!1,null,null,n,!1,r,s),e[zn]=t.current,il(e.nodeType===8?e.parentNode:e),new _d(t)};Wt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(I(188)):(e=Object.keys(e).join(","),Error(I(268,e)));return e=gh(t),e=e===null?null:e.stateNode,e};Wt.flushSync=function(e){return es(e)};Wt.hydrate=function(e,t,n){if(!va(t))throw Error(I(200));return wa(null,e,t,!0,n)};Wt.hydrateRoot=function(e,t,n){if(!Td(e))throw Error(I(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",l=Yg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Gg(t,null,e,1,n??null,s,!1,o,l),e[zn]=t.current,il(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new xa(t)};Wt.render=function(e,t,n){if(!va(t))throw Error(I(200));return wa(null,e,t,!1,n)};Wt.unmountComponentAtNode=function(e){if(!va(e))throw Error(I(40));return e._reactRootContainer?(es(function(){wa(null,null,e,!1,function(){e._reactRootContainer=null,e[zn]=null})}),!0):!1};Wt.unstable_batchedUpdates=Nd;Wt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!va(n))throw Error(I(200));if(e==null||e._reactInternals===void 0)throw Error(I(38));return wa(e,t,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function Qg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qg)}catch(e){console.error(e)}}Qg(),Qm.exports=Wt;var Gv=Qm.exports,Xp=Gv;Lu.createRoot=Xp.createRoot,Lu.hydrateRoot=Xp.hydrateRoot;const Yv={1:[{rows:1,cols:1}],2:[{rows:1,cols:2},{rows:2,cols:1}],3:[{rows:2,cols:2},{rows:1,cols:3},{rows:3,cols:1}],4:[{rows:2,cols:2},{rows:1,cols:4},{rows:4,cols:1}],5:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:5},{rows:5,cols:1}],6:[{rows:2,cols:3},{rows:3,cols:2},{rows:1,cols:6},{rows:6,cols:1}],7:[{rows:2,cols:4},{rows:4,cols:2}],8:[{rows:2,cols:4},{rows:4,cols:2},{rows:3,cols:3}],9:[{rows:3,cols:3},{rows:2,cols:5},{rows:5,cols:2}],10:[{rows:2,cols:5},{rows:5,cols:2}]},Ws=(e,t)=>{if(!Number.isFinite(e))return t;const n=Math.floor(e);return n>0?n:t};function Qv(e){const t=Ws(e,1);return(Yv[t]||[]).map(r=>({...r}))}function Rc(e,t){if(!e)return null;const n=Ws(t,1),r=Ws(e.rows,1),s=Ws(e.cols,1),o=r*s;if(o<n)return null;let l=e.emptySeatIndex??null;return o>n?(l==null||l<0||l>=o)&&(l=o-1):l=null,{rows:r,cols:s,emptySeatIndex:l}}const Zp=(e,t)=>{const n=Ws(e,1),r=(t||0)===90,s=Math.ceil(Math.sqrt(n)),o=r?s:Math.ceil(n/s),l=Math.ceil(n/o);return Rc({rows:o,cols:l},n)||{rows:1,cols:n}};function Jg(e,t,n){const r=Ws(e,1),s=Rc(n,r);if(s)return s;const o=Qv(r);if(!o.length)return Zp(r,t);const l=(t||0)===90,c=o.filter(f=>l?f.rows>=f.cols:f.cols>=f.rows)[0]||o[0];return Rc(c,r)||Zp(r,t)}const Jv="newui_app_state",_c=1,qv=e=>!!e&&typeof e=="object";function Xv(e){const t=Math.max(0,e.capacity||0),n=Array.isArray(e.preferredSeatIndexes)?e.preferredSeatIndexes:[],r=[];for(const s of n){const o=typeof s=="number"?s:parseInt(String(s),10);!Number.isFinite(o)||!Number.isInteger(o)||o<0||o>=t||r.push(o)}return Array.from(new Set(r)).sort((s,o)=>s-o)}function Zv(e){const t=(e.seatIds??[]).slice(),n=Math.max(0,e.capacity||0);if(t.length<n)for(let l=t.length;l<n;l++)t[l]=String(e.id)+"_s"+l;else t.length>n&&(t.length=n);const r=Xv(e),s=Jg(n,e.rotation||0,e.seatLayout),o=qv(e.meta)?e.meta:void 0;return{...e,seatIds:t,preferredSeatIndexes:r,seatLayout:s,meta:o}}function ew(e){return{...e,tables:e.tables.map(Zv)}}function tw(e){const n=((e||{layouts:[]}).layouts||[]).map(ew);return{version:_c,layouts:n}}function nw(){try{const e=localStorage.getItem(Jv);if(!e)return{version:_c,layouts:[]};const t=JSON.parse(e);return tw(t)}catch{return{version:_c,layouts:[]}}}function rw(){return nw().layouts}const sw="newui_periods_state";function ow(){try{const e=localStorage.getItem(sw);if(!e)return{periods:[],currentId:null};const t=JSON.parse(e);return{periods:t.periods??[],currentId:t.currentId??null}}catch{return{periods:[],currentId:null}}}function Tc(){return ow()}const lw="newui_tags_state_v1";function iw(){try{const e=localStorage.getItem(lw);return e?{version:1,tags:JSON.parse(e).tags??[]}:{version:1,tags:[]}}catch{return{version:1,tags:[]}}}function aw(){return iw().tags}const uw=d.createContext(null),cw="newui_students_state_v1";function dw(){try{const e=localStorage.getItem(cw);return e?{version:1,students:JSON.parse(e).students??[]}:{version:1,students:[]}}catch{return{version:1,students:[]}}}function fw(){return dw().students}const pw={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","6xl":"max-w-6xl","7xl":"max-w-7xl"};function Pd({isOpen:e,onRequestClose:t,title:n,subtitle:r,headerRight:s,footer:o,children:l,maxWidth:u="6xl",bodyClassName:c,bodyPadding:f=!0,showCloseX:g=!1}){if(d.useEffect(()=>{if(!e)return;const b=E=>{E.key==="Escape"&&t()};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[e,t]),!e)return null;const S=f?"px-5 py-4":"";return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40",style:{width:"100dvw",height:"100dvh"},onMouseDown:t}),i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{width:"100dvw",height:"100dvh"},children:i.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative w-full rounded-xl bg-white shadow-xl border border-slate-200 max-h-[90vh] overflow-hidden flex flex-col ${pw[u]}`,onMouseDown:b=>b.stopPropagation(),children:[i.jsx("div",{className:"border-b border-slate-200 px-5 py-4 bg-white",children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"min-w-0",children:[n&&i.jsx("div",{className:"text-lg font-semibold text-slate-900",children:n}),r&&i.jsx("div",{className:"text-sm text-slate-500",children:r})]}),(s||g)&&i.jsxs("div",{className:"flex items-center gap-2",children:[s,g&&i.jsx("button",{type:"button","aria-label":"Close",onClick:t,className:"rounded-md p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:i.jsx("span",{"aria-hidden":"true",className:"text-lg leading-none",children:""})})]})]})}),i.jsx("div",{className:`flex-1 min-h-0 overflow-y-auto overscroll-contain ${S} ${c??""}`,children:l}),o&&i.jsx("div",{className:"border-t border-slate-200 px-5 py-4 bg-slate-50",children:o})]})})]})}function mw(){return"pro"}function hw(e=mw()){return{tier:e,canUseDriveSync:e!=="free",canUseLocalSave:!0,canExportPDF:e!=="free",canUseAdvancedReports:e==="school"||e==="pro",canUseImports:!0,canUseMobile:!0}}function gw({studentId:e,hasPhoto:t=!1,src:n=null,onClick:r,widthPx:s,heightPx:o,sizePx:l=44}){const f={width:s??l,height:o??l};return i.jsx("button",{type:"button","aria-label":t?"Update student photo":"Add student photo",className:"flex-shrink-0 rounded-xl border border-slate-200 bg-white/60 overflow-hidden active:scale-[0.98]",style:f,onClick:g=>{g.stopPropagation(),r==null||r(e)},children:t&&n?i.jsx("img",{src:n,alt:"Student photo",className:"w-full h-full object-cover",draggable:!1}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18","aria-hidden":"true",className:"text-slate-500",children:i.jsx("path",{fill:"currentColor",d:"M9.5 4.5h5l1.2 1.8H19a2.5 2.5 0 0 1 2.5 2.5v8.7A2.5 2.5 0 0 1 19 20H5a2.5 2.5 0 0 1-2.5-2.5V8.8A2.5 2.5 0 0 1 5 6.3h3.3l1.2-1.8ZM12 9a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 1.7a2.3 2.3 0 1 1 0 4.6 2.3 2.3 0 0 1 0-4.6Z"})})})})}function qg(e){const t=(e||"").trim();if(!t)return{first:"Unknown",last:"Unknown"};if(t.includes(",")){const[o,l]=t.split(",",2),u=(o||"").trim()||"Unknown";return{first:(l||"").trim().split(/\s+/).filter(Boolean)[0]||"Unknown",last:u}}const n=t.split(/\s+/).filter(Boolean);if(n.length===1)return{first:n[0],last:"Unknown"};const r=n[0]||"Unknown",s=n[n.length-1]||"Unknown";return{first:r,last:s}}function ea(e){return(e||"").trim().replace(/\s+/g,"_").replace(/[^A-Za-z0-9_-]/g,"").replace(/_+/g,"_")||"Unknown"}function Ad(e,t){const n=qg(t),r=ea(n.first);return`${ea(n.last)}_${r}__id_${e}.jpg`}var Om,Mm;const Pc=((Mm=(Om=import.meta)==null?void 0:Om.env)==null?void 0:Mm.VITE_GOOGLE_CLIENT_ID)??"403722152172-rm3rvd6kba8s10a8svv60jbj2s93kv1e.apps.googleusercontent.com",yw="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email",ta="ClassSeats";function xw(e){return e?e.startsWith(".")?e:`.${e}`:""}function vw(e,t,n){const r=qg(t),s=ea(r.first),o=ea(r.last),l=xw(n);return`${o}_${s}__audio__id_${e}${l}`}const Xg="classseats_mobile_drive_session_v2",Id="classseats_mobile_drive_folder_v1",Dd="classseats_student_docs_folder_v1",Zg={classseats:"data_v1"},em="Student Docs",tm="studentPhotos",nm="audio",e0="https://us-east1-classseats-sync.cloudfunctions.net/exchangecode",ji="classseats_mobile_drive_pkce_verifier",qo="classseats_mobile_drive_return_to",Ci="classseats_mobile_drive_redirect_uri",t0="https://app.classseats.app/ClassSeatsMobile";function ww(){if(typeof window>"u")return t0;const e=window.location.origin;return e==="https://app.classseats.app"?"https://app.classseats.app/ClassSeatsMobile":e==="https://mifish3474.github.io"?"https://mifish3474.github.io/ClassSeats-Mobile-Testing/ClassSeatsMobile":`${e}/ClassSeatsMobile`}const Sw=45*60*1e3,bw="classseats_auth",Nw=1,Nr="driveSession",na="singleton";let $r=null,wn=null,Uo=!1,Ei="none";function kw(e){const{sessionLoaded:t}=e,n=(e.lastWriteReason||"").trim();return t?"ok":n?n==="explicit-disconnect"?"user-logged-out":n==="fatal-oauth-error"?"oauth-failure":n==="login-success"?"device-storage-wipe":"unknown":"no-session-yet"}function Ld(){return new Promise((e,t)=>{const n=indexedDB.open(bw,Nw);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(Nr)||r.createObjectStore(Nr,{keyPath:"id"})},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error||new Error("IndexedDB open failed"))})}async function jw(){const e=await Ld();return new Promise((t,n)=>{const o=e.transaction(Nr,"readonly").objectStore(Nr).get(na);o.onsuccess=()=>{const l=o.result;if(l){wn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason};const{id:u,lastWriteAt:c,lastWriteReason:f,...g}=l;t(g)}else t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}async function n0(e,t){const n=await Ld();return new Promise((r,s)=>{const o=n.transaction(Nr,"readwrite"),l=o.objectStore(Nr);if(!e)console.info("[Drive][IDB] CLEAR session",{reason:t}),l.delete(na),wn={lastWriteAt:Date.now(),lastWriteReason:t};else{const u={id:na,...e,lastWriteAt:Date.now(),lastWriteReason:t};console.info("[Drive][IDB] WRITE session",{reason:t,hasRefresh:!!e.refreshToken,expiresAt:e.expiresAt}),l.put(u),wn={lastWriteAt:u.lastWriteAt,lastWriteReason:u.lastWriteReason}}o.oncomplete=()=>r(),o.onerror=()=>s(o.error||new Error("IDB put/delete failed"))})}async function Cw(){try{const e=await Ld();return await new Promise((t,n)=>{const o=e.transaction(Nr,"readonly").objectStore(Nr).get(na);o.onsuccess=()=>{const l=o.result;l?(wn={lastWriteAt:l.lastWriteAt,lastWriteReason:l.lastWriteReason},t(l)):t(null)},o.onerror=()=>n(o.error||new Error("IDB get failed"))})}catch(e){return console.warn("[Drive][IDB] getDriveSessionRecord failed",e),null}}async function Ew(){const e=await Cw(),t=!!e,n=!!(e!=null&&e.refreshToken),r=(e==null?void 0:e.expiresAt)??null,s=(e==null?void 0:e.lastWriteAt)??(wn==null?void 0:wn.lastWriteAt)??null,o=(e==null?void 0:e.lastWriteReason)??(wn==null?void 0:wn.lastWriteReason)??null,l=e?"idb":"none",u=e==null?void 0:e.profile,c=kw({sessionLoaded:t,lastWriteReason:o}),f={sessionLoaded:t,hasRefresh:n,expiresAt:r,source:l,lastWriteAt:s,lastWriteReason:o,state:c,profile:u};return console.info("startup:",f),console.info("[Drive] startupSessionState",{state:c,lastWriteReason:o}),f}function Rw(){if(typeof window>"u")return null;try{const e=window.localStorage.getItem(Xg);return e?JSON.parse(e):null}catch{return null}}function _w(){typeof window>"u"||window.localStorage.removeItem(Xg)}async function Sa(){if(Uo)return $r;try{const t=await jw();if(t)return $r=t,Ei="idb",Uo=!0,$r}catch{}const e=Rw();if(e){$r=e,Ei="legacy",Uo=!0;try{await n0(e,"startup-migration")}catch{}return $r}return $r=null,Ei="none",Uo=!0,null}async function Od(e,t){$r=e,Uo=!0,Ei=e?"idb":"none";try{await n0(e,t)}catch(n){console.warn("[Drive][IDB] persistSession failed",n)}}async function r0(e){await Od(null,e),_w()}async function Tw(){return Sa()}function Pw(e,t=5*60*1e3){return!e||e.expiresAt<=Date.now()+t}function Aw(e){return e.replace(/^#/,"").split("&").map(t=>t.split("=")).reduce((t,[n,r])=>(n&&(t[decodeURIComponent(n)]=decodeURIComponent(r||"")),t),{})}function s0(e,t,n,r){const s=t?t*1e3:Sw;return{accessToken:e,expiresAt:Date.now()+s-60*1e3,refreshToken:n,profile:r}}async function o0(e){try{const t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return;const n=await t.json();return{email:n.email,name:n.name,picture:n.picture}}catch{return}}async function Iw(){const e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Dw(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=Array.from(new Uint8Array(r));return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lw(e,t){const n=await Iw(),r=await Dw(n),s=btoa(JSON.stringify({v:n,r:t||null}));return window.localStorage.setItem(ji,n),t?window.localStorage.setItem(qo,t):window.localStorage.removeItem(qo),window.localStorage.setItem(Ci,e),`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:Pc,redirect_uri:e,response_type:"code",scope:yw,include_granted_scopes:"true",state:s,prompt:"consent",access_type:"offline",code_challenge:r,code_challenge_method:"S256"}).toString()}`}async function Ow(e,t,n){const r={grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:n,client_id:Pc};console.info("[Drive] Exchanging code",{redirect_uri:n,client_id:Pc,code_preview:e?`${e.slice(0,4)}...${e.slice(-4)}`:"none"});const s=await fetch(e0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const o=await s.text().catch(()=>"");throw new Error(o||"Failed to exchange code for tokens.")}return s.json()}async function Mw(){if(typeof window>"u")return null;const e=window.location.search||"",t=new URLSearchParams(e);let n=t.get("code"),r=t.get("state");if(!n&&window.location.hash){const u=Aw(window.location.hash);n=u.code||n,r=u.state||r}if(!n)return null;let s=null,o=null,l=null;if(r)try{const u=JSON.parse(atob(r));u!=null&&u.v&&typeof u.v=="string"&&(s=u.v),u!=null&&u.r&&typeof u.r=="string"&&(o=u.r),u!=null&&u.d&&typeof u.d=="string"&&(l=u.d)}catch{}if(s||(s=window.localStorage.getItem(ji)),o||(o=window.localStorage.getItem(qo)),l||(l=window.localStorage.getItem(Ci)||t0),!s)return null;try{const u=await Ow(n,s,l),c=await o0(u.access_token),f=s0(u.access_token,u.expires_in,u.refresh_token,c||void 0);return await Od(f,"login-success"),window.localStorage.removeItem(ji),window.localStorage.removeItem(qo),window.localStorage.removeItem(Ci),o&&o!==l?window.location.replace(o):window.history.replaceState(null,document.title,l),f}catch{return window.localStorage.removeItem(ji),window.localStorage.removeItem(qo),window.localStorage.removeItem(Ci),null}}async function Uw(e,t){if(typeof window>"u")throw new Error("Browser required.");const n=ww(),r=await Lw(n,window.location.href);return window.location.href=r,new Promise(()=>{})}async function l0(){const e=await Sa();if(!e)return console.warn("[Drive] refreshDriveSession: no stored session"),null;if(e.expiresAt>Date.now()+60*1e3)return console.debug("[Drive] refreshDriveSession: not expiring soon; skipping refresh",{expiresAt:e.expiresAt}),e;if(!e.refreshToken)return console.warn("[Drive] refreshDriveSession: missing refresh token; cannot refresh; keeping existing session",{expiresAt:e.expiresAt}),e;try{const t=await fetch(e0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"refresh_token",refresh_token:e.refreshToken})});if(!t.ok){const o=await t.text().catch(()=>"");throw console.warn("[Drive] refreshDriveSession: HTTP error from token endpoint",{status:t.status,statusText:t.statusText,bodySnippet:o.slice(0,200)}),new Error("Refresh failed: "+t.status)}const n=await t.json(),r=await o0(n.access_token),s=s0(n.access_token,n.expires_in,e.refreshToken,r||e.profile);return await Od(s,"refresh-success"),s}catch(t){const n=String((t==null?void 0:t.message)||"");return console.warn("[Drive] refreshDriveSession: caught error",{message:n}),/invalid_grant|invalid_client/i.test(n)?(console.warn("[Drive] refreshDriveSession: treating as fatal OAuth error; clearing session"),await r0("fatal-oauth-error")):console.warn("[Drive] refreshDriveSession: non-fatal error; keeping stored session in IDB"),null}}async function kn(e){let t=e??await Sa();return t?Pw(t)?await l0():t:null}async function Fw(){const e=await Mw();if(e)return e;const t=await Sa();return t&&t.expiresAt>Date.now()+60*1e3?t:l0()}async function zw(){await r0("explicit-disconnect")}async function Ce(e,t,n){const r=await fetch(t,{...n,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",...(n==null?void 0:n.headers)||{}}});if(!r.ok){const s=await r.text().catch(()=>"");throw new Error(s||"Google Drive request failed.")}return r}function kr(e){return e.replace(/'/g,"\\'")}async function ro(e){const t=$w();if(t){if(await i0(e,t))return t;Bw()}const n=new URLSearchParams({q:`name='${ta}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return rm(s.files[0].id),s.files[0].id;const l=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:ta,mimeType:"application/vnd.google-apps.folder"})})).json();return rm(l.id),l.id}function rm(e){typeof window>"u"||window.localStorage.setItem(Id,e)}function $w(){return typeof window>"u"?null:window.localStorage.getItem(Id)}function Bw(){typeof window>"u"||window.localStorage.removeItem(Id)}function sm(e){typeof window>"u"||window.localStorage.setItem(Dd,e)}function Ww(){return typeof window>"u"?null:window.localStorage.getItem(Dd)}function Hw(){typeof window>"u"||window.localStorage.removeItem(Dd)}async function i0(e,t){try{return(await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id`)).ok}catch{return!1}}async function Vw(e){const t=Ww();if(t){if(await i0(e,t))return t;Hw()}const n=await ro(e),r=new URLSearchParams({q:`'${n}' in parents and name='${kr(em)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json();if(Array.isArray(o.files)&&o.files.length>0)return sm(o.files[0].id),o.files[0].id;const u=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:em,mimeType:"application/vnd.google-apps.folder",parents:[n]})})).json();if(!(u!=null&&u.id))throw new Error("Unable to create Student Docs folder.");return sm(u.id),u.id}async function Kw(e){const t=await ro(e),n=new URLSearchParams({q:`'${t}' in parents and name='${kr(tm)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:tm,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student photos folder.");return l.id}async function Gw(e){const t=await ro(e),n=new URLSearchParams({q:`'${t}' in parents and name='${kr(nm)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),s=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(s.files)&&s.files.length>0)return s.files[0].id;const l=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:nm,mimeType:"application/vnd.google-apps.folder",parents:[t]})})).json();if(!(l!=null&&l.id))throw new Error("Unable to create student audio folder.");return l.id}async function Yw(e,t,n){const r=(n||"").trim();if(!r)throw new Error("Document title is required.");const o=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.document",parents:[t]})})).json();if(!(o!=null&&o.id))throw new Error("Unable to create Google Doc.");return{fileId:o.id,title:o.name||r}}async function Qw(e){const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await Kw(n),s=Ad(e.studentId,e.studentFullName);let o=e.fileId?String(e.fileId):null;if(!o){const S=`name='${kr(s)}' and '${r}' in parents and trashed=false`,b=new URLSearchParams({q:S,fields:"files(id)",spaces:"drive"}),j=await(await Ce(n,`https://www.googleapis.com/drive/v3/files?${b.toString()}`)).json();o=Array.isArray(j.files)&&j.files.length>0?j.files[0].id:null}if(!o){const S=`student_${e.studentId}.jpg`,b=`name='${kr(S)}' and '${r}' in parents and trashed=false`,E=new URLSearchParams({q:b,fields:"files(id)",spaces:"drive"}),k=await(await Ce(n,`https://www.googleapis.com/drive/v3/files?${E.toString()}`)).json();o=Array.isArray(k.files)&&k.files.length>0?k.files[0].id:null}const l=o?{name:s,mimeType:"image/jpeg"}:{name:s,parents:[r],mimeType:"image/jpeg"},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.jpegBlob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const S=await f.text().catch(()=>"");throw new Error(S||"Failed to upload student photo.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student photo.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function Jw(e){const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");const n=t.accessToken,r=await Gw(n),s=vw(e.studentId,e.studentFullName,e.extension),o=e.fileId?String(e.fileId):null,l=o?{name:s,mimeType:e.mimeType}:{name:s,parents:[r],mimeType:e.mimeType},u=new FormData;u.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),u.append("file",e.blob,s);const c=o?`https://www.googleapis.com/upload/drive/v3/files/${o}?uploadType=multipart&fields=id,name,modifiedTime`:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime",f=await fetch(c,{method:o?"PATCH":"POST",headers:{Authorization:`Bearer ${n}`},body:u,signal:e.signal});if(!f.ok){const S=await f.text().catch(()=>"");throw new Error(S||"Failed to upload student audio.")}const g=await f.json();if(!(g!=null&&g.id))throw new Error("Unable to upload student audio.");return{fileId:g.id,folderId:r,fileName:g.name||s,modifiedTime:g.modifiedTime}}async function qw(e){if(!e)throw new Error("File ID is required.");const t=await kn();if(!(t!=null&&t.accessToken))throw new Error("Sign in with Google Drive first.");await Ce(t.accessToken,`https://www.googleapis.com/drive/v3/files/${e}`,{method:"DELETE"})}async function bu(e){const t=await ro(e),n=new URLSearchParams({q:`'${t}' in parents and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json()).files||[]).map(ts)}async function Nu(e,t){const r=await(await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId,appProperties`,{method:"GET"})).json();return ts(r)}async function Xw(e,t,n){const r=t.trim();if(!r)throw new Error("Folder name is required.");const s=["mimeType='application/vnd.google-apps.folder'",`name='${kr(r)}'`,"trashed=false"];n&&s.push(`'${n}' in parents`);const o=new URLSearchParams({q:s.join(" and "),fields:"files(id)",spaces:"drive"}),u=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return u.files[0].id;const f=await(await Ce(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:r,mimeType:"application/vnd.google-apps.folder",parents:n?[n]:void 0})})).json();if(!(f!=null&&f.id))throw new Error("Unable to create folder.");return f.id}async function Zw(e,t){const n=(t||[]).map(s=>s.trim()).filter(Boolean);if(n.length===0)throw new Error("Folder path is required.");let r=null;for(const s of n){if(!r&&s===ta){r=await ro(e);continue}r=await Xw(e,s,r)}if(!r)throw new Error("Unable to resolve folder path.");return r}async function eS(e,t){const n=t.trim();if(!n)return!1;const r=new URLSearchParams({q:`'root' in parents and mimeType='application/vnd.google-apps.folder' and name='${kr(n)}' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${r.toString()}`)).json(),l=Array.isArray(o.files)&&o.files.length>0?o.files[0].id:null;if(!l)return!1;const u=new URLSearchParams({q:`'${l}' in parents and trashed=false`,fields:"files(id)",spaces:"drive",pageSize:"1"}),f=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${u.toString()}`)).json();return Array.isArray(f.files)&&f.files.length>0?!1:(await Ce(e,`https://www.googleapis.com/drive/v3/files/${l}`,{method:"PATCH",body:JSON.stringify({trashed:!0})}),!0)}async function tS(e,t,n){if(!t)throw new Error("File ID is required.");if(!n)throw new Error("Folder ID is required.");let r=null;try{const l=await(await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=parents`,{method:"GET"})).json();Array.isArray(l.parents)&&l.parents.length>0&&(r=l.parents.join(","))}catch{r=null}const s=new URLSearchParams({addParents:n,fields:"id,parents"});r&&s.set("removeParents",r),await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?${s.toString()}`,{method:"PATCH",body:JSON.stringify({})})}async function nS(e,t,n){const r=await ro(e),s="classseats_drive_boundary",o={name:t,mimeType:"application/json",parents:[r],appProperties:Zg},l=[`--${s}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(o),`--${s}`,"Content-Type: application/json","",n,`--${s}--`,""].join(`\r
`),u=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${s}`},body:l});if(!u.ok){const f=await u.text().catch(()=>"");throw new Error(f||"Failed to create Google Drive file.")}const c=await u.json();return ts(c)}async function rS(e,t,n,r="{}"){const s=n.trim();if(!s)throw new Error("File name is required.");const o=new URLSearchParams({q:`'${t}' in parents and name='${kr(s)}' and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",spaces:"drive"}),u=await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`)).json();if(Array.isArray(u.files)&&u.files.length>0)return ts(u.files[0]);const c="classseats_drive_boundary",f={name:s,mimeType:"application/json",parents:[t],appProperties:Zg},g=[`--${c}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(f),`--${c}`,"Content-Type: application/json","",r,`--${c}--`,""].join(`\r
`),S=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${c}`},body:g});if(!S.ok){const E=await S.text().catch(()=>"");throw new Error(E||"Failed to create Google Drive file.")}const b=await S.json();return ts(b)}async function Ss(e,t){return(await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?alt=media`,{method:"GET"})).text()}async function om(e,t,n){const r=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${t}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:n});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(l||"Failed to upload file to Google Drive.")}const o=await(await Ce(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId`,{method:"GET"})).json();return ts(o)}function ts(e){var t;return e?{id:e.id,name:e.name,modifiedTime:e.modifiedTime,size:e.size,revisionId:e.headRevisionId||e.revisionId||((t=e==null?void 0:e.appProperties)==null?void 0:t.revisionId)}:{id:"",name:""}}async function ku(e){const t=new URLSearchParams({q:"mimeType='application/json' and trashed=false",fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Ce(e,`https://www.googleapis.com/drive/v3/files?${t.toString()}`)).json()).files||[]).map(ts)}const Vr=new Map;function a0(e,t){const n=Vr.get(e);if((n==null?void 0:n.value)!==void 0)return Promise.resolve(n.value);if(n!=null&&n.promise)return n.promise;const r=t().then(s=>(Vr.set(e,{value:s}),s)).catch(s=>{throw Vr.delete(e),s});return Vr.set(e,{promise:r}),r}function qs(e){if(!e){Vr.clear();return}for(const t of Vr.keys())t.startsWith(e)&&Vr.delete(t)}const sS="classseats-cache",oS=1,Un="driveFolders",xr="studentPhotoMap",vr="photoBlobs";function ba(){return typeof indexedDB>"u"?Promise.resolve(null):new Promise(e=>{const t=indexedDB.open(sS,oS);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Un)||n.createObjectStore(Un,{keyPath:"key"}),n.objectStoreNames.contains(xr)||n.createObjectStore(xr,{keyPath:"studentId"}),n.objectStoreNames.contains(vr)||n.createObjectStore(vr,{keyPath:"fileId"})},t.onsuccess=()=>e(t.result),t.onerror=()=>e(null)})}function Md(e,t){return t?Date.now()-e>t:!1}async function so(e,t){const n=await ba();return n?new Promise(r=>{const s=n.transaction(e,"readonly"),l=s.objectStore(e).get(t);l.onsuccess=()=>r(l.result||null),l.onerror=()=>r(null),s.onabort=()=>r(null)}):null}async function Na(e,t){const n=await ba();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).put(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function Xs(e,t){const n=await ba();if(n)return new Promise(r=>{const s=n.transaction(e,"readwrite");s.objectStore(e).delete(t),s.oncomplete=()=>r(),s.onerror=()=>r(),s.onabort=()=>r()})}async function ju(e){const t=await ba();if(t)return new Promise(n=>{const r=t.transaction(e,"readwrite");r.objectStore(e).clear(),r.oncomplete=()=>n(),r.onerror=()=>n(),r.onabort=()=>n()})}async function u0(e,t,n){const r=await so(Un,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Xs(Un,e),null):Md(r.updatedAt,t)?(await Xs(Un,e),null):r:null}async function c0(e){await Na(Un,e)}async function lS(e,t,n){const r=await so(xr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Xs(xr,e),null):Md(r.fetchedAt,t)?(await Xs(xr,e),null):r:null}async function iS(e,t){const n=await so(xr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function aS(e){await Na(xr,e)}async function uS(e,t,n){const r=await so(vr,e);return r?n&&r.accountKey&&r.accountKey!==n?(await Xs(vr,e),null):Md(r.fetchedAt,t)?(await Xs(vr,e),null):r:null}async function cS(e,t){const n=await so(vr,e);return!n||t&&n.accountKey&&n.accountKey!==t?null:n}async function d0(e){await Na(vr,e)}async function dS(){await Promise.all([ju(Un),ju(xr),ju(vr)])}const f0="driveAccountKey";async function fS(){const e=await so(Un,f0);return(e==null?void 0:e.value)||null}async function pS(e){const t={key:f0,value:e,updatedAt:Date.now(),accountKey:e};await Na(Un,t)}const lm="ClassSeats",im="studentPhotos",p0=30*24*60*60*1e3,mS=7*24*60*60*1e3,hS=7*24*60*60*1e3,gS=5*60*1e3,yS="classseats_studentPhotoRefs_v1",xS=()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},Kr=(e,t)=>{xS()&&console.debug(`[PhotoService] ${e}`,t)},Cu={folderLookups:0,photoMetaLookups:0,mediaDownloads:0};function Zs(e){Cu[e]+=1,Kr(`${e}=${Cu[e]}`,{count:Cu[e]})}const ra=new Map,sa=new Map,ns=new Map;let Ri=null;const m0=(e,t)=>`${e}:${t||0}`;function h0(e){return e.replace(/'/g,"\\'")}function vS(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(yS);if(!t)return null;const n=JSON.parse(t);if(!n||typeof n!="object")return null;const r=n[e];return!r||typeof r.fileId!="string"?null:r.fileId}catch{return null}}function g0(e){let t=0;const n=[],r=()=>{if(t>=e)return;const s=n.shift();s&&s()};return async function(o){t>=e&&await new Promise(l=>n.push(l)),t+=1;try{return await o()}finally{t-=1,r()}}}const Ud=g0(4),am=g0(3);async function rs(e,t,n){const r={Authorization:`Bearer ${e}`},s=(n==null?void 0:n.body)instanceof FormData;n!=null&&n.body&&!s&&(r["Content-Type"]="application/json");const o=await fetch(t,{...n,headers:{...r,...(n==null?void 0:n.headers)||{}}});if(!o.ok){const l=await o.text().catch(()=>"");throw new Error(l||"Google Drive request failed.")}return o}async function wS(e){var n,r,s,o,l;if((r=(n=e.driveSession)==null?void 0:n.profile)!=null&&r.email)return e.driveSession.profile.email;if((s=e.driveClient)!=null&&s.getStatus)try{const u=await e.driveClient.getStatus();if(u.connected)return((o=u.profile)==null?void 0:o.email)||null}catch{}const t=await kn(e.driveSession);return((l=t==null?void 0:t.profile)==null?void 0:l.email)||null}async function Nl(e){const t=await wS(e);if(!t)return null;Ri&&Ri!==t&&await Ds("account-change");const n=await fS();return n&&n!==t&&await Ds("account-change"),Ri=t,n!==t&&await pS(t),t}async function ka(e){var n,r;if(((n=e.driveClient)==null?void 0:n.kind)==="desktop")return null;const t=await kn(e.driveSession);return t!=null&&t.accessToken?t.accessToken:(r=e.driveSession)!=null&&r.accessToken?(Kr("falling back to existing drive session token"),e.driveSession.accessToken):null}async function Fd(e,t){const n=await a0(e,t);return n==null&&qs(e),n}function Fo(e,t){const n=ns.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return ns.set(e,{url:r}),r}function SS(e){const t=ns.get(e);return(t==null?void 0:t.url)||null}function y0(e,t){const n=`${e}:`;for(const[r,s]of ns.entries())r!==e&&!r.startsWith(n)||t&&r===t||(s!=null&&s.url&&URL.revokeObjectURL(s.url),ns.delete(r))}function bS(e){const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),t}function NS(e){const t=e.replace(/\s+/g,"");return t.length<32||t.length%4!==0?!1:/^[A-Za-z0-9+/=]+$/.test(t)}function um(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"image/jpeg"})}catch{return null}}function kS(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e))return new Blob([bS(e)]);if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=um(t[1],n==null?void 0:n[1]);if(r)return r}}if(NS(e)){const t=um(e);if(t)return t}return new Blob([e])}return null}async function cm(e,t,n,r){const s=`name='${h0(n)}' and '${t}' in parents and trashed=false`,o=new URLSearchParams({q:s,fields:"files(id,name,modifiedTime)",spaces:"drive"});return Zs("photoMetaLookups"),Ud(async()=>{const u=await(await rs(e,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET",signal:r})).json();return!Array.isArray(u.files)||u.files.length===0?null:u.files[0]})}async function jS(e,t,n){return Zs("photoMetaLookups"),Ud(async()=>{const s=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"GET",signal:n})).json();return s!=null&&s.id?{id:s.id,name:s.name,modifiedTime:s.modifiedTime}:null})}async function CS(e,t,n,r){return Ud(async()=>{const o=await(await rs(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime`,{method:"PATCH",body:JSON.stringify({name:n}),signal:r})).json();return o!=null&&o.id?{id:o.id,name:o.name,modifiedTime:o.modifiedTime}:null})}async function ES(e){return Fd("driveFolder:classSeats",async()=>{const t=await Nl(e),n=await u0("classSeatsFolderId",p0,t||void 0);if(n!=null&&n.value)return n.value;const r=await ka(e);if(!r)return null;Zs("folderLookups");const s=new URLSearchParams({q:`name='${lm}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),l=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${s.toString()}`,{method:"GET"})).json();let u=null;if(Array.isArray(l.files)&&l.files.length>0&&(u=l.files[0].id),!u){const f=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:lm,mimeType:"application/vnd.google-apps.folder"})})).json();u=(f==null?void 0:f.id)||null}return u?(await c0({key:"classSeatsFolderId",value:u,updatedAt:Date.now(),accountKey:t||void 0}),u):null})}async function RS(e){return Fd("driveFolder:studentPhotos",async()=>{const t=await Nl(e),n=await u0("studentPhotosFolderId",p0,t||void 0);if(n!=null&&n.value)return n.value;const r=await ka(e);if(!r)return null;const s=await ES(e);if(!s)return null;Zs("folderLookups");const o=new URLSearchParams({q:`'${s}' in parents and name='${h0(im)}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),u=await(await rs(r,`https://www.googleapis.com/drive/v3/files?${o.toString()}`,{method:"GET"})).json();let c=null;if(Array.isArray(u.files)&&u.files.length>0&&(c=u.files[0].id),!c){const g=await(await rs(r,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:im,mimeType:"application/vnd.google-apps.folder",parents:[s]})})).json();c=(g==null?void 0:g.id)||null}return c?(await c0({key:"studentPhotosFolderId",value:c,updatedAt:Date.now(),accountKey:t||void 0}),c):null})}async function zo(e){ra.set(e.studentId,e),sa.delete(e.studentId),qs(`studentPhoto:${e.studentId}`),await aS(e)}async function _S(e,t,n,r){const s=String(e),o=await Nl(n),l=ra.get(s);if(l&&(!o||l.accountKey===o))return l;const u=await lS(s,mS,o||void 0);if(u)return ra.set(s,u),u;const c=await iS(s,o||void 0),f=sa.get(s);if(f&&Date.now()-f<gS)return c||null;const g=await ka(n);if(!g)return c||null;if(c!=null&&c.fileId)try{const j=await jS(g,c.fileId,r);if(j){const k={studentId:s,fileId:j.id,fileName:j.name,updatedTime:j.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await zo(k),k}}catch{}const S=await RS(n);if(!S)return c||null;const b=t?Ad(e,t):c==null?void 0:c.fileName;if(b)try{const j=await cm(g,S,b,r);if(j){const k={studentId:s,fileId:j.id,fileName:j.name,updatedTime:j.modifiedTime,fetchedAt:Date.now(),accountKey:o||void 0};return await zo(k),k}}catch{return c||null}try{const j=`student_${e}.jpg`,k=await cm(g,S,j,r);if(k){let q=k.name,y=k.modifiedTime;if(b&&k.name!==b){const v=await CS(g,k.id,b,r);v!=null&&v.name&&(q=v.name,y=v.modifiedTime)}const m={studentId:s,fileId:k.id,fileName:q,updatedTime:y,fetchedAt:Date.now(),accountKey:o||void 0};return await zo(m),m}}catch{return c||null}const E=vS(s);if(E){const j={studentId:s,fileId:E,fileName:b||void 0,fetchedAt:Date.now(),accountKey:o||void 0};return await zo(j),j}return sa.set(s,Date.now()),c||null}async function TS(e,t,n){var s;if(((s=t.driveClient)==null?void 0:s.kind)==="desktop"&&t.driveClient.downloadFile)return Zs("mediaDownloads"),am(async()=>{var l,u;const o=await((u=(l=t.driveClient)==null?void 0:l.downloadFile)==null?void 0:u.call(l,e));return kS(o==null?void 0:o.data)});const r=await ka(t);return r?(Zs("mediaDownloads"),am(async()=>{const o=`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,l=async b=>await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${b}`},signal:n}),u=await l(r);if(u.ok)return u.blob();if(Kr("photo download failed",{fileId:e,status:u.status}),!(u.status===401||u.status===403))return null;const f=await kn(t.driveSession),g=f==null?void 0:f.accessToken;if(!g)return Kr("photo download retry skipped: no refreshed token",{fileId:e}),null;const S=await l(g);return S.ok?(Kr("photo download recovered after token refresh",{fileId:e}),S.blob()):(Kr("photo download retry failed",{fileId:e,status:S.status}),null)})):null}async function PS(e,t,n,r){const s=m0(e,t);y0(e,s);const o=SS(s);if(o)return o;const l=await Nl(n),u=await uS(s,hS,l||void 0);if(u)return Fo(s,u.blob);const c=await cS(s,l||void 0);try{const f=await a0(`photoBlob:${s}`,async()=>TS(e,n,r));if(!f)return qs(`photoBlob:${s}`),c?Fo(s,c.blob):null;const g={fileId:s,blob:f,fetchedAt:Date.now(),accountKey:l||void 0};return await d0(g),Fo(s,f)}catch{return qs(`photoBlob:${s}`),c?Fo(s,c.blob):null}}async function AS(e){const t=e.photoFileId?String(e.photoFileId):"";if(!t)return{fileId:null,url:null};const n=await PS(t,e.photoUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}async function IS(e){const t=`studentPhoto:${String(e.studentId)}`;return Fd(t,async()=>_S(e.studentId,e.fullName,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal))}async function DS(e){const t=m0(e.fileId,e.photoUpdatedAt);qs(`photoBlob:${t}`);const n=String(e.studentId),r=await Nl({driveClient:e.driveClient,driveSession:e.driveSession}),s=Ad(e.studentId,e.fullName),o={studentId:n,fileId:e.fileId,fileName:s,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await zo(o);const l={fileId:t,blob:e.blob,updatedTime:e.updatedTime,fetchedAt:Date.now(),accountKey:r||void 0};await d0(l),y0(e.fileId,t),Fo(t,e.blob)}async function Ds(e){e&&Kr("cache clear",{reason:e});for(const t of ns.values())URL.revokeObjectURL(t.url);ns.clear(),ra.clear(),sa.clear(),Ri=null,qs(),await dS()}function x0({studentId:e,fullName:t,photoFileId:n,photoUpdatedAt:r,driveClient:s,driveSession:o,driveAccountKey:l}){const[u,c]=d.useState(null),[f,g]=d.useState(null),[S,b]=d.useState(!1),E=d.useMemo(()=>String(e),[e]),j=d.useMemo(()=>n?String(n):"",[n]),k=(o==null?void 0:o.accessToken)||"",q=l||"";return d.useEffect(()=>{let y=!0;const m=new AbortController;return j?(b(!0),c(null),AS({photoFileId:j,photoUpdatedAt:r,driveClient:s,driveSession:o,signal:m.signal}).then(v=>{y&&(c(v.url),g(v.fileId))}).catch(()=>{y&&(c(null),g(null))}).finally(()=>{y&&b(!1)}),()=>{y=!1,m.abort()}):(c(null),g(null),b(!1),()=>{y=!1,m.abort()})},[E,j,r,s,o,k,q,t]),{photoUrl:u,fileId:f,loading:S}}const gl=new Map,LS=(e,t)=>`${e}:${t||0}`;function OS(e){return/^[A-Za-z0-9+/=\s]+$/.test(e)&&e.length%4===0}function dm(e,t){try{const n=e.replace(/\s+/g,""),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)s[o]=r.charCodeAt(o);return new Blob([s],{type:t||"audio/webm"})}catch{return null}}function MS(e){if(!e)return null;if(e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Blob([e]);if(ArrayBuffer.isView(e)){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=new Uint8Array(t.length);return n.set(t),new Blob([n.buffer])}if(typeof e=="string"){if(e.startsWith("data:")){const t=e.split(",",2);if(t.length===2){const n=t[0].match(/data:([^;]+)/),r=dm(t[1],n==null?void 0:n[1]);if(r)return r}}if(OS(e)){const t=dm(e);if(t)return t}return new Blob([e])}return null}async function US(e){var n,r;if((n=e.driveSession)!=null&&n.accessToken)return e.driveSession.accessToken;if(((r=e.driveClient)==null?void 0:r.kind)==="desktop")return null;const t=await kn(e.driveSession);return(t==null?void 0:t.accessToken)||null}function FS(e,t){const n=gl.get(e);n!=null&&n.url&&URL.revokeObjectURL(n.url);const r=URL.createObjectURL(t);return gl.set(e,{url:r}),r}function zS(e){const t=gl.get(e);return(t==null?void 0:t.url)||null}function $S(e,t){for(const[n,r]of gl.entries())n.startsWith(`${e}:`)&&(t&&n===t||(r.url&&URL.revokeObjectURL(r.url),gl.delete(n)))}async function BS(e,t,n){var o;if(((o=t.driveClient)==null?void 0:o.kind)==="desktop"&&t.driveClient.downloadFile){const l=await t.driveClient.downloadFile(e);return MS(l==null?void 0:l.data)}const r=await US(t);if(!r)return null;const s=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{method:"GET",headers:{Authorization:`Bearer ${r}`},signal:n});return s.ok?s.blob():null}async function WS(e,t,n,r){const s=LS(e,t);$S(e,s);const o=zS(s);if(o)return o;const l=await BS(e,n,r);return l?FS(s,l):null}async function HS(e){const t=e.audioFileId?String(e.audioFileId):"";if(!t)return{fileId:null,url:null};const n=await WS(t,e.audioUpdatedAt,{driveClient:e.driveClient,driveSession:e.driveSession},e.signal);return{fileId:t,url:n}}function zd({studentId:e,audioFileId:t,audioUpdatedAt:n,driveClient:r,driveSession:s}){const[o,l]=d.useState(null),[u,c]=d.useState(null),[f,g]=d.useState(!1),S=d.useMemo(()=>String(e),[e]),b=d.useMemo(()=>t?String(t):"",[t]),E=(s==null?void 0:s.accessToken)||"";return d.useEffect(()=>{let j=!0;const k=new AbortController;return b?(g(!0),l(null),HS({audioFileId:b,audioUpdatedAt:n,driveClient:r,driveSession:s,signal:k.signal}).then(q=>{j&&(l(q.url),c(q.fileId))}).catch(()=>{j&&(l(null),c(null))}).finally(()=>{j&&g(!1)}),()=>{j=!1,k.abort()}):(l(null),c(null),g(!1),()=>{j=!1,k.abort()})},[S,b,n,r,s,E]),{audioUrl:o,fileId:u,loading:f}}const VS="newui_constraints_v1";function KS(){try{const e=localStorage.getItem(VS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function GS(){return KS()}const v0=d.createContext(null);function YS({children:e}){const[t,n]=d.useState([]),r=d.useCallback(l=>{n(u=>u.filter(c=>c.id!==l))},[]),s=d.useCallback(l=>{const u=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`,c=l.tone||"info",f=l.duration??4e3;n(g=>[...g,{...l,id:u,tone:c}]),f>0&&typeof window<"u"&&window.setTimeout(()=>r(u),f)},[r]),o=d.useMemo(()=>s,[s]);return i.jsxs(v0.Provider,{value:o,children:[e,i.jsx("div",{className:"pointer-events-none fixed top-6 left-1/2 -translate-x-1/2 z-[1000] flex flex-col gap-4 w-full max-w-lg items-center",children:t.map(l=>{const u=l.tone==="success"?"bg-emerald-600 text-white shadow-emerald-500/40":l.tone==="error"?"bg-rose-600 text-white shadow-rose-500/40":l.tone==="warning"?"bg-amber-500 text-slate-900 shadow-amber-400/40":"bg-slate-800 text-white shadow-slate-900/40";return i.jsxs("div",{className:`pointer-events-auto rounded-3xl px-5 py-4 shadow-2xl flex items-start gap-4 text-base font-semibold w-full ${u}`,children:[i.jsx("div",{className:"flex-1 text-sm font-semibold",children:l.message}),i.jsx("button",{className:"text-base font-bold opacity-80 hover:opacity-100",onClick:()=>r(l.id),"aria-label":"Dismiss notification",children:""})]},l.id)})})]})}function $d(){const e=d.useContext(v0);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}const QS="newui_history_v1";function JS(){try{const e=localStorage.getItem(QS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function qS(){return JS()}const XS="newui_groupings_v1";function ZS(){try{const e=localStorage.getItem(XS);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function e1(){return ZS()}console.log(" GroupingAlgorithm.js (FIXED v2) file loaded!");console.log(" GroupingAlgorithm v2 loaded successfully!");const t1="newui_print_settings_v1",n1={seatingChartEditor:{lastUpdated:new Date(0).toISOString()}};function r1(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function nr(e,t,n,r){const s=typeof e=="number"?e:parseFloat(String(e));return Number.isFinite(s)?Math.min(r,Math.max(n,s)):t}function s1(e){return e==="a4"||e==="legal"||e==="tabloid"?e:"letter"}function o1(e){return Array.isArray(e)?e.filter(t=>typeof t=="string"||typeof t=="number"):null}function l1(e){return e==="posterTiled"?e:"single"}function i1(){var n,r,s,o,l;const e=r1(localStorage.getItem(t1)),t=(e==null?void 0:e.seatingChartEditor)??{};return{seatingChartEditor:{paper:s1(t.paper),orientation:t.orientation==="portrait"?"portrait":"landscape",marginMode:t.marginMode==="max"?"max":"safe",showPhotos:t.showPhotos!==!1,showTags:t.showTags!==!1,showSeatNumbers:t.showSeatNumbers===!0,showTableHeader:t.showTableHeader!==!1,selectedTagIds:o1(t.selectedTagIds),textScale:nr(t.textScale,1,.5,2.5),photoScale:nr(t.photoScale,1,.5,2),zoom:nr(t.zoom,1,.1,4),offsetX:nr(t.offsetX,0,-5e3,5e3),offsetY:nr(t.offsetY,0,-5e3,5e3),seatingChartLayoutMode:l1(t.seatingChartLayoutMode),poster:{mode:((n=t.poster)==null?void 0:n.mode)==="manual"?"manual":"auto",rows:Math.round(nr((r=t.poster)==null?void 0:r.rows,2,1,10)),cols:Math.round(nr((s=t.poster)==null?void 0:s.cols,2,1,10)),overlapIn:nr((o=t.poster)==null?void 0:o.overlapIn,.25,0,.5),showPageLabels:((l=t.poster)==null?void 0:l.showPageLabels)!==!1},lastUpdated:typeof t.lastUpdated=="string"?t.lastUpdated:n1.seatingChartEditor.lastUpdated}}}function w0(e,t=50){const n=t>0?t:50,r=Math.ceil(n*.9),s=Math.ceil(n*.7),o=Math.ceil(n*.5);return e>=r?{label:"Good Standing",color:"green",emoji:"",min:r}:e>=s?{label:"Caution",color:"yellow",emoji:"",min:s,max:r-1}:e>=o?{label:"Warning",color:"orange",emoji:"",min:o,max:s-1}:{label:"Alert",color:"red",emoji:"",min:0,max:o-1}}function a1(){return{periods:Tc().periods.map(t=>({id:t.id,behaviorNotes:t.behaviorNotes||{},pointsByStudent:t.pointsByStudent||{},pointsHistory:t.pointsHistory||[],pointsEnabled:t.pointsEnabled,startingPoints:t.startingPoints}))}}const u1=e=>{const[t,n,r]=e.split("-").map(s=>Number(s));return!Number.isFinite(t)||!Number.isFinite(n)||!Number.isFinite(r)?null:new Date(Date.UTC(t,n-1,r))},c1=e=>{const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return`${t}-${n}-${r}`},d1=e=>{const t=u1(e);return t?(t.setUTCDate(t.getUTCDate()-1),c1(t)):e},S0=(e,t,n)=>{if(!e)return null;const r=e[String(t)];return r&&r[n]||null},f1=e=>{if(!e)return null;const t=Object.keys(e);return t.length===0?null:t.reduce((n,r)=>r<n?r:n,t[0])};function Eu(e){var g;const{attendance:t,studentId:n,date:r,status:s,resets:o}=e;if(!t)return 0;const l=String(n),c=S0(o,n,s==="left_early"?"leftEarly":s==="tardy"?"tardy":"absent");let f=0;for(const S of Object.keys(t))S>r||c&&S<c||((g=t[S])==null?void 0:g[l])===s&&(f+=1);return f}function p1(e){var b,E;const{attendance:t,studentId:n,date:r,resets:s}=e;if(!t)return 0;const o=String(n),l=S0(s,n,"absent");if(l&&r<l)return 0;const u=Object.keys(t).filter(j=>j<=r&&(!l||j>=l)).sort((j,k)=>k.localeCompare(j));if(u.length===0)return 0;let c=null;for(const j of u){const k=((b=t[j])==null?void 0:b[o])||"unmarked";if(k!=="unmarked"){if(k!=="absent")return 0;c=j;break}}if(!c)return 0;const f=f1(t);let g=c,S=0;for(;!(l&&g<l);){const j=((E=t[g])==null?void 0:E[o])||"unmarked";if(j==="absent")S+=1;else if(j!=="unmarked")break;if(!f||g<=f)break;g=d1(g)}return S}const b0="https://www.classseats.com/updates",Bd="https://classseats.com",m1=`${Bd}/privacy.html`,h1=`${Bd}/terms.html`;function g1({variant:e="floating",className:t}){const n=new Date().getFullYear(),r=i.jsxs("div",{className:"w-full max-w-[460px] rounded-xl border border-indigo-100 bg-white/95 px-3 py-3 text-left text-slate-800 shadow-lg backdrop-blur",children:[i.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-700 flex flex-wrap items-center gap-1",children:[i.jsx("span",{children:"Early Access"}),i.jsx("span",{children:""}),i.jsx("a",{href:b0,target:"_blank",rel:"noreferrer",className:"text-indigo-700 underline decoration-indigo-300 decoration-2 underline-offset-4 hover:text-indigo-800",children:"Updates"}),i.jsx("span",{children:""}),i.jsxs("span",{children:["(c) ",n," ClassWare Solutions, LLC"]})]}),i.jsx("p",{className:"mt-1 text-[11px] leading-snug text-slate-700",children:"ClassSeats is in development. Features and pricing may change."})]});return e==="floating"?i.jsx("div",{className:`pointer-events-none fixed bottom-3 left-3 right-3 z-40 flex justify-end md:left-auto md:right-4 md:max-w-[420px] ${t??""}`,children:i.jsx("div",{className:"pointer-events-auto w-full md:w-auto",children:r})}):i.jsx("div",{className:t,children:r})}const y1="0.1.0",x1=new Date().toLocaleDateString();function v1({open:e,onClose:t,buildRevision:n}){const r=new Date().getFullYear();return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),i.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-700",children:["ClassSeats",i.jsx("sup",{className:"text-[6px] font-normal align-super",children:"TM"})," (Early Access)"]}),i.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"About"})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:t,"aria-label":"Close about",children:""})]}),i.jsx("p",{className:"mt-2 text-sm leading-relaxed text-slate-700",children:"ClassSeats is in active development. Features and pricing may change. Data is stored in your Google Drive or locally on your device  ClassWare Solutions, LLC does not store student data on its servers."}),i.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm text-slate-800 space-y-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"App version"}),i.jsx("span",{children:y1})]}),n&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build revision"}),i.jsxs("span",{children:["Rev ",n]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Build date"}),i.jsx("span",{children:x1})]})]}),i.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[i.jsx(ui,{href:Bd,label:"Home"}),i.jsx(ui,{href:m1,label:"Privacy"}),i.jsx(ui,{href:h1,label:"Terms"}),i.jsx(ui,{href:b0,label:"Get updates"})]}),i.jsxs("p",{className:"mt-4 text-[11px] text-slate-500",children:[" ",r," ClassWare Solutions, LLC. All rights reserved."]}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Google Drive is a trademark of Google LLC"}),i.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"ClassSeats is a product of ClassWare Solutions, LLC"})]})]}):null}function ui({href:e,label:t}){return i.jsxs("a",{href:e,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-800 shadow-sm hover:border-indigo-200 hover:text-indigo-700",children:[t,i.jsx("span",{"aria-hidden":"true",children:""})]})}function w1(e){const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function S1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function b1({isOpen:e,onRequestClose:t,unreadMessages:n,allMessages:r,dismissedIds:s,onDismiss:o}){const[l,u]=Os.useState("unread"),c=Os.useRef(!1);Os.useEffect(()=>{if(!e){c.current=!1;return}c.current||(c.current=!0,u("unread"))},[e]);const f=l==="all"?r:n;return i.jsxs(Pd,{isOpen:e,onRequestClose:t,title:"Messages",subtitle:"Updates and notes from ClassSeats",maxWidth:"md",footer:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsxs("p",{className:"text-xs text-slate-600",children:["Need Help? Email"," ",i.jsx("a",{className:"font-semibold text-slate-700 hover:text-slate-900",href:"mailto:support@classseats.com",children:"support@classseats.com"})]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 text-sm font-semibold",onClick:t,children:"Close"})]}),children:[i.jsxs("div",{className:"mb-3 inline-flex items-center rounded-full border border-slate-200 bg-slate-100 p-1",children:[i.jsxs("button",{type:"button",onClick:()=>u("unread"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="unread"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["Unread (",n.length,")"]}),i.jsxs("button",{type:"button",onClick:()=>u("all"),className:`rounded-full px-3 py-1 text-xs font-semibold ${l==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-700 hover:bg-slate-200"}`,children:["All (",r.length,")"]})]}),f.length===0?i.jsx("div",{className:"py-6",children:l==="unread"?i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No new messages right now."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"You're all caught up."})]}):i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-slate-700",children:"No messages available yet."}),i.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Published messages will appear here."})]})}):i.jsx("div",{className:"flex flex-col gap-3 py-1",children:f.map(g=>{var S,b;return i.jsxs("article",{className:"rounded-xl border border-slate-200 bg-white",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("h3",{className:"text-sm font-extrabold text-slate-900 truncate",children:g.title}),g.priority==="high"&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-100 text-rose-800 px-2 py-0.5 text-[11px] font-semibold",children:"Important"}),l==="all"&&s.has(g.id)&&i.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2 py-0.5 text-[11px] font-semibold",children:"Dismissed"})]}),i.jsx("div",{className:"mt-1 text-xs text-slate-500",children:w1(g.publishedAt)})]}),l==="all"&&s.has(g.id)?i.jsx("span",{className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-600 px-2.5 py-1 text-[11px] font-semibold",children:"Dismissed"}):i.jsx("button",{type:"button",className:"shrink-0 inline-flex items-center rounded-full bg-slate-100 text-slate-700 px-2.5 py-1 text-[11px] font-semibold hover:bg-slate-200",onClick:()=>o(g.id),title:"Dismiss this message",children:"Dismiss"})]}),i.jsxs("div",{className:"px-4 py-3",children:[i.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:g.body}),((S=g.cta)==null?void 0:S.label)&&((b=g.cta)==null?void 0:b.href)&&S1(g.cta.href)&&i.jsx("div",{className:"mt-3",children:i.jsxs("a",{className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 text-white px-3 py-2 text-sm font-semibold hover:bg-indigo-700",href:g.cta.href,target:"_blank",rel:"noopener noreferrer",children:[g.cta.label,i.jsx("span",{"aria-hidden":!0,children:""})]})})]})]},g.id)})})]})}function N1({current:e,onGoDesktop:t,onGoMobile:n}){const r="px-3 py-1.5 text-xs font-semibold rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500",s="bg-slate-900 text-white",o="bg-white text-slate-700 border border-slate-200 hover:bg-slate-50";return i.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white/80 p-1 shadow-sm",children:[i.jsx("button",{type:"button","aria-pressed":e==="desktop",className:`${r} ${e==="desktop"?s:o}`,onClick:t,children:"Desktop"}),i.jsx("button",{type:"button","aria-pressed":e==="mobile",className:`${r} ${e==="mobile"?s:o}`,onClick:n,children:"Mobile"})]})}function k1(){var n;if(typeof navigator>"u")return!1;const e=(n=navigator.userAgentData)==null?void 0:n.mobile;if(typeof e=="boolean")return e;const t=navigator.userAgent||"";return/iPhone|Android.+Mobile|Windows Phone|iPod/i.test(t)}function j1(e,t,n){const r=Tc().currentId,s=r!=null?String(r):null,o=new Date().toISOString();return{schemaVersion:1,version:1,exportedAt:o,updatedAt:o,lastWriter:"unknown",layouts:rw(),periodsState:Tc(),lastEditedPeriodId:s,lastEditedDate:null,students:n||fw(),tags:aw(),behaviorState:a1(),constraintsState:GS(),historyState:qS(),groupingsState:e1(),printSettings:i1()}}const or=e=>!!e&&typeof e=="object",C1=e=>e===!0||e==="true"||e===1||e==="1",Gr=e=>{const t=typeof e=="number"?e:parseInt(String(e),10);return Number.isFinite(t)&&Number.isInteger(t)?t:null};function E1(e){if(!or(e))return;const t=e.singleSeat;if(!or(t))return;const n=t.template;if(n!=="grid"&&n!=="arc")return;const r=Gr(t.row)??void 0,s=Gr(t.col)??void 0,o=Gr(t.arcIndex)??void 0,l=Gr(t.seatIndex)??void 0,u=t.angle,c=Number.isFinite(u)?Number(u):void 0;return{singleSeat:{template:n,row:r,col:s,arcIndex:o,seatIndex:l,angle:c}}}function R1(e,t){if(!Array.isArray(e))return[];const n=[];for(const r of e){const s=Gr(r);s!=null&&(s<0||s>=t||n.push(s))}return Array.from(new Set(n)).sort((r,s)=>r-s)}function _1(e){var u;if(!e||typeof e!="object"||(e.schemaVersion??(e.version===1?1:void 0))!==1)return null;const n=typeof e.exportedAt=="string"?e.exportedAt:new Date().toISOString(),r=typeof e.updatedAt=="string"?e.updatedAt:n,s=e.lastWriter==="desktop"||e.lastWriter==="mobile"||e.lastWriter==="unknown"?e.lastWriter:"unknown",o={...e,schemaVersion:1,version:e.version??1,exportedAt:n,updatedAt:r,lastWriter:s};if(o.behaviorState=or(e.behaviorState)?e.behaviorState:{},!or(o.periodsState)||!Array.isArray((u=o.periodsState)==null?void 0:u.periods)||!Array.isArray(o.students)||!Array.isArray(o.layouts)||!or(o.behaviorState)||!or(o.constraintsState)||!or(o.historyState)||!or(o.groupingsState))return null;switch((e.schemaVersion!==o.schemaVersion||e.updatedAt!==o.updatedAt||e.exportedAt!==o.exportedAt||e.lastWriter!==o.lastWriter)&&console.log("[Payload] migrated to schema v1",{hadSchemaVersion:e.schemaVersion,hadVersion:e.version,addedUpdatedAt:e.updatedAt!==o.updatedAt,addedLastWriter:e.lastWriter!==o.lastWriter}),o.schemaVersion){case 1:return o.students=(o.students||[]).map(c=>({...c,needsPreferredSeating:C1(c.needsPreferredSeating),quickNote:(typeof c.quickNote=="string",c.quickNote),quickNoteUpdatedAt:(typeof c.quickNoteUpdatedAt=="string",c.quickNoteUpdatedAt),photoFileId:typeof c.photoFileId=="string"?c.photoFileId:c.photoFileId==null?null:String(c.photoFileId),photoUpdatedAt:Gr(c.photoUpdatedAt),audioFileId:typeof c.audioFileId=="string"?c.audioFileId:c.audioFileId==null?null:String(c.audioFileId),audioUpdatedAt:Gr(c.audioUpdatedAt)})),o.layouts=(o.layouts||[]).map(c=>({...c,tables:(c.tables||[]).map(f=>{const g=Math.max(0,f.capacity||0),S=E1(f.meta);return{...f,meta:S,preferredSeatIndexes:R1(f.preferredSeatIndexes,g),seatLayout:Jg(g||1,f.rotation||0,f.seatLayout||null)}})})),o;default:return null}}function T1(e){return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.hasFile?e.dirty?{action:"upload",reason:"ready"}:{action:"skip",reason:"clean"}:{action:"skip",reason:"no-file"}}function P1(e){const t=e.graceMs;return e.isOffline?{action:"skip",reason:"offline"}:e.isLocked?{action:"skip",reason:"locked"}:e.inFlight?{action:"skip",reason:"in-flight"}:e.dirty?{action:"skip",reason:"dirty"}:e.lastLocalEditAt&&e.now-e.lastLocalEditAt<t?{action:"skip",reason:"grace-window"}:{action:"pull",reason:"ready"}}function A1(e){if(e.incomingRevisionId&&e.lastRevisionId)return e.incomingRevisionId===e.lastRevisionId?{action:"skip",reason:"same-revision"}:{action:"apply",reason:"fresh-revision"};const t=e.incomingUpdatedAt?Date.parse(e.incomingUpdatedAt):NaN,n=e.lastAppliedUpdatedAt?Date.parse(e.lastAppliedUpdatedAt):NaN;return Number.isFinite(t)&&Number.isFinite(n)&&t<=n?{action:"skip",reason:"stale-updatedAt"}:{action:"apply",reason:"fresh"}}const I1=new Set(["students","periodsState","layouts","tags","constraintsState","historyState","groupingsState","behaviorNotes","attendance","notes","alerts","payload"]),Ac=(e,t,n)=>{if(I1.has(t))return"[omitted]";if(typeof e=="string")return e.length>200?`[string ${e.length}]`:e;if(Array.isArray(e)){const r=e.slice(0,5).map(s=>Ac(s,"",n+1));return e.length>5&&r.push(`[+${e.length-5} more]`),n>1?`[array len=${e.length}]`:r}if(e&&typeof e=="object"){if(n>1)return"[object]";const r=Object.entries(e).slice(0,10).map(([s,o])=>[s,Ac(o,s,n+1)]);return r.length===0?e:Object.fromEntries(r)}return e};function To(e,t){if(!(typeof console>"u"))try{const n=t?Ac(t,"",0):void 0;n!==void 0?console.log(e,n):console.log(e)}catch{console.log(e)}}const fm="classseats_first_seen_at_v1",N0="classseats_announcements_dismissed_v1",D1="classseats_announcements_last_read_published_at_v1",k0="classseats_announcements_cache_v1",Wd="classseats_announcements_cache_at_v1",pm="appPrefs",Ic="announcements_state_v1.json";function yl(){return new Date().toISOString()}function $o(e){const t=Date.parse(e);return Number.isFinite(t)?t:0}function an(e){return typeof e=="string"?e.trim():""}function Hd(e){const t=an(e);return t&&Number.isFinite(Date.parse(t))?t:null}function L1(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function O1(e){return!!e&&typeof e=="object"&&e.schema===1&&Array.isArray(e.messages)}function M1(e){if(!e||typeof e!="object")return null;const t=e,n=an(t.id),r=t.audience==="onboarding"?"onboarding":t.audience==="all"?"all":null,s=t.priority==="high"?"high":t.priority==="normal"?"normal":null,o=an(t.publishedAt),l=an(t.title),u=an(t.body);if(!n||!r||!s||!o||!l||!u)return null;let c;const f=t.cta;if(f&&typeof f=="object"){const g=f,S=an(g.label),b=an(g.href);S&&b&&L1(b)&&(c={label:S,href:b})}return{id:n,audience:r,publishedAt:o,title:l,body:u,priority:s,...c?{cta:c}:{}}}function U1(e){if(!e||typeof e!="object")return null;const t=e;if(t.schema!==1&&t.schema!==2)return null;const n=an(t.updatedAt),r=Array.isArray(t.dismissed)?t.dismissed:[],s=Array.from(new Set(r.map(l=>an(l)).filter(Boolean))),o=Hd(t.lastReadPublishedAt);return{schema:2,updatedAt:n||yl(),dismissed:s,lastReadPublishedAt:o}}function j0(e){if(!O1(e))return null;const t=new Set,n=[];for(const r of e.messages){const s=M1(r);s&&(t.has(s.id)||(t.add(s.id),n.push(s)))}return{schema:1,messages:n}}function F1(){try{const e=localStorage.getItem(fm);if(e)return e;const t=yl();return localStorage.setItem(fm,t),t}catch{return yl()}}function Xo(){try{const e=localStorage.getItem(N0);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.map(n=>String(n))):new Set}catch{return new Set}}function Dc(e){try{localStorage.setItem(N0,JSON.stringify(Array.from(e)))}catch{}}function z1(){try{const e=localStorage.getItem(D1);return Hd(e)}catch{return null}}function $1(e){const t=Xo();t.add(String(e)),Dc(t)}function mm(e,t){return{schema:2,updatedAt:yl(),dismissed:Array.from(new Set(Array.from(e).map(n=>an(n)).filter(Boolean))),lastReadPublishedAt:Hd(t)}}function hm(e){try{const t=JSON.parse(e);return U1(t)}catch{return null}}function gm(e,t){const n=new Set(Array.from(e).map(String));for(const r of t){const s=an(r);s&&n.add(s)}return n}function B1(e,t){const n=$o(t),r=e.messages.filter(s=>s.audience==="onboarding"?!0:$o(s.publishedAt)>n);return r.sort((s,o)=>{const l=s.priority==="high"?1:0,u=o.priority==="high"?1:0;return l!==u?u-l:$o(o.publishedAt)-$o(s.publishedAt)}),r}function C0(){try{const e=localStorage.getItem(k0),t=localStorage.getItem(Wd);if(!e)return{wrapper:null,cacheAt:t||null};const n=JSON.parse(e);return{wrapper:j0(n),cacheAt:t||null}}catch{return{wrapper:null,cacheAt:null}}}function W1(e){try{localStorage.setItem(k0,JSON.stringify(e)),localStorage.setItem(Wd,yl())}catch{}}function H1(e,t){return e?Date.now()-$o(e)>t*60*60*1e3:!0}async function V1(e,t){const n=new AbortController,r=window.setTimeout(()=>n.abort(),t);try{const s=await fetch(e,{cache:"no-store",signal:n.signal});return s.ok?await s.json():null}catch{return null}finally{window.clearTimeout(r)}}function _i(e,t){const n=F1(),r=Xo(),s=z1(),o=e?B1(e,n):[],l=o.filter(u=>!r.has(u.id));return{fetchedAt:t,messages:l,allMessages:o,dismissedIds:new Set(r),lastReadPublishedAt:s,unreadCount:l.length}}function ci(){const{wrapper:e,cacheAt:t}=C0();return _i(e,t)}async function ym(e=12,t=!1){const{wrapper:n,cacheAt:r}=C0();if(!t&&!H1(r,e))return _i(n,r);const s=await V1("/announcements.json",3e3),o=j0(s);if(!o)return _i(n,r);W1(o);const l=(()=>{try{return localStorage.getItem(Wd)}catch{return r}})();return _i(o,l)}const xm="https://app.classseats.app";function K1({open:e,onBypass:t}){const[n,r]=d.useState(!1);if(d.useEffect(()=>{if(!e)return;const o=document.documentElement.style.overflow,l=document.body.style.overflow;return document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",()=>{document.documentElement.style.overflow=o,document.body.style.overflow=l}},[e]),!e)return null;const s=async()=>{try{await navigator.clipboard.writeText(xm),r(!0),window.setTimeout(()=>r(!1),1200)}catch{r(!1)}};return i.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Mobile setup required",style:{position:"fixed",inset:0,zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:16,background:"rgba(0,0,0,0.55)"},children:i.jsxs("div",{style:{width:"min(520px, 100%)",borderRadius:16,background:"white",color:"#0f172a",padding:18,boxShadow:"0 12px 40px rgba(0,0,0,0.25)"},children:[i.jsx("div",{style:{fontSize:22,fontWeight:700,marginBottom:10},children:"Hi! "}),i.jsxs("div",{style:{fontSize:15,lineHeight:1.45,marginBottom:14},children:[i.jsx("div",{style:{marginBottom:10},children:"Thanks for your interest in ClassSeats. It looks like youre on a mobile device."}),i.jsxs("div",{style:{marginBottom:10},children:["ClassSeats setup must be done on a desktop or laptop.",i.jsx("br",{}),"Mobile becomes available after youve set up your first class."]}),i.jsx("div",{children:"See you on desktop! "})]}),i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsx("button",{onClick:s,style:{borderRadius:12,padding:"10px 14px",border:"1px solid rgba(0,0,0,0.12)",fontWeight:600,cursor:"pointer",background:"white"},children:"Copy desktop link"}),n&&i.jsx("span",{style:{fontSize:13,fontWeight:600},children:"Copied!"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:t,style:{border:"none",background:"transparent",padding:0,fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"Ive already set up my class"})}),i.jsx("div",{style:{marginTop:10,fontSize:12,opacity:.75,userSelect:"text"},children:xm})]})})}const vm=e=>e?{...e}:{},wm=(e,t)=>{if(t.size===0)return e;const n={...e};return t.forEach(r=>{delete n[r]}),n},G1=e=>{if(!e||typeof e!="object"||typeof e.note!="string")return null;const t=typeof e.timestamp=="string"?e.timestamp:"";return{note:e.note,timestamp:t}},Y1=e=>{const t=e!=null&&e.note&&typeof e.note=="object"?e.note:e,n={};return Object.entries(t||{}).forEach(([r,s])=>{const o=G1(s);o&&(n[String(r)]=o)}),n};function Sm(e,t,n){const r={};return Object.entries(e||{}).forEach(([o,l])=>{const u=wm(vm(l),n);Object.keys(u).length>0&&(r[o]=u)}),t&&Object.entries(t).forEach(([o,l])=>{const u=wm(vm(l),n);Object.keys(u).length===0?delete r[o]:r[o]=u}),r}function bm(e,t,n,r){const s={};return Object.entries(e||{}).forEach(([l,u])=>{const c={};Object.entries(Y1(u)).forEach(([f,g])=>{n.has(f)||(c[f]=g)}),Object.keys(c).length>0&&(s[l]=c)}),t&&Object.entries(t).forEach(([l,u])=>{const c=s[l]||{},f={};Object.entries(u||{}).forEach(([g,S])=>{if(n.has(g))return;const b=c[g];b&&b.note===S?f[g]=b:f[g]={note:S,timestamp:r}}),Object.keys(f).length===0?delete s[l]:s[l]=f}),s}function Q1({children:e}){return i.jsx(i.Fragment,{children:e})}const Po=10,J1=250,q1=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a.40.2","audio/mp4"];function X1(){if(typeof MediaRecorder>"u")return"";for(const e of q1)if(MediaRecorder.isTypeSupported(e))return e;return""}function Z1(e){const t=e.toLowerCase();return t.includes("webm")?".webm":t.includes("mp4")?".m4a":".webm"}function E0({open:e,studentId:t,studentFullName:n,existingAudioFileId:r,existingAudioUpdatedAt:s,driveSession:o,onClose:l,onUploadComplete:u,onDeleteComplete:c}){const f=$d(),[g,S]=d.useState("idle"),[b,E]=d.useState(Po),[j,k]=d.useState(!1),[q,y]=d.useState(!1),[m,v]=d.useState(null),[T,O]=d.useState(0),[F,$]=d.useState(!1),z=d.useRef(null),ue=d.useRef(null),X=d.useRef([]),me=d.useRef(null),qe=d.useRef(null),ot=d.useRef(null),Xe=d.useRef(null),Fe=d.useRef(null),{audioUrl:ee}=zd({studentId:t,audioFileId:r||null,audioUpdatedAt:s??null,driveSession:o}),Oe=!!r&&!j&&!q&&g!=="recording",N=()=>{v(he=>(he!=null&&he.url&&URL.revokeObjectURL(he.url),null))},H=()=>{me.current&&(window.clearInterval(me.current),me.current=null)},Q=()=>{Fe.current&&(cancelAnimationFrame(Fe.current),Fe.current=null),ot.current=null,Xe.current=null,qe.current&&(qe.current.close().catch(()=>{}),qe.current=null),$(!1),O(0)},re=()=>{ue.current&&(ue.current.getTracks().forEach(he=>he.stop()),ue.current=null)},V=()=>{const he=z.current;he&&he.state!=="inactive"&&he.stop()},Ee=()=>{V(),Q(),re(),z.current=null,X.current=[],H()};d.useEffect(()=>(e||(Ee(),N(),S("idle"),E(Po)),()=>{e&&Ee()}),[e]);const ze=async()=>{if(g!=="recording"){if(typeof MediaRecorder>"u"){f({message:"Audio recording is not supported on this device.",tone:"error"});return}try{const he=await navigator.mediaDevices.getUserMedia({audio:!0}),St=X1(),We=new MediaRecorder(he,St?{mimeType:St}:void 0);ue.current=he,z.current=We,X.current=[];try{const Me=window.AudioContext||window.webkitAudioContext;if(Me){const Lt=new Me,Vt=Lt.createMediaStreamSource(he),B=Lt.createAnalyser();B.fftSize=512,Vt.connect(B);const _=new Uint8Array(new ArrayBuffer(B.frequencyBinCount));qe.current=Lt,ot.current=B,Xe.current=_,$(!0);const Z=()=>{const He=ot.current,et=Xe.current;if(!He||!et)return;He.getByteTimeDomainData(et);let Kt=0;for(let U=0;U<et.length;U+=1){const Y=(et[U]-128)/128;Kt+=Y*Y}const mt=Math.sqrt(Kt/et.length),M=Math.min(1,Math.sqrt(mt)*2.2);O(M),Fe.current=requestAnimationFrame(Z)};Fe.current=requestAnimationFrame(Z)}}catch{$(!1)}We.ondataavailable=Me=>{Me.data&&Me.data.size>0&&X.current.push(Me.data)},We.onstop=()=>{H(),Q(),re();const Me=We.mimeType||St,Lt=new Blob(X.current,{type:Me});if(X.current=[],!Lt.size){S("idle"),E(Po),f({message:"We could not save that recording. Please try again.",tone:"error"});return}const Vt=URL.createObjectURL(Lt);v({blob:Lt,url:Vt,mimeType:Me}),S("draft"),E(Po)},S("recording"),E(Po),We.start(J1),me.current=window.setInterval(()=>{E(Me=>Me<=1?(V(),0):Me-1)},1e3)}catch{Ee(),S("idle"),f({message:"We could not access your microphone. Please allow access and try again.",tone:"error"})}}},wt=()=>{V()},pt=async()=>{if(!(!m||j)){k(!0);try{const he=m.mimeType||m.blob.type||"audio/webm",St=Z1(he),We=await Jw({studentId:t,studentFullName:n,blob:m.blob,mimeType:he,extension:St,fileId:r||null}),Me=Date.now();u({fileId:We.fileId,audioUpdatedAt:Me}),N(),l()}catch(he){const We=(he instanceof Error?he.message:"").toLowerCase();We.includes("sign in")&&We.includes("drive")?f({message:"Please reconnect Google Drive to upload audio.",tone:"error"}):f({message:"Couldn't upload the audio. Please try again.",tone:"error"})}finally{k(!1)}}},Ze=async()=>{if(!(!r||q||!window.confirm("Delete this audio clip?"))){y(!0);try{await qw(r)}catch{f({message:"Audio was removed from the student, but we couldn't delete it from Drive.",tone:"warning"})}finally{y(!1),c(),l()}}},fn=!!r,Rr=!m&&fn,Hn=g==="idle"&&!m;return e?i.jsx(Pd,{isOpen:e,onRequestClose:l,title:"Record Audio",subtitle:"Name & Audio Intro (=10s)",maxWidth:"md",showCloseX:!0,footer:g==="draft"?i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:()=>{N(),S("idle")},disabled:j,children:"Re-record"}),i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:j,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:pt,disabled:j,children:j?"Uploading":"Accept"})]}):i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[i.jsx("div",{children:Oe&&i.jsx("button",{className:"rounded border border-rose-200 px-3 py-2 text-sm text-rose-700 hover:bg-rose-50",onClick:Ze,children:"Delete audio"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:l,disabled:j||q,children:"Close"}),Hn&&i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:ze,disabled:j||q,children:fn?"Record new":"Record"})]})]}),children:i.jsxs("div",{className:"space-y-4",children:[g==="recording"&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm font-semibold text-slate-700",children:[i.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-rose-600 animate-pulse"}),"Recording"]}),F&&i.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-200",children:i.jsx("div",{className:"h-full rounded-full bg-rose-500 transition-[width]",style:{width:`${Math.min(100,Math.max(8,Math.round(T*100)))}%`}})}),i.jsxs("div",{className:"mt-2 text-3xl font-bold text-slate-900",children:[b,"s"]}),i.jsx("button",{className:"mt-3 rounded bg-rose-600 px-4 py-2 text-sm font-semibold text-white",onClick:wt,children:"Stop"})]}),g==="draft"&&m&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Preview"}),i.jsx("audio",{controls:!0,src:m.url,className:"w-full"})]}),Rr&&i.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Current audio"}),ee?i.jsx("audio",{controls:!0,src:ee,className:"w-full"}):i.jsx("div",{className:"text-sm text-slate-500",children:"Loading audio"})]}),Hn&&!fn&&i.jsx("div",{className:"text-sm text-slate-500",children:"Tap record to capture a short name pronunciation."})]})}):null}function eb(e){const t=e.slice();for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function Yt(e){return String(e)}function Nm(e){try{const t=localStorage.getItem(e);if(!t)return new Set;const n=JSON.parse(t);return Array.isArray(n)?new Set(n.map(String)):new Set}catch{return new Set}}function Ru(e,t){try{localStorage.setItem(e,JSON.stringify(Array.from(t)))}catch{}}function km({open:e,title:t,body:n,confirmText:r,cancelText:s,onConfirm:o,onCancel:l,danger:u}){return e?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center p-4 sm:items-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:l}),i.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[i.jsxs("div",{className:"space-y-2 p-5",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:t}),i.jsx("div",{className:"text-sm text-slate-600",children:n})]}),i.jsxs("div",{className:"flex gap-2 p-4 pt-0",children:[i.jsx("button",{className:"flex-1 rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:l,children:s}),i.jsx("button",{className:`flex-1 rounded-xl px-4 py-2.5 text-sm font-semibold text-white ${u?"bg-rose-600 hover:bg-rose-700":"bg-violet-600 hover:bg-violet-700"}`,onClick:o,children:r})]})]})]}):null}function tb({students:e,periodId:t,driveFileId:n,driveClient:r,driveSession:s,onAudioSaved:o,onAudioDeleted:l}){const u=n??"local",c=`cs_mobile_flashcards_learned_v1:${u}:${t}`,[f,g]=d.useState(!1),[S,b]=d.useState(()=>Nm(c)),E=d.useRef(S);d.useEffect(()=>{E.current=S},[S]),d.useEffect(()=>{const B=Nm(c);E.current=B,b(B),g(!1)},[c]);const j=e.length,[k,q]=d.useState([]),[y,m]=d.useState(0),[v,T]=d.useState(!1),[O,F]=d.useState(null),[$,z]=d.useState(null),[ue,X]=d.useState(!1),me=d.useMemo(()=>{if(f)return e;const B=S;return e.filter(_=>!B.has(Yt(_.id))||Yt(_.id)===O)},[e,f,S,O]),qe=d.useMemo(()=>e.map(B=>Yt(B.id)).join("|"),[e]),ot=d.useMemo(()=>me.map(B=>Yt(B.id)).join("|"),[me]),Xe=d.useMemo(()=>{const B=new Set(e.map(Z=>Yt(Z.id)));let _=0;return S.forEach(Z=>{B.has(Z)&&_++}),_},[e,S]),Fe=Math.max(0,j-Xe),[ee,Oe]=d.useState(!1),[N,H]=d.useState(!1);d.useEffect(()=>{const B=E.current,_=(f?e:e.filter(Z=>!B.has(Yt(Z.id)))).map(Z=>Yt(Z.id));q(_),m(0),T(!1),F(null),z(null)},[f,t,u,qe]),d.useEffect(()=>{const B=new Set(me.map(_=>Yt(_.id)));q(_=>{const Z=_.filter(He=>B.has(He));return Z.length===_.length?_:(m(He=>Math.min(He,Math.max(0,Z.length-1))),Z)})},[ot]);const Q=d.useMemo(()=>new Map(me.map(B=>[Yt(B.id),B])),[me]),re=k[y]??null,V=re?Q.get(re)??null:null,{photoUrl:Ee}=x0({studentId:(V==null?void 0:V.id)??"unknown",fullName:(V==null?void 0:V.fullName)??null,photoFileId:(V==null?void 0:V.photoFileId)??null,photoUpdatedAt:(V==null?void 0:V.photoUpdatedAt)??null,driveClient:r,driveSession:s}),{audioUrl:ze}=zd({studentId:(V==null?void 0:V.id)??"unknown",audioFileId:(V==null?void 0:V.audioFileId)??null,audioUpdatedAt:(V==null?void 0:V.audioUpdatedAt)??null,driveSession:s}),wt=d.useRef(null),[pt,Ze]=d.useState(!1);d.useEffect(()=>{Ze(!1)},[ze]);const fn=B=>!re||O!==re||f?!1:(q(_=>{const Z=_.filter(He=>He!==re);return m(He=>Z.length===0?0:B==="prev"?Math.max(0,He-1):Math.min(He,Z.length-1)),Z}),F(null),!0),Rr=()=>{T(!1),z(null),!fn("next")&&m(B=>k.length===0?0:Math.min(B+1,k.length-1))},Hn=()=>{T(!1),z(null),!fn("prev")&&m(B=>Math.max(0,B-1))},he=async()=>{if(!ze)return;const B=wt.current;if(B){if(pt){B.pause(),Ze(!1);return}try{await B.play(),Ze(!0)}catch{}}},St=()=>{if(!V)return;const B=Yt(V.id);z(null),b(_=>{const Z=new Set(_);return Z.add(B),Ru(c,Z),Z}),F(B)},We=()=>{if(!V)return;const B=Yt(V.id);F(null),z(_=>_===B?null:B),b(_=>{if(!_.has(B))return _;const Z=new Set(_);return Z.delete(B),Ru(c,Z),Z})},Me=()=>{Oe(!1),T(!1),F(null),z(null),q(B=>eb(B)),m(0)},Lt=()=>{H(!1),T(!1),F(null),z(null);const B=new Set;b(B),Ru(c,B);const _=e.map(Z=>Yt(Z.id));q(_),m(0)},Vt=!f&&Fe===0&&j>0;return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsxs("div",{className:"space-y-0.5",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Flashcards"}),i.jsxs("div",{className:"text-xs text-slate-600",children:["Learned ",Xe," / ",j,"  Remaining ",Fe]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:k.length<2,onClick:()=>Oe(!0),children:"Shuffle"}),i.jsx("button",{className:`rounded-xl border px-3 py-2 text-xs font-semibold ${f?"border-violet-200 bg-violet-50 text-violet-900":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"}`,onClick:()=>{g(B=>!B),T(!1),F(null),z(null)},children:f?"Including learned":"Include learned"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>H(!0),children:"Clear learned"})]})]}),Vt?i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"All learned!"}),i.jsx("div",{className:"text-sm text-slate-600",children:"Youve marked everyone in this period as learned."}),i.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[i.jsx("button",{className:"rounded-xl bg-violet-600 px-4 py-3 text-sm font-semibold text-white hover:bg-violet-700",onClick:()=>g(!0),children:"Review learned students"}),i.jsx("button",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm font-semibold text-rose-700 hover:bg-rose-100",onClick:()=>H(!0),children:"Clear learned for this period"})]})]}):i.jsx("div",{className:"space-y-3",children:V?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"relative w-full",style:{perspective:1200},children:i.jsx("button",{type:"button",onClick:()=>T(B=>!B),className:"w-full text-left","aria-label":"Flip flashcard",children:i.jsxs("div",{className:"relative h-[380px] w-full",style:{transformStyle:"preserve-3d",transition:"transform 420ms cubic-bezier(0.2, 0.8, 0.2, 1)",transform:v?"rotateY(180deg)":"rotateY(0deg)"},children:[i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden"},children:i.jsxs("div",{className:"h-full w-full bg-slate-50 flex items-center justify-center",children:[Ee?i.jsx("img",{src:Ee,alt:"",className:"h-full w-full object-cover"}):i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-200 text-2xl font-bold text-slate-700",children:V.fullName.split(" ").slice(0,2).map(B=>{var _;return((_=B[0])==null?void 0:_.toUpperCase())??""}).join("")}),i.jsx("div",{className:"mt-3 text-sm text-slate-500",children:"No photo"})]}),i.jsx("div",{className:"absolute bottom-3 left-0 right-0 text-center text-xs font-semibold text-slate-500",children:"Tap to flip"})]})}),i.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-xl",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:i.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold leading-tight text-slate-900",children:V.fullName}),i.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"Tap again to see photo"}),i.jsxs("div",{className:"mt-4 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${ze?"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50":"border border-slate-200 bg-white text-slate-400 cursor-not-allowed"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),he()},disabled:!ze,children:pt?"Pause audio":"Play audio"}),i.jsx("button",{className:"w-full rounded-2xl px-4 py-3 text-sm font-semibold transition border border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100",onClick:B=>{B.preventDefault(),B.stopPropagation(),X(!0)},children:V.audioFileId?"Re-record audio":"Record audio"})]}),i.jsx("audio",{ref:wt,src:ze||void 0,onEnded:()=>Ze(!1),onPause:()=>Ze(!1)}),i.jsxs("div",{className:"mt-6 w-full max-w-sm space-y-2",children:[i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${O===re?"bg-emerald-600 text-white hover:bg-emerald-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),St()},children:" Ive learned this"}),i.jsx("button",{className:`w-full rounded-2xl px-4 py-3 text-sm font-semibold transition ${$===re?"bg-violet-600 text-white hover:bg-violet-700":"border border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`,onClick:B=>{B.preventDefault(),B.stopPropagation(),We()},children:" Still learning"})]})]})})]})})}),i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:y===0,onClick:Hn,children:"Prev"}),i.jsx("div",{className:"px-2 text-xs font-semibold text-slate-500",children:k.length===0?"0 / 0":`${y+1} / ${k.length}`}),i.jsx("button",{className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:k.length===0||y>=k.length-1,onClick:Rr,children:"Next"})]}),ue&&V&&i.jsx(E0,{open:!0,studentId:V.id,studentFullName:V.fullName,existingAudioFileId:V.audioFileId??null,existingAudioUpdatedAt:V.audioUpdatedAt??null,driveSession:s,onClose:()=>X(!1),onUploadComplete:({fileId:B,audioUpdatedAt:_})=>{o(V.id,B,_),X(!1)},onDeleteComplete:()=>{l(V.id),X(!1)}})]}):i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 text-center space-y-2",children:[i.jsx("div",{className:"text-base font-semibold text-slate-900",children:"No students found."}),i.jsx("div",{className:"text-sm text-slate-600",children:"This period doesnt have any students yet."})]})}),i.jsx(km,{open:ee,title:"Shuffle deck?",body:"This will randomize the order of the current deck once.",confirmText:"Shuffle",cancelText:"Cancel",onConfirm:Me,onCancel:()=>Oe(!1)}),i.jsx(km,{open:N,title:"Clear learned students?",body:"This resets learned progress for this period on this device.",confirmText:"Clear",cancelText:"Cancel",danger:!0,onConfirm:Lt,onCancel:()=>H(!1)})]})}const nb=.85,rb=900,sb=1200,ob=4,lb=60,ib=160;function ab({studentId:e,studentFullName:t,existingPhotoFileId:n,open:r,onClose:s,onAccept:o,onUploadComplete:l,title:u="Take Photo"}){const c=$d(),f=d.useRef(null),g=d.useRef(null),S=d.useRef(null),b=d.useRef(null),E=d.useRef(null),j=d.useRef(!1),k=d.useRef(new Map),q=d.useRef(null),y=d.useRef(null),m=d.useRef(1),v=d.useRef(null),T=d.useRef(null),[O,F]=d.useState(null),[$,z]=d.useState(!1),[ue,X]=d.useState(!1),[me,qe]=d.useState(!1),[ot,Xe]=d.useState(1),[Fe,ee]=d.useState(!1),[Oe,N]=d.useState(!1),H=d.useRef(null),Q=d.useMemo(()=>{if(typeof navigator>"u")return{isIOS:!1,isAndroid:!1};const M=navigator.userAgent||"",U=/iPad|iPhone|iPod/i.test(M)||M.includes("Mac")&&typeof document<"u"&&"ontouchend"in document,Y=/Android/i.test(M);return{isIOS:U,isAndroid:Y}},[]),re=()=>{k.current.clear(),q.current=null,v.current&&(cancelAnimationFrame(v.current),v.current=null),T.current=null},V=()=>{b.current=null,y.current=null,m.current=1,Xe(1),qe(!1),re()},Ee=()=>(H.current||(H.current=document.createElement("canvas")),H.current),ze=M=>{const U=Ee(),Y=U.getContext("2d");if(!Y)return 0;const J=ib,ce=Math.max(M.width,M.height)/J,de=Math.max(1,Math.round(M.width/(ce||1))),ye=Math.max(1,Math.round(M.height/(ce||1)));U.width=de,U.height=ye,Y.drawImage(M,0,0,de,ye);const Se=Y.getImageData(0,0,de,ye).data;let ge=0;for(let ht=0;ht<ye;ht++){const Vn=ht*de*4;for(let lt=0;lt<de;lt++){const Kn=Vn+lt*4,oo=(Se[Kn]+Se[Kn+1]+Se[Kn+2])/3;if(lt<de-1){const pn=Kn+4,Gn=(Se[pn]+Se[pn+1]+Se[pn+2])/3;ge+=Math.abs(oo-Gn)}if(ht<ye-1){const pn=Kn+de*4,Gn=(Se[pn]+Se[pn+1]+Se[pn+2])/3;ge+=Math.abs(oo-Gn)}}}return ge},wt=M=>{const{width:U,height:Y}=M;if(!U||!Y)return M;const J=rb/U,ce=sb/Y,de=Math.min(1,J,ce);if(de>=.999)return M;const ye=Math.max(1,Math.round(U*de)),Se=Math.max(1,Math.round(Y*de)),ge=document.createElement("canvas");ge.width=ye,ge.height=Se;const ht=ge.getContext("2d");return ht?(ht.drawImage(M,0,0,ye,Se),ge):M},pt=async M=>new Promise(U=>{M.toBlob(Y=>{if(Y){U(Y);return}M.toBlob(J=>U(J),"image/png")},"image/jpeg",nb)}),Ze=async M=>{const U=wt(M);return pt(U)},fn=async M=>{try{const U=await createImageBitmap(M),Y=document.createElement("canvas");Y.width=U.width,Y.height=U.height;const J=Y.getContext("2d");if(!J)return null;if(J.drawImage(U,0,0),"close"in U)try{U.close()}catch{}return Y}catch{return new Promise(U=>{const Y=URL.createObjectURL(M),J=new Image;J.onload=()=>{const ce=document.createElement("canvas");ce.width=J.naturalWidth||J.width,ce.height=J.naturalHeight||J.height;const de=ce.getContext("2d");if(URL.revokeObjectURL(Y),!de){U(null);return}de.drawImage(J,0,0),U(ce)},J.onerror=()=>{URL.revokeObjectURL(Y),U(null)},J.src=Y})}},Rr=async(M,U)=>{const Y=f.current,J=g.current;if(!Y||!J)return null;const ce=Y.videoWidth,de=Y.videoHeight;if(!ce||!de)return null;J.width=ce,J.height=de;const ye=J.getContext("2d");if(!ye)return null;let Se=-1/0,ge=null;for(let ht=0;ht<M;ht++){if(!j.current)return null;ht===0?await new Promise(lt=>requestAnimationFrame(()=>lt())):U>0&&await new Promise(lt=>setTimeout(lt,U)),ye.drawImage(Y,0,0,ce,de);const Vn=ze(J);if(Vn>=Se){Se=Vn,ge||(ge=document.createElement("canvas")),ge.width=ce,ge.height=de;const lt=ge.getContext("2d");lt&&lt.drawImage(J,0,0,ce,de)}}return ge||J},Hn=async()=>{if(typeof window>"u")return null;const M=b.current,U=window.ImageCapture;if(!M||!U)return null;try{const Y=new U(M);return typeof Y.takePhoto!="function"?null:await Y.takePhoto()}catch{return null}},he=()=>{S.current&&(S.current.getTracks().forEach(M=>M.stop()),S.current=null),f.current&&(f.current.srcObject=null),V()},St=()=>{O&&URL.revokeObjectURL(O),E.current=null,F(null)},We=()=>{he(),St(),z(!1),ee(!1),N(!1),s()},Me=M=>{const U=y.current;if(!U)return M;let Y=Math.min(U.max,Math.max(U.min,M));if(typeof U.step=="number"&&U.step>0){const J=Math.round((Y-U.min)/U.step);Y=U.min+J*U.step,Y=Math.min(U.max,Math.max(U.min,Y))}return Y},Lt=M=>{const U=b.current;if(!U)return;const Y=Me(M);T.current=Y,!v.current&&(v.current=requestAnimationFrame(()=>{v.current=null;const J=T.current;T.current=null,typeof J=="number"&&U.applyConstraints({advanced:[{zoom:J}]}).then(()=>{m.current=J,Xe(J)}).catch(()=>{})}))},Vt=async M=>{var U,Y;X(!0),z(!1),V();try{let J;try{J=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"},width:{ideal:1280},height:{ideal:960},frameRate:{ideal:30}},audio:!1})}catch{J=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}if(!M()){J.getTracks().forEach(de=>de.stop());return}S.current=J;const ce=J.getVideoTracks()[0]||null;if(b.current=ce,ce){const de=(U=ce.getCapabilities)==null?void 0:U.call(ce),ye=de==null?void 0:de.zoom;if(ye&&typeof ye.min=="number"&&typeof ye.max=="number"){y.current={min:ye.min,max:ye.max,step:typeof ye.step=="number"?ye.step:void 0};const Se=(Y=ce.getSettings)==null?void 0:Y.call(ce),ge=typeof(Se==null?void 0:Se.zoom)=="number"?Se.zoom:ye.min,ht=Me(ge);m.current=ht,Xe(ht),qe(!0)}}if(f.current){f.current.srcObject=J;try{await f.current.play()}catch{}}}catch{M()&&z(!0),he()}finally{M()&&X(!1)}};d.useEffect(()=>{let M=!0;return j.current=r,r?Vt(()=>M):(he(),St(),z(!1),N(!1)),()=>{M=!1,j.current=!1,he(),St(),z(!1),N(!1)}},[r]);const B=async()=>{if(!Oe){N(!0);try{let M=null;if(Q.isAndroid){const Y=await Hn();if(Y){const J=await fn(Y);J&&(M=await Ze(J))}}if(!M){const Y=Q.isIOS?ob:1,J=Q.isIOS?lb:0,ce=await Rr(Y,J);ce&&(M=await Ze(ce))}if(!M)return;E.current=M;const U=URL.createObjectURL(M);F(U),he()}finally{N(!1)}}},_=async()=>{if(Fe)return;const M=E.current;if(M){o(M),ee(!0);try{const U=n?null:await IS({studentId:e,fullName:t}),Y=await Qw({studentId:e,studentFullName:t,jpegBlob:M,fileId:n||(U==null?void 0:U.fileId)}),J=Date.now();await DS({studentId:e,fullName:t,fileId:Y.fileId,updatedTime:Y.modifiedTime,photoUpdatedAt:J,blob:M}),l==null||l({fileId:Y.fileId,photoUpdatedAt:J}),We()}catch(U){ee(!1);const J=(U instanceof Error?U.message:"").toLowerCase();J.includes("sign in")&&J.includes("drive")?c({message:"Please reconnect Google Drive to upload photos.",tone:"error"}):c({message:"Couldn't upload the photo. Your preview is still saved here - try again.",tone:"error"})}}},Z=()=>{St(),N(!1),Vt(()=>j.current)},He=M=>{if(!(!me||O)&&(M.preventDefault(),M.currentTarget.setPointerCapture(M.pointerId),k.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),k.current.size===2)){const U=Array.from(k.current.values()),Y=Math.hypot(U[0].x-U[1].x,U[0].y-U[1].y);q.current={initialDistance:Y,initialZoom:m.current}}},et=M=>{if(!me||O||!k.current.has(M.pointerId)||(M.preventDefault(),k.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),k.current.size<2||!q.current))return;const U=Array.from(k.current.values()),Y=Math.hypot(U[0].x-U[1].x,U[0].y-U[1].y);if(q.current.initialDistance<=0)return;const J=Y/q.current.initialDistance,ce=q.current.initialZoom*J;Lt(ce)},Kt=M=>{me&&(k.current.delete(M.pointerId),k.current.size<2&&(q.current=null))};if(!r)return null;const mt=me&&!O;return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:We}),i.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white p-4 shadow-2xl space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:u}),i.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-700",onClick:We,"aria-label":"Close",children:""})]}),$?i.jsxs("div",{className:"space-y-3",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Camera unavailable. Check permissions and try again."}),i.jsx("button",{type:"button",className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:We,children:"Close"})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"w-full aspect-[3/4] rounded-xl bg-slate-100 overflow-hidden flex items-center justify-center",onPointerDown:mt?He:void 0,onPointerMove:mt?et:void 0,onPointerUp:mt?Kt:void 0,onPointerCancel:mt?Kt:void 0,style:mt?{touchAction:"none"}:void 0,children:O?i.jsx("img",{src:O,alt:"",className:"w-full h-full object-cover"}):i.jsx("video",{ref:f,className:"w-full h-full object-cover",playsInline:!0,muted:!0})}),O?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm disabled:opacity-50",onClick:Z,disabled:Fe,children:"Retake"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:_,disabled:Fe,children:Fe?"Uploading...":"Accept"})]}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2 text-sm disabled:opacity-50",onClick:B,disabled:ue||Oe,children:Oe?"Capturing...":"Take Photo"}),i.jsx("button",{type:"button",className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2 text-sm",onClick:We,children:"Cancel"})]})]})]}),i.jsx("canvas",{ref:g,className:"hidden"})]})}const jm=!1,Cm="769",ub="https://app.classseats.app",Ao="cs_mobile_last_drive_file",cb="cs_mobile_local_draft_v2",_u="cs_mobile_students_mode_v1",Tu="cs_mobile_notes_sort_v1",Pu="cs_mobile_table_sort_v1",Au="cs_mobile_seat_number_sort_v1",db=14*24*60*60*1e3,Em=2e5,Rm=14,fb=2e4,_m="classseats_mobile_setup_gate_bypass_v1";function Io(e){return e?`${cb}:${e}`:null}function di(e){return e!=null&&e.id?[e.id,e.revisionId||"",e.modifiedTime||"",e.size||""].join("|"):null}function Ls(e){if(!(e!=null&&e.modifiedTime))return 0;const t=Date.parse(e.modifiedTime);return Number.isFinite(t)?t:0}function Tm(e){return e.filter(n=>!!(n!=null&&n.id)&&n.name===Ic).sort((n,r)=>Ls(r)-Ls(n))[0]||null}function pb(e,t){var n,r;return!e||!t?!1:(e.accessToken||"")===(t.accessToken||"")&&(e.refreshToken||"")===(t.refreshToken||"")&&(e.expiresAt||"")===(t.expiresAt||"")&&(((n=e.profile)==null?void 0:n.email)||"")===(((r=t.profile)==null?void 0:r.email)||"")}function R0(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function Pm(e,t){const n={};return Object.entries(e||{}).forEach(([r,s])=>{const o=Object.keys(s||{}).filter(u=>R0(u));o.sort((u,c)=>c.localeCompare(u)),o.slice(0,t).forEach(u=>{const c=(s==null?void 0:s[u])||{};Object.keys(c).length!==0&&(n[r]||(n[r]={}),n[r][u]={...c})})}),n}function fi(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s={};Object.entries(r||{}).forEach(([o,l])=>{s[o]={...l||{}}}),Object.keys(s).length>0&&(t[n]=s)}),t}function mb({student:e,attendance:t,points:n,pointsEnabled:r,maxPoints:s,hasNote:o,absenceTotal:l,absenceStreak:u,tardyCount:c,leftEarlyCount:f,customCounter:g,onShowAbsenceHelp:S,onShowTardyHelp:b,onShowLeftEarlyHelp:E,onShowCustomHelp:j,seatNumber:k,showSeatNumber:q=!1,statusBg:y,statusLabel:m,tempPhotoUrl:v,onOpenPhoto:T,onOpenMenu:O,driveClient:F,driveSession:$}){const z=w0(n,s),{photoUrl:ue}=x0({studentId:e.id,fullName:e.fullName,photoFileId:e.photoFileId,photoUpdatedAt:e.photoUpdatedAt,driveClient:F,driveSession:$}),[X,...me]=(e.fullName||"").split(" "),qe=me.join(" "),ot=(()=>{switch(t){case"present":return"";case"absent":return"";case"tardy":return"";case"left_early":return"";default:return""}})(),Xe=m(t),Fe=v||ue,ee=l??0,Oe=u??0,N=c??0,H=f??0,Q=g??0,re=ee===0&&Oe===0,V=N===0,Ee=H===0,ze=Q===0;return i.jsx("div",{className:`w-full rounded-2xl border px-4 py-3 shadow-sm ${y(t)}`,children:i.jsxs("div",{className:"flex items-start gap-2",children:[q&&i.jsx("div",{className:"flex h-[80px] w-8 shrink-0 items-center justify-center text-sm font-semibold text-slate-500",children:k||""}),i.jsx(gw,{studentId:e.id,hasPhoto:!!Fe,src:Fe,onClick:T,widthPx:60,heightPx:80}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"text-left min-w-0 flex-1",children:[i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:X}),i.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:qe||""})]}),i.jsx("button",{className:"text-xl text-slate-600 px-3 py-2 rounded-full hover:bg-slate-200 flex-shrink-0",onClick:wt=>{wt.stopPropagation(),O()},children:""})]}),i.jsxs("div",{className:"mt-1 flex items-center justify-between text-sm px-1",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:ot}),i.jsx("span",{className:"text-slate-700",children:Xe})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${re?"text-slate-600 bg-slate-100 border-slate-300":"text-rose-700 bg-rose-100 border-rose-200"}`,onClick:S,children:["A",ee,"/S",Oe]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${V?"text-slate-600 bg-slate-100 border-slate-300":"text-amber-700 bg-amber-100 border-amber-200"}`,onClick:b,children:["T",N]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${Ee?"text-slate-600 bg-slate-100 border-slate-300":"text-orange-700 bg-orange-100 border-orange-200"}`,onClick:E,children:["LE",H]}),i.jsxs("button",{type:"button",className:`text-[11px] font-semibold border rounded px-1.5 py-0.5 ${ze?"text-slate-600 bg-slate-100 border-slate-300":"text-slate-800 bg-slate-100 border-slate-400"}`,onClick:j,children:["",Q]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[r&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-lg",children:z.emoji}),i.jsx("span",{className:"text-emerald-700 font-semibold",children:n})]}),o&&i.jsx("span",{className:"text-indigo-600 text-lg",children:""})]})]})]})]})})}function hb(e,t,n){var S,b,E;if(!(e!=null&&e.activeGrouping)||!(e!=null&&e.tableAssignments))return null;let r=-1,s=-1;if(e.activeGrouping.forEach((j,k)=>{const q=j==null?void 0:j.findIndex(y=>String(y)===String(n));q!==-1&&(r=k,s=q)}),r===-1||s===-1)return null;const o=e.tableAssignments[String(r)];if(!o)return null;const l=String(o),u=((S=e.tableNumbering)==null?void 0:S.perTableSeatNumbers)&&e.tableNumbering.perTableSeatNumbers[l],c=(E=(b=t==null?void 0:t.tables)==null?void 0:b.find(j=>String(j.id)===l))==null?void 0:E.seatNumbers,f=u||c;if(!f)return null;const g=f[s];return g!=null?String(g):null}function Iu(e,t){const n=e==null?void 0:e[t];if(!n||typeof n!="object")return{};const r=n.note&&typeof n.note=="object"?n.note:n,s={};return Object.entries(r||{}).forEach(([o,l])=>{l&&typeof l=="object"&&typeof l.note=="string"&&(s[String(o)]=l.note)}),s}function gb(){var Mf,Uf,Ff,zf,$f;const e=$d(),t=k1(),n=d.useMemo(()=>hw(),[]),r=d.useMemo(()=>({kind:"web",openExternal:a=>typeof window<"u"?window.open(a,"_blank","noopener,noreferrer"):null}),[]),s=!n.canUseDriveSync,o="Drive sync is disabled.",[l,u]=d.useState(null),[c,f]=d.useState([]),[g,S]=d.useState(!1),[b,E]=d.useState(null),[j,k]=d.useState(()=>s?o:null),[q,y]=d.useState(!1),[m,v]=d.useState(!1),[T,O]=d.useState(null),[F,$]=d.useState(!1),[z,ue]=d.useState([]),[X,me]=d.useState(""),[qe,ot]=d.useState(!1),[Xe,Fe]=d.useState(!1),[ee,Oe]=d.useState(null),[N,H]=d.useState(null),[Q,re]=d.useState(!1),[V,Ee]=d.useState(!1),[ze,wt]=d.useState(!1),[pt,Ze]=d.useState(!1),[fn,Rr]=d.useState([]),[Hn,he]=d.useState([]),[St,We]=d.useState(new Set),[Me,Lt]=d.useState(0),[Vt,B]=d.useState(null),[_,Z]=d.useState(null),[He,et]=d.useState({}),[Kt,mt]=d.useState({}),[M,U]=d.useState({}),[Y,J]=d.useState({}),[ce,de]=d.useState(null),[ye,Se]=d.useState({note:"",delta:0,reason:""}),[ge,ht]=d.useState({pointsEnabled:!1,startingPoints:50,currentPoints:0,predictedPoints:0}),[Vn,lt]=d.useState(null),[Kn,oo]=d.useState(""),[pn,Gn]=d.useState(null),[ls,Vd]=d.useState(null),[_r,Kd]=d.useState(null),[ja,A0]=d.useState({}),Gd=d.useRef({}),[I0,Fb]=d.useState({}),[Yn,lo]=d.useState(null),[Yd,kl]=d.useState(0),[Qd,jl]=d.useState(null),[Jd,Ca]=d.useState(""),[it,is]=d.useState(null),[zb,D0]=d.useState([]),[$b,qd]=d.useState(!1),[Bb,Ea]=d.useState(null),[Wb,Hb]=d.useState(!1),[xe,bt]=d.useState(null),[tt,Xd]=d.useState(null),[Zd,ef]=d.useState(null),[Qn,io]=d.useState(null),[Cl,Tr]=d.useState(null),[Pr,tf]=d.useState(!1),[El,as]=d.useState(null),[jn,Ve]=d.useState(!1),[Vb,Ot]=d.useState(null),us=d.useRef(null),nf=d.useRef(null),[rf,cs]=d.useState(!1),Ra=typeof navigator<"u"?navigator.onLine:!0,[sf,ao]=d.useState(Ra),[of,_a]=d.useState(Ra),[fe,uo]=d.useState(!Ra),L0=d.useRef(null),O0=d.useRef(!1),Jn=d.useRef(!1),M0=d.useRef(15e3),U0=d.useRef(0),lf=d.useRef(!1),Cn=d.useRef(!1),Ar=d.useRef(!1),Ta=d.useRef(new Set),Mt=d.useRef(null),Pa=d.useRef(async()=>{}),Aa=d.useRef(0),af=d.useRef(null),uf=d.useRef(void 0),cf=d.useRef(null),Ia=()=>{const a=new Date,p=a.getFullYear(),h=String(a.getMonth()+1).padStart(2,"0"),x=String(a.getDate()).padStart(2,"0");return`${p}-${h}-${x}`},[le,co]=d.useState(Ia()),[Ir,F0]=d.useState("table"),[_t,Da]=d.useState(()=>{try{const a=localStorage.getItem(_u);return a==="notes"||a==="flashcards"?a:"attendance"}catch{return"attendance"}});d.useEffect(()=>{try{localStorage.setItem(_u,_t)}catch{}},[_t]);const[Rl,z0]=d.useState(()=>{try{return localStorage.getItem(Tu)==="last-first"?"last-first":"first-last"}catch{return"first-last"}});d.useEffect(()=>{try{localStorage.setItem(Tu,Rl)}catch{}},[Rl]);const[fo,$0]=d.useState(()=>{try{return localStorage.getItem(Pu)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Pu,fo)}catch{}},[fo]);const[_l,B0]=d.useState(()=>{try{return localStorage.getItem(Au)==="desc"?"desc":"asc"}catch{return"asc"}});d.useEffect(()=>{try{localStorage.setItem(Au,_l)}catch{}},[_l]);const W0=d.useMemo(()=>new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),[]);d.useEffect(()=>{Gd.current=ja},[ja]),d.useEffect(()=>()=>{Object.values(Gd.current).forEach(a=>URL.revokeObjectURL(a))},[]);const[$e,En]=d.useState(!1),[La,H0]=d.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem(_m)==="1"}catch{return!1}}),qn=d.useRef(0),Ut=d.useRef(null),df=d.useRef({}),ff=d.useRef({}),Tl=d.useRef(null),ds=d.useRef({}),fs=d.useRef({}),Xn=d.useRef(null),Pl=d.useRef(!1),Oa=d.useRef(!1),Ma=d.useRef(!1),ps=d.useRef(null),po=d.useRef(0),mo=d.useRef(!1),pf=d.useRef(0),tn=d.useCallback(a=>{Rr(a.messages),he(a.allMessages),Lt(a.unreadCount),We(new Set(a.dismissedIds))},[]),Dr=d.useRef(null),mf=d.useRef(null),Al=d.useRef(!1),Ua=d.useRef(!1),[hf,ms]=d.useState(!1),Il=d.useRef(0),Rn=d.useRef(null),Fa=d.useRef(!1),gf=1500,yf=3e4,Lr=d.useRef(null),Dl=d.useCallback(a=>a?df.current[a]??null:null,[]),Nt=d.useCallback((a,p)=>{a&&(df.current[a]=p||null)},[]),Ll=d.useCallback(a=>a||"__local__",[]),xf=d.useCallback(a=>ff.current[Ll(a)]??null,[Ll]),Or=d.useCallback((a,p)=>{p&&(ff.current[Ll(a)]=p)},[Ll]),mn=d.useCallback(a=>{ds.current={},fs.current={};const p=Io(a??(N==null?void 0:N.id));if(p)try{window.localStorage.removeItem(p)}catch{}Dr.current&&(window.clearTimeout(Dr.current),Dr.current=null)},[N==null?void 0:N.id]),hs=d.useCallback((a,p,h)=>{const x=ds.current;x[a]||(x[a]={}),x[a][p]={...h}},[]),vf=d.useCallback((a,p,h)=>{const x=fs.current;x[a]||(x[a]={}),x[a][p]={...h}},[]),wf=d.useCallback(()=>{const a=N==null?void 0:N.id,p=Io(a);if(!p)return;const h=Pm(fi(ds.current),Rm),x=Pm(fi(fs.current),Rm),w={savedAt:Date.now(),lastEditAt:Lr.current??Date.now(),selectedDate:le,selectedPeriodId:it,pendingAttendanceByDate:h,pendingNotesByDate:x,pointsLocal:M,pointsHistoryLocal:Y};let C=JSON.stringify(w);if(C.length>Em){const P={...w,pointsHistoryLocal:{}};C=JSON.stringify(P)}if(!(C.length>Em))try{window.localStorage.setItem(p,C)}catch{}},[N==null?void 0:N.id,Y,M,le,it]),Sf=d.useCallback(()=>{$e&&(Dr.current&&window.clearTimeout(Dr.current),Dr.current=window.setTimeout(()=>{wf(),Dr.current=null},250))},[$e,wf]),za=a=>{var p;return JSON.stringify({periodsState:((p=a.periodsState)==null?void 0:p.periods)||[],students:a.students||[]})},_n=d.useRef(0),[Kb,ho]=d.useState("unknown"),[Gb,$a]=d.useState(0),go=d.useRef(null),Ba=d.useRef(!1);d.useEffect(()=>{go.current=l},[l]);const Ol=d.useCallback(a=>{if(!a)return!1;const p=go.current;return pb(p,a)?!1:(go.current=a,u(a),!0)},[]);d.useCallback(async()=>{const a=await kn(go.current);return a&&Ol(a),a},[Ol]);const bf=d.useCallback(()=>{if(F)return!0;if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[F]),hn=d.useCallback(a=>{if(!bf())return;const p=`${new Date().toISOString()} ${a}`;ue(h=>[p,...h].slice(0,200))},[bf]);d.useEffect(()=>{s&&k(o)},[o,s]);const V0=d.useCallback(async()=>{var p;const a=await Ew();if(O(a),hn(`startup info: state=${a.state} sessionLoaded=${a.sessionLoaded} hasRefresh=${a.hasRefresh} expiresAt=${a.expiresAt} source=${a.source} lastWriteAt=${a.lastWriteAt} lastWriteReason=${a.lastWriteReason}`),a.state==="ok"){const h=await Tw();h&&(u(h),(p=h.profile)!=null&&p.email&&k(null))}return a},[hn]),gs=d.useCallback(async a=>{const p=go.current,h=(p==null?void 0:p.expiresAt)||null,x=await kn(p);return hn(`${a}: ensureFreshDriveSession ok=${!!x} before=${h} new=${x==null?void 0:x.expiresAt} hasRefresh=${!!(x!=null&&x.refreshToken)}`),x&&(Ol(x),y(!1)),x},[hn,Ol]),K0=d.useCallback(()=>{Il.current+=1,Rn.current&&window.clearTimeout(Rn.current),Rn.current=window.setTimeout(()=>{Il.current=0,Rn.current=null},2e3),Il.current>=5&&($(a=>!a),Il.current=0,Rn.current&&(window.clearTimeout(Rn.current),Rn.current=null))},[]),G0=()=>{const a=new URL(ub);new URL(window.location.href).searchParams.forEach((h,x)=>a.searchParams.set(x,h)),a.searchParams.set("from","mobile"),window.location.assign(a.toString())},Y0=a=>{var x,w;if(!_)return;const p=_.students.find(C=>String(C.id)===String(a));if(!p)return;const h=((x=p.periodIds)==null?void 0:x[0])||it||((w=_.periods[0])!=null&&w.id?String(_.periods[0].id):"");io({name:p.fullName,gender:p.gender||"F",periodId:h?String(h):""}),ef({id:String(a)})},Ml=()=>{ef(null),io(null)},Q0=a=>{if(!_)return;const p=_.students.find(x=>String(x.id)===String(a));!p||!window.confirm(`Delete ${p.fullName}? This removes them from this class list.`)||(Ta.current.add(String(a)),Z(x=>{if(!x)return x;const w=x.students.filter(P=>String(P.id)!==String(a)),C=x.periods.map(P=>{const D={...P.attendance||{}};Object.keys(D).forEach(A=>{const L={...D[A]||{}};delete L[String(a)],Object.keys(L).length===0?delete D[A]:D[A]=L});const R={...P.behaviorNotes||{}};Object.keys(R).forEach(A=>{const L={...R[A]||{}};delete L[String(a)],Object.keys(L).length===0?delete R[A]:R[A]=L});const W={...P.pointsByStudent||{}};delete W[String(a)];const K={...P.customCounterByStudent||{}};delete K[String(a)];const te={...P.attendanceResets||{}};delete te[String(a)];const ie=P.activeGrouping?P.activeGrouping.map(A=>A.filter(L=>String(L)!==String(a))):P.activeGrouping;return{...P,attendance:D,behaviorNotes:R,pointsByStudent:W,customCounterByStudent:K,attendanceResets:te,activeGrouping:ie}});return{...x,students:w,periods:C}}),et(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const P={...w[C]||{}};delete P[String(a)],w[C]=P}}),w}),mt(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const P={...w[C]||{}};delete P[String(a)],w[C]=P}}),w}),U(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{if(w[C]){const P={...w[C]||{}};delete P[String(a)],w[C]=P}}),w}),J(x=>{const w={...x||{}};return Object.keys(w).forEach(C=>{w[C]=(w[C]||[]).filter(P=>String(P.studentId)!==String(a))}),w}),Ae(),Ye({silent:!0}),bt(null),Xd(null),Ml())};d.useEffect(()=>()=>{Rn.current&&window.clearTimeout(Rn.current)},[]),d.useEffect(()=>{uo(!sf||!of)},[sf,of]);const Nf=d.useCallback(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("classseats_debug_drive")==="1"}catch{return!1}},[]),yo=d.useCallback(a=>{Nf()&&console.debug(a.startsWith("[Ping]")?a:`[Ping] ${a}`)},[Nf]);d.useEffect(()=>{Jn.current=!1;const a=L0,p=O0,h=M0,x=U0,w=()=>{a.current&&(window.clearTimeout(a.current),a.current=null)},C=K=>{if(Jn.current)return;w();const te=typeof K=="number"?K:h.current;yo(`[Ping] next ${te}`),a.current=window.setTimeout(()=>{a.current=null,P()},te)},P=async()=>{if(Jn.current)return;if(x.current=Date.now(),yo("[Ping] tick"),typeof document<"u"&&document.visibilityState!=="visible"){C(5e3);return}if(p.current){C(2e3);return}p.current=!0;const K=new AbortController,te=window.setTimeout(()=>K.abort(),5e3),ie=(()=>{try{return new URL(`/ping.txt?t=${Date.now()}`,window.location.origin).toString()}catch{return`/ping.txt?t=${Date.now()}`}})();let A=!1;try{const L=await fetch(ie,{cache:"no-store",signal:K.signal});A=!!(L!=null&&L.ok),A?(ao(!0),_a(!0),uo(!1),h.current=15e3,yo("[Ping] ok")):(ao(!1),_a(!1),uo(!0),h.current=Math.min(6e4,h.current*2),yo(`[Ping] fail status=${L==null?void 0:L.status}`))}catch(L){ao(!1),_a(!1),uo(!0),h.current=Math.min(6e4,h.current*2),yo(`[Ping] fail ${(L==null?void 0:L.message)||L}`)}finally{window.clearTimeout(te),p.current=!1,Jn.current||C()}},D=()=>{Jn.current||(ao(!0),P())},R=()=>{Jn.current||(ao(!1),uo(!0),C(2e3))},W=()=>{Jn.current||typeof document<"u"&&document.visibilityState==="visible"&&P()};return P(),window.addEventListener("online",D),window.addEventListener("offline",R),document.addEventListener("visibilitychange",W),()=>{Jn.current=!0,w(),window.removeEventListener("online",D),window.removeEventListener("offline",R),document.removeEventListener("visibilitychange",W)}},[]);const Ul=d.useCallback((a,p)=>{et(p.periods.reduce((h,x)=>{var C,P;const w=(C=ds.current[String(x.id)])==null?void 0:C[a];return h[x.id]=w?{...w}:(P=x.attendance)!=null&&P[a]?{...x.attendance[a]}:{},h},{})),mt(p.periods.reduce((h,x)=>{var C;const w=(C=fs.current[String(x.id)])==null?void 0:C[a];return h[x.id]=w?{...w}:Iu(x.behaviorNotes,a),h},{}))},[]);d.useEffect(()=>{if(!_)return;const a=uf.current!==_.periods,p=cf.current!==le;!a&&!p||(uf.current=_.periods,cf.current=le,Ul(le,_))},[Ul,_,le]),d.useEffect(()=>{const a=N==null?void 0:N.id;if(!a||mf.current===a)return;mf.current=a;const p=Io(a);if(!p)return;let h=null;try{const C=window.localStorage.getItem(p);if(!C)return;h=JSON.parse(C)}catch{return}if(!h||typeof h.savedAt!="number")return;if(Date.now()-h.savedAt>db){mn(a);return}ds.current=h.pendingAttendanceByDate||{},fs.current=h.pendingNotesByDate||{},h.pointsLocal&&U(h.pointsLocal),h.pointsHistoryLocal&&J(h.pointsHistoryLocal),h.selectedPeriodId&&is(h.selectedPeriodId),h.lastEditAt&&(Lr.current=h.lastEditAt);const x=h.selectedDate&&R0(h.selectedDate)?h.selectedDate:le;h.selectedDate&&x!==le&&co(x),_&&Ul(x,_),(Object.keys(h.pendingAttendanceByDate||{}).length>0||Object.keys(h.pendingNotesByDate||{}).length>0||Object.keys(h.pointsHistoryLocal||{}).length>0)&&(qn.current+=1,En(!0),Ve(!0))},[N==null?void 0:N.id,mn,Ul,_,le]),d.useEffect(()=>{Sf()},[He,Kt,M,Y,$e,Sf]);const kf=d.useCallback(a=>{const p={};return!a||typeof a!="object"||Object.entries(a).forEach(([h,x])=>{if(!x||typeof x!="object")return;const w={},C=x.note&&typeof x.note=="object"?x.note:x;Object.entries(C).forEach(([P,D])=>{D&&typeof D=="object"&&typeof D.note=="string"&&(w[String(P)]={note:D.note,timestamp:D.timestamp||new Date().toISOString()})}),Object.keys(w).length>0&&(p[h]=w)}),p},[]),Mr=a=>e({tone:"success",message:a}),at=a=>e({tone:"error",message:a}),gn=a=>e({tone:"info",message:a}),Fl=["unmarked","absent","tardy","left_early","present"],J0=["present","absent","tardy","left_early","unmarked"],zl=d.useCallback(a=>{if(!a)return!1;const p=a.toLowerCase();return p.includes("401")||p.includes("unauthorized")||p.includes("403")||p.includes("sign in with google drive first")},[]),q0=a=>{switch(a){case"present":return"bg-emerald-50 border-emerald-100";case"absent":return"bg-rose-50 border-rose-100";case"tardy":return"bg-amber-50 border-amber-100";case"left_early":return"bg-blue-50 border-blue-100";default:return"bg-slate-50 border-slate-200"}},jf=a=>{switch(a){case"present":return"Present";case"absent":return"Absent";case"tardy":return"Tardy";case"left_early":return"Left Early";default:return"Unmarked"}},Wa=(a,p)=>w0(a,p).emoji,X0=()=>`${Date.now()}-${Math.random().toString(36).slice(2)}`,Z0=a=>{const p=String(a.getMonth()+1).padStart(2,"0"),h=String(a.getDate()).padStart(2,"0");return`${p}-${h}-${a.getFullYear()}`},Ha=a=>`https://docs.google.com/document/d/${a}/edit`,Va=d.useCallback(a=>{if(!a)return;const p=Date.now(),h=af.current;if(h&&h.url===a&&p-h.at<600)return;af.current={url:a,at:p};try{if(r!=null&&r.openExternal){r.openExternal(a);return}}catch{}window.open(a,"_blank","noopener,noreferrer")||k==null||k("Pop-up blocked  please allow pop-ups to open Google Docs.")},[r]),Tn=d.useCallback(a=>_1(a),[]),Re=d.useCallback(async(a,p="preflight")=>{if(s)return k(o),null;if(fe)return k("Offline  will sync when back online."),y(!0),hn(`${p}: offline; skipping refresh`),null;try{const h=await gs(p);if(h)return h}catch(h){console.warn("[Drive] refresh failed",h),hn(`${p}: refresh failed ${(h==null?void 0:h.message)||h}`)}if(!a)return y(!0),k("Reconnect to Google Drive to continue syncing."),hn(`${p}: interactive=false; would trigger OAuth if allowed`),null;hn(`triggerOAuth: reason=${p} hadSession=${!!l} hasRefresh=${!!(l!=null&&l.refreshToken)}`);try{await Uw()}catch(h){at((h==null?void 0:h.message)||"Google sign-in was cancelled.")}return null},[o,l,s,at,fe,hn,gs]),Cf=d.useCallback(async()=>{if(s||fe||Pl.current)return!1;Pl.current=!0;try{const a=await Re(!1,"announcements-sync");if(!(a!=null&&a.accessToken))return!1;const p=a.accessToken,h=await Zw(p,[ta,pm]);let x=Xn.current;if(x)try{const A=await Nu(p,x);A!=null&&A.id||(x=null,Xn.current=null)}catch{x=null,Xn.current=null}const w=await ku(p),C=Tm(w);if(C!=null&&C.id){const A=x?await Nu(p,x).catch(()=>null):null,L=Ls(A||null),oe=Ls(C);(!x||C.id!==x||oe>=L)&&(x=C.id,Xn.current=C.id,ps.current=di(C)),po.current=0,await tS(p,C.id,h)}if(!x){const A=JSON.stringify(mm(Xo(),null),null,2),L=await rS(p,h,Ic,A);if(!(L!=null&&L.id))return!1;x=L.id,Xn.current=L.id,ps.current=di(L),po.current=0}const P=await Ss(p,x),D=hm(P),R=Xo(),W=gm(R,(D==null?void 0:D.dismissed)||[]),K=W.size!==R.size;K&&Dc(W);const te=new Set(((D==null?void 0:D.dismissed)||[]).map(String));let ie=W.size!==te.size;if(!ie){for(const A of W)if(!te.has(A)){ie=!0;break}}if(ie){const A=JSON.stringify(mm(W,null),null,2),L=await om(p,x,A);ps.current=di(L)}else ps.current=null;if(K||ie){const A=ci();tn(A)}return await eS(p,pm),!0}catch{return!1}finally{Pl.current=!1}},[tn,s,Re,fe]),$l=d.useCallback(async()=>{if(!(!l||s||fe)&&!(Oa.current||Pl.current)){Oa.current=!0;try{const a=await Re(!1,"announcements-poll");if(!(a!=null&&a.accessToken))return;const p=a.accessToken;let h=null,x=Xn.current;if(x)try{h=await Nu(p,x)}catch{h=null,x=null,Xn.current=null}const w=await ku(p),C=Tm(w);if(C!=null&&C.id){const oe=Ls(h||null),se=Ls(C);(!x||C.id!==x||se>=oe)&&(x=C.id,h=C,Xn.current=C.id),po.current=0}else if(!x){if(Date.now()<po.current)return;po.current=Date.now()+12e4;return}if(!x)return;const P=di(h||{id:x,name:Ic}),D=Date.now(),R=D-pf.current>=fb;if(P&&P===ps.current&&!R)return;const W=await Ss(p,x),K=hm(W);if(pf.current=D,ps.current=P,!K)return;const te=Xo(),ie=gm(te,K.dismissed||[]);if(!(ie.size!==te.size))return;Dc(ie);const L=ci();tn(L)}catch{}finally{Oa.current=!1}}},[tn,l,s,Re,fe]),Pn=d.useCallback(async a=>{if(Ma.current){a==="manual"&&mo.current&&window.setTimeout(()=>{Pn("manual")},350);return}Ma.current=!0;try{l&&!s&&!fe&&(a==="manual"&&mo.current?await Cf()&&(mo.current=!1):await $l());const x=await ym(a==="heartbeat"?24:12,a==="manual");tn(x)}catch{}finally{Ma.current=!1}},[tn,l,s,fe,$l,Cf]),ey=d.useCallback(()=>{Ze(!0),Pn("manual")},[Pn]),ty=d.useCallback(()=>{Ze(!1),mo.current&&Pn("manual")},[Pn]),ny=d.useCallback(a=>{$1(a),mo.current=!0;const p=ci();tn(p)},[tn]);d.useEffect(()=>{let a=!0;const p=ci();return a&&tn(p),(async()=>{const h=await ym(12,!0);a&&tn(h)})(),()=>{a=!1}},[tn]),d.useEffect(()=>{let a=!0;const p=60*60*1e3,h=window.setInterval(()=>{(async()=>a&&await Pn("heartbeat"))()},p);return()=>{a=!1,window.clearInterval(h)}},[Pn]),d.useEffect(()=>{if(!(l!=null&&l.accessToken)){Ba.current=!1;return}Ba.current||(Ba.current=!0,Pn("drive-connect"))},[l==null?void 0:l.accessToken,Pn]),d.useEffect(()=>{if(!l||s||fe)return;let a=!0;const p=()=>{a&&(typeof document<"u"&&document.visibilityState!=="visible"||$l())};p();const h=window.setInterval(p,2e4),x=()=>{document.visibilityState==="visible"&&p()},w=()=>p();return document.addEventListener("visibilitychange",x),window.addEventListener("online",w),()=>{a=!1,window.clearInterval(h),document.removeEventListener("visibilitychange",x),window.removeEventListener("online",w)}},[l,s,fe,$l]);const Bl=d.useCallback(async(a,p,h)=>{let x=!1;const w=async()=>{let C=h;if(C||(C=await Re(!0,`${p}-download`)),!C)throw new Error("Reconnect to Google Drive to continue.");try{return{data:await Ss(C.accessToken,a)}}catch(P){const D=(P==null?void 0:P.message)||"";if(!x&&zl(D))return x=!0,To("[Drive][Mobile] auth error on download, retrying once",{context:p,error:D}),h=null,w();throw P}};return w()},[Re,zl]),Ef=d.useCallback(async(a,p,h,x)=>{let w=!1;const C=async()=>{let P=x;if(P||(P=await Re(!0,`${h}-upload`)),!P)throw new Error("Reconnect to Google Drive to continue.");try{return await om(P.accessToken,a,p)}catch(D){const R=(D==null?void 0:D.message)||"";if(!w&&zl(R))return w=!0,To("[Drive][Mobile] auth error on upload, retrying once",{context:h,error:R}),x=null,C();throw D}};return C()},[Re,zl]),Zn=d.useCallback((a,p)=>{var D;if(!((D=a==null?void 0:a.periodsState)!=null&&D.periods)||!(a!=null&&a.students))return"failed";const h=za(a),x=(p==null?void 0:p.id)||Ut.current;if(x){const R=A1({incomingUpdatedAt:a.updatedAt,lastAppliedUpdatedAt:xf(x),incomingRevisionId:(p==null?void 0:p.revisionId)||null,lastRevisionId:Dl(x)??null});if(To("[Sync][Mobile] apply decision",{fileKey:x,decision:R}),R.action==="skip")return p&&(Ut.current=p.id,H(p),Nt(p.id,p.revisionId||null)),_n.current=Date.now(),"skipped"}qn.current=0,Cn.current=!1,Ar.current=!1,En(!1),Ve(!1),Ot(null),ms(!1),mn(),Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null);const w=(a.layouts||[]).reduce((R,W)=>(R[String(W.id)]={id:String(W.id),name:W.name,tables:(W.tables||[]).map(K=>({id:String(K.id),name:K.name||"Table",seatNumbers:Array.isArray(K.seatNumbers)?K.seatNumbers:void 0}))},R),{}),C=a.periodsState.periods.map(R=>({id:String(R.id),name:R.name,layoutId:R.layoutId||null,tableAssignments:R.tableAssignments||{},activeGrouping:R.activeGrouping||[],tableNumbering:R.tableNumbering||void 0,attendance:R.attendance||{},attendanceResets:R.attendanceResets||{},customCounterByStudent:R.customCounterByStudent||{},behaviorNotes:kf(R.behaviorNotes),pointsByStudent:R.pointsByStudent||{},pointsEnabled:R.pointsEnabled??!1,startingPoints:R.startingPoints??50,pointsHistory:R.pointsHistory||[]})),P=(a.students||[]).map(R=>{var W;return{id:String(R.id),fullName:R.fullName||R.name||"Student",gender:typeof R.gender=="string"?R.gender:void 0,periodIds:((W=R.periodIds)==null?void 0:W.map(K=>String(K)))||[],profileUpdatedAt:typeof R.profileUpdatedAt=="string"?R.profileUpdatedAt:void 0,quickNote:typeof R.quickNote=="string"?R.quickNote:void 0,quickNoteUpdatedAt:typeof R.quickNoteUpdatedAt=="string"?R.quickNoteUpdatedAt:void 0,photoFileId:typeof R.photoFileId=="string"?R.photoFileId:R.photoFileId==null?null:String(R.photoFileId),photoUpdatedAt:(()=>{if(typeof R.photoUpdatedAt=="number")return R.photoUpdatedAt;if(typeof R.photoUpdatedAt=="string"){const K=Number.parseInt(R.photoUpdatedAt,10);return Number.isFinite(K)?K:null}return null})(),audioFileId:typeof R.audioFileId=="string"?R.audioFileId:R.audioFileId==null?null:String(R.audioFileId),audioUpdatedAt:(()=>{if(typeof R.audioUpdatedAt=="number")return R.audioUpdatedAt;if(typeof R.audioUpdatedAt=="string"){const K=Number.parseInt(R.audioUpdatedAt,10);return Number.isFinite(K)?K:null}return null})(),docs:Array.isArray(R.docs)?R.docs.map(K=>({...K,id:String(K.id),driveFileId:String(K.driveFileId)})):[]}});return Z({periods:C,students:P,layouts:w}),is(R=>{var A;const W=R?String(R):null,K=a.periodsState.currentId?String(a.periodsState.currentId):null;return[W,K,((A=C[0])==null?void 0:A.id)||null].filter(Boolean).find(L=>C.some(oe=>String(oe.id)===L))||null}),et(C.reduce((R,W)=>{var K;return R[W.id]=(K=W.attendance)!=null&&K[le]?{...W.attendance[le]}:{},R},{})),mt(C.reduce((R,W)=>(R[W.id]=Iu(W.behaviorNotes,le),R),{})),U(C.reduce((R,W)=>{var te;const K=W.pointsByStudent?{...W.pointsByStudent}:{};return W.pointsEnabled&&((te=W.studentsIds)==null||te.forEach(ie=>{K[ie]===void 0&&(K[ie]=W.startingPoints??50)})),R[W.id]=K,R},{})),Tl.current=h,ho(a.lastWriter||"unknown"),p?(Ut.current=p.id,H(p),Nt(p.id,p.revisionId||null)):Nt(Ut.current,null),as(null),$a(R=>R+1),Or(x,a.updatedAt),_n.current=Date.now(),"applied"},[le,xf,kf,Iu,et,mt,U,is,Z,En,Ve,H,Nt,Ot,ms,ho,as,$a,Or,mn]),Ae=d.useCallback(()=>{qn.current+=1,Lr.current=Date.now(),En(!0),Ve(!0)},[]),Ka=d.useCallback((a,p,h)=>{Z(x=>x&&{...x,periods:x.periods.map(w=>{if(String(w.id)!==String(a))return w;const C={...w.attendanceResets||{}},P={...C[String(p)]||{}};return P[h]=le,C[String(p)]=P,{...w,attendanceResets:C}})}),Ae()},[Ae,le]),Rf=d.useCallback((a,p,h)=>{const x=Math.trunc(h);!Number.isFinite(x)||x===0||(Z(w=>w&&{...w,periods:w.periods.map(C=>{if(String(C.id)!==String(a))return C;const P={...C.customCounterByStudent||{}},D=Number(P[String(p)]||0),R=Math.max(0,D+x);return R<=0?delete P[String(p)]:P[String(p)]=R,{...C,customCounterByStudent:P}})}),Ae())},[Ae]),ry=d.useCallback((a,p)=>{Z(h=>h&&{...h,periods:h.periods.map(x=>{if(String(x.id)!==String(a))return x;const w={...x.customCounterByStudent||{}};return delete w[String(p)],{...x,customCounterByStudent:w}})}),Ae()},[Ae]),Ga=d.useCallback((a,p,h)=>{et(x=>{const w={...x||{}};return w[a]={...w[a]||{}},h==="unmarked"?delete w[a][p]:w[a][p]=h,hs(String(a),le,w[a]),w}),Ae()},[Ae,le,hs]);d.useCallback((a,p)=>{var C;const h=((C=He[a])==null?void 0:C[p])||"unmarked",x=Fl.indexOf(h),w=Fl[(x+1)%Fl.length];Ga(a,p,w)},[He,Ga,Fl]);const Wl=d.useCallback((a,p)=>{et(h=>{const x={...h||{}};return x[a]={...x[a]||{}},p.forEach(w=>{x[a][w]||(x[a][w]="present")}),hs(String(a),le,x[a]),x}),Ae()},[Ae,le,hs]),sy=d.useCallback((a,p,h,x)=>{if(h===0||p.length===0)return;const w=(x==null?void 0:x.trim())||"Bulk points update",C=_==null?void 0:_.periods.find(D=>D.id===a),P=(C==null?void 0:C.startingPoints)??50;U(D=>{const R={...D||{}};return R[a]={...R[a]||{}},p.forEach(W=>{const K=R[a][W]??P;R[a][W]=Math.max(0,K+h)}),R}),J(D=>{const R={...D||{}},W=R[a]?[...R[a]]:[];return p.forEach(K=>W.push({studentId:K,delta:h,reason:w,date:le})),R[a]=W,R}),Ae()},[_==null?void 0:_.periods,le,Ae]),_f=d.useCallback(a=>{et(p=>{const h={...p||{}};return h[a]={},hs(String(a),le,h[a]),h}),gn("Reset attendance to unmarked for this date."),Ae()},[gn,Ae,le,hs]),oy=d.useCallback(()=>{if(!ce)return;const{periodId:a,studentId:p}=ce,{note:h,delta:x,reason:w}=ye,C=ge;if(C.pointsEnabled&&x!==0&&!w.trim()){at("Please provide a reason when changing points.");return}mt(P=>{const D={...P||{}};return D[a]={...D[a]||{}},h.trim()?D[a][p]=h.trim():delete D[a][p],vf(String(a),le,D[a]),D}),C.pointsEnabled&&x!==0&&(U(P=>{const D={...P||{}};D[a]={...D[a]||{}};const R=D[a][p]??C.startingPoints??0,W=Math.max(0,R+x);return D[a][p]=W,D}),J(P=>{const D={...P||{}},R=D[a]?[...D[a]]:[];return R.push({studentId:p,delta:x,reason:w||"Behavior note",date:le}),D[a]=R,D})),Ae(),de(null),Se({note:"",delta:0,reason:""})},[ce,ye,ge,Ae,le,vf,mt,U,at]),Tf=d.useCallback((a,p,h)=>{var D,R;const x=((D=Kt[a])==null?void 0:D[p])||"",w=_==null?void 0:_.periods.find(W=>W.id===a),C=(w==null?void 0:w.startingPoints)??50,P=((R=M[a])==null?void 0:R[p])??C;Se({note:x,delta:0,reason:""}),ht({pointsEnabled:!!(w!=null&&w.pointsEnabled),startingPoints:C,currentPoints:P,predictedPoints:P}),de({periodId:a,studentId:p,studentName:h})},[Kt,M,_]),ly=d.useCallback((a,p,h)=>{Tf(a,p,h)},[Tf]);d.useEffect(()=>{if(s){k(o),v(!0);return}let a=!0;return(async()=>{await V0();const h=await Fw().catch(()=>null);if(!h||!a){a&&v(!0);return}const x=await kn(h),w=x||h;if(hn(`startup refresh result: ok=${!!x} expiresAt=${x==null?void 0:x.expiresAt}`),!!a){if(u(w),lf.current){v(!0);return}lf.current=!0;try{const C=localStorage.getItem(Ao);if(!C){Al.current=!0,v(!0);return}const P=JSON.parse(C);if(P!=null&&P.id&&(P!=null&&P.name)){Ua.current=!0;const D={id:P.id,name:P.name,modifiedTime:P.modifiedTime,size:P.size,revisionId:P.revisionId};Oe(D),k(`Restoring ${D.name}`);const R=await Ss(h.accessToken,D.id),W=typeof R=="string"?JSON.parse(R):R,K=Tn(W);if(!K)throw new Error("Drive file could not be parsed.");const te=Zn(K,D);te==="applied"?(H(D),k(`Loaded ${D.name} from Drive.`),as(new Date().toISOString())):te==="skipped"&&(H(D),k("Drive file is older than current data  keeping existing state."))}Al.current=!0,v(!0)}catch(C){console.error("[Drive] Restore failed",C),k("Google sign-in failed. Please try again."),Ua.current=!1,Al.current=!0,v(!0)}}})(),()=>{a=!1}},[]),d.useEffect(()=>{var w;if(s||!m||Q)return;const a=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,p=t||a,h=(((w=_==null?void 0:_.periods)==null?void 0:w.length)??0)>0;if(!(p&&!h&&!La&&!fe)){if(!l){re(!0);return}_||N!=null&&N.id||Al.current&&(Ua.current||re(!0))}},[N,l,s,fe,t,_,La,m,Q]),d.useEffect(()=>{Q||Ee(!1)},[Q]),d.useEffect(()=>{if(!V)return;const a=p=>{var x;const h=p.target;h&&((x=nf.current)!=null&&x.contains(h)||Ee(!1))};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[V]),d.useEffect(()=>{const a=window.setInterval(async()=>{l&&await gs("timer")},3e5);return()=>window.clearInterval(a)},[l,gs]),d.useEffect(()=>{const a=async()=>{l&&await gs("visibility")};return document.addEventListener("visibilitychange",a),()=>document.removeEventListener("visibilitychange",a)},[l,gs]),d.useEffect(()=>{if(g){const a=window.setTimeout(()=>{S(!1),E("Still loading Drive files. Try Sign in with Google then tap Refresh Cloud Files.")},12e3);return B(a),()=>window.clearTimeout(a)}Vt&&(window.clearTimeout(Vt),B(null)),Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null)},[g,Vt]);const iy=d.useCallback(()=>{zw(),u(null),f([]),Oe(null),H(null),k(null),gn("Signed out of Google Drive."),Ds("drive-disconnect")},[gn,Ds]),ay=d.useCallback(()=>{if(!window.confirm("Clear local ClassSeats data on this device? This removes local class data and drafts on this device only. Google Drive files will not be changed."))return;const p=Io(N==null?void 0:N.id),h=Io(ee==null?void 0:ee.id);try{window.localStorage.removeItem(Ao),window.localStorage.removeItem(_u),window.localStorage.removeItem(Tu),window.localStorage.removeItem(Pu),window.localStorage.removeItem(Au),p&&window.localStorage.removeItem(p),h&&h!==p&&window.localStorage.removeItem(h)}catch{}Z(null),et({}),mt({}),U({}),J({}),is(null),Oe(null),H(null),En(!1),Ve(!1),Ot(null),mn(),Ds("local-clear"),Ee(!1),k("Local data cleared on this device."),gn("Local ClassSeats data cleared from this device.")},[N==null?void 0:N.id,Ds,mn,ee==null?void 0:ee.id,gn]),uy=d.useCallback(async()=>{var a;!N||!((a=window.desktopBridge)!=null&&a.uploadDriveFile)||confirm(`Delete ${N.name} from Drive? This cannot be undone.`)&&(await window.desktopBridge.uploadDriveFile({fileId:N.id,content:JSON.stringify({deleted:!0,message:"File deleted by user."})}),Z(null),et({}),mt({}),U({}),J({}),mn(),H(null),is(null),k("Deleted active file from Drive."))},[N,mn]);d.useCallback(async()=>{},[Zn,Tn,H,Nt]);const Ya=d.useCallback(async(a=!0,p=!1)=>{if(!(g&&!p)){S(!0),E(null);try{const h=await Re(a,"refreshFiles");if(!h){E("Sign in with Google to view cloud files.");return}const x=await bu(h.accessToken);f(x),k(null)}catch(h){const x=(h==null?void 0:h.message)||"Unable to load Drive files.";E(x),at(x)}finally{S(!1)}}},[Re,at,g]);d.useEffect(()=>{if(!Q){Fa.current=!1;return}s||l&&(Fa.current||(Fa.current=!0,Ya(!0)))},[l,s,Ya,Q]),d.useEffect(()=>{Q&&N!=null&&N.id&&(re(!1),Ee(!1))},[N==null?void 0:N.id,Q]),d.useCallback(async()=>{qd(!0),Ea(null);try{const a=await Re(!0,"importList");if(!a){Ea("Sign in first to import.");return}const p=await ku(a.accessToken);D0(p)}catch(a){const p=(a==null?void 0:a.message)||"Unable to list Drive files.";Ea(p),at(p)}finally{qd(!1)}},[Re,at]);const cy=d.useCallback(async()=>{if(!ee){E("Select a cloud file first.");return}if(Cn.current){E("Sync in progress. Please wait.");return}if($e||jn)if(window.confirm("You have unsynced changes. Sync them to Drive before switching files? Click OK to sync, Cancel to discard changes.")){if(await Ye({silent:!0}),$e||jn){E("Sync did not complete. Try again before switching files.");return}}else{if(!window.confirm("Discard unsynced changes and load the selected file?"))return;qn.current=0,En(!1),Ve(!1),Ot(null)}if(await Re(!0,"loadSelected")){Fe(!0);try{const p=await Bl(ee.id,"loadSelected"),h=typeof p.data=="string"?JSON.parse(p.data):p.data,x=Tn(h);if(!x)throw new Error("File could not be parsed.");const w=Zn(x,ee);if(w==="applied")k(`Loaded ${ee.name}. Data available locally.`),re(!1);else if(w==="skipped")k("Drive file is older than current data. Keeping existing data.");else throw new Error("File could not be parsed.");localStorage.setItem(Ao,JSON.stringify({id:ee.id,name:ee.name,modifiedTime:ee.modifiedTime,size:ee.size,revisionId:ee.revisionId})),Mr(`Loaded ${ee.name} from Drive.`)}catch(p){const h=(p==null?void 0:p.message)||"Unable to load Drive file.";E(h),at(h)}finally{Fe(!1)}}},[Re,ee,at,Mr,Zn,Tn,$e,jn,Bl]);d.useCallback(async()=>{const a=X.trim();if(!a){E("Enter a file name first.");return}const p=await Re(!0,"createFile");if(p){ot(!0),E(null);try{const x={...j1(void 0,void 0,_==null?void 0:_.students),lastWriter:"mobile",updatedAt:new Date().toISOString()},w=await nS(p.accessToken,a,JSON.stringify(x,null,2));f(C=>[w,...C]),H(w),Ut.current=w.id,Nt(w.id,w.revisionId||null),Or(w.id,x.updatedAt),Oe(w),me(""),localStorage.setItem(Ao,JSON.stringify({id:w.id,name:w.name,modifiedTime:w.modifiedTime,size:w.size,revisionId:w.revisionId})),Mr(`Created ${w.name} in Drive.`)}catch(h){const x=(h==null?void 0:h.message)||"Unable to create Drive file.";E(x),at(x)}finally{ot(!1)}}},[X,Re,_,Or,at,Mr]);const Pf=d.useCallback((a,p)=>{const h={...a||{}};return Object.entries(p||{}).forEach(([x,w])=>{if(!w||typeof w!="object")return;const C=h[x]||{},P={...C};["absent","tardy","leftEarly"].forEach(D=>{const R=w[D],W=C[D];R&&(!W||R>W)?P[D]=R:W&&(P[D]=W)}),h[x]=P}),h},[]),Ye=d.useCallback(async a=>{var h,x,w;if(s){k(o);return}if(Cn.current)return;if(a!=null&&a.silent&&!$e){Ve(!1),Ot(null);return}if(!((h=_==null?void 0:_.periods)!=null&&h.length)||!((x=_==null?void 0:_.students)!=null&&x.length)){k("Cannot sync until data is loaded. Open a file first.");return}if(fe){Ve(!0),Ot("Offline - changes will sync when back online."),ms(!0);return}if(Ar.current){k("Sync already running.");return}const p=qn.current;try{const C=await Re(!(a!=null&&a.silent),"syncUpload");if(!C){Ot("Reconnect to Google Drive to continue syncing."),Ve(!0);return}if(!N){k("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ve(!0);return}const P=T1({isOffline:fe,isLocked:Ar.current,inFlight:Cn.current,hasSession:!0,hasFile:!!N,dirty:$e,now:Date.now(),lastLocalEditAt:Lr.current,graceMs:gf});if(To("[Sync][Mobile] upload decision",P),P.action==="skip"){if(P.reason==="clean"&&!(a!=null&&a.silent)){const ne=N.id,be=(await bu(C.accessToken)).find(vs=>vs.id===ne),nt=be||N,kt=await Ss(C.accessToken,ne),ut=typeof kt=="string"?JSON.parse(kt):kt,yn=Tn(ut);if(!yn)throw new Error("Drive file could not be parsed.");const er=Zn(yn,nt);if(er==="failed")throw new Error("Drive file could not be parsed.");er==="applied"&&gn("Updated from Drive."),be!=null&&be.revisionId&&Nt(ne,be.revisionId||null),_n.current=Date.now(),as(new Date().toISOString()),Ve(!1),Ot(null),k("Synced with Google Drive."),Mr("Synced with Google Drive.");return}P.reason==="no-file"&&(k("Select a cloud file before syncing."),Ot("Select a cloud file before syncing."),Ve(!0));return}Ar.current=!0,Cn.current=!0,tf(!0);const D=fi(ds.current),R=fi(fs.current),W=await Bl(N.id,"syncUpload",C),K=typeof W.data=="string"?JSON.parse(W.data):W.data,te=Tn(K);if(!((w=te==null?void 0:te.periodsState)!=null&&w.periods))throw new Error("Drive file missing periods.");const ie=Ta.current,A=new Date().toISOString(),L=(te.periodsState.periods||[]).map(ne=>{const ve=String(ne.id),be=M[ve]||{},nt=Array.isArray(ne.pointsHistory)?[...ne.pointsHistory]:[],kt=Y[ve]||[],ut=_==null?void 0:_.periods.find(nn=>String(nn.id)===ve),yn=Pf(ne.attendanceResets||{},(ut==null?void 0:ut.attendanceResets)||{}),er=Sm(ne.attendance,D[ve],ie),vs=bm(ne.behaviorNotes,R[ve],ie,A),wo=[...nt,...kt].filter(nn=>!ie.has(String(nn.studentId))),So={...be};ie.forEach(nn=>{delete So[nn]});const Bf={...yn||{}};ie.forEach(nn=>{delete Bf[nn]});const Wf={...ne.customCounterByStudent||{},...(ut==null?void 0:ut.customCounterByStudent)||{}};ie.forEach(nn=>{delete Wf[nn]});const vy=ne.activeGrouping?ne.activeGrouping.map(nn=>nn.filter(wy=>!ie.has(String(wy)))):ne.activeGrouping;return{...ne,attendance:er,attendanceResets:Bf,customCounterByStudent:Wf,behaviorNotes:vs,pointsByStudent:So,pointsHistory:wo,activeGrouping:vy}}),oe=te.students||[],se=(_==null?void 0:_.students)||[],Ne=new Map(se.map(ne=>[String(ne.id),ne])),Ke=oe.filter(ne=>!ie.has(String(ne.id))).map(ne=>{const ve=Ne.get(String(ne.id));if(!ve)return ne;let be={...ne};const nt=ve.profileUpdatedAt||"",kt=ne.profileUpdatedAt||"";nt&&(!kt||nt>kt)&&(be={...be,fullName:ve.fullName,gender:ve.gender,periodIds:ve.periodIds,profileUpdatedAt:nt});const ut=ve.quickNoteUpdatedAt||"",yn=ne.quickNoteUpdatedAt||"";ut&&(!yn||ut>yn)&&(be={...be,quickNote:ve.quickNote,quickNoteUpdatedAt:ve.quickNoteUpdatedAt});const er=typeof ve.photoUpdatedAt=="number"?ve.photoUpdatedAt:0,vs=typeof ne.photoUpdatedAt=="number"?ne.photoUpdatedAt:0;er&&(!vs||er>vs)&&(be={...be,photoFileId:ve.photoFileId??null,photoUpdatedAt:er});const wo=typeof ve.audioUpdatedAt=="number"?ve.audioUpdatedAt:0,So=typeof ne.audioUpdatedAt=="number"?ne.audioUpdatedAt:0;return wo&&(!So||wo>So)&&(be={...be,audioFileId:ve.audioFileId??null,audioUpdatedAt:wo}),be}),Ur=new Set(oe.map(ne=>String(ne.id)));se.forEach(ne=>{ie.has(String(ne.id))||Ur.has(String(ne.id))||Ke.push(ne)});const An={...te,schemaVersion:1,version:1,lastWriter:"mobile",lastEditedPeriodId:it?String(it):null,lastEditedDate:le,updatedAt:A,students:Ke,periodsState:{...te.periodsState,periods:L}},vo=JSON.stringify(An,null,2),ke=await Ef(N.id,vo,"syncUpload",C);J(ne=>{const ve={...ne||{}};return delete ve[it||""],ve}),ke?(Tl.current=za(An),Nt(ke.id,ke.revisionId||null),Ut.current=ke.id,H(ke),Or(ke.id,An.updatedAt),_n.current=Date.now()):Or(N.id,An.updatedAt),Ta.current.clear(),ho("mobile"),a!=null&&a.silent||(k("Synced with Google Drive."),Mr("Synced with Google Drive.")),as(new Date().toISOString()),Ve(!1),localStorage.setItem(Ao,JSON.stringify({id:(ke==null?void 0:ke.id)||N.id,name:(ke==null?void 0:ke.name)||N.name,modifiedTime:(ke==null?void 0:ke.modifiedTime)||N.modifiedTime,size:(ke==null?void 0:ke.size)||N.size,revisionId:(ke==null?void 0:ke.revisionId)||N.revisionId})),qn.current===p&&(Z(ne=>{if(!ne)return ne;const ve=ne.periods.map(be=>{const nt=String(be.id),kt=Sm(be.attendance,D[nt],new Set),ut=bm(be.behaviorNotes,R[nt],new Set,A);return{...be,attendance:kt,behaviorNotes:ut}});return{...ne,periods:ve}}),En(!1),Ve(!1),mn())}catch(C){const P=(C==null?void 0:C.message)||"Failed to sync with Drive.";k(P),a!=null&&a.silent||at(P),Ve(!0)}finally{tf(!1),Cn.current=!1,Ar.current=!1}},[N,Re,Zn,at,gn,Mr,M,Y,_,le,it,$e,o,s,fe,Tn,mn,Z,Dl,Or,Nt,Bl,Ef,Pf]),Hl=d.useCallback(()=>{s||fe||$e&&N&&l&&(Ve(!0),Ye({silent:!0}))},[$e,N,l,s,Ye,fe]);d.useEffect(()=>{const a=()=>{document.visibilityState==="visible"&&(Hl(),!$e&&!Pr&&!fe&&N&&Pa.current())};return window.addEventListener("online",Hl),document.addEventListener("visibilitychange",a),()=>{window.removeEventListener("online",Hl),document.removeEventListener("visibilitychange",a)}},[Hl,$e,Pr,fe,N]),d.useEffect(()=>{if(fe){ms(!0);return}if(!hf||!N||!l)return;(async()=>{if(!$e){Ve(!1),Ot(null),ms(!1);return}Ve(!0),Ot("Reconnected  refreshing data"),await Ye({silent:!0}),ms(!1),Ot(null)})()},[fe,hf,N,l,$e,Ye]),d.useEffect(()=>{if(!N||!$e&&!jn||Cn.current)return;const a=window.setTimeout(()=>{Ye({silent:!0})},500);return()=>window.clearTimeout(a)},[$e,jn,N,Ye,He,Kt,M,Y]),d.useEffect(()=>{if(!jn||s||fe||!N)return;const a=window.setInterval(()=>{Cn.current||Ar.current||Ye({silent:!0})},2500);return()=>window.clearInterval(a)},[jn,s,fe,N,Ye]),d.useEffect(()=>{N&&Nt(N.id,N.revisionId||null)},[N,Nt]),d.useEffect(()=>{Ut.current=(N==null?void 0:N.id)||null,Aa.current=0},[N]);const Vl=d.useCallback(async()=>{if(s)return;const a=Ut.current;if(!a)return;const p=P1({isOffline:fe,isLocked:Ar.current||Pr,inFlight:Cn.current,dirty:$e,now:Date.now(),lastLocalEditAt:Lr.current,lastPullAt:_n.current,graceMs:gf});if(To("[Sync][Mobile] pull decision",p),p.action==="skip")return;const h=await Re(!1,"pull");if(h&&Ut.current===a)try{const x=await bu(h.accessToken);if(Ut.current!==a)return;const w=x.find(R=>R.id===a),C=Dl(a),P=!(w!=null&&w.revisionId)||w.revisionId!==C,D=Date.now()-Aa.current>=yf;if(P||D){Aa.current=Date.now();const R=await Ss(h.accessToken,a);if(Ut.current!==a)return;const W=typeof R=="string"?JSON.parse(R):R,K=Tn(W);if(!K)return;const te=za(K);if(Tl.current&&te===Tl.current){w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now(),ho(K.lastWriter||"unknown");return}const ie=Zn(K,w);ie==="applied"&&Ut.current===a?(as(new Date().toISOString()),w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now(),ho(K.lastWriter||"unknown"),$a(A=>A+1),gn("Updated from Drive.")):ie==="skipped"&&(w!=null&&w.revisionId&&Nt(a,w.revisionId||null),_n.current=Date.now())}else _n.current=Date.now()}catch{}},[Zn,Re,Tn,gn,$e,Pr,fe,s,Dl,Nt,yf]);d.useEffect(()=>{Pa.current=Vl},[Vl]),d.useEffect(()=>{if(s)return;const a=()=>{Pa.current()},p=window.setTimeout(a,2e3),h=window.setInterval(a,1e4);return()=>{window.clearTimeout(p),window.clearInterval(h)}},[s]),d.useEffect(()=>{if(Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null),!s&&!($e||Pr||fe||!N))return Mt.current=window.setTimeout(()=>{Vl()},5e3),()=>{Mt.current&&(window.clearTimeout(Mt.current),Mt.current=null)}},[$e,Pr,fe,N,s,Vl]);const Af=(T==null?void 0:T.state)??"unknown";let If=Af==="ok"&&l?"Connected to Google Drive":"Google Drive Sync",ys="Link Google Drive to save and sync. Files stay in your Drive.",xs=l?"Manage Files":"Connect to Drive";switch(Af){case"no-session-yet":xs=l?"Manage Files":"Connect to Google Drive",ys="Store your seating data in a private folder in your Google Drive.";break;case"device-storage-wipe":xs=l?"Manage Files":"Reconnect Google Drive",ys="Your device cleared your Google connection. Tap below to reconnect; your files are still in your Drive.";break;case"oauth-failure":xs=l?"Manage Files":"Reconnect Google Drive",ys="There was a Google sign-in problem. Reconnect to continue syncing.";break;case"user-logged-out":xs=l?"Manage Files":"Connect to Google Drive",ys="You disconnected from Google Drive.";break}s&&(If="Drive sync disabled",ys=o,xs="Drive disabled");const Df=xe&&tt&&(_!=null&&_.periods)&&_.periods.find(a=>String(a.id)===String(tt))||null,Gt=d.useMemo(()=>!xe||!_?null:_.students.find(a=>String(a.id)===String(xe.id))||null,[xe,_]),{audioUrl:xo}=zd({studentId:(Gt==null?void 0:Gt.id)??"menu",audioFileId:(Gt==null?void 0:Gt.audioFileId)??null,audioUpdatedAt:(Gt==null?void 0:Gt.audioUpdatedAt)??null,driveSession:l}),Qa=!!(Gt!=null&&Gt.audioFileId),Lf=Df&&xe?Math.max(0,Number(((Mf=Df.customCounterByStudent)==null?void 0:Mf[String(xe.id)])||0)):null;d.useEffect(()=>{xe||(cs(!1),us.current&&us.current.pause())},[xe]),d.useEffect(()=>{cs(!1),us.current&&us.current.pause()},[xo]);const dy=async()=>{if(!xo)return;const a=us.current;if(a){if(rf){a.pause(),cs(!1);return}try{await a.play(),cs(!0)}catch{e({message:"Could not play audio. Please try again.",tone:"error"})}}},fy=_t==="attendance"&&!!_&&!!it,py=typeof window<"u"?window.matchMedia("(max-width: 820px)").matches:!1,my=t||py,hy=(((Uf=_==null?void 0:_.periods)==null?void 0:Uf.length)??0)>0,gy=my&&m&&!hy&&!La&&!fe,Of=!(!s&&!l),yy=ee?`Open "${ee.name}"`:"Open File",xy=d.useCallback(()=>{try{window.localStorage.setItem(_m,"1")}catch{}H0(!0)},[]);return i.jsx(Q1,{children:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"min-h-[100dvh] h-[100dvh] bg-gradient-to-b from-violet-900 to-indigo-800 text-white flex flex-col relative",children:[i.jsxs("div",{className:"bg-emerald-50 text-emerald-900 text-xs px-4 py-1 text-center",children:[i.jsx("span",{role:"img","aria-label":"lock",className:"mr-1",children:""}),"Privacy: Data stays on this device and in your Google Drive. Use your school Google account. No data is sent to our servers."]}),fe&&i.jsx("div",{className:"bg-slate-900 text-white text-xs px-4 py-1 text-center",children:"Offline  edits are saved locally and will sync when youre back online."}),i.jsxs("div",{className:"px-4 pt-2 flex items-center justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow",onClick:K0,title:"Version",type:"button",children:["Rev ",Cm]}),i.jsx("button",{className:"text-[11px] px-2 py-1 rounded border border-white/60 bg-white/20 text-white shadow hover:bg-white/30",onClick:()=>wt(!0),type:"button",children:"About"}),i.jsx("a",{href:"https://help.classseats.app/",target:"_blank",rel:"noopener noreferrer",className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow hover:bg-white",title:"Open ClassSeats Help Center",children:" Help"})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[i.jsx("span",{className:"text-[16px] font-bold tracking-wide text-white/90 whitespace-nowrap",children:"ClassSeats Mobile"}),!t&&i.jsx(N1,{current:"mobile",onGoDesktop:G0,onGoMobile:()=>{}})]})]}),fy&&i.jsx("div",{className:"mt-[76px]"}),jm,_t==="attendance"&&_&&it&&(()=>{const a=_.periods.find(te=>te.id===it);if(!a)return null;const p=_.students.filter(te=>{var ie;return(ie=te.periodIds)==null?void 0:ie.includes(String(a.id))}),h=He[a.id]||{},x=p.length||1,w=p.filter(te=>h[te.id]==="present").length,C=p.filter(te=>h[te.id]==="absent").length,P=p.filter(te=>h[te.id]==="tardy").length,D=p.filter(te=>h[te.id]==="left_early").length,R=w+C+P+D,W=Math.round(R/x*100),K=Math.round(w/x*100);return i.jsx("div",{className:"fixed left-0 right-0 z-40 px-4 pt-2",style:{top:"76px"},children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow px-3 py-2 flex flex-wrap items-center gap-2 text-xs text-slate-800",children:[i.jsxs("span",{className:"font-semibold",children:["Progress: ",W,"%  Present: ",K,"%"]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 font-semibold",children:[" Present: ",w]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-rose-100 text-rose-800 font-semibold",children:[" Absent: ",C]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-amber-100 text-amber-800 font-semibold",children:[" Tardy: ",P]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-800 font-semibold",children:[" Left Early: ",D]})]})})})(),i.jsxs("main",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-28 pt-20 space-y-6 relative",children:[i.jsx(g1,{variant:"inline"}),i.jsx("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-5",children:i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-base font-semibold text-slate-900",children:If}),i.jsx("p",{className:"text-xs text-slate-600",children:ys}),i.jsxs("p",{className:"text-[11px] text-slate-500",children:[l?((Ff=l.profile)==null?void 0:Ff.email)||"Signed in":"Not signed in"," "," ",(N==null?void 0:N.name)||(ee==null?void 0:ee.name)||"No file selected",fe&&"  Offline"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[jn&&i.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-amber-100 text-amber-800",children:"Pending sync"}),fe&&i.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-slate-200 text-slate-700",children:"Offline"}),i.jsx("button",{className:"rounded-full bg-slate-900 text-white font-semibold px-4 py-2 text-sm disabled:opacity-50",disabled:s||!l||!N,onClick:()=>{if(s){k(o);return}Ye()},title:s?o:void 0,children:"Sync Now"}),i.jsx("button",{className:"rounded-full bg-emerald-600 text-white font-semibold px-4 py-2 text-sm",onClick:()=>{if(s){k(o);return}return l?re(!0):void Re(!0,"cta")},disabled:s,title:s?o:void 0,children:xs})]})]})}),s&&i.jsx("p",{className:"max-w-2xl mx-auto text-sm text-rose-100 text-left",children:"Drive sync is disabled."}),F&&i.jsxs("section",{className:"max-w-2xl mx-auto bg-slate-900 text-slate-100 rounded-2xl shadow-inner p-3 space-y-2 text-xs",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"font-semibold",children:"Drive Debug"}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>$(!1),children:"Close"})]}),i.jsx("button",{className:"text-slate-200 underline",onClick:()=>ue([]),children:"Clear"})]}),i.jsxs("div",{className:"border border-slate-700 rounded p-2 h-48 overflow-y-auto space-y-1 bg-slate-800/70",children:[z.length===0&&i.jsx("div",{className:"text-slate-400",children:"No debug entries yet."}),z.map((a,p)=>i.jsx("div",{className:"font-mono text-[11px] whitespace-pre-wrap break-all",children:a},p))]})]}),i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsx("div",{className:"mt-3",children:i.jsx("div",{className:"inline-flex w-full rounded-xl border border-slate-200 bg-slate-50 p-1",children:i.jsxs("div",{className:"grid w-full grid-cols-3 gap-1",children:[i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${_t==="attendance"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Da("attendance"),children:"Attendance"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${_t==="notes"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Da("notes"),children:"Notes"}),i.jsx("button",{className:`rounded-lg px-2 py-2 text-sm font-semibold transition ${_t==="flashcards"?"bg-violet-100 text-violet-900 shadow-sm ring-1 ring-violet-200":"text-slate-600"}`,onClick:()=>Da("flashcards"),children:"Flashcards"})]})})})}),i.jsxs("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-6 space-y-6",children:[_&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[i.jsx("div",{children:i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:_t==="attendance"?"Attendance & Behavior":_t==="notes"?"Student Notes":"Flashcards"})}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[_t==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Date:"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(le);a.setDate(a.getDate()-1),co(a.toISOString().slice(0,10))},children:""}),i.jsx("input",{type:"date",className:"rounded border border-slate-300 px-2 py-1 text-sm",value:le,onChange:a=>co(a.target.value||Ia())}),i.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const a=new Date(le);a.setDate(a.getDate()+1),co(a.toISOString().slice(0,10))},children:""}),i.jsx("button",{className:"px-2 py-1 rounded border border-emerald-200 bg-emerald-50 text-emerald-700 text-sm font-semibold",onClick:()=>co(Ia()),children:"Today"})]})]}),_t==="notes"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Sort:"}),i.jsxs("select",{className:"rounded border border-slate-300 bg-white text-slate-900 px-3 py-2 text-sm shadow-sm",value:Rl,onChange:a=>z0(a.target.value),children:[i.jsx("option",{value:"first-last",children:"First Last"}),i.jsx("option",{value:"last-first",children:"Last, First"})]})]}),_t==="attendance"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"View:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:Ir,onChange:a=>F0(a.target.value),children:[i.jsx("option",{value:"table",children:"Table View"}),i.jsx("option",{value:"list-last-first",children:"List (Last, First)"}),i.jsx("option",{value:"list-first-last",children:"List (First Last)"}),i.jsx("option",{value:"list-seat-number",children:"List (Seat Number)"})]}),Ir==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Table Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:fo,onChange:a=>$0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3 / A, B, C)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1 / C, B, A)"})]})]}),Ir==="list-seat-number"&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Seat Order:"}),i.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:_l,onChange:a=>B0(a.target.value),children:[i.jsx("option",{value:"asc",children:"Ascending (1, 2, 3)"}),i.jsx("option",{value:"desc",children:"Descending (3, 2, 1)"})]})]})]}),_.periods.length>0&&i.jsx("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:it||"",onChange:a=>is(a.target.value||null),children:_.periods.map(a=>i.jsx("option",{value:a.id,children:a.name},a.id))})]})]}),it?(()=>{const a=_.periods.find(A=>A.id===it);if(!a)return i.jsx("p",{className:"text-sm text-slate-500",children:"Period not found."});if(_t==="notes"){const A=_.students.filter(L=>{var oe;return(oe=L.periodIds)==null?void 0:oe.includes(String(it))}).slice().sort((L,oe)=>{const[se,...Ne]=L.fullName.split(" "),[Ke,...Ur]=oe.fullName.split(" ");return Rl==="last-first"?Ne.join(" ").localeCompare(Ur.join(" ")):se.localeCompare(Ke)});return i.jsx("div",{className:"space-y-3",children:A.length===0?i.jsx("p",{className:"text-sm text-slate-500",children:"No students found."}):A.map(L=>{var se;const oe=(se=L.docs)==null?void 0:se.find(Ne=>Ne.pinned);return i.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm",children:i.jsx("div",{className:"flex flex-col gap-3",children:i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800 truncate",children:[L.fullName,"  QuickNote"]}),L.quickNote&&i.jsxs("div",{className:"relative mt-1",children:[i.jsx("div",{className:"text-xs text-slate-600 whitespace-pre-wrap break-words max-h-28 overflow-hidden pr-2",children:L.quickNote}),L.quickNote.length>180&&i.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t from-white to-transparent"}),i.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Open Quick Note to view/edit more."})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{oo(L.quickNote||""),lt({studentId:L.id,studentName:L.fullName})},children:"Quick Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-50",disabled:!oe,onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),oe&&Va(Ha(oe.driveFileId))},children:"Pinned Note"}),i.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>Gn({studentId:L.id,studentName:L.fullName}),children:"Docs"})]})]})})},L.id)})})}if(_t==="flashcards"){const A=_.students.filter(L=>{var oe;return(oe=L.periodIds)==null?void 0:oe.includes(String(it))});return i.jsx(tb,{students:A,periodId:String(it),driveFileId:Ut.current,driveClient:r,driveSession:l,onAudioSaved:(L,oe,se)=>{Z(Ne=>Ne&&{...Ne,students:Ne.students.map(Ke=>String(Ke.id)===String(L)?{...Ke,audioFileId:oe,audioUpdatedAt:se}:Ke)}),Ae(),Ye({silent:!0})},onAudioDeleted:L=>{Z(oe=>oe&&{...oe,students:oe.students.map(se=>String(se.id)===String(L)?{...se,audioFileId:null,audioUpdatedAt:null}:se)}),Ae(),Ye({silent:!0})}})}const p=a.layoutId?_.layouts[a.layoutId]:null,h=_.students.filter(A=>{var L;return(L=A.periodIds)==null?void 0:L.includes(String(a.id))}),x=h.reduce((A,L)=>(A[String(L.id)]=L,A),{}),w={};p==null||p.tables.forEach(A=>w[A.id]={id:A.id,name:A.name,students:[]});const C=[],P=a.tableAssignments||{};Array.isArray(a.activeGrouping)&&Object.keys(P||{}).length>0?(a.activeGrouping.forEach((A,L)=>{const oe=P[String(L)]||P[L],se=oe?w[oe]:null;A==null||A.forEach(Ne=>{const Ke=x[String(Ne)];Ke&&(se?se.students.push(Ke):C.push(Ke))})}),h.forEach(A=>{(a.activeGrouping||[]).some(oe=>oe==null?void 0:oe.some(se=>String(se)===String(A.id)))||C.push(A)})):h.forEach(A=>{const L=P[String(A.id)]||P[A.id];L&&w[L]?w[L].students.push(A):C.push(A)});const D=Object.values(w).sort((A,L)=>{const oe=A.name||"",se=L.name||"",Ne=W0.compare(oe,se);if(Ne!==0)return fo==="asc"?Ne:-Ne;const Ke=String(A.id).localeCompare(String(L.id));return fo==="asc"?Ke:-Ke}),R=He[a.id]||{},W={...a.attendance||{},[le]:R},K=a.attendanceResets||{};Kt[a.id];const te=M[a.id]||{};I0[a.id];const ie=(A,L,oe)=>{var be,nt;const se=R[A.id],Ne=Eu({attendance:W,studentId:A.id,date:le,status:"absent",resets:K}),Ke=p1({attendance:W,studentId:A.id,date:le,resets:K}),Ur=Eu({attendance:W,studentId:A.id,date:le,status:"tardy",resets:K}),An=Eu({attendance:W,studentId:A.id,date:le,status:"left_early",resets:K}),vo=Math.max(0,Number(((be=a.customCounterByStudent)==null?void 0:be[String(A.id)])||0)),ke=typeof te[A.id]=="number"?te[A.id]:a.startingPoints??50,ne=!!((nt=Kt[a.id])!=null&&nt[A.id]),ve=ja[String(A.id)]||null;return i.jsx(mb,{student:A,attendance:se,points:ke,pointsEnabled:!!a.pointsEnabled,maxPoints:a.startingPoints??50,hasNote:ne,absenceTotal:Ne,absenceStreak:Ke,tardyCount:Ur,leftEarlyCount:An,customCounter:vo,onShowAbsenceHelp:()=>Tr("absent"),onShowTardyHelp:()=>Tr("tardy"),onShowLeftEarlyHelp:()=>Tr("leftEarly"),onShowCustomHelp:()=>Tr("custom"),seatNumber:L,showSeatNumber:oe,statusBg:q0,statusLabel:jf,tempPhotoUrl:ve,onOpenPhoto:()=>{Vd({id:String(A.id),fullName:A.fullName,photoFileId:A.photoFileId??null})},onOpenMenu:()=>{bt({id:A.id,name:A.fullName}),Xd(a.id)},driveClient:r,driveSession:l},A.id)};if(Ir!=="table"){const A=new Map;h.forEach(se=>{A.set(String(se.id),hb(a,p,se.id))});const L=Ir==="list-seat-number",oe=[...h].sort((se,Ne)=>{const[Ke,...Ur]=se.fullName.split(" "),[An,...vo]=Ne.fullName.split(" "),ke=Ur.join(" "),ne=vo.join(" ");if(Ir==="list-seat-number"){const ve=A.get(String(se.id)),be=A.get(String(Ne.id)),nt=parseInt(String(ve??""),10),kt=parseInt(String(be??""),10),ut=Number.isFinite(nt),yn=Number.isFinite(kt);return ut!==yn?ut?-1:1:ut&&yn&&nt!==kt?_l==="asc"?nt-kt:kt-nt:`${se.fullName||""}`.localeCompare(`${Ne.fullName||""}`)}return Ir==="list-last-first"?`${ke} ${Ke}`.localeCompare(`${ne} ${An}`):`${Ke} ${ke}`.localeCompare(`${An} ${ne}`)});return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Wl(a.id,h.map(se=>se.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>_f(a.id),children:"Reset Today"})]}),i.jsx("div",{className:"space-y-2",children:oe.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students found."}):oe.map(se=>ie(se,L?A.get(String(se.id)):null,L))})]})}return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Wl(a.id,h.map(A=>A.id)),children:"Mark Rest Present (All)"}),i.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>_f(a.id),children:"Reset Today"})]}),D.map(A=>{const L=A.students.filter(se=>R[se.id]!=="absent").map(se=>se.id),oe=A.name.replace("Table","").trim()||A.name;return i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200 gap-3",children:[i.jsxs("div",{className:"flex flex-col leading-tight text-center min-w-[54px]",children:[i.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Table"}),i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:oe})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Wl(a.id,A.students.map(se=>se.id)),children:"Mark Rest Present"}),a.pointsEnabled&&i.jsx("button",{className:"text-[11px] rounded bg-amber-600 text-white px-3 py-2 font-semibold",onClick:()=>{jl(null),kl(0),Ca(""),lo({periodId:a.id,tableName:A.name,studentIds:L})},children:"Table Points"})]})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:A.students.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No students assigned."}):A.students.map(se=>ie(se))})]},A.id)}),i.jsxs("div",{className:"rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Unassigned"}),i.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Wl(a.id,C.map(A=>A.id)),children:"Mark Rest Present"})]}),i.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:C.length===0?i.jsx("p",{className:"text-xs text-slate-500",children:"No unassigned students."}):C.map(A=>ie(A))})]})]})})():i.jsx("p",{className:"text-sm text-slate-500",children:"Load and select a period to begin."})]}),ls&&i.jsx(ab,{open:!0,studentId:ls.id,studentFullName:ls.fullName,existingPhotoFileId:ls.photoFileId,onClose:()=>Vd(null),onAccept:a=>{const p=ls.id;if(!p)return;const h=URL.createObjectURL(a);A0(x=>{const w=x[p];return w&&URL.revokeObjectURL(w),{...x,[p]:h}})},onUploadComplete:({fileId:a,photoUpdatedAt:p})=>{const h=ls.id;Z(x=>x&&{...x,students:x.students.map(w=>w.id===h?{...w,photoFileId:a,photoUpdatedAt:p}:w)}),Ae(),Ye({silent:!0})}}),_r&&i.jsx(E0,{open:!0,studentId:_r.id,studentFullName:_r.fullName,existingAudioFileId:_r.audioFileId,existingAudioUpdatedAt:_r.audioUpdatedAt,driveSession:l,onClose:()=>Kd(null),onUploadComplete:({fileId:a,audioUpdatedAt:p})=>{const h=_r.id;Z(x=>x&&{...x,students:x.students.map(w=>w.id===h?{...w,audioFileId:a,audioUpdatedAt:p}:w)}),Ae(),Ye({silent:!0})},onDeleteComplete:()=>{const a=_r.id;Z(p=>p&&{...p,students:p.students.map(h=>h.id===a?{...h,audioFileId:null,audioUpdatedAt:null}:h)}),Ae(),Ye({silent:!0})}}),Zd&&Qn&&i.jsx(Pd,{isOpen:!0,onRequestClose:Ml,title:"Edit Student",maxWidth:"md",showCloseX:!0,footer:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:Ml,children:"Cancel"}),i.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:()=>{const a=Qn.name.trim();if(!a||!Qn.periodId){alert("Name and period are required.");return}const p=Zd.id;Z(h=>h&&{...h,students:h.students.map(x=>String(x.id)===String(p)?{...x,fullName:a,gender:Qn.gender,periodIds:[String(Qn.periodId)],profileUpdatedAt:new Date().toISOString()}:x)}),Ae(),Ye({silent:!0}),Ml()},children:"Save"})]}),children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Full Name"}),i.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:Qn.name,onChange:a=>io(p=>p&&{...p,name:a.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Gender"}),i.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Qn.gender,onChange:a=>io(p=>p&&{...p,gender:a.target.value}),children:[i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"O",children:"Other/Prefer not"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-slate-600",children:"Class Period"}),i.jsx("select",{className:"mt-1 w-full rounded border px-3 py-2",value:Qn.periodId,onChange:a=>io(p=>p&&{...p,periodId:a.target.value}),children:((_==null?void 0:_.periods)||[]).map(a=>i.jsx("option",{value:String(a.id),children:a.name},String(a.id)))})]})]})}),xe&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center px-4",onClick:()=>bt(null),children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-4 w-full max-w-sm space-y-3",onClick:a=>a.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:xe.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Actions"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{type:"button",className:"rounded-md p-1 text-slate-600 hover:text-slate-800",onClick:()=>{bt(null),Y0(xe.id)},"aria-label":"Edit student",children:""}),i.jsx("button",{type:"button",className:"rounded-md p-1 text-rose-600 hover:text-rose-700",onClick:()=>Q0(xe.id),"aria-label":"Delete student",children:""}),i.jsx("button",{className:"rounded-md p-1 text-slate-500 hover:text-slate-700",onClick:()=>bt(null),children:""})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:J0.map(a=>i.jsx("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{tt&&Ga(tt,xe.id,a),bt(null)},children:jf(a)},a))}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{className:"w-full rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{tt&&ly(tt,xe.id,xe.name),bt(null)},children:" Notes and Points"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:`rounded-lg border px-2 py-2 text-xs text-left ${Qa&&xo?"border-slate-200 text-slate-700 hover:bg-slate-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:()=>{dy()},disabled:!Qa||!xo,children:rf?" Pause audio":" Play audio"}),i.jsxs("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{const a=_==null?void 0:_.students.find(p=>String(p.id)===String(xe.id));Kd({id:xe.id,fullName:xe.name,audioFileId:(a==null?void 0:a.audioFileId)??null,audioUpdatedAt:(a==null?void 0:a.audioUpdatedAt)??null}),bt(null)},children:[" ",Qa?"Re-record audio":"Record audio"]})]})]}),i.jsx("audio",{ref:us,src:xo||void 0,onEnded:()=>cs(!1),onPause:()=>cs(!1)}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{tt&&xe&&Rf(tt,xe.id,1),bt(null)},children:[""," +1 counter ",typeof Lf=="number"?`(${Lf})`:""]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{tt&&xe&&Rf(tt,xe.id,-1),bt(null)},children:[""," -1 counter"]}),i.jsxs("button",{className:"w-full rounded-lg border border-slate-300 px-2 py-2 text-xs text-left hover:bg-slate-50 text-slate-700",onClick:()=>{tt&&xe&&ry(tt,xe.id),bt(null)},children:[""," Reset counter"]}),i.jsx("button",{className:"w-full rounded-lg border border-rose-200 px-2 py-2 text-xs text-left hover:bg-rose-50 text-rose-700",onClick:()=>{tt&&xe&&Ka(tt,xe.id,"absent"),bt(null)},children:" Reset absence streak"}),i.jsx("button",{className:"w-full rounded-lg border border-amber-200 px-2 py-2 text-xs text-left hover:bg-amber-50 text-amber-700",onClick:()=>{tt&&xe&&Ka(tt,xe.id,"tardy"),bt(null)},children:" Reset tardy counter"}),i.jsx("button",{className:"w-full rounded-lg border border-orange-200 px-2 py-2 text-xs text-left hover:bg-orange-50 text-orange-700",onClick:()=>{tt&&xe&&Ka(tt,xe.id,"leftEarly"),bt(null)},children:" Reset left early counter"})]}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>bt(null),children:"Close"})]})}),Cl&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Tr(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"About this badge"}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Tr(null),children:""})]}),Cl==="absent"?i.jsx("p",{className:"text-sm text-slate-700",children:"A# is total absences since reset. S# is the latest absence streak ending on the most recent marked day (unmarked days are skipped)."}):Cl==="leftEarly"?i.jsx("p",{className:"text-sm text-slate-700",children:"LE# shows the left early count since the last reset."}):Cl==="custom"?i.jsxs("p",{className:"text-sm text-slate-700",children:["","# is your custom teacher counter since the last reset."]}):i.jsx("p",{className:"text-sm text-slate-700",children:"T# shows the tardy count since the last reset."}),i.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>Tr(null),children:"Got it"})]})]}),ce&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>de(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:["Behavior for ",ce.studentName]}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Today  Points ",ge.pointsEnabled?`${Wa(ge.currentPoints,ge.startingPoints)} ${ge.currentPoints}`:"disabled"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>de(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:ye.note,onChange:a=>Se(p=>({...p,note:a.target.value})),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:4,placeholder:"Enter behavior note...",autoFocus:!0,onMouseDown:a=>a.stopPropagation(),onClick:a=>a.stopPropagation()}),i.jsx("div",{className:"flex flex-wrap gap-2",children:[" Excellent participation"," Needs redirection"," Academic progress"," Positive peer interactions"].map(a=>i.jsx("button",{onClick:()=>Se(p=>({...p,note:p.note?p.note+" "+a:a})),className:"text-[11px] px-2.5 py-1 rounded-lg bg-slate-100 hover:bg-slate-200 border border-slate-200 text-slate-700",children:a},a))})]}),ge.pointsEnabled&&i.jsxs("div",{className:"space-y-3 border border-slate-200 rounded-xl p-3 bg-slate-50",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Points"}),i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsxs("span",{children:[Wa(ge.currentPoints,ge.startingPoints)," ",ge.currentPoints]}),i.jsx("span",{className:"text-slate-400",children:""}),i.jsxs("span",{children:[Wa(Math.max(0,ge.currentPoints+ye.delta),ge.startingPoints)," ",Math.max(0,ge.currentPoints+ye.delta)]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,0,-1,-2].map(a=>i.jsx("button",{onClick:()=>Se(p=>({...p,delta:a,reason:p.reason})),className:`px-3 py-1.5 rounded border text-sm font-semibold ${ye.delta===a?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-700 border-slate-300 hover:bg-indigo-50"}`,children:a>0?`+${a}`:a},a)),i.jsx("button",{onClick:()=>{const a=prompt("Enter custom point change:",String(ye.delta));if(a===null)return;const p=parseInt(a,10);Number.isNaN(p)||Se(h=>({...h,delta:p,reason:h.reason}))},className:"px-3 py-1.5 rounded border text-sm font-semibold bg-white text-slate-700 border-slate-300 hover:bg-indigo-50",children:"Custom"})]}),ye.delta!==0&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Reason (required)"}),i.jsx("input",{value:ye.reason,onChange:a=>Se(p=>({...p,reason:a.target.value})),className:"w-full border border-slate-300 rounded px-2 py-1 text-sm",placeholder:"Enter reason for point change"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:oy,children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>de(null),children:"Cancel"})]})]})]}),Vn&&_&&(()=>{const a=_.students.find(p=>p.id===Vn.studentId);return a?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>lt(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Quick Note"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>lt(null),children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),i.jsx("textarea",{value:Kn,onChange:p=>oo(p.target.value),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:5,placeholder:"Add a quick note...",autoFocus:!0,onMouseDown:p=>p.stopPropagation(),onClick:p=>p.stopPropagation()})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:()=>{const p=Vn.studentId,h=Kn;Z(x=>x&&{...x,students:x.students.map(w=>w.id===p?{...w,quickNote:h,quickNoteUpdatedAt:new Date().toISOString()}:w)}),qn.current+=1,En(!0),Ve(!0),Lr.current=Date.now(),Ye({silent:!0}),lt(null)},children:"Save"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>lt(null),children:"Cancel"})]})]})]}):null})(),pn&&_&&(()=>{const a=_.students.find(w=>w.id===pn.studentId);if(!a)return null;const p=_.periods.find(w=>w.id===it),x=(a.docs||[]).slice().sort((w,C)=>{if(w.pinned&&!C.pinned)return-1;if(!w.pinned&&C.pinned)return 1;const P=w.createdAt?new Date(w.createdAt).getTime():0;return(C.createdAt?new Date(C.createdAt).getTime():0)-P});return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Gn(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Student Docs"}),i.jsx("p",{className:"text-xs text-slate-500",children:a.fullName})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>Gn(null),children:""})]}),i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-xs text-slate-500",children:"Tap a doc to open it in Google Docs."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"To protect privacy, ClassSeats can only see the documents it helps create."}),i.jsx("p",{className:"text-[11px] leading-snug text-slate-500",children:"All documents are created in the ClassSeats/Student Docs folder in your Google Drive."})]}),i.jsx("button",{className:"rounded-lg bg-emerald-600 text-white text-xs font-semibold px-3 py-2 disabled:opacity-50",disabled:!n.canUseDriveSync,onClick:async()=>{if(n.canUseDriveSync)try{const w=await Re(!0,"studentDocCreate");if(!w)return;const C=(p==null?void 0:p.name)||"Period",P=`Notes - ${a.fullName} - ${C} ${Z0(new Date)}`,D=window.prompt("Name this Doc:",P);if(!D||!D.trim())return;const R=D.trim(),W=await Vw(w.accessToken),K=await Yw(w.accessToken,W,R),te=new Date().toISOString(),ie={id:X0(),driveFileId:K.fileId,title:K.title||R,createdAt:te,lastOpenedAt:te};Z(A=>A&&{...A,students:A.students.map(L=>L.id===a.id?{...L,docs:[...L.docs||[],ie]}:L)}),qn.current+=1,En(!0),Ve(!0),Lr.current=Date.now(),Va(Ha(K.fileId))}catch(w){at((w==null?void 0:w.message)||"Unable to create Google Doc.")}},children:"+ New Doc"})]}),i.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2",children:x.length===0?i.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3 text-sm text-slate-600",children:"No Docs yet."}):x.map(w=>i.jsx("button",{className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",onClick:C=>{C.preventDefault(),C.stopPropagation(),Va(Ha(w.driveFileId))},children:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{className:"font-semibold text-slate-900",children:w.title}),w.pinned&&i.jsx("span",{className:"text-[10px] font-semibold text-emerald-700 bg-emerald-100 px-2 py-0.5 rounded-full",children:"PINNED"})]})},w.id))}),i.jsx("button",{className:"w-full rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>Gn(null),children:"Close"})]})]})})(),!_&&i.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"No class file loaded yet."}),i.jsx("p",{className:"text-sm text-slate-600",children:"To take attendance or track points, open a class file from your Google Drive."}),i.jsx("button",{className:"w-full rounded-lg bg-emerald-600 text-white font-semibold py-2",onClick:()=>{if(s){k(o);return}return l?re(!0):void Re(!0,"empty-state")},disabled:s,title:s?o:void 0,children:"Manage Files"})]}),Yn&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>lo(null)}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:Yn.tableName}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Apply points to ",Yn.studentIds.length," present student",Yn.studentIds.length===1?"":"s"]})]}),i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>lo(null),children:""})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note (required)"}),i.jsx("textarea",{className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Describe why youre adjusting points",value:Jd,onChange:a=>Ca(a.target.value),rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Choose points"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,-1,-2].map(a=>{const p=Qd===a;return i.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm font-semibold border ${p?"bg-amber-600 text-white border-amber-600":"bg-white text-amber-800 border-amber-300"}`,onClick:()=>{jl(a),kl(0)},children:[a>0?`+${a}`:a," pts"]},a)}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"number",className:"w-24 rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Custom",value:Yd,onFocus:()=>jl(null),onChange:a=>kl(Number(a.target.value)||0)})})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{className:"flex-1 rounded-lg bg-amber-600 text-white font-semibold py-2",onClick:()=>{const a=Jd.trim(),p=Qd??Yd;if(!a){at("Enter a note for the point change.");return}if(!p){at("Select a point value.");return}sy(Yn.periodId,Yn.studentIds,p,a),jl(null),kl(0),Ca(""),lo(null)},children:"Apply"}),i.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>lo(null),children:"Cancel"})]}),i.jsx("p",{className:"text-[11px] text-slate-500",children:"Only present students at this table receive the adjustment. Absent students are skipped."}),(()=>{const a=(Y[Yn.periodId]||[]).filter(h=>{var x;return((x=h.date)==null?void 0:x.startsWith(le))&&Yn.studentIds.includes(String(h.studentId))});if(a.length===0)return null;const p=h=>{var x;return((x=_==null?void 0:_.students.find(w=>String(w.id)===String(h)))==null?void 0:x.fullName)||`Student ${h}`};return i.jsxs("div",{className:"border-t border-slate-200 pt-2 space-y-1",children:[i.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Todays table adjustments"}),i.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:a.map((h,x)=>i.jsxs("div",{className:"text-xs text-slate-700 flex justify-between",children:[i.jsx("span",{className:"font-semibold",children:p(h.studentId)}),i.jsxs("span",{children:[h.delta>0?"+":"",h.delta,"  ",h.reason||"No note"]})]},`${h.studentId}-${x}`))})]})})()]})]})]}),Q&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Of?()=>{re(!1),Ee(!1)}:void 0}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-5 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Select Your ClassSeats File"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Choose the file you use on desktop to continue."})]}),i.jsxs("div",{ref:nf,className:"relative flex items-center gap-3",children:[l&&i.jsx("button",{type:"button",className:"text-slate-600 hover:text-slate-800 text-sm font-semibold px-2 py-1 rounded-lg border border-slate-200","aria-label":"More actions",onClick:()=>Ee(a=>!a),children:"More"}),Of&&i.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>{re(!1),Ee(!1)},children:""}),V&&l&&i.jsxs("div",{className:"absolute right-0 top-8 min-w-[220px] rounded-xl border border-slate-200 bg-white shadow-lg p-1 z-10 text-sm",children:[i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-slate-800",onClick:()=>{Ee(!1),iy()},children:"Sign out of Google Drive"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 disabled:text-slate-400 disabled:hover:bg-transparent text-rose-700",disabled:!N,onClick:()=>{Ee(!1),uy()},children:"Delete active class file"}),i.jsx("button",{type:"button",className:"w-full text-left rounded-lg px-3 py-2 hover:bg-slate-100 text-rose-700",onClick:ay,children:"Clear local ClassSeats data (this device)"})]})]})]}),s?i.jsx("div",{className:"space-y-2 text-sm text-rose-700",children:i.jsx("p",{children:o})}):l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-600",children:i.jsxs("div",{children:[i.jsxs("p",{children:["Signed in as: ",i.jsx("span",{className:"font-semibold text-slate-900",children:((zf=l.profile)==null?void 0:zf.email)||"your account"})]}),i.jsxs("p",{children:["Current file: ",i.jsx("span",{className:"font-semibold text-slate-900",children:(N==null?void 0:N.name)||(ee==null?void 0:ee.name)||"None selected"})]})]})}),jm,i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Your files"}),i.jsx("button",{type:"button","aria-label":"Refresh file list",className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>void Ya(!0),children:""})]}),i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-3 max-h-64 overflow-auto space-y-2",children:[g&&i.jsx("p",{className:"text-sm text-slate-500",children:"Loading Drive files"}),b&&i.jsx("p",{className:"text-sm text-rose-600",children:b}),!g&&!b&&c.length===0&&i.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[i.jsx("p",{className:"font-semibold",children:"No ClassSeats files found yet."}),i.jsx("p",{className:"text-slate-500",children:"Create your class file on desktop first, then tap refresh."})]}),!g&&!b&&c.length>0&&c.map(a=>{const p=(ee==null?void 0:ee.id)===a.id,h=(N==null?void 0:N.id)===a.id;return i.jsxs("button",{className:`w-full text-left rounded-xl border px-3 py-2 transition ${p?"border-indigo-400 bg-indigo-50 text-indigo-900":h?"border-emerald-400 bg-emerald-50 text-emerald-900":"border-slate-200 bg-white hover:bg-slate-100"}`,onClick:()=>Oe(a),children:[i.jsx("p",{className:"text-sm font-semibold",children:a.name}),i.jsxs("p",{className:"text-[11px] text-slate-500",children:["Updated ",a.modifiedTime?new Date(a.modifiedTime).toLocaleString():"",a.size?`  ${(Number(a.size)/1024).toFixed(1)} KB`:""]}),h&&i.jsx("p",{className:"text-[11px] text-emerald-700 font-semibold",children:"Active"})]},a.id)})]}),i.jsx("button",{className:"w-full rounded-2xl bg-emerald-600 text-white font-semibold py-2 disabled:opacity-50",onClick:cy,disabled:!ee||Xe,children:Xe?"Loading":yy})]})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm text-slate-700",children:"Hi! you need a Class File already set up in your Google Drive to access mobile. Let's get you connected."}),i.jsx("button",{className:"w-full rounded-2xl bg-indigo-600 text-white font-semibold py-2",onClick:()=>{Re(!0)},children:"Connect to Google Drive"})]})]})]})]})]}),i.jsx("div",{className:"fixed inset-x-0 bottom-0 px-4 pb-[env(safe-area-inset-bottom)]",children:i.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow-lg px-4 py-3 flex flex-wrap items-center gap-2 text-xs text-slate-700",children:[i.jsxs("div",{className:"flex-1 min-w-[180px]",children:[i.jsx("p",{className:"font-semibold text-slate-900",children:Pr?"Saving":El?`Synced ${new Date(El).toLocaleTimeString()}`:"Ready"}),i.jsxs("p",{className:"text-[11px] text-slate-500 truncate",children:[l?(($f=l.profile)==null?void 0:$f.email)||"Signed in":"Not signed in"," "," ",(N==null?void 0:N.name)||(ee==null?void 0:ee.name)||"No file selected",fe&&"  Offline"]}),jn&&i.jsx("p",{className:"text-[11px] text-amber-700",children:"Pending sync"})]}),i.jsxs("div",{className:"flex w-full items-center gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"rounded-full bg-emerald-600 text-white px-3 py-2 text-xs font-semibold disabled:opacity-50 flex-none",disabled:!l||!N,onClick:()=>void Ye(),children:"Sync Now"}),i.jsx("button",{className:"rounded-full bg-slate-900 text-white px-3 py-2 text-xs font-semibold flex-none",onClick:()=>l?re(!0):void Re(!0,"cta"),children:"Manage Files"})]}),i.jsxs("button",{type:"button",onClick:ey,className:"relative ml-auto inline-flex h-9 w-9 items-center justify-center rounded-full bg-slate-100 text-slate-700 hover:bg-slate-200 flex-none",title:"Messages","aria-label":"Messages",children:[i.jsx("span",{"aria-hidden":!0,className:"text-2xl leading-none",children:""}),Me>0&&i.jsx("span",{className:"absolute -top-1 -right-1 inline-flex min-w-[16px] items-center justify-center rounded-full bg-violet-600 text-white px-1 py-0.5 text-[10px] font-semibold",children:Me})]})]})]})}),i.jsx(b1,{isOpen:pt,onRequestClose:ty,unreadMessages:fn,allMessages:Hn,dismissedIds:St,onDismiss:ny}),i.jsx(v1,{open:ze,onClose:()=>wt(!1),buildRevision:Cm}),i.jsx(K1,{open:gy,onBypass:xy})]}),fe&&i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-4 text-center space-y-2 text-slate-900",children:[i.jsx("p",{className:"text-base font-semibold",children:"Mobile paused while offline"}),i.jsx("p",{className:"text-sm text-slate-600",children:"Edits are disabled while offline. Reconnect to resume."}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Last sync: ",El?new Date(El).toLocaleTimeString():"No sync yet"]})]})})]})})}function yb({toasts:e}){return i.jsx("div",{className:"fixed right-4 top-4 z-[1000] flex w-[320px] max-w-[calc(100vw-2rem)] flex-col gap-2",children:e.map(t=>{const n=t.kind==="success"?"border-emerald-200 bg-emerald-50 text-emerald-900":t.kind==="error"?"border-rose-200 bg-rose-50 text-rose-900":t.kind==="warning"?"border-amber-200 bg-amber-50 text-amber-900":"border-slate-200 bg-slate-50 text-slate-800",r=t.kind==="success"?"":t.kind==="error"?"":t.kind==="warning"?"":"";return i.jsx("div",{className:`rounded-xl border px-3 py-2 shadow-sm ${n}`,children:i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx("span",{"aria-hidden":"true",children:r}),i.jsx("div",{className:"leading-snug",children:t.message})]})},t.id)})})}function xb({open:e,opts:t,onCancel:n,onConfirm:r}){if(!e||!t)return null;const s=t.tone??"default",o=t.confirmText??"Confirm",l=t.cancelText===null,u=t.cancelText??"Cancel",c=s==="danger"?"bg-rose-600 hover:bg-rose-700 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 flex items-center justify-end gap-2",children:[!l&&i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:`rounded-xl px-4 py-2 text-sm font-semibold ${c}`,onClick:r,children:o})]})]})})}function vb({open:e,opts:t,onCancel:n,onConfirm:r}){const[s,o]=d.useState("");if(d.useEffect(()=>{e&&t&&o(t.defaultValue??"")},[e,t]),!e||!t)return null;const l=t.confirmText??"OK",u=t.cancelText??"Cancel",c=t.inputType??"text";return i.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/40 p-4",children:i.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl border border-slate-200",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t.title}),t.message&&i.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t.message})]}),i.jsxs("div",{className:"p-5 space-y-3",children:[i.jsx("input",{autoFocus:!0,type:c,value:s,onChange:f=>o(f.target.value),placeholder:t.placeholder??"",className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"}),i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:n,children:u}),i.jsx("button",{className:"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700",onClick:()=>r(s),children:l})]})]})]})})}function wb(){return Math.random().toString(16).slice(2)+Date.now().toString(16)}function Sb({children:e}){const[t,n]=d.useState([]),r=d.useRef(null),[s,o]=d.useState(!1),[l,u]=d.useState(null),c=d.useRef(null),[f,g]=d.useState(!1),[S,b]=d.useState(null),E=d.useCallback((y,m,v=2500)=>{const T=wb(),O={id:T,kind:y,message:m,durationMs:v};n(F=>[...F,O]),window.setTimeout(()=>{n(F=>F.filter($=>$.id!==T))},v)},[]),j=d.useCallback(y=>(u(y),o(!0),new Promise(m=>{r.current=m})),[]),k=d.useCallback(y=>(b(y),g(!0),new Promise(m=>{c.current=m})),[]),q=d.useMemo(()=>({toast:E,confirm:j,prompt:k}),[E,j,k]);return i.jsxs(uw.Provider,{value:q,children:[e,i.jsx(yb,{toasts:t}),i.jsx(xb,{open:s,opts:l,onCancel:()=>{o(!1);const y=r.current;r.current=null,y==null||y(!1)},onConfirm:()=>{o(!1);const y=r.current;r.current=null,y==null||y(!0)}}),i.jsx(vb,{open:f,opts:S,onCancel:()=>{g(!1);const y=c.current;c.current=null,y==null||y(null)},onConfirm:y=>{g(!1);const m=c.current;c.current=null,m==null||m(y)}})]})}const wr={waiting:!1,registration:null},Lc=new Set;let Am=null;const Oc="cs_sw_update_requested_v1",bb=2*60*1e3;function _0(){for(const e of Lc)e({...wr})}function Im(e){e&&Am===e||(e&&(Am=e),!wr.waiting&&(wr.waiting=!0,_0()))}function Nb(e){return Lc.add(e),e({...wr}),()=>{Lc.delete(e)}}async function kb(){var e,t,n;if("serviceWorker"in navigator&&!window.__cs_sw_registered){window.__cs_sw_registered=!0;try{const o=await navigator.serviceWorker.register("/service-worker.js?rev=a32766475c1a39cab07b90358057538f7aed4185",{updateViaCache:"none"});wr.registration=o;const l=()=>{try{const f=window.sessionStorage.getItem(Oc);if(!f)return!1;const g=Number(f);if(!Number.isFinite(g))return!1;const S=Date.now()-g<bb;return S||window.sessionStorage.removeItem(Oc),S}catch{return!1}};if(o.waiting&&navigator.serviceWorker.controller){const f=l();console.info("[PWA] waiting SW detected",{active:(e=o.active)==null?void 0:e.scriptURL,waiting:(t=o.waiting)==null?void 0:t.scriptURL,controller:(n=navigator.serviceWorker.controller)==null?void 0:n.scriptURL,updateRequested:f}),f?o.waiting.postMessage({type:"SKIP_WAITING"}):Im(o.waiting.scriptURL)}o.addEventListener("updatefound",()=>{const f=o.installing;f&&f.addEventListener("statechange",()=>{var g,S,b,E;if(f.state==="installed"&&navigator.serviceWorker.controller){const j=l();console.info("[PWA] SW installed update",{active:(g=o.active)==null?void 0:g.scriptURL,waiting:(S=o.waiting)==null?void 0:S.scriptURL,installing:f.scriptURL,controller:(b=navigator.serviceWorker.controller)==null?void 0:b.scriptURL,updateRequested:j}),j?(E=o.waiting)==null||E.postMessage({type:"SKIP_WAITING"}):Im(f.scriptURL)}})});const u=()=>{wr.waiting||o.update().catch(()=>{})};window.addEventListener("focus",u),window.setInterval(u,6e4),_0();let c=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{c||(c=!0,wr.waiting=!1,window.location.reload())})}catch(r){console.warn("[PWA] SW registration failed",r)}}}async function jb(){var t,n,r;const e=wr.registration;if(e!=null&&e.waiting){console.info("[PWA] activate update",{active:(t=e.active)==null?void 0:t.scriptURL,waiting:(n=e.waiting)==null?void 0:n.scriptURL,controller:(r=navigator.serviceWorker.controller)==null?void 0:r.scriptURL});try{window.sessionStorage.setItem(Oc,String(Date.now()))}catch{}e.waiting.postMessage({type:"SKIP_WAITING"})}}function Cb(){const[e,t]=d.useState({waiting:!1,registration:null});return d.useEffect(()=>Nb(t),[]),e.waiting?i.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-[9999]",children:i.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-slate-900 text-white px-4 py-3 shadow-xl",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Update available"}),i.jsx("button",{className:"rounded-xl bg-white/15 hover:bg-white/25 px-3 py-1 text-sm font-semibold",onClick:async()=>{await jb()},children:"Refresh"})]})}):null}const Eb=["classseats_","classseats.","newui_"],Rb=new Set(["attendance:lastDate"]),_b=["classseats_auth","classseats-cache"],Du={border:"1px solid #cbd5e1",borderRadius:"10px",padding:"10px 14px",background:"#ffffff",color:"#0f172a",fontWeight:600,cursor:"pointer"};function Tb(){try{const e=[];for(let t=0;t<window.localStorage.length;t+=1){const n=window.localStorage.key(t);if(!n)continue;(Eb.some(s=>n.startsWith(s))||Rb.has(n))&&e.push(n)}for(const t of e)window.localStorage.removeItem(t)}catch{}}function Pb(){try{window.sessionStorage.clear()}catch{}}function Ab(){return"indexedDB"in window?Promise.all(_b.map(e=>new Promise(t=>{try{const n=window.indexedDB.deleteDatabase(e);n.onsuccess=()=>t(),n.onerror=()=>t(),n.onblocked=()=>t()}catch{t()}}))).then(()=>{}):Promise.resolve()}async function Ib(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(t=>t.unregister()))}catch{}}async function Db(){if("caches"in window)try{const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t)))}catch{}}function Dm(){window.location.reload()}class Lb extends Os.Component{constructor(){super(...arguments),this.state={hasError:!1,details:""},this.onReload=()=>{Dm()},this.onRefresh=async()=>{await Ib(),await Db(),Dm()},this.onRestart=async()=>{window.confirm("Restart will clear local ClassSeats data on this device, then reload the app. Continue?")&&(Tb(),Pb(),await Ab(),await this.onRefresh())}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t){const n=t instanceof Error?t.message:String(t||"Unknown error");this.setState({details:n})}render(){return this.state.hasError?i.jsx("div",{role:"alert",style:{minHeight:"100dvh",display:"grid",placeItems:"center",background:"#f8fafc",color:"#0f172a",padding:"24px"},children:i.jsxs("div",{style:{width:"100%",maxWidth:"560px",background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"14px",padding:"20px",boxShadow:"0 10px 30px rgba(15, 23, 42, 0.08)"},children:[i.jsx("h1",{style:{margin:"0 0 8px",fontSize:"1.1rem"},children:"Oops - the most recent update did not install properly. This happens sometimes. Sorry! "}),i.jsx("p",{style:{margin:"0 0 12px",lineHeight:1.45},children:"Try the buttons below, in order, to try to get things running again."}),i.jsx("p",{style:{margin:"0 0 16px",lineHeight:1.45,color:"#334155"},children:"If that does not work, delete the shortcut on your home screen, go to mobile.classseats.app, and add a new shortcut to your home screen."}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsx("button",{type:"button",onClick:this.onReload,style:Du,children:"Reload"}),i.jsx("button",{type:"button",onClick:this.onRefresh,style:Du,children:"Refresh"}),i.jsx("button",{type:"button",onClick:this.onRestart,style:Du,children:"Restart"})]}),this.state.details?i.jsxs("p",{style:{margin:"12px 0 0",fontSize:"0.86rem",color:"#475569"},children:["Error details: ",this.state.details]}):null]})}):this.props.children}}const Ob=document.getElementById("root"),Lm="cs_chunk_recovery";function Mb(){window.__cs_boot_mounted=!0,window.dispatchEvent(new Event("classseats:boot-mounted"))}function Ub(){return Os.useEffect(()=>{Mb()},[]),null}function T0(e){if(!e)return!1;const t=typeof e=="string"?e:typeof e.message=="string"?e.message:"";return t.includes("Loading chunk")||t.includes("ChunkLoadError")||t.includes("Failed to fetch dynamically imported module")||t.includes("Importing a module script failed")}function P0(){sessionStorage.getItem(Lm)||(sessionStorage.setItem(Lm,"1"),"serviceWorker"in navigator?navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(t=>t.unregister()))).finally(()=>window.location.reload()):window.location.reload())}window.addEventListener("error",e=>{T0(e.error||e.message)&&P0()});window.addEventListener("unhandledrejection",e=>{T0(e.reason)&&P0()});Lu.createRoot(Ob).render(i.jsx(Os.StrictMode,{children:i.jsx(Lb,{children:i.jsx(YS,{children:i.jsxs(Sb,{children:[i.jsx(Ub,{}),i.jsx(gb,{}),i.jsx(Cb,{})]})})})})),kb();
